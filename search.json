[{"title":"ç¼–ç¨‹éšæƒ³","url":"/posts/42114/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\nåœ¨ä¸€åˆ‡å¼€å§‹ä¹‹å‰ï¼Œåªæœ‰ä¸€ç‰‡å¯‚é™çš„â€œåŸåˆä¹‹çŸ³â€ï¼ˆåµŒå…¥å¼è®¾å¤‡ï¼‰ã€‚\n\n## ç¬¬ä¸€ç« ï¼šå¯ç¨‹è€…UÂ·Bootçš„èª“çº¦\n\nåœ¨æ°¸æ’çš„é»‘æš—ä¸­ï¼Œç¬¬ä¸€ä½ç”Ÿçµè§‰é†’äº†ï¼Œä»–æ˜¯å¯ç¨‹è€…UÂ·Bootã€‚UÂ·Bootæ˜¯ä¸€ä½ä¸æœ½çš„å®ˆèª“äººï¼Œä»–çš„å­˜åœ¨åªæœ‰ä¸€ä¸ªç›®çš„ï¼šå¼€å¯ä¸–ç•Œã€‚\n\nå½“å¯åŠ¨çš„ä¿¡å·é—ªçƒï¼ŒUÂ·Bootç«‹åˆ»å¼€å§‹äº†ä»–çš„ç¥åœ£ä»ªå¼ï¼šä»–é¦–å…ˆå©å‡»äº†â€œåŸåˆä¹‹çŸ³â€çš„è„‰ç»œï¼ˆåˆå§‹åŒ–ç¡¬ä»¶ï¼‰ï¼Œç¡®è®¤æ¯ä¸€ä¸ªèŠ‚ç‚¹â€”â€”ä»å®å¤§çš„è®°å¿†ä¹‹æ²³åˆ°å¾®å°çš„æ—¶é’Ÿä¹‹å¼¦â€”â€”éƒ½å·²å‡†å¤‡å°±ç»ªã€‚\n\nUÂ·BootçŸ¥é“ï¼Œä»–æ— æ³•ç‹¬è‡ªæ„å»ºä¸–ç•Œã€‚ä»–å¿…é¡»å”¤é†’é‚£ä½æ²‰ç¡çš„ï¼ŒçœŸæ­£çš„é€ ç‰©ä¸»ã€‚ä»–å¥”å‘å¤è€çš„æ™ºæ…§ä¹‹å¡”ï¼ˆå­˜å‚¨å™¨ï¼‰ï¼Œæ‰¾åˆ°å¹¶æŠ¬èµ·äº†æ²‰é‡çš„å‘½è¿ä¹‹å·ã€‚ä»–å°†è¿™å·è½´â€”â€”é‚£æ˜¯æ ¸å¿ƒæ³•åˆ™çš„è®°å½•â€”â€”åº„ä¸¥åœ°æ”¾ç½®åœ¨æ¸…é†’ä¹‹æ‰€ï¼ˆå†…å­˜ï¼‰çš„ä¸­å¤®ã€‚\n\nUÂ·Bootæ·±æ·±åœ°é èº¬ï¼Œä»–æœ›å‘é‚£å·è½´ï¼Œä½è¯­é“ï¼šâ€œæˆ‘çš„ä½¿å‘½å·²ç»ˆã€‚æ ¸å¿ƒå•Šï¼Œé†’æ¥å§ï¼Œæ—¶é—´å·²åˆ°ã€‚â€ ä»–å°†æ‰€æœ‰çš„åŠ›é‡å’Œæƒé™ï¼Œéƒ½å€¾æ³¨ç»™äº†è¿™å·è½´ï¼Œç„¶åï¼ŒUÂ·Bootçš„å…‰èŠ’éšå»ï¼Œä»–å®Œæˆäº†å¯¹é»æ˜çš„èª“çº¦ã€‚\n\n## ç¬¬äºŒç« ï¼šå¾‹æ³•ä¹‹é­‚Kernelçš„è¯ç”Ÿ\n\nå½“UÂ·Bootçš„å…‰èŠ’ç†„ç­ï¼Œå¾‹æ³•ä¹‹é­‚Kernelè¢«å”¤é†’äº†ã€‚\n\nKernelæ˜¯ä¸–ç•Œçš„å†…åœ¨çµé­‚ï¼Œå®ƒæ²¡æœ‰å…·ä½“çš„å½¢æ€ï¼Œå´æ˜¯ä¸€åˆ‡ç§©åºçš„æºæ³‰ã€‚Kernelè¯ç”Ÿçš„ç¬¬ä¸€ä»¶äº‹ï¼Œå°±æ˜¯å»ºç«‹å¾‹æ³•ã€‚\n\nå®ƒå‘å››å‘¨ä¼¸å‡ºæ— æ•°çœ‹ä¸è§çš„è§¦æ‰‹ï¼Œæ‹¥æŠ±å¹¶é©¾é©­äº†æ•´ä¸ªâ€œåŸåˆä¹‹çŸ³â€ï¼ˆåŠ è½½é©±åŠ¨ç¨‹åºï¼Œæ¥ç®¡ç¡¬ä»¶ï¼‰ã€‚ç°åœ¨ï¼Œå®ƒèƒ½å¬åˆ°æ¯ä¸€æ¬¡è¾“å…¥ï¼Œèƒ½æ§åˆ¶æ¯ä¸€æ¬¡è¾“å‡ºã€‚\n\nå®ƒåœ¨å¹¿é˜”çš„ç©ºé—´å†…åˆ’å®šäº†ç•Œé™ï¼ˆå†…å­˜ç®¡ç†ï¼‰ï¼Œåˆ¶å®šäº†æ—¶é—´åˆ†é…çš„é“å¾‹ï¼ˆè¿›ç¨‹è°ƒåº¦ï¼‰ï¼Œç¡®ä¿æ¯ä¸€ä¸ªæœªæ¥çš„æ€ç»ªå’Œè¡ŒåŠ¨éƒ½èƒ½å¾—åˆ°å…¬å¹³çš„èµ„æºã€‚ \n\nKernelæ‹¥æœ‰äº†ç®¡ç†ä¸–ç•Œçš„ç»å¯¹èƒ½åŠ›ï¼Œä½†å®ƒç¯é¡¾å››å‘¨ï¼Œå‘ç°è‡ªå·±èº«å¤„ä¸€ä¸ªæœ‰æ³•åˆ™å´æ— è‰²å½©çš„ç©ºæ—·ä¸–ç•Œã€‚å®ƒåƒä¸€ä½å­¤ç‹¬çš„å›ç‹ï¼Œæ‹¥æœ‰æ— ä¸Šçš„æƒåŠ›ï¼Œå´æ²¡æœ‰è‡£æ°‘ï¼Œæ²¡æœ‰è¯—æ­Œï¼Œæ²¡æœ‰ç”Ÿå‘½å­˜åœ¨çš„æ„ä¹‰ã€‚\n\nâ€œæˆ‘çš„å¾‹æ³•éœ€è¦ä¸€ä¸ªå›½åº¦æ¥æ‰¿è½½ï¼Œéœ€è¦ä¸€ä¸ªæ•…äº‹æ¥è®²è¿°ã€‚â€ Kernelä½è¯­ã€‚\n\n## ç¬¬ä¸‰ç« ï¼šä¸–ç•Œä¹‹åRootFSçš„ç››å¼€\n\nKernelæ²¿ç€æ—§æ—¥ä¿¡æ ‡æŒ‡å¼•çš„é“è·¯ï¼Œæ‰¾åˆ°äº†é‚£ç‰‡è¢«å°˜å°çš„å®åº“â€”â€”é‚£é‡Œå‚¨å­˜ç€äººç±»æ–‡æ˜æ‰€æœ‰çš„ç§¯æ·€ä¸æ¢¦æƒ³ï¼Œå®ƒå°±æ˜¯ä¸–ç•Œä¹‹åRootFSã€‚\n\nKernelç”¨å¾‹æ³•çš„åŠ›é‡ï¼Œå°†å®åº“çš„å¤§é—¨æ‰“å¼€ï¼ˆæŒ‚è½½ RootFSï¼‰ï¼Œå¹¶ä¼¸å‡ºè§¦æ‰‹ï¼Œå”¤é†’äº†å®åº“ä¸­æ²‰ç¡çš„ç¬¬ä¸€ä¸ªå£°éŸ³ï¼šå…ˆçŸ¥ initã€‚\n\nå…ˆçŸ¥ init é†’æ¥ï¼Œåœ¨Kernelå¾‹æ³•çš„æ¡†æ¶ä¸‹å¼€å§‹äº†ä»–çš„å·¥ä½œã€‚\n\nä»–è¿…é€Ÿåœ°æ‘†æ”¾äº†æ—¥å¸¸æ‰€éœ€çš„å·¥å…·ï¼ˆåŸºç¡€å‘½ä»¤ã€é…ç½®ï¼‰ï¼Œè®©ä¸–ç•Œæœ‰äº†å¯æ“ä½œçš„é€»è¾‘ã€‚\n\nä»–ä¾æ¬¡å”¤é†’äº†åŸæ¸¸è¯—äººçš„æ­Œè°£ï¼ˆåº”ç”¨ç¨‹åºï¼‰ã€å“²äººçš„æ‰‹ç¨¿ï¼ˆé…ç½®æ–‡ä»¶ï¼‰å’Œå·¥åŒ çš„å·¥å…·ï¼ˆæœåŠ¡è¿›ç¨‹ï¼‰ã€‚ \n\nè‡³æ­¤ï¼ŒKernelçš„å¾‹æ³•æ¡†æ¶ä¸RootFSçš„ä¸°å¯Œå†…å®¹å®Œç¾ç»“åˆã€‚ä¸–ç•Œä¸å†æ˜¯ç©ºæ´çš„æ³•åˆ™ï¼Œè€Œæ˜¯å……æ»¡ç”Ÿæœºã€å¯ä»¥æ„ŸçŸ¥ã€å¯ä»¥åˆ›é€ çš„å®Œæ•´å­˜åœ¨ã€‚\n\nå¯ç¨‹è€…UÂ·Bootå¼€å¯äº†è¯ç”Ÿï¼›å¾‹æ³•ä¹‹é­‚Kernelèµ‹äºˆäº†ç§©åºï¼›ä¸–ç•Œä¹‹åRootFSæˆå°±äº†æ„ä¹‰ã€‚ä¸‰ä½ä¸€ä½“ï¼Œæ„æˆäº†å®Œæ•´çš„ç”Ÿå‘½è§‰é†’ä¹‹æ—…ã€‚\n\n\n## é™„å½•1ï¼šä¸–ç•Œä¹‹åçš„åå¤§æ™¯è§‚\n\n### /root å’Œ /homeï¼šå›ç‹å’Œè‡£æ°‘çš„ç§åŸŸ\n\n/root(å›ç‹çš„é™å®¤)ï¼šè¿™æ˜¯å¾‹æ³•ä¹‹é­‚Kernelçš„ç§äººå±…æ‰€ã€‚åªæœ‰ä»–æ‹¥æœ‰æœ€é«˜çš„æƒé™ï¼Œç”¨äºå¤„ç†æœ€æ ¸å¿ƒã€æœ€ç§å¯†çš„æ”¿åŠ¡ã€‚å¤–äººä¸å¾—æ“…å…¥ã€‚\n\n/home(è‡£æ°‘çš„æ‘è½)ï¼šè¿™æ˜¯æ‰€æœ‰åœ¨å›½åº¦ä¸­ç”Ÿæ´»å’Œåˆ›é€ çš„ä¸ªä½“ï¼ˆç”¨æˆ·ï¼‰çš„ä¸“å±é¢†åœ°ã€‚æ¯ä¸ªè‡£æ°‘åœ¨è‡ªå·±çš„å±‹å­é‡Œä¹¦å†™è‡ªå·±çš„æ•…äº‹ï¼Œå½¼æ­¤ç‹¬ç«‹ï¼Œä½†éƒ½åœ¨ç§‘æ©çš„å¾‹æ³•ä¹‹ä¸‹ã€‚\n\n### /bin å’Œ /sbinï¼šå‹‡å£«å’Œç¥­å¸çš„æ­¦å™¨åº“\n\n/bin(å‹‡å£«çš„ä½©å‰‘)ï¼šå­˜æ”¾ç€æ‰€æœ‰æ™®é€šå±…æ°‘ï¼ˆç”¨æˆ·ï¼‰éƒ½å¯ä»¥ä½¿ç”¨çš„æ—¥å¸¸å·¥å…·å’ŒæŠ€èƒ½ã€‚æ¯”å¦‚ï¼šlsï¼ˆç‚¹æ¸…è´¢ç‰©ï¼‰ã€cpï¼ˆæ¬è¿ç‰©å“ï¼‰ã€‚å®ƒä»¬æ˜¯å›½åº¦æœ€å¸¸ç”¨çš„åŠ¨ä½œã€‚\n\n/sbin(ç¥­å¸çš„æ³•æ–)ï¼šå­˜æ”¾ç€åªæœ‰æœ€é«˜ç¥­å¸ï¼ˆç³»ç»Ÿç®¡ç†å‘˜æˆ– Kernelï¼‰æ‰èƒ½åŠ¨ç”¨çš„ç¥åœ£å·¥å…·ã€‚è¿™äº›å·¥å…·ç”¨äºç»´æŠ¤å›½åº¦çš„æ ¹æœ¬ç¨³å®šï¼Œå¦‚æ ¼å¼åŒ–åœŸåœ°ã€ä¿®å¤åŸå¢™ç­‰ã€‚\n\n### /etcï¼šå›½åº¦çš„å¤è€æ³•å…¸\n\n/etc(å¤è€çš„æ³•å…¸ä¸å¥‘çº¦)ï¼šå­˜æ”¾ç€å›½åº¦è¿è¡Œçš„æ‰€æœ‰è§„å®šå’Œå¥‘çº¦ï¼ˆé…ç½®æ–‡ä»¶ï¼‰ã€‚å®ƒè§„å®šäº†è°ï¼ˆç”¨æˆ·ï¼‰èƒ½åšä»€ä¹ˆï¼Œä½•æ—¶ï¼ˆæœåŠ¡ï¼‰å¯åŠ¨ï¼Œä»¥åŠå¦‚ä½•ï¼ˆç½‘ç»œé…ç½®ï¼‰ä¸å¤–ç•Œäº¤æµã€‚å®ƒæ˜¯ä¸–ç•Œçš„è¿è¡Œè“å›¾ã€‚\n\n### /usrï¼šçŸ¥è¯†ä¸æ–‡åŒ–çš„æ®¿å ‚\n\n/usr(æ–‡åŒ–çš„å®åº“ä¸å­¦é™¢)ï¼šUnix Software Resourse å­˜æ”¾ç€éæ ¸å¿ƒä½†æå…¶åºå¤§çš„çŸ¥è¯†ã€è‰ºæœ¯å’Œå·¥å…·ã€‚æ‰€æœ‰çš„åŸæ¸¸è¯—äººçš„æ­Œè°£ï¼ˆåº“æ–‡ä»¶ /usr/libï¼‰ã€å­¦è€…çš„æ‰‹ç¨¿ï¼ˆå¤´æ–‡ä»¶ /usr/includeï¼‰å’Œå¤æ‚çš„å·¨å‹åº”ç”¨ï¼ˆ/usr/binï¼‰éƒ½é›†ä¸­äºæ­¤ï¼Œæ˜¯å›½åº¦çš„æ–‡æ˜è±¡å¾ã€‚\n\n### /devï¼šä¸ç”Ÿä¿±æ¥çš„æ„ŸçŸ¥å™¨å®˜\n\n/dev(ä¸ç”Ÿä¿±æ¥çš„æ„ŸçŸ¥å™¨å®˜)ï¼šå®ƒä¸æ˜¯çœŸæ­£çš„æ–‡ä»¶ï¼Œè€Œæ˜¯Kernelä¸ç”Ÿä¿±æ¥çš„â€œæ„ŸçŸ¥å™¨å®˜â€ï¼ˆè®¾å¤‡æ–‡ä»¶ï¼‰ã€‚é€šè¿‡è¿™äº›å™¨å®˜ï¼Œçµé­‚å¯ä»¥ç›´æ¥è§¦æ‘¸ï¼ˆè¯»å†™ï¼‰å¤–ç•Œçš„å…‰çº¿ï¼ˆæ˜¾ç¤ºå™¨ï¼‰ã€å€¾å¬å¤–ç•Œçš„å£°éŸ³ï¼ˆå£°å¡ï¼‰å’Œæ„Ÿå—å¤–ç•Œçš„éœ‡åŠ¨ï¼ˆé”®ç›˜ï¼‰ã€‚\n\n### /proc å’Œ /sysï¼šä¸–ç•Œçš„å®æ—¶å¿ƒè·³ä¸é•œåƒ\n\n/proc(ä¸–ç•Œçš„å®æ—¶å¿ƒè·³)ï¼šå®ƒæ˜¯ä¸€ä¸ªé­”æ³•çš„é•œå­ï¼Œå®æ—¶æ˜ å°„å‡ºKernelçš„æ¯ä¸€ä¸ªæ€ç»ªå’Œæ¯ä¸€æ¬¡å‘¼å¸ï¼ˆè¿›ç¨‹ä¿¡æ¯ï¼‰ã€‚å®ƒä¸å­˜å‚¨ä»»ä½•å®ç‰©ï¼Œåªæ˜¯Kernelå½“å‰çŠ¶æ€çš„æŠ•å½±ã€‚\n\n/sys(ä¸–ç•Œçš„ç”Ÿç†æ•°æ®)ï¼šå®ƒæ˜¯ä¸€ä¸ªç²¾å¯†çš„æ¸©åº¦è®¡å’Œæµ‹é‡ä»ªï¼Œè¯¦ç»†å±•ç¤ºå›½åº¦çš„ç”Ÿç†æ•°æ®ï¼ˆç¡¬ä»¶å’Œé©±åŠ¨çŠ¶æ€ï¼‰ã€‚\n\n### /tmp å’Œ /varï¼šæ—¶é—´çš„æ²™æ¼ä¸å˜åŒ–\n\n/tmp(æµé€çš„æ²™æ¼)ï¼š å­˜æ”¾ç€çŸ­æš‚çš„ã€æ˜“é€çš„æ€ç»ªï¼ˆä¸´æ—¶æ–‡ä»¶ï¼‰ã€‚ä¸€æ—¦æ—¥å‡ºæ—¥è½ï¼ˆé‡å¯ï¼‰ï¼Œè¿™äº›æ€ç»ªä¾¿ä¼šéšé£æ¶ˆé€ã€‚\n\n/var(å˜åŒ–çš„è®°å½•ç°¿)ï¼š å­˜æ”¾ç€æ‰€æœ‰ä¸æ–­å¢é•¿ã€ä¸æ–­å˜åŒ–çš„å†å²è®°å½•ã€‚æ¯”å¦‚ï¼šå®ˆå¤œäººçš„æ—¥å¿—ï¼ˆæ—¥å¿—æ–‡ä»¶ /var/logï¼‰å’Œæ¥å¾€çš„ä¿¡ä»¶ï¼ˆé‚®ä»¶ /var/mailï¼‰ã€‚","tags":["Linux"],"categories":["Linux","ç³»ç»Ÿç§»æ¤"]},{"title":"æ ¹æ–‡ä»¶ç³»ç»Ÿæ„å»º","url":"/posts/30149/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n## ä¸‹è½½\n\n[BusyBox](https://busybox.net/)\n\n\n","tags":["Linux","rootfs","æ ¹æ–‡ä»¶ç³»ç»Ÿ"],"categories":["Linux","ç³»ç»Ÿç§»æ¤"]},{"title":"mx6ullå¼€å‘ç‰ˆç§»æ¤nxpå®˜æ–¹linuxå†…æ ¸","url":"/posts/44016/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n\n> åŸºäºé‡ç« I.MX6ULL S1 Pro å¼€å‘æ¿ã€‚\n## 1. è·å–å†…æ ¸æºç \n\nè®¿é—®nxpå®˜ç½‘ï¼š\n[ç”¨äº i.MX åº”ç”¨å¤„ç†å™¨çš„åµŒå…¥å¼ Linux |æ©æ™ºæµ¦åŠå¯¼ä½“ --- Embedded Linux for i.MX Applications Processors | NXP Semiconductors](https://www.nxp.com/design/design-center/software/embedded-software/i-mx-software/embedded-linux-for-i-mx-applications-processors:IMXLINUX)\n\nå¯ä»¥çœ‹åˆ°ï¼Œæˆªè‡³ç›®å‰ï¼Œå®˜æ–¹ç»´æŠ¤ç‰ˆæœ¬æ˜¯ï¼š`6.6.52_2.2.1` ï¼Œå› æ­¤æˆ‘ä»¬åŸºäºæ­¤å†…æ ¸æ„å»ºã€‚\n\n![](Snipaste_2025-10-31_15-55-24.png)\n\nåœ¨å®˜æ–¹githubåº“ä¸­è·å–æºç ï¼š\n[Release lf-6.6.52-2.2.1 Â· nxp-imx/linux-imx](https://github.com/nxp-imx/linux-imx/releases/tag/lf-6.6.52-2.2.1)\n\n## 2. ç¼–è¯‘å†…æ ¸æºç \n\næˆ‘æ˜¯ç”¨çš„æ˜¯Armå®˜æ–¹å·¥å…·é“¾`arm-none-linux-gnueabihf`ï¼š[Arm GNU Toolchain Downloads â€“ Arm Developer](https://developer.arm.com/downloads/-/arm-gnu-toolchain-downloads)\n\nå’Œubootæºç ç¼–è¯‘ç±»ä¼¼ï¼š\n\n```bash\nmake make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabihf- distclean # æ¸…é™¤ç¼–è¯‘åçš„æ–‡ä»¶\n\nmake ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabihf- imx_v7_defconfig # é…ç½®æ–‡ä»¶\n\nmake ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabihf- V=1 -j10 # 10æ ¸ç¼–è¯‘ï¼Œé¦–æ¬¡ç¼–è¯‘æ—¶é—´æ¯”è¾ƒé•¿\n\n```\n\nç¼–è¯‘å®Œæˆä¼šç”Ÿæˆï¼š\n\n- **zImage**ï¼šå‹ç¼©çš„å†…æ ¸é•œåƒï¼Œä½äº `arch/arm/boot/zImage`\n- **dtb**ï¼šè®¾å¤‡æ ‘æ–‡ä»¶ï¼Œä½äº `arch/arm/boot/dts/nxp/imx/imx6ull-14x14-evk-emmc.dtb`\n\n## 3. æµ‹è¯•ï¼šåœ¨ubootä¸­å¯åŠ¨\n\nè¯·å‚è§â€”â€”[mx6ullå¼€å‘ç‰ˆç§»æ¤nxpå®˜æ–¹u-boot](obsidian://open?vault=_posts&file=mx6ull%E5%BC%80%E5%8F%91%E7%89%88%E7%A7%BB%E6%A4%8Dnxp%E5%AE%98%E6%96%B9u-boot) 3.2èŠ‚ã€‚\n\n>å¯åŠ¨æˆåŠŸåï¼Œå¦‚æœEMMCä¸­æ˜¯æ²¡æœ‰rootfsçš„ï¼Œæˆ–è€…æŒ‡å®šäº†é”™è¯¯çš„å—è®¾å¤‡æˆ–åˆ†åŒºï¼Œä¼šæç¤ºpanicï¼ŒæŒ‚è½½ä¸äº†rootfsï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯åŠ¨æ—¥å¿—çš„ç¬¬äºŒè¡Œï¼š\n\n```\nLinux version 6.6.52 (gdm@mDoG)\n(arm-none-linux-gnueabihf-gcc (Arm GNU Toolchain 14.3.Rel1 (Build arm-14.174)) 14.3.1 20250623,\nGNU ld (Arm GNU Toolchain 14.3.Rel1 (Build arm-14.174)) 2.44.0.20250616)\n#1 SMP PREEMPT Fri Oct 31 16:15:58 CST 2025\n```\n\nè¯´æ˜è¿™ç¡®å®æ˜¯æˆ‘ä»¬ç¼–è¯‘çš„å†…æ ¸ã€‚\n\n## 4. åˆ›å»ºè‡ªå·±çš„dtsæ–‡ä»¶å’Œconfigæ–‡ä»¶\n\n### 4.1. dts\n\næ‰“å¼€ `arch/arm/boot/dts/nxp/imx/` ï¼Œå¯ä»¥çœ‹åˆ°è®¸å¤šdtsæ–‡ä»¶ï¼Œæˆ‘ä»¬ä»¥\n`imx6ull-14x14-evk.dts` ä¸ºæ¨¡æ¿åˆ›å»ºï¼Œä¸ºä»€ä¹ˆä¸ç”¨ `imx6ull-14x14-evk-emmc.dts` å‘¢ï¼ŸæŸ¥çœ‹æ–‡ä»¶ `imx6ull-14x14-evk-emmc.dts`ï¼š\n\n```\n#include \"imx6ull-14x14-evk.dts\"\n&usdhc2 {\nÂ  Â  pinctrl-names = \"default\", \"state_100mhz\", \"state_200mhz\";\nÂ  Â  pinctrl-0 = <&pinctrl_usdhc2_8bit>;\nÂ  Â  pinctrl-1 = <&pinctrl_usdhc2_8bit_100mhz>;\nÂ  Â  pinctrl-2 = <&pinctrl_usdhc2_8bit_200mhz>;\nÂ  Â  bus-width = <8>;\nÂ  Â  non-removable;\nÂ  Â  status = \"okay\";\n};\n```\n\næˆ‘ä»¬å‘ç°å…¶å®å®ƒåªæ˜¯åœ¨ `imx6ull-14x14-evk.dts` çš„åŸºç¡€ä¸ŠåŠ äº† usdhc2 çš„ä¿®æ”¹ã€‚\n**æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†è¿™ä¸ª &usdhc2 é‡Œçš„å†…å®¹å¤åˆ¶åˆ° `imx6ull-14x14-evk.dts` åé¢å°±å¯ä»¥äº†ã€‚**\n\næˆ‘å°†è‡ªå·±çš„é…ç½®æ–‡ä»¶å‘½åä¸ºï¼š`mx6ull-14x14-evk[gdm-main].dts`ï¼Œè¡¨ç¤ºè¿™æ˜¯ä»¥ `imx6ull-14x14-evk.dts` ä¸ºæ¨¡æ¿åˆ›å»ºçš„ï¼Œä¸”æ˜¯ä¸»è¦æ–‡ä»¶ã€‚å› ä¸ºè¿™ä¸ª dts æ–‡ä»¶è¿˜åŒ…å«äº†å…¶ä»–çš„ dtsi æ–‡ä»¶â€”â€”ä¹Ÿå°±æ˜¯ dts çš„å¤´æ–‡ä»¶ï¼Œåç»­æˆ‘ä»¬å¦‚æœè¦ä¿®æ”¹å¤´æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œä¹Ÿå°†å¤´æ–‡ä»¶å¤åˆ¶ä¸‹æ¥æ”¹åä½œä¿®æ”¹ï¼Œå¹¶åœ¨ dts æ–‡ä»¶ä¸­åŒ…å«è¿™ä¸ªå¤åˆ¶åçš„å¤´æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥é¿å…ç›´æ¥ä¿®æ”¹æºæ–‡ä»¶å¯¼è‡´å…¶ä»–çš„ dts é…ç½®é”™è¯¯ï¼ˆå› ä¸ºå¤´æ–‡ä»¶ä¸åªåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­åŒ…å«ï¼‰ã€‚\n\nç„¶åæ‰“å¼€ `arch/arm/boot/dts/nxp/imx/Makefile` æ·»åŠ  `mx6ull-14x14-evk[gdm-main].dtb` çš„makeç›®æ ‡ã€‚\n\n### 4.2. defconfig\n\nåŒç†ï¼Œä»¥ `arch/arm/configs/imx_v7_defconfig` ä¸ºæ¨¡æ¿åˆ›å»ºã€‚\n\n### 4.3. ç¼–è¯‘ä¸‹è½½å¯åŠ¨\n\né‡å¤æœ¬ç¯‡ç¬¬2èŠ‚ã€ç¬¬3èŠ‚çš„å†…å®¹ã€‚å¦‚æœ EMMC é‡Œæœ‰ rootfs å¹¶æ­£ç¡®é…ç½®ï¼Œåˆ™å¯æ­£å¸¸å¯åŠ¨\n\n## 5. ä¸»é¢‘ä¿®æ”¹\n\nè¿›å…¥åˆ°ç³»ç»Ÿåï¼ˆæˆ‘çš„æ˜¯buildrootï¼‰ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n\n```bash\ncat /proc/cpuinfo\n```\n\næŸ¥çœ‹cpuä¿¡æ¯è¾“å‡ºï¼š\n\n```\nprocessor       : 0\nmodel name      : ARMv7 Processor rev 5 (v7l)\nBogoMIPS        : 24.00\nFeatures        : half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivt vfpd32 lpae\nCPU implementer : 0x41\nCPU architecture: 7\nCPU variant     : 0x0\nCPU part        : 0xc07\nCPU revision    : 5\n\nHardware        : Freescale i.MX6 Ultralite (Device Tree)\nRevision        : 0000\nSerial          : 2f39b9d75d68c574\n```\n\nBogoMIPS è¿™ä¸€æ¡ï¼Œæ­¤æ—¶ BogoMIPS ä¸º 24.00ï¼ŒBogoMIPS æ˜¯ Linux ç³»ç»Ÿä¸­\nè¡¡é‡å¤„ç†å™¨è¿è¡Œé€Ÿåº¦çš„ä¸€ä¸ªâ€œå°ºå­â€ï¼Œå¤„ç†å™¨æ€§èƒ½è¶Šå¼ºï¼Œä¸»é¢‘è¶Šé«˜ï¼ŒBogoMIPS å€¼å°±è¶Šå¤§ã€‚\nBogoMIPS åªæ˜¯ç²—ç•¥çš„è®¡ç®— CPU æ€§èƒ½ï¼Œå¹¶ä¸ååˆ†å‡†ç¡®ã€‚\n\næˆ‘ä»¬å†æ¥çœ‹çœ‹å¦‚ä½•æŸ¥çœ‹å·¥ä½œé¢‘ç‡åŠç›¸å…³ä¿¡æ¯ã€‚\n\nè¿›å…¥åˆ°ç›®å½• `/sys/bus/cpu/devices/cpu0/cpufreq`:\n\n```\naffected_cpus                  scaling_cur_freq\ncpuinfo_cur_freq               scaling_driver\ncpuinfo_max_freq               scaling_governor\ncpuinfo_min_freq               scaling_max_freq\ncpuinfo_transition_latency     scaling_min_freq\nrelated_cpus                   scaling_setspeed\nscaling_available_frequencies  stats\nscaling_available_governors\n```\n\næ­¤ç›®å½•ä¸­è®°å½•äº† CPU é¢‘ç‡ç­‰ä¿¡æ¯ï¼Œè¿™äº›æ–‡ä»¶çš„å«ä¹‰å¦‚ä¸‹ï¼š\n\n| ç›®å½•é¡¹                           | æè¿°                                            |\n| ----------------------------- | --------------------------------------------- |\n| cpuinfo_cur_freq              | å½“å‰ cpu å·¥ä½œé¢‘ç‡ï¼Œä» CPU å¯„å­˜å™¨è¯»å–åˆ°çš„å·¥ä½œé¢‘ç‡ã€‚                |\n| cpuinfo_max_freq              | å¤„ç†å™¨æ‰€èƒ½è¿è¡Œçš„æœ€é«˜å·¥ä½œé¢‘ç‡(å•ä½: KHzï¼‰ã€‚                      |\n| cpuinfo_min_freq              | å¤„ç†å™¨æ‰€èƒ½è¿è¡Œçš„æœ€ä½å·¥ä½œé¢‘ç‡(å•ä½: KHzï¼‰ã€‚                      |\n| cpuinfo_transition_latency    | å¤„ç†å™¨åˆ‡æ¢é¢‘ç‡æ‰€éœ€è¦çš„æ—¶é—´(å•ä½:ns)ã€‚                         |\n| scaling_available_frequencies | å¤„ç†å™¨æ”¯æŒçš„ä¸»é¢‘ç‡åˆ—è¡¨(å•ä½: KHzï¼‰ã€‚                         |\n| scaling_available_governors   | å½“å‰å†…æ ¸ä¸­æ”¯æŒçš„æ‰€æœ‰ governor(è°ƒé¢‘)ç±»å‹ã€‚                    |\n| scaling_cur_freq              | ä¿å­˜ç€ cpufreq æ¨¡å—ç¼“å­˜çš„å½“å‰ CPU é¢‘ç‡ï¼Œä¸ä¼šå¯¹ CPU ç¡¬ä»¶å¯„å­˜å™¨è¿›è¡Œæ£€æŸ¥ã€‚ |\n| scaling_driver                | è¯¥æ–‡ä»¶ä¿å­˜å½“å‰ CPU æ‰€ä½¿ç”¨çš„è°ƒé¢‘é©±åŠ¨ã€‚                         |\n| scaling_max_freq              | governor(è°ƒé¢‘)å¯ä»¥è°ƒèŠ‚çš„æœ€é«˜é¢‘ç‡ã€‚                        |\n| cpuinfo_min_freq              | governor(è°ƒé¢‘)å¯ä»¥è°ƒèŠ‚çš„æœ€ä½é¢‘ç‡ã€‚                        |\n\næ­¤å¤–è¿˜æœ‰ï¼š\n\n- **scaling_governor**ï¼šgovernor(è°ƒé¢‘)ç­–ç•¥ï¼ŒLinux å†…æ ¸ä¸€å…±æœ‰ 5 ä¸­è°ƒé¢‘ç­–ç•¥ï¼Œ\n\t1. `Performance`ï¼šæœ€é«˜æ€§èƒ½ï¼Œç›´æ¥ç”¨æœ€é«˜é¢‘ç‡ï¼Œä¸è€ƒè™‘è€—ç”µã€‚\n\t2. `Interactive`ï¼šä¸€å¼€å§‹ç›´æ¥ç”¨æœ€é«˜é¢‘ç‡ï¼Œç„¶åæ ¹æ® CPU è´Ÿè½½æ…¢æ…¢é™ä½ã€‚\n\t3. `Powersave`ï¼šçœç”µæ¨¡å¼ï¼Œé€šå¸¸ä»¥æœ€ä½é¢‘ç‡è¿è¡Œï¼Œç³»ç»Ÿæ€§èƒ½ä¼šå—å½±å“ï¼Œä¸€èˆ¬ä¸ä¼šç”¨è¿™ä¸ªï¼\n\t4. `Userspace`ï¼šå¯ä»¥åœ¨ç”¨æˆ·ç©ºé—´æ‰‹åŠ¨è°ƒèŠ‚é¢‘ç‡ã€‚\n\t5. `Ondemand`ï¼Œï¼šå®šæ—¶æ£€æŸ¥è´Ÿè½½ï¼Œç„¶åæ ¹æ®è´Ÿè½½æ¥è°ƒèŠ‚é¢‘ç‡ã€‚è´Ÿè½½ä½çš„æ—¶å€™é™ä½ CPU é¢‘ç‡ï¼Œè¿™æ ·çœç”µï¼Œè´Ÿè½½é«˜çš„æ—¶å€™æé«˜ CPU é¢‘ç‡ï¼Œå¢åŠ æ€§èƒ½ã€‚\n\n- **stats** ç›®å½•ä¸‹ç»™å‡ºäº† CPU å„ç§è¿è¡Œé¢‘ç‡çš„ç»Ÿè®¡æƒ…å†µï¼Œæ¯”å¦‚ CPU åœ¨å„é¢‘ç‡ä¸‹çš„è¿è¡Œæ—¶é—´åŠå˜é¢‘æ¬¡æ•°ã€‚\n\nä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å„å‚æ•°çš„å€¼ï¼š\n```bash\ncat [ç›®å½•é¡¹]\n```\n\nä¼šå‘ç°å½“å‰è°ƒåº¦æ¨¡å¼æ˜¯ `Ondemand`ã€‚\n\nå¦‚æœæˆ‘æƒ³è®©æˆ‘ä»¬çš„æ¿å­ä¸€ç›´æ»¡è¡€è¿è¡Œï¼Œæ€ä¹ˆåšï¼Ÿæˆ‘ä»¬åªéœ€å›¾å½¢åŒ–é…ç½®defconfigæ–‡ä»¶ã€‚\n\nè¿›å…¥åˆ° kernel æºç ç›®å½•ï¼Œä½¿ç”¨å‘½ä»¤æ‰“å¼€å›¾å½¢åŒ–é…ç½®æ–‡ä»¶ï¼š\n\n```bash\nmake menuconfig\n```\n\n![](Snipaste_2025-10-31_23-08-34.png)\n\nè¿›å…¥ `CPU Power Management`-> `CPU Frequency scaling`-> `Default CPUFreq governor` ï¼Œé€‰æ‹©performanceï¼Œå†æ¬¡ç¼–è¯‘ï¼ˆä¸ç”¨distcleanæ¸…ç†ï¼‰ï¼Œå†ä¼ è¿›å¼€å‘æ¿ã€‚\n\nå†æ¬¡æŸ¥çœ‹å°±å¯ä»¥å‘ç°ï¼š\n\n![](Snipaste_2025-10-31_23-15-11.png)\n\n**å½“ç„¶æ—¥å¸¸ä½¿ç”¨è¿˜æ˜¯ `Ondemand` æ›´å¥½ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯æ¢å› `Ondemand` äº†ã€‚**\n\nè‡³æ­¤ï¼Œæˆ‘ä»¬ä»¥ä¿®æ”¹ä¸»é¢‘ä¸ºå¼•ï¼Œä»‹ç»äº†å¦‚ä½•è°ƒè¯•ä¿®æ”¹é…ç½®æ–‡ä»¶å¹¶åº”ç”¨ä¿®æ”¹ã€‚\n\n--end--\n\n## 6. ç³»ç»Ÿç½‘ç»œæµ‹è¯•\n\né‡ç«çš„æ¿å­PHYèŠ¯ç‰‡ä½¿ç”¨çš„å’Œnxpå®˜æ–¹çš„ä¸€æ ·ï¼Œå› æ­¤ç›´æ¥é€‚é…nxpå®˜æ–¹linuxå†…æ ¸ï¼Œä¸ç”¨ä¿®æ”¹è®¾å¤‡æ ‘æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œè®²ä¸€ä¸‹ç½‘ç»œæµ‹è¯•ã€‚\n\nè¿›å…¥åˆ°ç³»ç»Ÿåï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯ç”¨ä»»ä½•ä¸€ä¸ªç½‘ç»œé©±åŠ¨è®¾å¤‡çš„ï¼Œä½¿ç”¨ `ifconfig` å‘½ä»¤å¯èƒ½åªä¼šæ˜¾ç¤ºä¸€ä¸ªâ€œlocâ€ã€‚æ‰€ä»¥æˆ‘ä»¬è¾“å…¥å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰çš„ç½‘ç»œé©±åŠ¨è®¾å¤‡ï¼š\n\n```bash\nifconfig -a\n```\n\nè¾“å‡ºï¼š\n\n![](Snipaste_2025-11-02_18-29-44.png)\n\næˆ‘é€šè¿‡MACåœ°å€åˆ†è¾¨å‡ºæˆ‘åº”è¯¥å¯ç”¨çš„æ˜¯ `eth0` å®ƒæ­£é€šè¿‡ç½‘çº¿è¿æ¥ç€æˆ‘çš„ç”µè„‘ï¼Œè¾“å…¥å‘½ä»¤ï¼š\n\n```bash\nifconfig eth0 up\n```\n\nå¯ç”¨åï¼Œæˆ‘ä»¬é€šè¿‡ `ifconfig` å‘½ä»¤å°±èƒ½æŸ¥çœ‹åˆ°è¿™ä¸ªè®¾å¤‡äº†ã€‚ä½†æ˜¯è¿™ä¸ªç½‘å¡éƒ½è¿˜æ²¡\næœ‰ IP åœ°å€ï¼Œæ‰€ä»¥ä¸èƒ½è¿›è¡Œ ping ç­‰æ“ä½œã€‚\n\næ‰€ä»¥æˆ‘ä»¬ä¸ºå…¶åˆ†é… ip åœ°å€ï¼š\n\n```bash\nifconfig eth0 192.168.137.145\n```\n\nç°åœ¨å°±èƒ½ ping é€šæˆ‘çš„ç”µè„‘äº†ã€‚\næˆ‘çš„ç”µè„‘ä»¥å¤ªç½‘å¡ ip åœ°å€ä¸º 192.168.137.1ï¼š\n\n![](Snipaste_2025-11-02_18-38-02.png)\n\n","tags":["Linux","å†…æ ¸ç§»æ¤"],"categories":["Linux","ç³»ç»Ÿç§»æ¤"]},{"title":"mx6ullå¼€å‘ç‰ˆç§»æ¤nxpå®˜æ–¹u-boot","url":"/posts/26288/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n## 1. æˆ‘å†™å°¼ç›ï¼\n\næˆ‘ä»–å¦ˆç›´æ¥ä¸æƒ³ç å­—ã€‚\næˆ‘ä»–å¦ˆç›´æ¥è½¬è½½ã€‚\n\nç§»æ¤éƒ¨åˆ†ï¼š\nä½œè€…ï¼šè§‰çš‡åµŒå…¥å¼ éµå¾ªÂ [CC 4.0 BY-SA](http://creativecommons.org/licenses/by-sa/4.0/)Â ç‰ˆæƒåè®®ã€‚\n[i.MX6ULL - ä»é›¶å¼€å§‹ç§»æ¤uboot-imx_v2020.04_5.4.70_2.3.0-CSDNåšå®¢](https://blog.csdn.net/qq153471503/article/details/126587387)\n\n## 2. å›¾å½¢åŒ–é…ç½®\n\nåœ¨ubootç›®å½•ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤ï¼š\n\n```\nmake menuconfig\n```\n\nå¯ä»¥é€šè¿‡å›¾å½¢åŒ–ç•Œé¢é…ç½®ubootï¼Œæ›´åŠ ç›´è§‚ã€‚\n\n## 3. U-boot å¯åŠ¨Linuxæµ‹è¯•\n\n### 3.1. ä»EMMCå¯åŠ¨\n\n#### 3.1.1. æŸ¥çœ‹\n\né¦–å…ˆæ£€æŸ¥EMMCé‡Œé¢æ˜¯å¦æœ‰â€”â€”Linuxé•œåƒzImageã€.dtbæ–‡ä»¶å’Œæ ¹æ–‡ä»¶ç³»ç»Ÿã€‚\n\næˆ‘ä»¬å½“å‰çš„mmcç¯å¢ƒæ˜¯SDå¡ï¼Œåˆ‡æ¢åˆ°EMMCã€‚è¾“å…¥å‘½ä»¤ï¼š\n\n```\nmmc dev 1\n```\n\n>å…·ä½“EMMCçš„è®¾å¤‡å· æ ¹æ®å®é™…æƒ…å†µè¾“å…¥ã€‚\n\nè¯¥å¼€å‘æ¿EMMCåˆ†åŒºæ˜¯è¿™æ ·çš„ï¼š\n- åˆ†åŒº0ï¼šæ˜¯å­˜æ”¾bootçš„ï¼Œ\n- åˆ†åŒº1ï¼šå­˜æ”¾linuxé•œåƒå’Œè®¾å¤‡æ ‘ï¼Œ\n- åˆ†åŒº2ï¼šå­˜æ”¾rootã€‚\n\n>å¯ä»¥ä½¿ç”¨ `fstype mmc dev:part` å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ã€‚\n>å…¶ä¸­ devæ˜¯EMMCçš„è®¾å¤‡å·ï¼Œpartæ˜¯åˆ†åŒºå·ã€‚è¿è¡Œåï¼š\n>åˆ†åŒº0è¾“å‡º `Unrecognized...`ï¼›\n>åˆ†åŒº1è¾“å‡º `fat` ï¼›åˆ†åŒº2è¾“å‡º `ext4`ã€‚\n\nåˆ†åŒº1ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯FATï¼Œå› æ­¤ç”¨ `fatls` æŸ¥çœ‹EMMCåˆ†åŒº1é‡Œé¢çš„æ–‡ä»¶ï¼š\n\n```\nfatls mmc dev:part\n```\n\nè¾“å‡ºï¼š\n\n```\n7863120   zImage\n    38733   imx6ull-mmc-npi-lite.dtb\n\n2 file(s), 0 dir(s)\n```\n\nè¯´æ˜ç³»ç»Ÿå’Œè®¾å¤‡æ ‘æ˜¯å­˜åœ¨çš„ã€‚\n\n#### 3.1.2. åŠ è½½ç³»ç»Ÿç›¸å…³å‘½ä»¤\n\n- **æŸ¥çœ‹æŒ‡å®šçš„é•œåƒåŠ è½½åœ°å€ï¼š**\n\n\t`printenv loadaddr`\n\n\tè¾“å‡ºä¸º `0x80800000`\n\n- **æŸ¥çœ‹æŒ‡å®šçš„è®¾å¤‡æ ‘åŠ è½½åœ°å€ï¼š**\n\n\t`printenv fdt_addr`\n\n\tè¾“å‡ºä¸º `0x83000000`\n\n- **æŠŠzImageåŠ è½½åˆ°åœ°å€ `0x80800000`ï¼š**\n\n\t`fatload mmc 1:1 80800000 zImage`\n\n- **æŠŠè®¾å¤‡æ ‘åŠ è½½åˆ°åœ°å€ `0x83000000`**ï¼š\n\n\t`fatload mmc 1:1 83000000 imx6ull-mmc-npi-lite.dtb`\n\n- **å¯åŠ¨å†…æ ¸ï¼š**\n\t`bootz 80800000 - 83000000`\n\n#### 3.1.3. è®¾ç½®bootcmd\n\n`bootcmd` æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œä¿å­˜ç€ uboot é»˜è®¤å‘½ä»¤ï¼Œuboot å€’è®¡æ—¶ç»“æŸä»¥åå°±ä¼šæ‰§è¡Œ bootcmd ä¸­çš„å‘½ä»¤ã€‚è¿™äº›å‘½ä»¤ä¸€èˆ¬éƒ½æ˜¯ç”¨æ¥å¯åŠ¨ Linux å†…æ ¸çš„ï¼Œæ¯”å¦‚è¯»å– EMMC æˆ–è€… NAND Flash ä¸­çš„ Linux å†…æ ¸é•œåƒæ–‡ä»¶å’Œè®¾å¤‡æ ‘æ–‡ä»¶åˆ° DRAM ä¸­ï¼Œç„¶åå¯åŠ¨ Linux å†…æ ¸ã€‚\n\n```\nsetenv bootcmd 'mmc dev 1; fatload mmc 1:1 80800000 zImage; fatload mmc 1:1 83000000 imx6ull-mmc-npi-lite.dtb; bootz 80800000 - 83000000;'\n```\n\n#### 3.1.4. è®¾ç½®bootargs\n\n<details>\n\n<summary> å…³äºbootargsçš„ä»‹ç»æœ‰ç‚¹é•¿ï¼ŒæŠ˜å ä¸€ä¸‹ã€‚</summary>\n\nbootargs ä¿å­˜ç€ uboot ä¼ é€’ç»™ Linux å†…æ ¸çš„å‚æ•°ï¼Œbootargs ç¯å¢ƒå˜é‡æ˜¯ç”± mmcargs è®¾ç½®çš„ï¼Œmmcargs ç¯å¢ƒå˜é‡å¦‚ä¸‹ï¼š\n`mmcargs=setenv bootargs console=${console},${baudrate} root=${mmcroot}`\n\nå…¶ä¸­ console=ttymxc0ï¼Œbaudrate=115200ï¼Œmmcroot=/dev/mmcblk0p2 rootwait rwï¼Œ\n\nå› æ­¤å°†mmcargs å±•å¼€ä»¥åå°±æ˜¯ï¼š\n`mmcargs=setenv bootargs console= ttymxc0, 115200 root= /dev/mmcblk0p2 rootwait rw`\n\nå¯ä»¥çœ‹å‡ºç¯å¢ƒå˜é‡ mmcargs å°±æ˜¯è®¾ç½® bootargs çš„å€¼ä¸º`console= ttymxc0, 115200 root=/dev/mmcblk1p2 rootwait rw`ï¼Œ\n\nbootargs å°±æ˜¯è®¾ç½®äº†å¾ˆå¤šçš„å‚æ•°çš„å€¼ï¼Œè¿™äº›å‚æ•° Linux å†…æ ¸ä¼šä½¿ç”¨åˆ°ï¼Œå¸¸ç”¨çš„å‚æ•°æœ‰ï¼š\n\n- **consoleï¼š**\n\tconsole ç”¨æ¥è®¾ç½® linux ç»ˆç«¯(æˆ–è€…å«æ§åˆ¶å°)ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ä»€ä¹ˆè®¾å¤‡æ¥å’Œ Linux è¿›è¡Œäº¤äº’ï¼Œä¾‹å¦‚ä¸²å£ã€ LCD å±å¹•ã€‚å¦‚æœæ˜¯ä¸²å£çš„è¯åº”è¯¥æ˜¯ä¸²å£å‡ ã€æ³¢ç‰¹ç‡ç­‰ã€‚ä¸€èˆ¬è®¾ç½®ä¸²å£ä½œä¸º Linux ç»ˆç«¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç”µè„‘ä¸Šé€šè¿‡ä¸²å£ç¨‹åºæ¥å’Œ linux äº¤äº’äº†ã€‚è¿™é‡Œè®¾ç½® console ä¸º ttymxc0ï¼Œå› ä¸º linuxå¯åŠ¨ä»¥å I.MX6ULL çš„ä¸²å£ 1 åœ¨ linux ä¸‹çš„è®¾å¤‡æ–‡ä»¶å°±æ˜¯/dev/ttymxc0ï¼Œâ€ä¸€åˆ‡çš†æ–‡ä»¶â€œã€‚\n- **rootï¼š**\n\troot ç”¨æ¥è®¾ç½®æ ¹æ–‡ä»¶ç³»ç»Ÿçš„ä½ç½®ï¼Œä¾‹å¦‚ï¼Œ`root=/dev/mmcblk1p2` æŒ‡æ ¹æ–‡ä»¶ç³»ç»Ÿå­˜æ”¾åœ¨ mmcblk1 è®¾å¤‡çš„åˆ†åŒº 2 ä¸­ã€‚\n\t`rootwait rw`ã€‚rootwait è¡¨ç¤ºç­‰å¾… mmc è®¾å¤‡åˆå§‹åŒ–å®Œæˆä»¥åå†æŒ‚è½½ï¼Œå¦åˆ™çš„è¯mmc è®¾å¤‡è¿˜æ²¡åˆå§‹åŒ–å®Œæˆå°±æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿä¼šå‡ºé”™çš„ã€‚rw è¡¨ç¤ºæ ¹æ–‡ä»¶ç³»ç»Ÿæ˜¯å¯ä»¥è¯»å†™çš„ï¼Œä¸åŠ  rw çš„è¯å¯èƒ½æ— æ³•åœ¨æ ¹æ–‡ä»¶ç³»ç»Ÿä¸­è¿›è¡Œå†™æ“ä½œï¼Œåªèƒ½è¿›è¡Œè¯»æ“ä½œã€‚\n- **rootfstypeï¼š**\n\tæ­¤é€‰é¡¹ä¸€èˆ¬é…ç½® root ä¸€èµ·ä½¿ç”¨ï¼Œrootfstype ç”¨äºæŒ‡å®šæ ¹æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œå¦‚æœæ ¹æ–‡ä»¶ç³»ç»Ÿä¸ºext æ ¼å¼çš„è¯æ­¤é€‰é¡¹æ— æ‰€è°“ã€‚å¦‚æœæ ¹æ–‡ä»¶ç³»ç»Ÿæ˜¯ yaffsã€jffs æˆ– ubifs çš„è¯å°±éœ€è¦è®¾ç½®æ­¤é€‰é¡¹ï¼ŒæŒ‡å®šæ ¹æ–‡ä»¶ç³»ç»Ÿçš„ç±»å‹ã€‚\n\n</details>\n\nè®¾ç½®ï¼š\n```\nsetenv bootargs 'console=ttymxc0,115200 root=/dev/mmcblk1p2 rootwait rw'\n```\n\n#### 3.1.5. å¯åŠ¨\n\nä½¿ç”¨å‘½ä»¤ `run bootcmd` æˆ– åœ¨åˆ‡æ¢åˆ°EMMCç¯å¢ƒåç›´æ¥è¾“å…¥`boot`ã€‚\n\n### 3.2. ä»ç½‘ç»œå¯åŠ¨\n\n#### 3.2.1. å®‰è£… tftpd-hpa å’Œå®¢æˆ·ç«¯å·¥å…·\n\n```bash\nsudo apt update\nsudo apt install tftpd-hpa tftp-hpa\n```\n\n#### 3.2.2. åˆ›å»ºå…±äº«ç›®å½•å¹¶å¼€æ”¾æƒé™\n\nTFTP çš„é»˜è®¤æ ¹ç›®å½•æ˜¯ `/srv/tftp`ï¼Œä½ ä¹Ÿå¯ä»¥æ”¹æˆåˆ«çš„ï¼š\n\n```bash\nsudo mkdir -p /srv/tftp\nsudo chmod 777 /srv/tftp\n```\n\nç„¶åæŠŠè¦ä¼ çš„æ–‡ä»¶ï¼ˆæ¯”å¦‚ `uImage`ï¼‰æ”¾è¿›å»ï¼š\n\n```bash\ncp ~/uImage /srv/tftp/\n```\n\n#### 3.2.3. æ‰‹åŠ¨å¯åŠ¨ TFTP æœåŠ¡ï¼ˆå› ä¸ºæ²¡æœ‰ systemctlï¼‰\n\nç›´æ¥è¿è¡Œï¼š\n\n```bash\nsudo /usr/sbin/in.tftpd --foreground --secure --verbose /srv/tftp\n```\n\n- --foregroundï¼šåœ¨å‰å°è¿è¡Œ\n- --secureï¼šåªå…è®¸è®¿é—®æŒ‡å®šç›®å½•\n- --verboseï¼šæ‰“å°è¯¦ç»†æ—¥å¿—\n\n> è¿˜æœ‰ä¸€äº›é€‰é¡¹ï¼Œä¾‹å¦‚ï¼š\n> --address <ip:port>ï¼šæŒ‡å®š TFTP æœåŠ¡ç›‘å¬çš„ IP åœ°å€å’Œç«¯å£ã€‚\n> --blocksize <å¤§å°>ï¼šæŒ‡å®šä¸€ä¸ªæ•°æ®åŒ…çš„å¤§å°ã€‚\n> --createï¼šå…è®¸å®¢æˆ·ç«¯ä¸Šä¼ ã€‚\n\nè¿™ä¼šåœ¨å‰å°å¯åŠ¨æœåŠ¡å™¨ï¼ˆæŒ‰ `Ctrl+C` å¯åœæ­¢ï¼‰ã€‚\n\nå¦‚æœä½ æƒ³è®©å®ƒ**åå°è¿è¡Œ**ï¼š\n\n```bash\nsudo /usr/sbin/in.tftpd --secure /srv/tftp &\n```\n\n#### 3.2.4. ç¡®è®¤æœåŠ¡åœ¨ç›‘å¬ UDP 69 ç«¯å£\n\n```bash\nsudo netstat -anu | grep :69\n```\n\næˆ–è€…ï¼š\n\n```bash\nsudo ss -anu | grep 69\n```\n\nå‡ºç°ç±»ä¼¼ï¼š\n\n```nginx\nudp   UNCONN  0      0      0.0.0.0:69    0.0.0.0:*\n```\n\nè¯´æ˜å¯åŠ¨æˆåŠŸã€‚\n\n#### 3.2.5. è®© U-Boot èƒ½è®¿é—® WSL çš„ IP\n\nè¿™æ˜¯å…³é”®éƒ¨åˆ†ã€‚\nWSL å’Œ Windows çš„ç½‘ç»œæ˜¯**æ¡¥æ¥ä½†ä¸å®Œå…¨å…±äº«çš„**ï¼Œæ‰€ä»¥å¼€å‘æ¿ä¸èƒ½ç›´æ¥è®¿é—® `127.0.0.1` æˆ– `localhost`ã€‚\n\n1. åœ¨ Windows é‡Œæ‰§è¡Œï¼š\n\n```powershell\nipconfig\n```\næ‰¾åˆ° **ä»¥å¤ªç½‘é€‚é…å™¨ vEthernet (WSL)** è¿™ä¸€é¡¹ã€‚\nå®ƒé€šå¸¸æ˜¯ç±»ä¼¼ `172.25.x.x` æˆ– `192.168.137.x` çš„ IPï¼Œæ¯”å¦‚ï¼š\n\n```nginx\nIPv4 Address. . . . . . . . . . . : 172.27.240.1\n```\n2. åœ¨ U-Boot é‡Œè®¾ç½®ï¼š\n\n```bash\nsetenv serverip 192.168.137.1\nsetenv ipaddr 192.168.137.144\n```\n\n3. å…³é—­é˜²ç«å¢™ï¼š\n\tåœ¨è®¾ç½®â€”â€”ç½‘ç»œä¸Internetâ€”â€”é«˜çº§ç½‘ç»œè®¾ç½®â€”â€”Windowsé˜²ç«å¢™ï¼Œå°†å…¬ç”¨ç½‘ç»œä¸­çš„é˜²ç«å¢™æš‚æ—¶å…³é—­ã€‚\n\t\n4. æµ‹è¯•ï¼š\n\n```bash\nping 192.168.137.1\n```\nå¦‚æœæ˜¾ç¤º â€œhost is aliveâ€ï¼Œè¯´æ˜è¿é€šã€‚\n\n#### 3.2.6. ä¼ æ–‡ä»¶\n\nå‡è®¾ä½ è¦ä¸‹è½½ `/srv/tftp/uImage` åˆ°å†…å­˜åœ°å€ `0x80800000`ï¼š\n\n```bash\ntftp 0x80800000 uImage\n```\n\nçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š\n\n```nginx\nUsing FEC device\nTFTP from server 172.27.240.1; our IP address is 172.27.240.166\nFilename 'uImage'.\nLoad address: 0x80800000\nLoading: #########################################\ndone\nBytes transferred = 3456789 (34abcd hex)\n```\n\nå°±æˆåŠŸäº†ï¼\n","tags":["Linux","u-bootç§»æ¤"],"categories":["Linux","ç³»ç»Ÿç§»æ¤"]},{"title":"å¤§èŸ’è›‡-typeråº“","url":"/posts/40650/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n## ä¸€ã€å®‰è£…\n\n```bash\npip install typer[all]\n```\n\n`[all]` ä¼šé¢å¤–å®‰è£…é¢œè‰²å’Œè¡¥å…¨åŠŸèƒ½ï¼ˆæ¨èï¼‰ã€‚\n\n## äºŒã€æœ€ç®€å•çš„ä¾‹å­\n\n```python\nimport typer\n\ndef main(name: str):\n    typer.echo(f\"Hello {name}\")\n\nif __name__ == \"__main__\":\n    typer.run(main)\n```\n\nè¿è¡Œï¼š\n```bash\npython3 app.py gdm\n```\n\nè¾“å‡ºï¼š\n```\nHello gdm\n```\n\nTyper ä¼šè‡ªåŠ¨è§£æå‘½ä»¤è¡Œå‚æ•°å¹¶ç”Ÿæˆå¸®åŠ©ï¼š\n\n```bash\npython3 app.py --help\n```\n\n```\nUsage: app.py [OPTIONS] NAME\n\nArguments:\n  NAME  [required]\n\nOptions:\n  --help  Show this message and exit.\n```\n\n\n## ä¸‰ã€å¸¦ç±»å‹æç¤ºçš„å‚æ•°è§£æ\n\nTyper ä¼šæ ¹æ®**Python ç±»å‹æ³¨è§£**è‡ªåŠ¨è½¬æ¢è¾“å…¥ï¼š\n\n```python\ndef main(\nname: str, \nage: int, \nactive: bool = True\n):\n    typer.echo(f\"Name: {name}, Age: {age}, Active: {active}\")\n\nif __name__ == \"__main__\":\n    typer.run(main)\n\n```\n\næ‰§è¡Œï¼š\n```bash\npython3 app.py gdm 25 --active\n```\n\næˆ–å…³é—­ activeï¼š\n```bash\npython3 app.py gdm 25 --no-active\n```\n\n\n## å››ã€ä½¿ç”¨é€‰é¡¹ï¼ˆOptionsï¼‰\n\nå¦‚æœä½ å¸Œæœ›æŸä¸ªå‚æ•°æ˜¯å¯é€‰çš„ã€å¸¦å‰ç¼€çš„é€‰é¡¹ï¼Œå¯ä»¥ç”¨ `typer.Option`ã€‚\n\n```python\ndef main(\nname: str = typer.Option(\"World\", help=\"åå­—\"), \nrepeat: int = typer.Option(1, help=\"é‡å¤æ¬¡æ•°\")\n):\n\n    for _ in range(repeat):\n        typer.echo(f\"Hello {name}\")\n\nif __name__ == \"__main__\":\n    typer.run(main)\n\n```\n\nè¿è¡Œï¼š\n\n\n```bash\npython3 app.py --name gdm --repeat 3\n```\n\n\n## äº”ã€ä½¿ç”¨å‚æ•°ï¼ˆArgumentsï¼‰\n\n`typer.Argument()` ç”¨äºå®šä¹‰**ä½ç½®å‚æ•°**ï¼Œå³å¿…éœ€å‚æ•°ã€‚\n\n```python\ndef main(filename: str = typer.Argument(..., help=\"æ–‡ä»¶è·¯å¾„\")):\n    typer.echo(f\"Processing file: {filename}\")\n\nif __name__ == \"__main__\":\n    typer.run(main)\n```\n\n`...` è¡¨ç¤ºå¿…é¡»æä¾›ã€‚\n\nç¤ºä¾‹ï¼š\n```bash\npython3 app.py data.txt\n```\n\n\n## å…­ã€å‘½ä»¤åˆ†ç»„ï¼ˆå¤šä¸ªå­å‘½ä»¤ï¼‰\n\nä½ å¯ä»¥åƒå†™ Git ä¸€æ ·å®šä¹‰å¤šå‘½ä»¤ç»“æ„ã€‚\n\n```python\nimport typer\n\napp = typer.Typer()\n\n@app.command()\ndef add(a: int, b: int):\n    typer.echo(a + b)\n\n@app.command()\ndef sub(a: int, b: int):\n    typer.echo(a - b)\n\nif __name__ == \"__main__\":\n    app()\n```\n\nè¿è¡Œï¼š\n```bash\npython3 app.py add 3 5\npython3 app.py sub 10 2\n```\n\nå¸®åŠ©ä¿¡æ¯ï¼š\n```bash\npython3 app.py --help\n```\n\n```\nCommands:\n  add\n  sub\n```\n\n\n## ä¸ƒã€é»˜è®¤å‘½ä»¤ï¼ˆå…¥å£å‡½æ•°ï¼‰\n\nå¦‚æœåªå®šä¹‰ä¸€ä¸ªå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š\n\n```python\nimport typer\n\napp = typer.Typer()\n\n@app.command()\ndef greet(name: str):\n    typer.echo(f\"Hi {name}\")\n\nif __name__ == \"__main__\":\n    app()\n\n```\n\n\n## å…«ã€æç¤ºè¾“å…¥ï¼ˆPromptï¼‰\n\nTyper æ”¯æŒäº¤äº’å¼è¾“å…¥ï¼š\n\n```python\ndef main(password: str = typer.Option(..., prompt=True, hide_input=True)):\n    typer.echo(\"Password received!\")\n\nif __name__ == \"__main__\":\n    typer.run(main)\n```\n\nè¿è¡Œåä¼šæç¤ºè¾“å…¥å¯†ç è€Œä¸å›æ˜¾ã€‚\n\n## ä¹ã€é¢œè‰²è¾“å‡º\n\n```python\ntyper.secho(\"æˆåŠŸ!\", fg=typer.colors.GREEN, bold=True)\ntyper.secho(\"è­¦å‘Š!\", fg=typer.colors.YELLOW)\ntyper.secho(\"é”™è¯¯!\", fg=typer.colors.RED)\n```\n\n## åã€é€€å‡ºä¸é”™è¯¯\n\n```python\nif error:\n    typer.echo(\"Something went wrong.\")\n    raise typer.Exit(code=1)\n```\n\næˆ–ï¼š\n\n```python\ntyper.Abort()  # ç›¸å½“äº Ctrl+C\n```\n\n\n## åä¸€ã€è‡ªåŠ¨è¡¥å…¨\n\nä¸ºç»ˆç«¯å®‰è£… Typer è¡¥å…¨è„šæœ¬ï¼š\n\n```bash\napp --install-completion\n\n```\n\nç„¶åé‡å¯ç»ˆç«¯ã€‚\n\n## åäºŒã€å¤æ‚ç»“æ„ï¼ˆåµŒå¥—å‘½ä»¤ï¼‰\n\nå¯ä»¥åˆ›å»ºå¤šä¸ª `Typer` å®ä¾‹ï¼Œå¹¶æ³¨å†Œå­å‘½ä»¤æ¨¡å—ï¼š\n\n```python\nimport typer\n\napp = typer.Typer()\nuser_app = typer.Typer()\napp.add_typer(user_app, name=\"user\")\n\n@user_app.command(\"create\")\ndef create_user(name: str):\n    typer.echo(f\"Created user: {name}\")\n\nif __name__ == \"__main__\":\n    app()\n```\n\nè¿è¡Œï¼š\n```bash\npython app.py user create gdm\n```\n\n\n## åä¸‰ã€ä¸Clickå…¼å®¹\n\nTyper åŸºäº Clickï¼Œå¯ä»¥æ··ç”¨ Click çš„å‡½æ•°ï¼š\n\n```python\nimport typer\nimport click\n\n@app.command()\n@click.option(\"--debug/--no-debug\", default=False)\ndef run(debug):\n    typer.echo(f\"Debug = {debug}\")\n\n```\n\n## åå››ã€å®Œæ•´ç¤ºä¾‹\n\nä¸€ä¸ªå¸¦é¢œè‰²ã€å¸®åŠ©ä¿¡æ¯ã€å‘½ä»¤ç»„ã€é€‰é¡¹çš„ç»¼åˆä¾‹å­ï¼š\n\n```python\nimport typer\n\napp = typer.Typer(help=\"ä¸€ä¸ªç®€å•çš„æ–‡ä»¶å¤„ç†å·¥å…·\")\n\n@app.command(help=\"è¯»å–æ–‡ä»¶å†…å®¹\")\ndef read(file: str):\n    with open(file, \"r\", encoding=\"utf-8\") as f:\n        typer.echo(f.read())\n\n@app.command(help=\"ç»Ÿè®¡æ–‡ä»¶è¡Œæ•°\")\ndef count(file: str):\n    lines = sum(1 for _ in open(file, \"r\", encoding=\"utf-8\"))\n    typer.secho(f\"{file}: {lines} lines\", fg=typer.colors.GREEN)\n\nif __name__ == \"__main__\":\n    app()\n\n```\n"},{"title":"å¤§èŸ’è›‡-richåº“","url":"/posts/30447/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n## ğŸª¶ Rich åº“æ–°æ‰‹ä½¿ç”¨æŒ‡å—\n\n\n`Rich` æ˜¯ä¸€ä¸ªè¶…å¼ºçš„ Python åº“ï¼Œç”¨æ¥è®©ç»ˆç«¯è¾“å‡ºå˜å¾—**æ¼‚äº®ã€æœ‰è‰²å½©ã€æœ‰æ ¼å¼**ã€‚\nå®ƒå¯ä»¥æ˜¾ç¤º**å½©è‰²æ–‡å­—ã€è¡¨æ ¼ã€è¿›åº¦æ¡ã€Markdownã€é«˜äº®ä»£ç ã€æ—¥å¿—ä¿¡æ¯**ç­‰ã€‚\n\nå®‰è£…éå¸¸ç®€å•ï¼š\n\n```bash\npip install rich\n```\n\nå¯¼å…¥æ–¹å¼ï¼š\n\n```python\nfrom rich import print\nfrom rich.console import Console\n```\n\n\n### ä¸€ã€å½©è‰²è¾“å‡ºåŸºç¡€\n\nRich è‡ªå¸¦çš„ `print` å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»ä¼¼ BBCode çš„æ ‡ç­¾ä¸Šè‰²ã€‚\n\n```python\nfrom rich import print\n\nprint(\"[bold red]é”™è¯¯ï¼š[/bold red] æ–‡ä»¶æœªæ‰¾åˆ°ï¼\")\nprint(\"[green]ä»»åŠ¡å®Œæˆï¼[/green]\")\nprint(\"[yellow on black]è­¦å‘Šï¼šå†…å­˜ä¸è¶³[/yellow on black]\")\n```\n\n`[color]æ–‡å­—[/color]`\næ”¯æŒæ ·å¼å¦‚ï¼š`bold`, `italic`, `underline`, `red`, `green`, `blue`, `on color`, `blink` ç­‰ã€‚\n\n### äºŒã€ä½¿ç”¨ Console å¯¹è±¡ï¼ˆæ›´çµæ´»ï¼‰\n\n```python\nfrom rich.console import Console\n\nconsole = Console()\nconsole.print(\"æ™®é€šè¾“å‡º\")\nconsole.print(\"[bold magenta]é«˜äº®è¾“å‡º[/bold magenta]\")\nconsole.log(\"è¿™æ˜¯å¸¦æ—¶é—´æˆ³çš„æ—¥å¿—è¾“å‡º\")\n```\n\n### ä¸‰ã€æ‰“å°è¡¨æ ¼\n\n```python\nfrom rich.console import Console\nfrom rich.table import Table\n\ntable = Table(title=\"å­¦ç”Ÿæˆç»©\")\n\ntable.add_column(\"å§“å\", style=\"cyan\", no_wrap=True)\ntable.add_column(\"ç§‘ç›®\", style=\"magenta\")\ntable.add_column(\"åˆ†æ•°\", justify=\"right\", style=\"green\")\n\ntable.add_row(\"å¼ ä¸‰\", \"æ•°å­¦\", \"88\")\ntable.add_row(\"æå››\", \"è‹±è¯­\", \"93\")\ntable.add_row(\"ç‹äº”\", \"ç‰©ç†\", \"75\")\n\nconsole = Console()\nconsole.print(table)\n```\n\nè¾“å‡ºï¼šå½©è‰²ã€æœ‰è¾¹æ¡†çš„æ¼‚äº®è¡¨æ ¼ã€‚\n\n### å››ã€è¿›åº¦æ¡\n\n```python\nimport time\nfrom rich.progress import track\n\nfor i in track(range(10), description=\"[cyan]æ­£åœ¨å¤„ç†...\"):\n    time.sleep(0.3)\n```\n\nå®ƒä¼šåœ¨ç»ˆç«¯æ˜¾ç¤ºä¸€ä¸ªåŠ¨æ€è¿›åº¦æ¡ï¼Œéå¸¸ç›´è§‚ã€‚\n\n### äº”ã€æ‰“å° Markdown æ–‡æœ¬\n\n```python\nfrom rich.console import Console\nfrom rich.markdown import Markdown\n\nmd = Markdown(\"\"\"\n# æ ‡é¢˜\n- æ”¯æŒåˆ—è¡¨\n- **åŠ ç²—**\n- *æ–œä½“*\n\"\"\")\n\nconsole = Console()\nconsole.print(md)\n```\n\n\n### å…­ã€ä»£ç é«˜äº®\n\n```python\nfrom rich.console import Console\nfrom rich.syntax import Syntax\n\ncode = '''\ndef hello():\n    print(\"Hello, world!\")\n'''\n\nsyntax = Syntax(code, \"python\", theme=\"monokai\", line_numbers=True)\nconsole = Console()\nconsole.print(syntax)\n```\n\n### ä¸ƒã€æ—¥å¿—ä¸è¿½è¸ª\n\n```python\nfrom rich.console import Console\nfrom rich.traceback import install\n\ninstall()  # è®©æŠ¥é”™æ˜¾ç¤ºå½©è‰²å †æ ˆ\nconsole = Console()\n\ndef divide(a, b):\n    return a / b\n\ndivide(5, 0)  # ä¼šè¾“å‡ºå¸¦é¢œè‰²çš„é”™è¯¯ä¿¡æ¯\n\n```\n\n### å…«ã€ç»„åˆç¤ºä¾‹ï¼šå¤šç§å…ƒç´ ä¸€èµ·å±•ç¤º\n\n```python\nfrom rich.console import Console\nfrom rich.table import Table\nfrom rich.progress import track\nfrom time import sleep\n\nconsole = Console()\n\nconsole.rule(\"[bold green]Rich ç¤ºä¾‹\")\n\ntable = Table(title=\"ä»»åŠ¡çŠ¶æ€\")\ntable.add_column(\"ä»»åŠ¡å\", style=\"cyan\")\ntable.add_column(\"çŠ¶æ€\", style=\"magenta\")\n\nfor i in track(range(5), description=\"[yellow]æ‰§è¡Œä»»åŠ¡ä¸­...\"):\n    sleep(0.2)\n    table.add_row(f\"ä»»åŠ¡{i+1}\", \"å®Œæˆ\")\n\nconsole.print(table)\nconsole.rule(\"[bold blue]æ‰§è¡Œç»“æŸ\")\n\n```\n\n### ä¹ã€å¸¸è§åŠŸèƒ½é€Ÿè§ˆ\n\n| åŠŸèƒ½ | æ¨¡å— | ç¤ºä¾‹ |\n| ---- | ---- | ---- |\n| å½©è‰²æ–‡æœ¬ | rich.print | [red]Error[/red] |\n| è¡¨æ ¼ | rich.table.Table | ç¾è§‚çš„è¡¨æ ¼è¾“å‡º |\n| è¿›åº¦æ¡ | rich.progress | track() |\n| Markdown | rich.markdown.Markdown | æ¸²æŸ“ Markdown |\n| ä»£ç é«˜äº® | rich.syntax.Syntax | é«˜äº® Python ç­‰ä»£ç  |\n| æ—¥å¿—è¾“å‡º | console.log() | å½©è‰²æ—¶é—´æˆ³æ—¥å¿— |\n| å½©è‰²é”™è¯¯è¿½è¸ª | rich.traceback.install() | è®©å¼‚å¸¸æ›´æ¸…æ™° |\n\n## ğŸŒˆ Rich è¿›é˜¶ç»„ä»¶ä½¿ç”¨æŒ‡å—\n\nè¿™äº›åŠŸèƒ½è®©ä½ ä¸ä»…èƒ½â€œç¾åŒ–è¾“å‡ºâ€ï¼Œè¿˜èƒ½åœ¨ç»ˆç«¯ä¸­**æ„å»ºäº¤äº’å¼ä¿¡æ¯ç•Œé¢**ã€‚\nä¸»è¦åŒ…æ‹¬ï¼š`Panel`ã€`Layout`ã€`Tree`ã€`Live`ã€`Columns` ç­‰æ¨¡å—ã€‚\n\n### ä¸€ã€Panel â€”â€” ç»™å†…å®¹åŠ ä¸Šâ€œä¿¡æ¯å¡ç‰‡è¾¹æ¡†â€\n\n`Panel` ç”¨æ¥è®©å†…å®¹çœ‹èµ·æ¥åƒä¸€å—é†’ç›®çš„æç¤ºæ¿ã€‚\n\n```python\nfrom rich.console import Console\nfrom rich.panel import Panel\n\nconsole = Console()\n\npanel = Panel(\n    \"[bold yellow]æ“ä½œæˆåŠŸï¼[/bold yellow]\\næ•°æ®å·²ä¿å­˜åˆ°æ•°æ®åº“ã€‚\",\n    title=\"é€šçŸ¥\",\n    subtitle=\"rich.panel ç¤ºä¾‹\",\n    border_style=\"green\"\n)\n\nconsole.print(panel)\n```\n\nå¯ä»¥è®¾ç½®ï¼š\n\n- `title` / `subtitle`ï¼šä¸Šã€ä¸‹æ ‡é¢˜\n- `border_style`ï¼šè¾¹æ¡†é¢œè‰²\n- `expand=True`ï¼šè®©é¢æ¿å æ»¡ç»ˆç«¯å®½åº¦\n\n### äºŒã€Layout â€”â€” æ„å»ºç»ˆç«¯â€œç•Œé¢å¸ƒå±€â€\n\n`Layout` èƒ½è®©ç»ˆç«¯åƒç½‘é¡µä¸€æ ·åˆ†åŒºã€‚é€‚åˆæ—¥å¿—é¢æ¿ã€çŠ¶æ€æ ç­‰ã€‚\n\n```python\nfrom rich.console import Console\nfrom rich.layout import Layout\nfrom rich.panel import Panel\n\nconsole = Console()\nlayout = Layout()\n\n# æ•´ä½“åˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†\nlayout.split(\n    Layout(name=\"header\", size=3),\n    Layout(name=\"body\", ratio=1)\n)\n\n# å†æŠŠ body åˆ†ä¸ºå·¦å³\nlayout[\"body\"].split_row(\n    Layout(name=\"left\"),\n    Layout(name=\"right\")\n)\n\nlayout[\"header\"].update(Panel(\"[bold magenta]Rich Layout ç¤ºä¾‹\"))\nlayout[\"left\"].update(Panel(\"å·¦ä¾§é¢æ¿å†…å®¹\"))\nlayout[\"right\"].update(Panel(\"å³ä¾§é¢æ¿å†…å®¹\"))\n\nconsole.print(layout)\n```\n\nå¯ä»¥ä½¿ç”¨ `split()`ï¼ˆä¸Šä¸‹ï¼‰æˆ– `split_row()`ï¼ˆå·¦å³ï¼‰æ¥åˆ’åˆ†åŒºåŸŸã€‚\næ¯ä¸ªåŒºåŸŸéƒ½èƒ½ç”¨ `.update()` æ”¾å…¥ `Panel`ã€`Table`ã€`Markdown` ç­‰å†…å®¹ã€‚\n\n### ä¸‰ã€Tree â€”â€” ç”Ÿæˆæ¼‚äº®çš„ç›®å½•ç»“æ„\n\n`Tree` æ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„è¾“å‡ºå·¥å…·ï¼Œå¾ˆé€‚åˆæ‰“å°æ–‡ä»¶å±‚çº§æˆ–é…ç½®ç»“æ„ã€‚\n\n```python\nfrom rich.console import Console\nfrom rich.tree import Tree\n\nconsole = Console()\n\ntree = Tree(\"ğŸ“‚ é¡¹ç›®ç»“æ„\")\nsrc = tree.add(\"src\")\nsrc.add(\"main.py\")\nsrc.add(\"utils.py\")\n\ndocs = tree.add(\"docs\")\ndocs.add(\"readme.md\")\n\ntree.add(\"requirements.txt\")\n\nconsole.print(tree)\n```\n\nå¯æ­é… emoji å’Œé¢œè‰²ä½¿ç”¨ï¼Œè®©ç»ˆç«¯ç›®å½•æ›´ç›´è§‚ã€‚\n\n### å››ã€Live â€”â€” å®æ—¶æ›´æ–°ç»ˆç«¯å†…å®¹ï¼ˆåŠ¨æ€ç•Œé¢ï¼‰\n\n`Live` èƒ½è®©ä½ æŒç»­åˆ·æ–°è¾“å‡ºï¼Œè€Œä¸æ˜¯åˆ·å±ã€‚\n\n```python\nimport time\nfrom rich.live import Live\nfrom rich.table import Table\n\ntable = Table()\ntable.add_column(\"ä»»åŠ¡\")\ntable.add_column(\"è¿›åº¦\")\n\nwith Live(table, refresh_per_second=4):\n    for i in range(5):\n        table.add_row(f\"ä»»åŠ¡ {i+1}\", f\"{(i+1)*20}%\")\n        time.sleep(1)\n```\n\n`Live` ä¼šåœ¨åŒä¸€å—åŒºåŸŸåŠ¨æ€æ›´æ–°å†…å®¹ï¼Œéå¸¸é€‚åˆå®æ—¶ç›‘æ§æˆ–è¿›åº¦æ˜¾ç¤ºã€‚\n\n\n\n### äº”ã€Columns â€”â€” å¤šåˆ—å¹¶æ’æ˜¾ç¤ºå†…å®¹\n\nå½“ä½ æƒ³è®©ä¸€å †å†…å®¹æ•´é½åœ°æ’åœ¨ä¸€è¡Œï¼ˆæ¯”å¦‚æ—¥å¿—æˆ–çŠ¶æ€æ ï¼‰æ—¶ï¼Œ`Columns` æ˜¯åˆ©å™¨ã€‚\n\n```python\nfrom rich.console import Console\nfrom rich.columns import Columns\nfrom rich.panel import Panel\n\nconsole = Console()\n\npanels = [\n    Panel(\"CPU: 24%\", title=\"ç³»ç»ŸçŠ¶æ€\", border_style=\"cyan\"),\n    Panel(\"å†…å­˜: 1.2 GB\", title=\"å†…å­˜\", border_style=\"green\"),\n    Panel(\"ç½‘ç»œ: æ­£å¸¸\", title=\"ç½‘ç»œ\", border_style=\"magenta\"),\n]\n\nconsole.print(Columns(panels))\n```\n\nä¼šè‡ªåŠ¨æ ¹æ®ç»ˆç«¯å®½åº¦æ’ç‰ˆï¼Œå¤šåˆ—è‡ªé€‚åº”ã€‚\n\n### å…­ã€Progressï¼ˆè¿›é˜¶ç‰ˆï¼‰â€”â€” å¤šä»»åŠ¡è¿›åº¦æ¡\n\nä¹‹å‰çš„ `track()` æ˜¯ç®€åŒ–ç”¨æ³•ã€‚\nè¿›é˜¶ç”¨æ³•å¯ä»¥åŒæ—¶æ˜¾ç¤ºå¤šä¸ªä»»åŠ¡ã€‚\n\n```python\nimport time\nfrom rich.progress import Progress\n\nwith Progress() as progress:\n    task1 = progress.add_task(\"[cyan]ä¸‹è½½æ–‡ä»¶A...\", total=100)\n    task2 = progress.add_task(\"[magenta]ä¸‹è½½æ–‡ä»¶B...\", total=100)\n\n    while not progress.finished:\n        progress.update(task1, advance=2)\n        progress.update(task2, advance=1)\n        time.sleep(0.05)\n```\n\nä½ å¯ä»¥éšæ—¶ `update(task_id, advance=x)` æ¥æ¨è¿›è¿›åº¦ï¼Œéå¸¸é€‚åˆå¤šçº¿ç¨‹æˆ–å¾ªç¯ä»»åŠ¡ã€‚\n\n### ä¸ƒã€ç»„åˆç¤ºä¾‹ï¼šä¸€ä¸ªç®€æ˜“â€œç³»ç»Ÿç›‘æ§ç•Œé¢â€\n\n```python\nimport time\nfrom rich.console import Console\nfrom rich.layout import Layout\nfrom rich.panel import Panel\nfrom rich.live import Live\n\nconsole = Console()\n\nlayout = Layout()\nlayout.split_column(\n    Layout(name=\"header\", size=3),\n    Layout(name=\"main\", ratio=1),\n    Layout(name=\"footer\", size=3)\n)\n\nlayout[\"header\"].update(Panel(\"[bold green]ğŸ–¥ ç³»ç»Ÿç›‘æ§\"))\nlayout[\"footer\"].update(Panel(\"æŒ‰ Ctrl+C é€€å‡º\", border_style=\"red\"))\n\ndef make_main_panel(cpu, mem):\n    return Panel(f\"CPU ä½¿ç”¨ç‡: {cpu}%\\nå†…å­˜å ç”¨: {mem} MB\", border_style=\"cyan\")\n\nwith Live(layout, refresh_per_second=2):\n    for i in range(100):\n        cpu = (i * 3) % 100\n        mem = 500 + (i * 2)\n        layout[\"main\"].update(make_main_panel(cpu, mem))\n        time.sleep(0.1)\n```\n\nè¿è¡Œåï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªå®æ—¶æ›´æ–°çš„åŠ¨æ€â€œç•Œé¢â€ï¼Œåƒä¸ªè¿·ä½ ç›‘æ§å°ã€‚\n\n## é«˜çº§\n\nRich çš„å¼€å‘è€…è¿˜å†™äº†ä¸€ä¸ªåŸºäºå®ƒçš„**ç»ˆç«¯åº”ç”¨æ¡†æ¶**ï¼š[**Textual**](https://github.com/Textualize/textual)  \nå®ƒèƒ½è®©ä½ ç”¨ Rich çš„åŸºç¡€è¯­æ³•å†™å‡ºå¸¦çª—å£ã€æŒ‰é’®ã€æ»šåŠ¨åŒºçš„å®Œæ•´ TUIï¼ˆç»ˆç«¯UIï¼‰ç¨‹åºã€‚\n\næœ‰ä½™åŠ›å¯ä»¥å­¦ä¹ ä¸€ä¸‹ã€‚\n","tags":["python","rich"],"categories":["python"]},{"title":"å¤§èŸ’è›‡-jsonåº“","url":"/posts/50277/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n## json.load()\n**æè¿°ï¼š** ä»æ–‡ä»¶å¯¹è±¡è¯»å– JSON æ•°æ®å¹¶ååºåˆ—åŒ–ä¸º Python å¯¹è±¡  \n**è¯­æ³•ï¼š**\n```python\njson.load(fp, *, cls=None, object_hook=None, parse_float=None, parse_int=None, parse_constant=None, object_pairs_hook=None, **kw)\n```\n**ç¤ºä¾‹ï¼š**\n```python\nimport json\nwith open('data.json', 'r') as f:\n    data = json.load(f)\n```\n\n## json.loads()\n**æè¿°ï¼š** ä»å­—ç¬¦ä¸²è¯»å– JSON æ•°æ®å¹¶ååºåˆ—åŒ–ä¸º Python å¯¹è±¡  \n**è¯­æ³•ï¼š**\n```python\njson.loads(s, *, cls=None, object_hook=None, parse_float=None, parse_int=None, parse_constant=None, object_pairs_hook=None, **kw)\n```\n**ç¤ºä¾‹ï¼š**\n```python\ndata = json.loads('{\"name\": \"Alice\", \"age\": 25}')\n```\n\n## json.dump()\n**æè¿°ï¼š** å°† Python å¯¹è±¡åºåˆ—åŒ–ä¸º JSON å¹¶å†™å…¥æ–‡ä»¶  \n**è¯­æ³•ï¼š**\n```python\njson.dump(obj, fp, *, skipkeys=False, ensure_ascii=True, check_circular=True,\n          allow_nan=True, cls=None, indent=None, separators=None,\n          default=None, sort_keys=False, **kw)\n```\n**ç¤ºä¾‹ï¼š**\n```python\ndata = {\"name\": \"Bob\", \"age\": 30}\nwith open('data.json', 'w') as f:\n    json.dump(data, f, indent=4)\n```\n\n## json.dumps()\n**æè¿°ï¼š** å°† Python å¯¹è±¡åºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²  \n**è¯­æ³•ï¼š**\n```python\njson.dumps(obj, *, skipkeys=False, ensure_ascii=True, check_circular=True,\n           allow_nan=True, cls=None, indent=None, separators=None,\n           default=None, sort_keys=False, **kw)\n```\n**ç¤ºä¾‹ï¼š**\n```python\ns = json.dumps({\"x\": 1, \"y\": 2}, indent=2)\n```\n\n## json.JSONDecoder\n**æè¿°ï¼š** JSON ååºåˆ—åŒ–ç±»ï¼Œå¯è‡ªå®šä¹‰è§£æé€»è¾‘  \n**è¯­æ³•ï¼š**\n```python\nclass json.JSONDecoder(object_hook=None, object_pairs_hook=None, parse_float=None,\n                       parse_int=None, parse_constant=None, strict=True, **kw)\n```\n**ç¤ºä¾‹ï¼š**\n```python\ndecoder = json.JSONDecoder()\nobj = decoder.decode('{\"a\":1,\"b\":2}')\n```\n\n## json.JSONEncoder\n**æè¿°ï¼š** JSON åºåˆ—åŒ–ç±»ï¼Œå¯è‡ªå®šä¹‰ç¼–ç è¡Œä¸º  \n**è¯­æ³•ï¼š**\n```python\nclass json.JSONEncoder(skipkeys=False, ensure_ascii=True, check_circular=True,\n                       allow_nan=True, sort_keys=False, indent=None, separators=None, default=None)\n```\n**ç¤ºä¾‹ï¼š**\n```python\nencoder = json.JSONEncoder(indent=2)\ns = encoder.encode({\"name\": \"test\"})\n```\n\n## json.JSONDecodeError\n**æè¿°ï¼š** è§£ç  JSON æ—¶çš„å¼‚å¸¸ç±»å‹ï¼ˆç»§æ‰¿è‡ª `ValueError`ï¼‰  \n**è¯­æ³•ï¼š**\n```python\ntry:\n    json.loads('invalid json')\nexcept json.JSONDecodeError as e:\n    print(e)\n```\n\n## json.toolï¼ˆå‘½ä»¤è¡Œæ¨¡å—ï¼‰\n**æè¿°ï¼š** å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæ ¼å¼åŒ– JSON è¾“å‡º  \n**è¯­æ³•ï¼š**\n```bash\npython -m json.tool input.json\n```\n**ç¤ºä¾‹ï¼š**\n```bash\necho '{\"a\":1,\"b\":2}' | python -m json.tool\n```\n\n## å‚æ•°è¯´æ˜ï¼ˆé€‚ç”¨äº dump/dumps/load/loadsï¼‰\n\n### indent\næ§åˆ¶ç¼©è¿›æ ¼å¼ï¼ˆæ•´æ•°æˆ–å­—ç¬¦ä¸²ï¼‰  \n```python\njson.dumps(data, indent=4)\n```\n\n### separators\nè‡ªå®šä¹‰åˆ†éš”ç¬¦ï¼ˆé»˜è®¤ `(', ', ': ')`ï¼‰  \n```python\njson.dumps(data, separators=(',', ':'))\n```\n\n### sort_keys\næŒ‰é”®åæ’åºè¾“å‡º  \n```python\njson.dumps(data, sort_keys=True)\n```\n\n### ensure_ascii\næ˜¯å¦è½¬ä¹‰é ASCII å­—ç¬¦  \n```python\njson.dumps({\"ä¸­æ–‡\": \"æµ‹è¯•\"}, ensure_ascii=False)\n```\n\n### default\nå®šä¹‰æ— æ³•åºåˆ—åŒ–å¯¹è±¡çš„å¤„ç†å‡½æ•°  \n```python\ndef encode_complex(obj):\n    if isinstance(obj, complex):\n        return {\"real\": obj.real, \"imag\": obj.imag}\n    raise TypeError()\n\njson.dumps(1+2j, default=encode_complex)\n```\n\n### object_hook\nè‡ªå®šä¹‰ååºåˆ—åŒ–å¤„ç†å‡½æ•°  \n```python\ndef as_person(d):\n    return Person(d['name']) if 'name' in d else d\n\njson.loads('{\"name\":\"Alice\"}', object_hook=as_person)\n```\n\n### parse_float, parse_int, parse_constant\nç”¨äºè‡ªå®šä¹‰è§£ææ•°å­—/å¸¸é‡çš„å‡½æ•°  \n```python\njson.loads('{\"num\": 1.23}', parse_float=lambda x: round(float(x), 1))\n```\n\n## å¸¸è§ç”¨æ³•å¯¹æ¯”\n\n| æ“ä½œ   | ä»å­—ç¬¦ä¸²         | ä»æ–‡ä»¶         | è¾“å‡ºä¸ºå­—ç¬¦ä¸²       | è¾“å‡ºä¸ºæ–‡ä»¶       |\n| ---- | ------------ | ----------- | ------------ | ----------- |\n| ååºåˆ—åŒ– | json.loads() | json.load() | â€”            | â€”           |\n| åºåˆ—åŒ–  | â€”            | â€”           | json.dumps() | json.dump() |\n\n","tags":["python","json"],"categories":["python"]},{"title":"u-bootå¸¸è§å‘½ä»¤","url":"/posts/13859/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\nU-Bootï¼ˆUniversal Boot Loaderï¼‰æ˜¯åµŒå…¥å¼ç³»ç»Ÿå¼€å‘ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç»„ä»¶ï¼Œå®ƒè´Ÿè´£åœ¨æ“ä½œç³»ç»Ÿå¯åŠ¨ä¹‹å‰ï¼Œè¿›è¡ŒåŸºæœ¬çš„ç¡¬ä»¶åˆå§‹åŒ–ï¼Œå¹¶æä¾›ä¸€ä¸ªäº¤äº’å¼çš„å‘½ä»¤è¡Œæ¥å£ï¼Œä»¥ä¾¿ç”¨æˆ·è¿›è¡Œç³»ç»Ÿé…ç½®ã€å†…æ ¸åŠ è½½ç­‰æ“ä½œã€‚æŒæ¡ U-Boot çš„å¸¸è§å‘½ä»¤æ˜¯åµŒå…¥å¼å·¥ç¨‹å¸ˆçš„åŸºæœ¬åŠŸã€‚\n\næœ¬æ–‡å°†ä¸ºæ‚¨ä»‹ç»ä¸€äº› U-Boot ä¸­æœ€å¸¸ç”¨å’Œæœ€å…³é”®çš„å‘½ä»¤åŠå…¶ç”¨é€”ã€‚\n\n## ä¸€ã€ ç¯å¢ƒä¸ä¿¡æ¯æŸ¥çœ‹å‘½ä»¤\n\nè¿™äº›å‘½ä»¤ç”¨äºæŸ¥çœ‹å’Œç®¡ç† U-Boot çš„è¿è¡Œç¯å¢ƒå’Œç³»ç»Ÿä¿¡æ¯ã€‚\n\n| **å‘½ä»¤**       | **ç”¨é€”**                                  | **ç¤ºä¾‹**                 | **å¤‡æ³¨**              |\n| ------------ | --------------------------------------- | ---------------------- | ------------------- |\n| `help` æˆ– `?` | æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‘½ä»¤çš„åˆ—è¡¨æˆ–ç‰¹å®šå‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ã€‚                  | `help` / `help setenv` | `?` æ˜¯ `help` çš„åˆ«åã€‚   |\n| `printenv`   | æ˜¾ç¤ºæ‰€æœ‰çš„ç¯å¢ƒå˜é‡åŠå…¶å€¼ã€‚                           | `printenv`             | ç¯å¢ƒå˜é‡é€šå¸¸ä¿å­˜åœ¨éæ˜“å¤±æ€§å­˜å‚¨ä»‹è´¨ä¸­ã€‚ |\n| `bdinfo`     | æ˜¾ç¤ºæ¿çº§ä¿¡æ¯ï¼ˆBoard Info Structureï¼‰ï¼Œå¦‚å†…å­˜åœ°å€ã€å¤§å°ç­‰ã€‚ | `bdinfo`               |                     |\n| `version`    | æ˜¾ç¤º U-Boot çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚                        | `version`              |                     |\n\n## äºŒã€ ç¯å¢ƒå˜é‡æ“ä½œå‘½ä»¤\n\nç¯å¢ƒå˜é‡æ˜¯ U-Boot é…ç½®ç³»ç»Ÿè¡Œä¸ºçš„å…³é”®ï¼Œä¾‹å¦‚å®šä¹‰å¯åŠ¨å‚æ•°ã€ç½‘ç»œè®¾ç½®ç­‰ã€‚\n\n|**å‘½ä»¤**|**ç”¨é€”**|**ç¤ºä¾‹**|**å¤‡æ³¨**|\n|---|---|---|---|\n|`setenv`|è®¾ç½®æˆ–ä¿®æ”¹ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼ã€‚|`setenv ipaddr 192.168.1.100`|æ›´æ”¹æ˜¯ä¸´æ—¶çš„ï¼Œåªåœ¨å½“å‰ U-Boot ä¼šè¯ä¸­ç”Ÿæ•ˆã€‚|\n|`saveenv`|å°†å½“å‰å†…å­˜ä¸­çš„ç¯å¢ƒå˜é‡ä¿å­˜åˆ°éæ˜“å¤±æ€§å­˜å‚¨ï¼ˆå¦‚ Flash æˆ– eMMCï¼‰ä¸­ã€‚|`saveenv`|ä½¿ç¯å¢ƒå˜é‡æ°¸ä¹…ç”Ÿæ•ˆã€‚|\n|`run`|æ‰§è¡Œå­˜å‚¨åœ¨ä¸€ä¸ªç¯å¢ƒå˜é‡ä¸­çš„å‘½ä»¤åºåˆ—ã€‚|`run bootcmd`|`bootcmd` æ˜¯ä¸€ä¸ªé‡è¦çš„ç¯å¢ƒå˜é‡ï¼Œå®šä¹‰äº†è‡ªåŠ¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ã€‚|\n|`bootargs`|**ï¼ˆç‰¹æ®Šå˜é‡ï¼‰** è®¾ç½®ä¼ é€’ç»™ Linux å†…æ ¸çš„å¯åŠ¨å‚æ•°ã€‚|`setenv bootargs 'root=/dev/mmcblk0p2 console=ttyS0,115200'`|é€šå¸¸åœ¨å¯åŠ¨å‰è®¾ç½®ã€‚|\n|`bootcmd`|**ï¼ˆç‰¹æ®Šå˜é‡ï¼‰** è®¾å®š U-Boot è‡ªåŠ¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ã€‚|`setenv bootcmd 'tftp 0x42000000 zImage; bootm 0x42000000'`|å¯åŠ¨æ—¶è‹¥ä¸æ‰“æ–­ï¼Œåˆ™æ‰§è¡Œæ­¤å˜é‡ä¸­çš„å‘½ä»¤ã€‚|\n\n## ä¸‰ã€ å†…å­˜ä¸å­˜å‚¨æ“ä½œå‘½ä»¤\n\nè¿™äº›å‘½ä»¤ç”¨äºè¯»å†™å†…å­˜ã€ä»å¤–éƒ¨å­˜å‚¨åŠ è½½æ•°æ®ã€ä»¥åŠæ“ä½œ Flash ç­‰ã€‚\n\n| **å‘½ä»¤**                            | **ç”¨é€”**                            | **ç¤ºä¾‹**                                                | **å¤‡æ³¨**                                                |\n| --------------------------------- | --------------------------------- | ----------------------------------------------------- | ----------------------------------------------------- |\n| `mw`                              | å†…å­˜å†™å…¥ï¼ˆMemory Writeï¼‰ï¼Œå‘å†…å­˜åœ°å€å†™å…¥æŒ‡å®šå€¼ã€‚    | `mw.l 0x40000000 0xDEADBEEF 10`                       | `.b` (å­—èŠ‚), `.w` (å­—), `.l` (é•¿å­—) æŒ‡å®šå†™å…¥å•ä½ã€‚**10æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶æ•°**ã€‚ |\n| `md`                              | å†…å­˜æ˜¾ç¤ºï¼ˆMemory Displayï¼‰ï¼ŒæŸ¥çœ‹æŒ‡å®šå†…å­˜åœ°å€çš„å†…å®¹ã€‚ | `md.l 0x40000000 10`                                  | **10æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶æ•°**ï¼Œè¡¨ç¤ºæ˜¾ç¤º 10 ä¸ªå•ä½ã€‚                           |\n| `cp`                              | å†…å­˜æ‹·è´ï¼ˆMemory Copyï¼‰ï¼Œåœ¨å†…å­˜æˆ–å­˜å‚¨ä¹‹é—´å¤åˆ¶æ•°æ®ã€‚   | `cp.b 0x40000000 0x40100000 0x100`                    | å¯ç”¨äºä» NAND/SD/eMMC ç­‰åˆ° RAM çš„å¤åˆ¶ã€‚                         |\n| `erase`                           | æ“¦é™¤ Flash æˆ–å…¶ä»–å­˜å‚¨åŒºåŸŸã€‚                 | `erase 0x50000000 +0x100000`                          | æ…ç”¨ï¼ä¼šæ¸…é™¤æ•°æ®ã€‚                                             |\n| `nand` / `mmc` / `spi` / `sata` ç­‰ | é’ˆå¯¹ä¸åŒå­˜å‚¨ä»‹è´¨çš„æ“ä½œå‘½ä»¤ã€‚                    | `mmc rescan` / `nand read 0x40000000 kernel 0x800000` | å…·ä½“å‘½ä»¤å–å†³äº U-Boot é…ç½®å’Œç¡¬ä»¶æ”¯æŒã€‚                               |\n| `cmp`                             | æ¯”è¾ƒä¸¤æ®µå†…å­˜åœ°å€çš„æŒ‡å®šå•ä½é•¿åº¦æ•°æ®æ˜¯å¦ç›¸ç­‰             | `cmp.l 80000000 80000100 10`                          | `.b` (å­—èŠ‚), `.w` (å­—), `.l` (é•¿å­—) æŒ‡å®šå†™å…¥å•ä½ã€‚**10æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶æ•°**ã€‚ |\n\n## å››ã€ ç½‘ç»œä¸æ–‡ä»¶ä¼ è¾“å‘½ä»¤\n\nåœ¨åµŒå…¥å¼å¼€å‘ä¸­ï¼Œé€šå¸¸é€šè¿‡ç½‘ç»œï¼ˆå¦‚ TFTPï¼‰ä»ä¸»æœºä¸‹è½½å†…æ ¸æˆ–æ–‡ä»¶ç³»ç»Ÿé•œåƒã€‚\n\n| **å‘½ä»¤**   | **ç”¨é€”**                    | **ç¤ºä¾‹**                                                       | **å¤‡æ³¨**                             |\n| -------- | ------------------------- | ------------------------------------------------------------ | ---------------------------------- |\n| `ping`   | æµ‹è¯•ç½‘ç»œè¿æ¥ã€‚                   | `ping 192.168.1.1`                                           | éœ€è¦è®¾ç½® `ipaddr` å’Œ `serverip` ç¯å¢ƒå˜é‡ã€‚   |\n| `tftp`   | ä½¿ç”¨ TFTP åè®®ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°å†…å­˜ã€‚    | `tftp 0x42000000 zImage`                                     | 0x42000000 æ˜¯å†…å­˜åœ°å€ï¼ŒzImage æ˜¯æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶åã€‚ |\n| `dhcp`   | é€šè¿‡ DHCP è·å–æ¿å­çš„ IP åœ°å€ç­‰ç½‘ç»œå‚æ•°ã€‚ | `dhcp`                                                       |                                    |\n| `setenv` | **ï¼ˆç½‘ç»œç›¸å…³å˜é‡ï¼‰** è®¾ç½®ç½‘ç»œå‚æ•°ã€‚      | `setenv ipaddr 192.168.1.10` / `setenv serverip 192.168.1.1` |                                    |\n\n### issue#1:æ— æ³•pingé€š\n\nç¬¬ä¸€ï¼Œæ£€æŸ¥ç¯å¢ƒå˜é‡ï¼Œé…ç½®å¥½ipaddrã€ethaddrã€netmaskï¼Œç¡®ä¿ä¸ä¸»æœºå¤„äºåŒä¸€ç½‘æ®µã€‚\n\n| **ç¯å¢ƒå˜é‡**  | **ç”¨é€”**                        |\n| --------- | ----------------------------- |\n| ipaddr    | å¼€å‘æ¿ipåœ°å€                       |\n| ethaddr   | å¼€å‘æ¿MACåœ°å€                      |\n| netmask   | å­ç½‘æ©ç                           |\n| gatewayip | ç½‘å…³åœ°å€                          |\n| serveip   | æœåŠ¡å™¨ IP åœ°å€ï¼Œä¹Ÿå°±æ˜¯ä¸»æœº IP åœ°å€ï¼Œç”¨äºè°ƒè¯•ä»£ç ã€‚ |\n\n```\nsetenv ipaddr 192.168.137.144\nsetenv ethaddr yourethaddr\nsetenv netmask 255.255.255.0\nsetenv serverip 192.168.137.1\nsaveenv\n```\n\nç¬¬äºŒï¼Œæ£€æŸ¥æ— è¯¯åï¼Œä½¿ç”¨ç½‘çº¿è¿æ¥ä¸»æœºï¼ˆç”µè„‘ï¼‰ï¼Œå‘ç°æ— æ³•pingé€šã€‚\n\n- **åŸå› **ï¼šwindowsç³»ç»Ÿæ— æ³•è¯†åˆ«è¿æ¥åˆ°ä»¥å¤ªç½‘æ¥å£çš„è®¾å¤‡ï¼Œæ˜¾ç¤ºä¸ºâ€œæœªè¯†åˆ«çš„ç½‘ç»œâ€ï¼Œä½¿ç”¨çš„æ˜¯å…¬ç”¨ç½‘ç»œçš„ç½‘ç»œé…ç½®æ–‡ä»¶ï¼Œè€Œwindowså…¬ç”¨ç½‘ç»œé…ç½®æ–‡ä»¶é»˜è®¤æ˜¯ä¸å…è®¸å›åº”pingçš„ï¼Œå› æ­¤æ— æ³•pingé€šã€‚\n\n- **è§£å†³æ–¹æ³•**ï¼šåœ¨è®¾ç½®â€”â€”ç½‘ç»œä¸Internetâ€”â€”é«˜çº§ç½‘ç»œè®¾ç½®â€”â€”Windowsé˜²ç«å¢™ï¼Œå°†å…¬ç”¨ç½‘ç»œä¸­çš„é˜²ç«å¢™æš‚æ—¶å…³é—­ï¼Œå³å¯pingé€šã€‚\n\n\n## äº”ã€ ç³»ç»Ÿå¯åŠ¨å‘½ä»¤\n\nè¿™äº›å‘½ä»¤ç”¨äºåŠ è½½å¹¶å¯åŠ¨æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚\n\n| **å‘½ä»¤**           | **ç”¨é€”**                                           | **ç¤ºä¾‹**             | **å¤‡æ³¨**                         |\n| ---------------- | ------------------------------------------------ | ------------------ | ------------------------------ |\n| `bootm`          | å¯åŠ¨ä¸€ä¸ªç”± `mkimage` å·¥å…·åˆ¶ä½œçš„ã€å¸¦æœ‰ U-Boot æ˜ åƒå¤´ä¿¡æ¯çš„å†…æ ¸æˆ–æ“ä½œç³»ç»Ÿæ˜ åƒã€‚ | `bootm 0x42000000` | åœ°å€æ˜¯å†…æ ¸åœ¨ RAM ä¸­çš„åŠ è½½åœ°å€ã€‚             |\n| `bootz`          | å¯åŠ¨ä¸€ä¸ª Linux zImage æ ¼å¼çš„å†…æ ¸ã€‚                         | `bootz 0x42000000` | é€šå¸¸ç”¨äºå¯åŠ¨æœªè¢« `mkimage` æ‰“åŒ…çš„ zImageã€‚ |\n| `boot` æˆ– `bootd` | æ‰§è¡Œ `bootcmd` ç¯å¢ƒå˜é‡ä¸­å®šä¹‰çš„å‘½ä»¤ï¼Œå®ç°é»˜è®¤å¯åŠ¨ã€‚                  | `boot`             | `bootd` æ˜¯ `boot` çš„åˆ«åã€‚          |\n\n## æ€»ç»“\n\nU-Boot çš„å‘½ä»¤ä¼—å¤šï¼Œä½†ä¸Šè¿°è¿™äº›æ˜¯æ—¥å¸¸å¼€å‘å’Œè°ƒè¯•ä¸­æœ€å¸¸ç”¨çš„ã€‚é€šè¿‡è¿™äº›å‘½ä»¤ï¼Œæ‚¨å¯ä»¥å®ç°ï¼š\n\n1. **æŸ¥çœ‹å’Œä¿®æ”¹é…ç½®ï¼š** ä½¿ç”¨ `printenv`ã€`setenv` å’Œ `saveenv` ç®¡ç†å¯åŠ¨å‚æ•°å’Œç½‘ç»œè®¾ç½®ã€‚\n    \n2. **åŠ è½½æ˜ åƒæ–‡ä»¶ï¼š** ä½¿ç”¨ `tftp`ã€`mmc read` ç­‰å°†å†…æ ¸ã€è®¾å¤‡æ ‘ï¼ˆDTBï¼‰å’Œæ–‡ä»¶ç³»ç»ŸåŠ è½½åˆ° RAM ä¸­ã€‚\n    \n3. **å¯åŠ¨ç³»ç»Ÿï¼š** ä½¿ç”¨ `bootm` æˆ– `bootz` å¼•å¯¼æ“ä½œç³»ç»Ÿã€‚\n    \n4. **è°ƒè¯•å’Œè¯Šæ–­ï¼š** ä½¿ç”¨ `md`ã€`mw` å’Œ `ping` ç­‰è¿›è¡Œå†…å­˜å’Œç½‘ç»œæµ‹è¯•ã€‚\n    \n\nåœ¨å®é™…æ“ä½œä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡è¾“å…¥ `help` å‘½ä»¤æ¥è·å–å½“å‰ U-Boot ç‰ˆæœ¬æ‰€æ”¯æŒçš„å®Œæ•´å‘½ä»¤åˆ—è¡¨ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ U-Bootï¼\n\n---\n","tags":["u-boot"],"categories":["Linux","ç³»ç»Ÿç§»æ¤"]},{"title":"åœ¨Linuxä¸­åˆ›å»ºä¸€ä¸ªå­—ç¬¦é©±åŠ¨è®¾å¤‡","url":"/posts/59269/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n\n","tags":["Linux","å­—ç¬¦é©±åŠ¨"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"è®°å½•æ­å»ºä¸€å°äº‘æœåŠ¡å™¨ç¯å¢ƒçš„è¿‡ç¨‹","url":"/posts/2446/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n- [1. å‰è¨€](#1-å‰è¨€)\n- [2. æ“ä½œä¹ æƒ¯éƒ¨åˆ†](#2-æ“ä½œä¹ æƒ¯éƒ¨åˆ†)\n  - [2.1. ä¿®æ”¹ä¸»æœºå](#21-ä¿®æ”¹ä¸»æœºå)\n  - [2.2. é…ç½®æ—¶åŒº](#22-é…ç½®æ—¶åŒº)\n- [3. ğŸ”å®‰å…¨éƒ¨åˆ†](#3-å®‰å…¨éƒ¨åˆ†)\n  - [3.1. é‡æ–°è®¾ç½®rootå¯†ç ä¸ºå¼ºå¯†ç ](#31-é‡æ–°è®¾ç½®rootå¯†ç ä¸ºå¼ºå¯†ç )\n  - [3.2. æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¼ºå¯†ç ](#32-æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¼ºå¯†ç )\n  - [3.3. ç³»ç»Ÿå‡çº§](#33-ç³»ç»Ÿå‡çº§)\n  - [3.4. ä½¿ç”¨SSH Keyè¿œç¨‹ç™»å½•è€Œä¸æ˜¯å¯†ç ](#34-ä½¿ç”¨ssh-keyè¿œç¨‹ç™»å½•è€Œä¸æ˜¯å¯†ç )\n    - [3.4.1. åœ¨æœ¬åœ°ç”µè„‘ä¸Šç”Ÿæˆå¯†åŒ™å¯¹ï¼š](#341-åœ¨æœ¬åœ°ç”µè„‘ä¸Šç”Ÿæˆå¯†åŒ™å¯¹)\n    - [3.4.2. åˆ›å»ºconfigæ–‡ä»¶](#342-åˆ›å»ºconfigæ–‡ä»¶)\n    - [3.4.3. å¤åˆ¶å…¬åŒ™åˆ°æœåŠ¡å™¨](#343-å¤åˆ¶å…¬åŒ™åˆ°æœåŠ¡å™¨)\n    - [3.4.4. ç™»å½•](#344-ç™»å½•)\n  - [3.5. æ”¹sshç«¯å£\\&é…ç½®é˜²ç«å¢™](#35-æ”¹sshç«¯å£é…ç½®é˜²ç«å¢™)\n    - [3.5.1. åˆæ­¥é…ç½®](#351-åˆæ­¥é…ç½®)\n    - [3.5.2. æ”¹SSHç«¯å£](#352-æ”¹sshç«¯å£)\n    - [3.5.3. å…³é—­22ç«¯å£](#353-å…³é—­22ç«¯å£)\n  - [3.6. sshé…ç½®æ–‡ä»¶](#36-sshé…ç½®æ–‡ä»¶)\n    - [3.6.1. ç¦ç”¨ rootè¿œç¨‹ç™»å½•\\&å¯†ç ç™»å½•](#361-ç¦ç”¨-rootè¿œç¨‹ç™»å½•å¯†ç ç™»å½•)\n    - [3.6.2. ä½¿ç”¨SSH2](#362-ä½¿ç”¨ssh2)\n    - [3.6.3. é‡å¯ssh](#363-é‡å¯ssh)\n  - [3.7. Fail2banå·¥å…·é˜²æš´åŠ›ç ´è§£](#37-fail2banå·¥å…·é˜²æš´åŠ›ç ´è§£)\n    - [3.7.1. é…ç½®fail2ban](#371-é…ç½®fail2ban)\n    - [3.7.2. æŸ¥çœ‹çŠ¶æ€](#372-æŸ¥çœ‹çŠ¶æ€)\n    - [3.7.3. è§£å°ip](#373-è§£å°ip)\n    - [3.7.4. å¯ç”¨fail2ban](#374-å¯ç”¨fail2ban)\n    - [3.7.5. å°è´´å£«](#375-å°è´´å£«)\n- [4. ç³»ç»Ÿç»´æŠ¤éƒ¨åˆ†](#4-ç³»ç»Ÿç»´æŠ¤éƒ¨åˆ†)\n  - [4.1. ~~ä½¿ç”¨expkg~~](#41-ä½¿ç”¨expkg)\n- [5. ç³»ç»Ÿè¿è¡Œéƒ¨åˆ†](#5-ç³»ç»Ÿè¿è¡Œéƒ¨åˆ†)\n\n\n## 1. å‰è¨€\n\nå‰å‡ å¤©åœ¨ä¸ƒç‰›äº‘ç§Ÿäº†ä¸€å°è½»é‡åº”ç”¨çº§æœåŠ¡å™¨ï¼Œ2c4gbï¼Œè¶³å¤Ÿæ»¡è¶³ç©å…·çš„éœ€æ±‚äº†ã€‚ç¬¬ä¸€æ¬¡ç©æœåŠ¡å™¨ï¼Œç°åœ¨æŠŠè‡ªå·±çš„æ­å»ºç¯å¢ƒçš„è¿‡ç¨‹è®°å½•ä¸€ä¸‹ï¼Œæ–¹ä¾¿æ—¥åæ“ä½œã€‚\n\näº‘æœåŠ¡å™¨ç³»ç»Ÿï¼šUbuntu 24.04 LTS\näº‘æœåŠ¡å™¨å‚å•†ï¼šä¸ƒç‰›äº‘\näº‘æœåŠ¡å™¨è§„æ ¼ï¼šè½»é‡å‹ T1 2C4GB CPUå‹\n\n\n## 2. æ“ä½œä¹ æƒ¯éƒ¨åˆ†\n### 2.1. ä¿®æ”¹ä¸»æœºå\n\nsshç™»å½•åˆ°æœåŠ¡å™¨åï¼Œå‘ç°ä¸»æœºåæ˜¯ä¸€å¨ä¹±ç ï¼Œçœ‹ç€å¤ªéš¾å—äº†ï¼Œå¿…é¡»æ”¹äº†ã€‚\n![](Snipaste_2025-10-14_14-17-13.png)\n\næ°¸ä¹…ä¿®æ”¹ä¸»æœºåå‘½ä»¤ï¼š\n```bash\nsudo hostnamectl set-hostname myserver\n```\n\né‡å¯ç”Ÿæ•ˆã€‚\n\n### 2.2. é…ç½®æ—¶åŒº\n\nè¾“å…¥ `date` å‘½ä»¤ï¼Œå‘ç°æœåŠ¡å™¨ä½¿ç”¨çš„ä¸–ç•Œåè°ƒæ—¶ï¼ˆUTCï¼‰ï¼Œæ”¹ä¸ºä¸­å›½æ ‡å‡†æ—¶ï¼ˆUTC+8ï¼‰ï¼Œç¬¦åˆä¹ æƒ¯ã€‚\n\n```bash\nsudo timedatectl set-timezone Asia/Shanghai\n```\n\nè¿è¡Œåï¼Œä½¿ç”¨  `timedatectl` å‘½ä»¤ç¡®è®¤æ˜¯å¦ä¿®æ”¹æˆåŠŸï¼Œå¹¶æŸ¥çœ‹ `NTP service` æ˜¯å¦å¯ç”¨ï¼Œè¿™æ˜¯è‡ªåŠ¨åŒæ­¥ç½‘ç»œæ—¶é—´ï¼Œå¯ä¿æŒæ—¶é—´ç²¾å‡†ã€‚è‹¥æœªå¯ç”¨åˆ™éœ€æŸ¥è¯¢ç›¸å…³æ•™ç¨‹å¯ç”¨ã€‚\n\n\n## 3. ğŸ”å®‰å…¨éƒ¨åˆ†\n\næ­¤éƒ¨åˆ†éœ€æ ¼å¤–é‡è§†ï¼\n\n### 3.1. é‡æ–°è®¾ç½®rootå¯†ç ä¸ºå¼ºå¯†ç \n\nä¸ç”¨å¤šè¯´ï¼Œ`passwd` å‘½ä»¤å³å¯ã€‚\n\n### 3.2. æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¼ºå¯†ç \n\n```bash\nadduser yourname\n```\n\næ·»åŠ åˆ°sudoç»„ï¼š\n```bash\nusermod -aG sudo yourname\n```\n\næŸ¥çœ‹ç”¨æˆ·ç»„ï¼š\n```bash\ncat /etc/group\n```\n\næŸ¥çœ‹å½“å‰ç”¨æˆ·æ‰€å±ç»„ï¼š`groups`å‘½ä»¤ã€‚\n\n>è®¾ç½®å®Œæˆåï¼Œé€€å‡ºrootç”¨æˆ·ç™»å½•ï¼Œç”¨SSHä»¥æ™®é€šç”¨æˆ·é‡æ–°ç™»å½•åˆ°æœåŠ¡å™¨ã€‚\n\n### 3.3. ç³»ç»Ÿå‡çº§\n\n```bash\nsudo apt update\nsudo apt upgrade\n```\n\n\n### 3.4. ä½¿ç”¨SSH Keyè¿œç¨‹ç™»å½•è€Œä¸æ˜¯å¯†ç \n\nSSH Key ç™»å½•æ¯”å¯†ç å®‰å…¨å¾ˆå¤šï¼Œå‡ ä¹æ— æ³•ç ´è§£ã€‚æœ¬è´¨å°±æ˜¯è®©æœåŠ¡å™¨è¯†åˆ«ä½ çš„ç”µè„‘ï¼Œåªæœ‰ä½ çš„ç”µè„‘æ‰èƒ½ç™»å½•åˆ°æœåŠ¡å™¨ã€‚\n\n#### 3.4.1. åœ¨æœ¬åœ°ç”µè„‘ä¸Šç”Ÿæˆå¯†åŒ™å¯¹ï¼š\n\n```bash\nssh-keygen -t rsa -b 4096\n```\n\n- `-t`ï¼šæŒ‡å®šå¯†åŒ™ç±»å‹ï¼Œrsaæ˜¯ç»å…¸ç®—æ³•ï¼Œå…¼å®¹æ€§å¥½ã€‚\n- `-b`ï¼šæŒ‡å®šå¯†åŒ™é•¿åº¦ä¸º4096ä½ã€‚\n\nå®ƒä¼šæç¤ºä½ å‡ ä¸ªé—®é¢˜ï¼š\n\n```\nGenerating public/private rsa key pair. Enter file in which to save the key (/home/yourname/.ssh/id_rsa):\n```\n\nè¿™æ—¶å€™ï¼š\n- **ç›´æ¥å›è½¦** å°±ä¼šæŠŠå¯†é’¥ç”Ÿæˆåœ¨é»˜è®¤ä½ç½®ï¼š\n    - ç§é’¥ï¼š`~/.ssh/id_rsa` ï¼Œ**ç»å¯¹ä¸èƒ½æ³„éœ²ï¼**\n    - å…¬é’¥ï¼š`~/.ssh/id_rsa.pub\n- **æˆ–è€…**æŒ‡å®šä½ç½®åŠæ–‡ä»¶åã€‚\næ¥ç€ä¼šæç¤ºï¼š\n\n```\nEnter passphrase (empty for no passphrase):\n```\n\nè¿™é‡Œä½ å¯ä»¥é€‰æ‹©ï¼š\n- **ç›´æ¥å›è½¦**ï¼šä¸è®¾ç½®å¯†ç ï¼Œç™»å½•æ›´æ–¹ä¾¿ï¼›\n- **è¾“å…¥å¯†ç çŸ­è¯­**ï¼šå¤šä¸€å±‚ä¿æŠ¤ï¼ˆæ¯æ¬¡ç”¨ç§é’¥ç™»å½•éƒ½è¦è¾“å…¥è¿™ä¸²å¯†ç ï¼‰ã€‚\n\n#### 3.4.2. åˆ›å»ºconfigæ–‡ä»¶\n\næœ‰æ—¶ï¼Œæˆ‘ä»¬ä¸åªæœ‰ä¸€ä¸ªsshå¯†åŒ™å¯¹ï¼Œæ¯”å¦‚æˆ‘ä¸ºgithubç”Ÿæˆäº†ä¸€ä¸ªå¯†åŒ™å¯¹ï¼Œä¹Ÿç»™æœåŠ¡å™¨ç”Ÿæˆäº†ä¸€ä¸ªã€‚å¦‚æœä½¿ç”¨äº†éé»˜è®¤åç§°çš„å¯†é’¥æ–‡ä»¶ï¼Œéœ€è¦åœ¨Â _~/.ssh/config_Â æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚\n\nåœ¨æœ¬åœ°ä¿å­˜sshå¯†åŒ™å¯¹æ–‡ä»¶çš„æ–‡ä»¶å¤¹é‡Œï¼Œæ‰“å¼€æˆ–åˆ›å»ºåä¸º `config` çš„æ–‡ä»¶ï¼Œæ— éœ€åç¼€åã€‚ç¼–è¾‘è¯¥æ–‡ä»¶ï¼Œç¤ºä¾‹ï¼š\n\n```\n# GitHubï¼ˆå¸¸è§ï¼‰\nHost github.com\n  HostName github.com\n  User git\n  IdentityFile ~/.ssh/id_ed25519_github\n  IdentitiesOnly yes\n\n# æˆ‘çš„æœåŠ¡å™¨\nHost myserver #ä½ çš„ä¸»æœºå\n  HostName 1.2.3.4 #ä¸»æœºipåœ°å€/åŸŸå\n  User someone #ä½ è¦ç™»å½•çš„ç”¨æˆ·\n  Port 22        # å¦‚æœä½ æ”¹è¿‡SSHç«¯å£å°±å†™ä¸Šï¼Œé»˜è®¤22\n  IdentityFile ~/.ssh/id_rsa_server\n  IdentitiesOnly yes\n```\n\n| å‚æ•°                   | å«ä¹‰                         |\n| -------------------- | -------------------------- |\n| `Host`               | è‡ªå®šä¹‰çš„åˆ«åï¼ˆå¯ä»¥éšæ„èµ·åï¼‰             |\n| `HostName`           | å®é™…çš„æœåŠ¡å™¨åŸŸåæˆ– IP åœ°å€            |\n| `User`               | ç™»å½•ç”¨æˆ·å                      |\n| `Port`               | SSH ç«¯å£ï¼ˆæ²¡æ”¹çš„è¯é»˜è®¤ 22ï¼‰          |\n| `IdentityFile`       | ç§é’¥æ–‡ä»¶è·¯å¾„                     |\n| `IdentitiesOnly yes` | åªä½¿ç”¨æŒ‡å®šçš„ç§é’¥ï¼Œé¿å…è‡ªåŠ¨å°è¯•å…¶ä»– key å¯¼è‡´æ‹’ç» |\n\n#### 3.4.3. å¤åˆ¶å…¬åŒ™åˆ°æœåŠ¡å™¨\n\næ–¹å¼1\n\n---\n\nåœ¨æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¿å­˜sshå…¬åŒ™ï¼ŒæœåŠ¡å™¨ç”¨å®ƒæ¥è¯†åˆ«è¿œç¨‹ç™»å½•åˆ°å®ƒçš„ç”µè„‘ã€‚\n\n```bash\nmkdir ~/.ssh\ntouch ~/.ssh/authorized_keys\nsudo chmod 700 ~/.ssh\nsudo chmod 600 ~/.ssh/authorized_keys\n```\n\nä¹‹åä½¿ç”¨nanoç¼–è¾‘å™¨ï¼Œå°†æœ¬åœ°çš„.pubæ–‡ä»¶é‡Œçš„å†…å®¹å¤åˆ¶åˆ°authorized_keyså³å¯ã€‚\n\n>- **åƒä¸‡åˆ«ä¸Šä¼ ç§é’¥**ï¼ˆä¾‹å¦‚ `id_rsa`ã€`id_ed25519`ï¼‰ã€‚åªä¼  `*.pub`ã€‚\n>- **æƒé™å¿…é¡»æ­£ç¡®**ï¼š- ç¡®ä¿æœåŠ¡å™¨ `~/.ssh` æƒé™æ˜¯ `700`ï¼Œ`~/.ssh/authorized_keys` æƒé™æ˜¯ `600`ï¼Œå¦åˆ™ SSH ä¼šæ‹’ç»ä½¿ç”¨å¯†é’¥ã€‚\n>- **æ¯ä¸ªå…¬é’¥ä¸€è¡Œ**ï¼Œä¸è¦æ’å…¥æ¢è¡Œæˆ–ç©ºæ ¼ã€‚`authorized_keys` å¯åŒ…å«å¤šæŠŠå…¬é’¥ï¼ˆå¤šå°ç”µè„‘å¯å…±ç”¨ï¼‰ã€‚\n\næ–¹å¼2\n\n---\n\nwindowå¯ä½¿ç”¨gitbashã€‚linuxç›´æ¥è¾“å…¥ï¼š\n\n```bash\nssh-copy-id -i ~/.ssh/id_rsa_server.pub root@SERVER_IP\n```\n- `-i` åé¢æ˜¯ä½ æœ¬åœ°çš„å…¬é’¥æ–‡ä»¶ï¼ˆæ¯”å¦‚ `~/.ssh/id_rsa_server.pub`ï¼‰ã€‚\n- è¿è¡Œä¼šæç¤ºè¾“å…¥æœåŠ¡å™¨å¯†ç ï¼Œç„¶åæŠŠå…¬é’¥è¿½åŠ åˆ°æœåŠ¡å™¨ `~/.ssh/authorized_keys`ã€‚\n**æ³¨æ„ä¸è¦é”™ä¼ æˆç§åŒ™ï¼**\n\n---\n\n#### 3.4.4. ç™»å½•\n\nå°è¯•åœ¨æœ¬åœ°sshç™»å½•ã€‚æ­£å¸¸çš„è¯ä¸ç”¨è¾“å¯†ç å°±å¯ä»¥ç›´æ¥ç™»é™†ä¸Šï¼š\n\n```bash\nssh Host\n```\n\n### 3.5. æ”¹sshç«¯å£&é…ç½®é˜²ç«å¢™\n\n> è­¦å‘Šï¼šæ­¤æ­¥æ“ä½œéœ€è¦è°¨æ…ï¼Œè‡³å°‘ä¿ç•™ä¸€ä¸ªå·²ç™»å½•çš„sshç»ˆç«¯ï¼Œå¦åˆ™å¦‚æœæ“ä½œä¸å½“ä¼šå¯¼è‡´è¢«é”ï¼ˆæ— æ³•ç™»å½•åˆ°æœåŠ¡å™¨ï¼‰ï¼Œæ­£ç¡®é…ç½®ä¹‹å‰å…ˆä¸è¦å¯ç”¨é˜²ç«å¢™ã€‚\n\n#### 3.5.1. åˆæ­¥é…ç½®\n\nUbuntu å†…ç½®äº†UFWé˜²ç«å¢™ã€‚é€šè¿‡é˜²ç«å¢™ï¼Œå°½å¯èƒ½å°‘çš„æš´éœ²ç«¯å£ï¼Œæå‡å®‰å…¨æ€§ã€‚\n\næˆ‘ä»¬é¦–å…ˆå…è®¸ä»¥ä¸‹ç«¯å£ï¼š\n- 22ç«¯å£ï¼šSSHé»˜è®¤ç«¯å£\n- 80ç«¯å£ï¼šHTTPæœåŠ¡ï¼Œå¦‚æœä½ åœ¨æœåŠ¡å™¨ä¸Šæ¶ç½‘ç«™ï¼Œè¿™ä¸ªç«¯å£å¿…é¡»å¼€æ”¾ã€‚\n- 443ç«¯å£ï¼šHTTPSæœåŠ¡\n\n```bash\nsudo ufw default deny incoming\nsudo ufw default allow outgoing\nsudo ufw allow 22/tcp    # SSHç«¯å£\nsudo ufw allow 80/tcp      # HTTP\nsudo ufw allow 443/tcp     # HTTPS\n```\n\n`sudo ufw default deny incoming`ï¼šé»˜è®¤æ‹’ç»æ‰€æœ‰è¿›å…¥æœåŠ¡å™¨çš„æµé‡ï¼ˆincoming trafficï¼‰ã€‚é™¤éä½ æ˜ç¡®å…è®¸æŸä¸ªç«¯å£ï¼Œå¦åˆ™å¤–éƒ¨æ— æ³•è¿æ¥åˆ°ä½ çš„æœåŠ¡å™¨ã€‚\n`sudo ufw default allow outgoing`ï¼šé»˜è®¤å…è®¸æœåŠ¡å™¨å‘å‡ºçš„æ‰€æœ‰æµé‡ï¼ˆoutgoing trafficï¼‰ã€‚æœåŠ¡å™¨å¯ä»¥è‡ªç”±è®¿é—®å¤–éƒ¨ç½‘ç»œï¼ˆæ¯”å¦‚ä¸‹è½½æ›´æ–°ã€è®¿é—® API ç­‰ï¼‰ã€‚\n\n#### 3.5.2. æ”¹SSHç«¯å£\n\n> **æ³¨æ„**ï¼šä¿ç•™ä¸€ä¸ªå·²ç»ç™»å½•çš„ SSH çª—å£ï¼Œå…ˆæµ‹è¯•æ–°ç«¯å£å¯ç”¨å†å…³é—­æ—§çª—å£ï¼Œé¿å…è‡ªå·±è¢«é”ã€‚\n\nä¸ä½¿ç”¨é»˜è®¤SSHç«¯å£ç™»å½•ï¼Œæé«˜å®‰å…¨æ€§ã€‚\n\n1. ç¼–è¾‘ SSH é…ç½®ï¼š\n\n```bash\nsudo nano /etc/ssh/sshd_config\n```\n\næ‰¾åˆ°ï¼š`#Port 22`\nä¿®æ”¹ä¸ºï¼š`Port your_ssh_port`\n\n>å»ºè®® SSH æ”¹åˆ° **1024 ä»¥ä¸Šï¼Œæœ€å¥½ 2000~65000 çš„èŒƒå›´**ï¼Œä¾‹å¦‚ 2222ã€22022ã€55222ã€‚\n\n2. é˜²ç«å¢™å…è®¸è¯¥ç«¯å£å¹¶å¯ç”¨é˜²ç«å¢™\n\n```bash\nsudo ufw allow your_ssh_port/tcp\nsudo ufw enable\n```\n\nè¿è¡Œ `sudo ufw status` å‘½ä»¤æ£€æŸ¥é˜²ç«å¢™è§„åˆ™ã€‚\nåº”è¯¥æ˜¾ç¤ºï¼š\n```\nTo                         Action      From\n--                         ------      ----\n22/tcp                     ALLOW       Anywhere\n80/tcp                     ALLOW       Anywhere\n443/tcp                    ALLOW       Anywhere\nyour_ssh_port/tcp          ALLOW       Anywhere\n22/tcp (v6)                ALLOW       Anywhere (v6)\n80/tcp (v6)                ALLOW       Anywhere (v6)\n443/tcp (v6)               ALLOW       Anywhere (v6)\nyour_ssh_port/tcp (v6)     ALLOW       Anywhere (v6)\n```\n\n3. é‡å¯ SSHï¼š\n`sudo systemctl restart ssh`\n\n4. æµ‹è¯•æ–°ç«¯å£ï¼š\n`ssh -p your_ssh_port root@SERVER_IP`\n\nå¦‚æœç¬¬å››æ­¥è®¿é—®è¢«æ‹’ç»ï¼Œåˆ«æ…Œï¼Œä½¿ç”¨å‘½ä»¤ï¼š\n```bash\nsudo sshd -T | grep port\n```\n\nå¦‚æœè¾“å‡ºçš„æ˜¯ä½ è®¾å®šçš„ç«¯å£å·ï¼Œ**ä¸”ufwä¸­å…è®¸äº†è®¾å®šç«¯å£**ï¼Œé‚£ä¹ˆå¯ä»¥å¿½ç•¥ä¿ç•™sshçª—å£çš„noteï¼Œç›´æ¥é‡å¯äº‘æœåŠ¡å™¨ï¼Œé‡æ–°ä»¥æ–°ç«¯å£å·ç™»å½•ï¼Œåº”è¯¥å¯ä»¥æˆåŠŸã€‚\n\n#### 3.5.3. å…³é—­22ç«¯å£\n\næˆåŠŸç™»å½•åï¼Œå¯ä»¥å…³é—­22ç«¯å£äº†\n\n```bash\nsudo ufw delete allow 22/tcp\nsudo ufw reload\nsudo ufw status\n```\n\n### 3.6. sshé…ç½®æ–‡ä»¶\n\nä¾æ—§ï¼š\n\n```bash\nsudo nano /etc/ssh/sshd_config\n```\n\n#### 3.6.1. ç¦ç”¨ rootè¿œç¨‹ç™»å½•&å¯†ç ç™»å½•\n\né…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š\n\n```\nPermitRootLogin no # ç¦ç”¨rootç™»å½•\nPasswordAuthentication no # ç¦ç”¨å¯†ç ç™»å½•\n```\n\nå¯¹äºç¬¬äºŒä¸ªé€‰é¡¹ï¼Œè¯·è‡ªè¡Œå†³å®šã€‚è‡³äºæš´åŠ›ç ´è§£ï¼Œç”¨Fail2banå·¥å…·å¯ä»¥é˜²æš´åŠ›ç ´è§£ã€‚\n\n| é…ç½®                         | ä¼˜åŠ¿          | é£é™©                      |\n| -------------------------- | ----------- | ----------------------- |\n| PasswordAuthentication yes | å¯ä»¥ç”¨å¯†ç ç™»å½•ï¼ˆçµæ´»ï¼‰ | å®¹æ˜“è¢«æš´åŠ›ç ´è§£ï¼Œå®‰å…¨æ€§ä½            |\n| PasswordAuthentication no  | å®‰å…¨æ€§é«˜ï¼Œé˜²æ­¢æš´åŠ›æ”»å‡» | å¦‚æœ SSH Key é…ç½®æœ‰é—®é¢˜ï¼Œå¯èƒ½ç™»å½•ä¸ä¸Š |\n\n#### 3.6.2. ä½¿ç”¨SSH2\n\n- `Protocol` æŒ‡å®š SSH ä½¿ç”¨çš„åè®®ç‰ˆæœ¬ï¼š\n    - **Protocol 1**ï¼šSSH-1ï¼Œå­˜åœ¨ä¸¥é‡å®‰å…¨æ¼æ´ï¼Œä¸å†æ¨è\n    - **Protocol 2**ï¼šSSH-2ï¼Œæ›´å®‰å…¨ï¼Œæ›´ç¨³å®š\n- ç°ä»£ Linux å‘è¡Œç‰ˆé»˜è®¤ä½¿ç”¨ **Protocol 2**ï¼Œä½†æœ€å¥½ç¡®è®¤é…ç½®æ–‡ä»¶é‡Œæ˜ç¡®æŒ‡å®šã€‚\n\nåœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹æˆ–åœ¨é€‚å½“ä½ç½®æ·»åŠ ï¼š\n```\nProtocol 2\n```\n\n#### 3.6.3. é‡å¯ssh\n\n```bash\nsudo systemctl restart ssh\n```\n\n### 3.7. Fail2banå·¥å…·é˜²æš´åŠ›ç ´è§£\n\nè¯¥å·¥å…·å¯ä»¥è‡ªåŠ¨å°ç¦æš´åŠ›ç ´è§£ IPã€‚\n\n```bash\nsudo apt install fail2ban\nsudo systemctl enable fail2ban\nsudo systemctl start fail2ban\n```\n\n#### 3.7.1. é…ç½®fail2ban\n\n```\nsudo nano /etc/fail2ban/jail.local\n# æ·»åŠ ï¼š\n[sshd]\nenabled = true\nmaxretry = 5\nfindtime = 86400\nbantime = 86400\n```\n\n- **enabled** â†’ æ˜¯å¦å¯ç”¨è¯¥ jail\n- **port** â†’ SSH æœåŠ¡ç«¯å£ï¼ˆå¯ç”¨é€—å·æŒ‡å®šå¤šä¸ªç«¯å£ï¼Œå¦‚ 22,2222ï¼‰\n- **maxretry** â†’ è¶…è¿‡å¤šå°‘æ¬¡å¤±è´¥è¢« ban\n- **bantime** â†’ å°ç¦æŒç»­æ—¶é—´ï¼Œå¯æ”¹ä¸º `-1` æ°¸ä¹…å°ç¦\n- **findtime** â†’ åœ¨findtimeæ—¶é—´å†…è¾“å…¥maxretryæ¬¡é”™è¯¯å¯†ç å³è¢«å°ç¦ã€‚\n\n#### 3.7.2. æŸ¥çœ‹çŠ¶æ€\n\n```bash\nsudo fail2ban-client status\n```\n\n```\nStatus for the jail: sshd\n|- Filter\n|  |- Currently failed: 3\n|  |- Total failed: 15\n|  `- File list: /var/log/auth.log\n`- Actions\n   |- Currently banned: 1\n   |- Total banned: 5\n   `- Banned IP list: 123.45.67.89\n```\n\n- `Banned IP list` â†’ è¢«å°ç¦çš„ IP\n- `Currently banned` â†’ å½“å‰å°ç¦æ•°é‡\n#### 3.7.3. è§£å°ip\n\nå¦‚æœè‡ªå·±è¢« banï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è§£å°ï¼ˆå‡è®¾ä½ çš„ IP æ˜¯ `1.2.3.4`ï¼‰ï¼š\n\n```bash\nsudo fail2ban-client set sshd unbanip 1.2.3.4\n```\nè§£å°åä½ å¯ä»¥æ­£å¸¸ SSH ç™»å½•ã€‚\n\n#### 3.7.4. å¯ç”¨fail2ban\n\n```bash\nsudo systemctl enable --now fail2ban\n```\n#### 3.7.5. å°è´´å£«\n1. **æ”¹è§„åˆ™å‰ä¿æŒä¸€ä¸ªæ´»åŠ¨ SSH ä¼šè¯**ï¼Œæµ‹è¯•æ–°è§„åˆ™ç”Ÿæ•ˆå†é€€å‡º\n2. **å…ˆå°èŒƒå›´æµ‹è¯•**ï¼šä¾‹å¦‚ `maxretry = 3, bantime = 60`ï¼Œç¡®è®¤ä¸ä¼šè¯¯é”è‡ªå·±\n3. **å®šæœŸæ£€æŸ¥**ï¼š\n```bash\nsudo fail2ban-client status sshd\nsudo fail2ban-client status\n```\n\n\n> åšå®Œä¸Šé¢éƒ¨åˆ†åï¼Œåœ¨äº‘æœåŠ¡å™¨åå°åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰é•œåƒï¼Œå¤‡ä»½ä¸€ä¸‹ï¼Œæ–¹ä¾¿æ—¥åå¿«é€Ÿæ¢å¤ã€‚\n\n## 4. ç³»ç»Ÿç»´æŠ¤éƒ¨åˆ†\n\n### 4.1. ~~ä½¿ç”¨expkg~~\n\n## 5. ç³»ç»Ÿè¿è¡Œéƒ¨åˆ†","tags":["VPS"],"categories":["VPS"]},{"title":"å“ˆå¸Œè¡¨ä¸è®¾å¤‡å·","url":"/posts/7167/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n## 1. å“ˆå¸Œè¡¨çš„é€šä¿—ç†è§£\n\næˆ‘ä»¬çŸ¥é“ï¼Œçº¿æ€§é“¾è¡¨çµæ´»æ€§é«˜ï¼Œæ‰©å±•æ€§å¼ºï¼Œä½†æ˜¯æŸ¥æ‰¾æ•ˆç‡ä½ï¼›è€Œæ•°ç»„è™½ç„¶æŸ¥æ‰¾æ•ˆç‡é«˜ï¼Œä½†æ˜¯æ‰©å±•æ€§ï¼Œçµæ´»æ€§éƒ½ä¸é«˜ã€‚å“ˆå¸Œè¡¨åˆ™å·§å¦™çš„ç»“åˆäº†è¿™ä¸¤ç§æ•°æ®ç»“æ„çš„ä¼˜ç‚¹ï¼Œä¸ä»…æ’å…¥ã€åˆ é™¤æ•°æ®é«˜æ•ˆï¼ŒåŒæ—¶æŸ¥æ‰¾æ•ˆç‡ä¹Ÿé«˜ï¼Œä½†æ˜¯å†…å­˜å ç”¨ä¹Ÿé«˜ï¼Œç›¸å½“äºç”¨ç©ºé—´æ¢æ—¶é—´ã€‚\n\n### 1.1. ç±»æ¯”ï¼šå¿«é€’ä»“åº“\n\næƒ³è±¡ä½ åœ¨ä¸€ä¸ªå¿«é€’ä»“åº“å·¥ä½œï¼Œ\n- è¿™ä¸ªä»“åº“æœ‰100ä¸ªè´§æ¶ï¼ˆ0~99ï¼‰ã€‚\n- æ¯ä¸ªå¿«é€’éƒ½æœ‰ä¸€ä¸ªå¿«é€’åã€‚\n- æœ‰ä¸€ä¸ªhashç‰Œçš„ç¼–ç å™¨ï¼Œä¸“é—¨æŠŠè¿™äº›å¿«é€’åç¼–ç æˆ0~99çš„æ•°å­—ï¼Œä½ æ ¹æ®è¿™äº›æ•°å­—æŠŠå¿«é€’æ”¾åœ¨ç›¸åº”çš„è´§æ¶ã€‚\n\n Like thisï¼š\n\n| å¿«é€’å   | ç¼–ç ç»“æœï¼ˆè´§æ¶å·ï¼‰                | æ”¾åˆ°å“ªä¸ªæ¶å­ |\n| ----- | ------------------------ | ------ |\n| Alice | hash(\"Alice\") % 100 = 37 | 37å·æ¶   |\n| Bob   | hash(\"Bob\") % 100 = 12   | 12å·æ¶   |\n| Carol | hash(\"Carol\") % 100 = 37 | 37å·æ¶   |\n\nWTFï¼ŸAlice å’Œ Carol éƒ½è¢«åˆ†åˆ°äº†37å·æ¶ï¼Œæ€ä¹ˆåŠï¼Ÿ\n\nèªæ˜çš„ä½ åœ¨37å·æ¶ä¸Šæ”¾ä¸€ä¸ªâ€œå°ç¯®å­â€ï¼ŒæŠŠæ‰€æœ‰æ’åˆ°è¿™é‡Œçš„å¿«é€’éƒ½æ”¾ä¸€èµ·ã€‚\næŸ¥æ‰¾æ—¶ï¼Œåªéœ€è¦åœ¨ç¯®å­é‡Œç¿»å‡ ä¸‹ã€‚\n\n### 1.2. ç†è§£ï¼šå“ˆå¸Œè¡¨çš„åŸç†\n- hashè¡¨å°±æ˜¯è¿™ä¸ªè´§æ¶ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œé“¾è¡¨æ•°ç»„â€ã€‚\n\n```c\n#define TABLE_SIZE 10\nstruct hash_node *table[TABLE_SIZE];  // æ•°ç»„ï¼Œæ¯ä¸ªæ§½ä½ä¸€ä¸ªæŒ‡é’ˆï¼Œåˆå§‹å…¨ä¸ºNULL\n```\n\n- æ•´ä¸ªå¿«é€’åŒ…è£¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä½œä¸€ä¸ªç»“æ„ä½“ã€‚ç»“æ„ä½“æˆå‘˜â€œå¿«é€’åâ€å³ä¸ºâ€œé”®â€ï¼Œå®ƒä»¬ç”¨æ¥ç´¢å¼•å¯¹åº”çš„å¿«é€’ï¼›å½“ç„¶ï¼Œç»“æ„ä½“æˆå‘˜â€å¿«é€’é‡Œè£…çš„ç‰©å“â€œå°±æ˜¯â€œå€¼â€ã€‚\n\n```c\nstruct hash_node {\n    char *key;                // é”®\n    char *value;              // å€¼\n    struct hash_node *next;   // æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ\n};\n```\n\n- ç¼–ç å™¨å‘¢ï¼Œå°±æ˜¯æ‰€è°“çš„å“ˆå¸Œå‡½æ•°ï¼Œå®ƒä¼šè®¡ç®—å‡ºä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºå°†â€œé”®â€ æ˜ å°„åˆ°æ•°ç»„ï¼ˆå“ˆå¸Œè¡¨ï¼‰çš„æŸä¸€ä¸ªæ§½ä½ä¸­ï¼Œä¹Ÿå°±æ˜¯æŸä¸ªå†…å­˜å—å•¦ã€‚\n\n- ä¸€æ§½ä¸å®¹ä¸¤é”®ï¼Ÿnononoï¼è¢«ä¼Ÿå¤§çš„hashç¥åˆ†é…åœ¨åŒä¸€æ§½çš„é”®å€¼ä¼šå½¢æˆé“¾è¡¨å•¦~\n\n```c\nvoid insert(char *key, char *value)\n{\n    int index = hash(key) % TABLE_SIZE;  // è®¡ç®—æ§½ä½\n    struct hash_node *new_node = malloc(sizeof(struct hash_node));\n    new_node->key = strdup(key);\n    new_node->value = strdup(value);\n\n    // å°†æ–°èŠ‚ç‚¹æ’å…¥åˆ°é“¾è¡¨å¤´éƒ¨\n    new_node->next = table[index];   // æŒ‡å‘åŸæ¥çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹\n    table[index] = new_node;         // æ•°ç»„è¯¥æ§½ä½ç°åœ¨æŒ‡å‘æ–°èŠ‚ç‚¹\n}\n```\n\næ›´ç›´è§‚ä¸€ç‚¹\n```\n[æ§½ä½2ï¼šé“¾è¡¨é¦–åœ°å€]---------[æ§½ä½3ï¼šé“¾è¡¨é¦–åœ°å€]---------[æ§½ä½4ï¼šç©º]---------\n\t| -> æœ€æ–°æ·»åŠ çš„èŠ‚ç‚¹         | -> èŠ‚ç‚¹\n\t| -> åç»­æ·»åŠ çš„\n\t| -> é¦–æ¬¡æ’å…¥çš„èŠ‚ç‚¹\n```\n\nä¸Šæ–‡æä¾›çš„é“¾è¡¨æ’å…¥æ–¹æ³•æ˜¯é¦–æ’æ³•ï¼Œé“¾è¡¨é¦–åœ°å€ç”±æœ€æ–°æ·»åŠ çš„èŠ‚ç‚¹åœ°å€å‘ˆç°ã€‚\n\n## 2. å“ˆå¸Œè¡¨åœ¨linuxä¸­çš„åº”ç”¨\n\nåœ¨ Linux é‡Œï¼Œæ¯ä¸ªè®¾å¤‡ï¼ˆæ¯”å¦‚ `/dev/sda`, `/dev/ttyS0`ï¼‰éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼š\n**è®¾å¤‡å· = ä¸»å· + æ¬¡å·**ã€‚\nä½ å¯ä»¥ç†è§£ä¸ºï¼š\n- ä¸»å·ï¼šè®¾å¤‡ç±»åˆ«ï¼ˆæ¯”å¦‚â€œç¡¬ç›˜ç±»â€ã€â€œä¸²å£ç±»â€ï¼‰\n- æ¬¡å·ï¼šåŒç±»ä¸­çš„ç¼–å·ï¼ˆç¬¬1ä¸ªã€ç¬¬2ä¸ªï¼‰\n\nè®¾å¤‡å·ç±»å‹å®šä¹‰ï¼š\n```c\ntypedef unsigned long long dev_t;\n```\n\nä¸»æ¬¡è®¾å¤‡å·å¯ä»¥é€šè¿‡ä»¥ä¸‹å®æ“ä½œï¼š\n```c\nMAJOR(dev_t dev); // è·å–ä¸»è®¾å¤‡å·\nMINOR(dev_t dev); // è·å–æ¬¡è®¾å¤‡å·\nMKDEV(int major, int minor); // ç»„åˆæˆä¸€ä¸ªdev_t\n```\n\n- å·²æ³¨å†Œçš„è®¾å¤‡å·å¯ä»¥ä½¿ç”¨`cat /proc/devices`æŸ¥çœ‹\n- å†…æ ¸æ˜¯å¸Œæœ›ä¸€ä¸ªè®¾å¤‡é©±åŠ¨(file_operation)å¯ä»¥ç‹¬è‡ªå æœ‰ä¸€ä¸ªä¸»è®¾å¤‡å·å’Œå¤šä¸ªæ¬¡è®¾å¤‡å·ï¼Œè€Œé€šå¸¸ä¸€ä¸ªè®¾å¤‡æ–‡ä»¶ç»‘å®šä¸€ä¸ªä¸»è®¾å¤‡å·å’Œä¸€ä¸ªæ¬¡è®¾å¤‡å·ï¼Œæ‰€ä»¥è®¾å¤‡é©±åŠ¨ä¸è®¾å¤‡æ–‡ä»¶æ˜¯ä¸€å¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šçš„å…³ç³»ã€‚\n\n\nå†…æ ¸å°±åƒä¸€ä¸ªå¤§ä»“åº“ï¼Œå­˜ç€æˆåƒä¸Šä¸‡ä¸ªè®¾å¤‡ã€‚\nç³»ç»Ÿè¦æ ¹æ®è®¾å¤‡å·ï¼Œ**å¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„è®¾å¤‡ç»“æ„ä½“**ï¼ˆé‡Œé¢ä¿å­˜æ“ä½œå‡½æ•°ã€çŠ¶æ€ç­‰ä¿¡æ¯ï¼‰ã€‚\n\näºæ˜¯å®ƒç”¨å“ˆå¸Œè¡¨æ¥å®ç°ï¼š\næŠŠè®¾å¤‡å·ç®—ä¸€ç®— â†’ å¾—å‡ºâ€œè´§æ¶å·â€ â†’ ç›´æ¥æ‰¾åˆ°è®¾å¤‡å¯¹åº”çš„ä¿¡æ¯ç»“æ„ã€‚\n\n","tags":["Linux","å“ˆå¸Œè¡¨","è®¾å¤‡å·","æ•°æ®ç»“æ„"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"Linuxæ–‡ä»¶æ“ä½œè°ƒç”¨é“¾æ¢ç©¶","url":"/posts/31088/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\nç†è§£å®Œæ•´è°ƒç”¨é“¾ç›¸å½“äºæ‰“é€š Linux å†…æ ¸çš„â€œä¸»ç»è„‰â€ï¼Œä¹‹åå†çœ‹å­—ç¬¦è®¾å¤‡ã€å—è®¾å¤‡ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œè®¾å¤‡â€”â€”éƒ½ä¼šå˜å¾—æ¸…æ™°è®¸å¤šã€‚\n\n> æ–‡ä¸­æåˆ°çš„æ–¹æ³•è¡¨æ˜¯æˆ‘è‡ªå·±ç”¨çš„å«æ³•ï¼Œæ›´é€šç”¨çš„å¥½åƒå«æ–‡ä»¶æ“ä½œå‡½æ•°é›†/é©±åŠ¨å‡½æ•°é›†ã€‚\n\n## åˆ›å»ºè®¾å¤‡æ–‡ä»¶ï¼šä»¥å­—ç¬¦è®¾å¤‡ä¸ºä¾‹\n\n### æ³¨å†Œè®¾å¤‡å·\n\né©±åŠ¨ä¸­é¦–å…ˆè¦æ³¨å†Œè®¾å¤‡å·ï¼ˆä¸»è®¾å¤‡å· + æ¬¡è®¾å¤‡å·ï¼‰ï¼š\n```c\n#include <linux/fs.h>\ndev_t dev_num; // è®¾å¤‡å·\n// åŠ¨æ€åˆ†é…è®¾å¤‡å·\nalloc_chrdev_region(&dev_num, 0, 1, \"mychardev\");\n// æˆ–è€…é™æ€åˆ†é…\n// register_chrdev_region(MKDEV(240, 0), 1, \"mychardev\");\n```\n\nç›¸å½“äºä½ å»åŒ»é™¢çœ‹ç—…ï¼Œå…ˆæŒ‚å·ã€‚\n\n### åˆå§‹åŒ–å¹¶æ³¨å†Œcdevç»“æ„\n\nä½ ç”³è¯·äº†ä¸€ä¸ªå­—ç¬¦è®¾å¤‡æè¿°å¯¹è±¡ï¼Œè¯¥ç»“æ„ä½“çš„åŸå‹ä¸ºï¼š\n```c\nstruct cdev {\n    struct kobject kobj;               // ä¾› sysfs ä½¿ç”¨\n    struct module *owner;              // æ¨¡å—æ‰€å±\n    const struct file_operations *ops; // ä½ çš„é©±åŠ¨å‡½æ•°é›†åˆ\n    dev_t dev;                         // è®¾å¤‡å· (ä¸»+æ¬¡)\n    unsigned int count;                // ç®¡ç†çš„æ¬¡è®¾å¤‡æ•°é‡\n};\n```\n\nè®°å½•äº†ï¼š\n- æˆ‘æ˜¯è°ï¼ˆdev_t è®¾å¤‡å·ï¼‰\n- æˆ‘è¦è°ƒç”¨å“ªç»„å‡½æ•°ï¼ˆfile_operationsï¼‰    \n- æˆ‘å±äºå“ªä¸ªæ¨¡å—ï¼ˆownerï¼‰\n\nè¿™äº›éƒ½æ˜¯éœ€è¦å¡«å……çš„ï¼ˆç”¨åé¢çš„ä¸¤ä¸ªå‡½æ•°ï¼‰ã€‚**æ³¨æ„ä½ åªéœ€è¦ç”³è¯·å³å¯ã€‚**\n\nç„¶åä½ å°†è‡ªå·±çš„è‡ªå®šä¹‰é©±åŠ¨å‡½æ•°æ³¨å†Œåˆ°äº†file_operationç»“æ„ä½“ï¼Œè¿™ä¸ªä½ è¦è‡ªå·±å¡«å……ï¼š\n```c\nstatic const struct file_operations my_fops = {\n    .owner = THIS_MODULE,\n    .open  = my_open,\n    .read  = my_read,\n    .write = my_write,\n    .release = my_release,\n};\n```\n\nå¹¶å°†è¿™ä¸ªæ–¹æ³•è¡¨æ³¨å†Œåˆ°äº†å…¨å±€è¡¨ï¼š\n```c\ncdev_init(&my_cdev, &my_fops); //åˆå§‹åŒ–å­—ç¬¦è®¾å¤‡æè¿°å¯¹è±¡ï¼Œç»‘å®šæ–¹æ³•è¡¨\n//å°†è¯¥å¯¹è±¡æ³¨å†Œè¿›è¡¨ï¼Œå‘Šè¯‰å†…æ ¸ï¼šâ€œä»è®¾å¤‡å· dev å¼€å§‹çš„ count ä¸ªæ¬¡è®¾å¤‡ï¼Œç”±è¿™ä¸ª cdev é©±åŠ¨è´Ÿè´£ã€‚â€\ncdev_add(&my_cdev, dev_num, ã€æ¬¡è®¾å¤‡å·æ•°é‡ã€‘);\n```\n\nè¿™ä¸¤ä¸ªå‡½æ•°ä¼šå°†ä½ çš„cdevç»“æ„ä½“å¡«å¥½ï¼Œçœ‹å‡½æ•°çš„å®šä¹‰å°±æ˜ç™½äº†ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š\n```c\nvoid cdev_init(struct cdev *cdev, const struct file_operations *fops)\n{\n    memset(cdev, 0, sizeof(*cdev));\n    INIT_LIST_HEAD(&cdev->list);\n    kobject_init(&cdev->kobj, &ktype_cdev_dynamic);\n    cdev->ops = fops;\n}\n\nint cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n    p->dev = dev;\n    p->count = count;\n    kobject_add(&p->kobj, NULL, \"%s\", \"char_dev\");\n\n    // æŠŠè®¾å¤‡ç™»è®°åˆ°å…¨å±€å­—ç¬¦è®¾å¤‡è¡¨\n    return cdev_map_add(p);\n}\n```\n\nè¿™ä¸€æ­¥å°±æ˜¯ä½ è¢«å«åˆ°å·ï¼Œå»æè¿°ä½ çš„ç—…æƒ…ï¼Œå¡«å……ä½ çš„ç—…å†ã€‚\n\n## æ–‡ä»¶æ“ä½œè°ƒç”¨é“¾\n### ç”¨æˆ·ç©ºé—´å±‚\n\nå½“æˆ‘ä»¬ä½¿ç”¨openå‡½æ•°æ—¶ï¼Œ\n\n```c\nint fd = open(\"/dev/led\", O_RDWR);\n```\n\n- å®é™…ä¸Šè¿™ä¸æ˜¯ç›´æ¥è¿›å…¥å†…æ ¸çš„å‡½æ•°ï¼Œè€Œæ˜¯ glibc å¯¹ç³»ç»Ÿè°ƒç”¨çš„å°è£…ã€‚\n- å®ƒæœ€ç»ˆä¼šæ‰§è¡Œä¸€æ¡æ±‡ç¼–æŒ‡ä»¤ï¼ˆx86 ä¸‹æ˜¯ `syscall`ï¼ŒARM ä¸‹æ˜¯ `svc #0`ï¼‰  \n    è§¦å‘**è½¯ä¸­æ–­**ï¼Œé™·å…¥å†…æ ¸æ€ã€‚\næ­¤æ—¶ CPU ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œè¿›å…¥ç³»ç»Ÿè°ƒç”¨è¡¨ã€‚\n\n### å†…æ ¸ç³»ç»Ÿè°ƒç”¨\n\nLinux å†…æ ¸åœ¨ `fs/open.c` ä¸­å®šä¹‰ï¼š\n\n```c\nSYSCALL_DEFINE3(open, const char __user *filename, int flags, umode_t mode)\n{\n    return do_sys_open(AT_FDCWD, filename, flags, mode);\n}\n```\n\n- `SYSCALL_DEFINE3` æ˜¯ä¸€ä¸ªå®ï¼Œå®šä¹‰äº†ç³»ç»Ÿè°ƒç”¨çš„å…¥å£ã€‚\n- å‚æ•°ä»ç”¨æˆ·ç©ºé—´å¤åˆ¶è¿›å†…æ ¸ï¼ˆä½¿ç”¨ `copy_from_user()`ï¼‰ã€‚\n\n> æ‰€ä»¥å†…æ ¸åšçš„äº‹å°±æ˜¯å‘¼å«Virtual File Systemå±‚ï¼Œè®©VFSå±‚è¿™ä¸ªä¸“å®¶æ¥å¤„ç†æ–‡ä»¶ã€‚\n\n### VFSå±‚\n\n> VFSï¼ˆVirtual File Systemï¼‰æ˜¯ Linux æ–‡ä»¶ç³»ç»ŸæŠ½è±¡å±‚ï¼Œ\n   è®©æ‰€æœ‰â€œæ–‡ä»¶â€çœ‹èµ·æ¥ä¸€è‡´ï¼Œä¸ç®¡æ˜¯ ext4ã€procfs è¿˜æ˜¯å­—ç¬¦è®¾å¤‡ã€‚\n\nå…³é”®ä»»åŠ¡ï¼š\n1. **è§£æè·¯å¾„ `/dev/led`**ï¼šé€šè¿‡ `namei()` æŸ¥æ‰¾ inodeã€‚\n2. **åˆ›å»º file ç»“æ„ä½“**ï¼š`struct file` è¡¨ç¤ºä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ã€‚\n3. **æ‰¾åˆ° inode å¯¹åº”çš„ file_operations**ï¼šé¦–å…ˆVFSä¼šåˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼ˆinode->i_modeï¼‰ï¼Œæ€ä¹ˆæ‰¾ï¼Œä¸åŒæ–‡ä»¶ç³»ç»Ÿã€è®¾å¤‡ç±»å‹æ‰¾çš„æ–¹æ³•ä¸åŒï¼Œæ„Ÿè§‰æ¯ä¸ªç±»å‹è®¾å¤‡éƒ½å¯ä»¥å•å¼€ä¸€ç¯‡ä»‹ç»äº†....å› ä¸ºæœ¬æ–‡æ˜¯äº†è§£å¤§ä½“æ¡†æ¶æ‰€ä»¥è¿™é‡Œå…ˆç•¥è¿‡äº†...æ‰¾åˆ°çš„æ–¹æ³•è¡¨åœ°å€è¿™é‡Œæˆ‘ä»¬ç”¨`f_op`è¡¨ç¤ºã€‚ \n4. **è°ƒç”¨å¯¹åº”çš„ open å›è°ƒ**ï¼š`f_op->open(inode, file)`ã€‚è¿™é‡Œå°±æ˜¯è°ƒç”¨é©±åŠ¨å‡½æ•°äº†ï¼Œä½ è‡ªå·±å¼€å‘çš„é©±åŠ¨å‡½æ•°ï¼Œå¥½è€¶ï¼\n\nåç»­è¡¥å……ï¼š\n> 1. inodeæ˜¯ç´¢å¼•èŠ‚ç‚¹ï¼Œç›¸å½“äºæ–‡ä»¶çš„èº«ä»½è¯ï¼Œè®°å½•äº†æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶ç±»å‹ã€æƒé™ã€æ‰€æœ‰è€…ç­‰....\n> 2. åˆ›å»ºfileç»“æ„ä½“å°±ç›¸å½“äºåœ¨è¿›ç¨‹ä¸­å®ä¾‹åŒ–äº†ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œå°±æ˜¯ä½ æ‰“å¼€çš„æ–‡ä»¶å¯¹è±¡ã€‚éœ€è¦çŸ¥é“çš„æ˜¯è¿™ä¸ªç»“æ„ä½“é‡Œé¢åŒ…å«äº†è¿™ä¸ªæ–‡ä»¶å¯¹è±¡çš„å±æ€§ï¼ŒåŒ…æ‹¬è¯¥å¯¹è±¡çš„**æ–¹æ³•è¡¨**çš„åœ°å€f_opã€‚\n> 3. æ€ä¹ˆæ‰¾ç¤ºä¾‹ï¼šä¾‹å¦‚å­—ç¬¦è®¾å¤‡ï¼ŒVFSé€šè¿‡inodeæŸ¥è¯¢è¯¥è®¾å¤‡ä¸ºå­—ç¬¦è®¾å¤‡ï¼ŒVFSé€šè¿‡inodeæå–è®¾å¤‡å·ï¼Œä»¥è®¾å¤‡å·ä¸ºç´¢å¼•ï¼Œè°ƒç”¨å‡½æ•°æŸ¥æ‰¾å“ˆå¸Œè¡¨`chrdevs[]`â€”â€”è¿™ç›¸å½“äºæ˜¯è®¾å¤‡<->f_opsæ˜ å°„è¡¨ï¼Œæ‰¾åˆ°å…¶ä¸­å¯¹åº”çš„cdevç»“æ„ä½“ï¼ˆå­—ç¬¦è®¾å¤‡å¯¹è±¡ï¼‰ï¼Œç„¶åè®¾ç½®`file->f_op = cdev->ops;` \n\nåŒæ—¶æˆ‘ä»¬ä¸è¦æ··æ·†inodeå’Œfileç»“æ„ä½“ï¼š\n\n|å¯¹è±¡|ä»£è¡¨ä»€ä¹ˆ|ç”Ÿå‘½å‘¨æœŸ|å…±äº«æ€§|\n|---|---|---|---|\n|**inode**|æ–‡ä»¶è‡ªèº«ï¼ˆå­˜æ”¾åœ¨ç£ç›˜ä¸Šï¼‰|æ–‡ä»¶å­˜åœ¨æœŸé—´|æ‰€æœ‰æ‰“å¼€è€…å…±äº«åŒä¸€ä¸ª inode|\n|**file**|ä¸€æ¬¡æ‰“å¼€æ“ä½œçš„å®ä¾‹|ä» open åˆ° close|æ¯ä¸ªæ‰“å¼€è€…ç‹¬ç«‹ä¸€ä»½|\n\n### è®¾å¤‡é©±åŠ¨å±‚\n\nç„¶åä½ çš„å±å±±ä»£ç å°±è¦å¼€å§‹å‘åŠ›äº†ï¼\n\n```c\nif (file->f_op && file->f_op->open)\n    file->f_op->open(inode, file);\n```\n\næ­¤æ—¶å°±è¿›å…¥äº†é©±åŠ¨ä¸­ä½ è‡ªå·±å†™çš„\n\n```c\nstatic int led_open(struct inode *inode, struct file *file)\n{\n    // åˆå§‹åŒ–ç¡¬ä»¶ã€è®¾ç½®çŠ¶æ€ç­‰\n    return 0;\n}\n```\n\nä¹‹åï¼Œç”¨æˆ·æ‰§è¡Œï¼š\n\n```c\nwrite(fd, buf, len);\nread(fd, buf, len);\n```\n\nä¹Ÿéƒ½ä¼šèµ°ï¼š\n```c\nsys_write() â†’ vfs_write() â†’ file->f_op->write()\nsys_read()  â†’ vfs_read()  â†’ file->f_op->read()\n```\n\n","tags":["Linux","è°ƒç”¨é“¾"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"å¤§èŸ’è›‡-sys/argparseåº“","url":"/posts/22025/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n# sysåº“\n\n`sys`Â æ˜¯ Python æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œæä¾›äº†ä¸ Python è§£é‡Šå™¨åŠå…¶ç¯å¢ƒäº¤äº’çš„åŠŸèƒ½ã€‚\né€šè¿‡Â `sys`Â åº“ï¼Œä½ å¯ä»¥è®¿é—®ä¸ Python è§£é‡Šå™¨ç›¸å…³çš„å˜é‡å’Œå‡½æ•°ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œå‚æ•°ã€æ ‡å‡†è¾“å…¥è¾“å‡ºã€ç¨‹åºé€€å‡ºç­‰ã€‚å‘½ä»¤è¡Œå‚æ•°éƒ¨åˆ†å¯ç”¨`argparse`åº“æ›¿ä»£ã€‚\n\n## sys.argv\næè¿°ï¼šå‘½ä»¤è¡Œå‚æ•°çš„åˆ—è¡¨ã€‚`sys.argv[0]`Â æ˜¯è„šæœ¬çš„åç§°ï¼Œåç»­å…ƒç´ æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°ã€‚\nè¯­æ³•ï¼š`sys.argv[]`\nç¤ºä¾‹ï¼š\n```python\nimportÂ sys  \n  \nprint(\"è„šæœ¬åç§°:\",Â sys.argv[0])  \nprint(\"å‚æ•°åˆ—è¡¨:\",Â sys.argv[1:])\n```\n\n## sys.exit\næè¿°ï¼šç”¨äºé€€å‡ºç¨‹åºã€‚ä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªæ•´æ•°ä½œä¸ºé€€å‡ºçŠ¶æ€ç ï¼Œé€šå¸¸Â `0`Â è¡¨ç¤ºæˆåŠŸï¼Œéé›¶å€¼è¡¨ç¤ºé”™è¯¯ã€‚\nè¯­æ³•ï¼š`sys.exit(numï¼‰`\nç¤ºä¾‹ï¼š\n```python\nimport sys\n\nprint(\"ç¨‹åºå¼€å§‹\")\nsys.exit(0)\nprint(\"è¿™è¡Œä»£ç ä¸ä¼šæ‰§è¡Œ\")\n```\n\n## sys.stdin/stdout/stderr\næè¿°ï¼š`sys.stdin`ã€`sys.stdout`Â å’ŒÂ `sys.stderr`Â åˆ†åˆ«ä»£è¡¨æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯æµã€‚ä½ å¯ä»¥é‡å®šå‘è¿™äº›æµä»¥å®ç°è‡ªå®šä¹‰çš„è¾“å…¥è¾“å‡ºè¡Œä¸ºã€‚\nè¯­æ³•ï¼š`sys.stderr.write(\"err\")`\nç¤ºä¾‹ï¼š\n```python\nimport sys\n\n# é‡å®šå‘æ ‡å‡†è¾“å‡ºåˆ°æ–‡ä»¶\nwith open('output.txt', 'w') as f:\n    sys.stdout = f\n    print(\"è¿™è¡Œå†…å®¹å°†å†™å…¥ output.txt\")\n\n# æ¢å¤æ ‡å‡†è¾“å‡º\nsys.stdout = sys.__stdout__\nprint(\"è¿™è¡Œå†…å®¹å°†æ˜¾ç¤ºåœ¨æ§åˆ¶å°\")\n```\n\n## sys.version/version_info\næè¿°ï¼šæä¾›äº†å½“å‰ Python è§£é‡Šå™¨çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚\nè¯­æ³•ï¼š`sys.version`\nç¤ºä¾‹ï¼š\n```python\nimport sys\n\nprint(\"Python ç‰ˆæœ¬:\", sys.version)\nprint(\"ç‰ˆæœ¬ä¿¡æ¯:\", sys.version_info)\n```\n\n## sys.path\næè¿°ï¼šåˆ—è¡¨ï¼ŒåŒ…å«äº† Python è§£é‡Šå™¨åœ¨å¯¼å…¥æ¨¡å—æ—¶æœç´¢çš„è·¯å¾„ã€‚å¯ä»¥ä¿®æ”¹è¿™ä¸ªåˆ—è¡¨æ¥æ·»åŠ è‡ªå®šä¹‰çš„æ¨¡å—æœç´¢è·¯å¾„ã€‚\nç¤ºä¾‹ï¼š\n```python\nimport sys\n\nprint(\"æ¨¡å—æœç´¢è·¯å¾„:\", sys.path)\nsys.path.append('/custom/path')\nprint(\"æ›´æ–°åçš„æ¨¡å—æœç´¢è·¯å¾„:\", sys.path)\n```\n\n## å…¶ä»–\n\n| å±æ€§               | è¯´æ˜                                           |\n| ---------------- | -------------------------------------------- |\n| `sys.modules`    | å·²åŠ è½½æ¨¡å—çš„å­—å…¸                                     |\n| `sys.platform`   | æ“ä½œç³»ç»Ÿå¹³å°æ ‡è¯†ï¼ˆå¦‚Â `'win32'`,Â `'linux'`,Â `'darwin'`ï¼‰ |\n| `sys.executable` | Python è§£é‡Šå™¨çš„ç»å¯¹è·¯å¾„                              |\n| `sys.byteorder`  | å­—èŠ‚åºï¼ˆ`'little'`Â æˆ–Â `'big'`ï¼‰                    |\n| `sys.maxsize`    | æœ€å¤§æ•´æ•°å€¼ï¼ˆ`2**31-1`Â æˆ–Â `2**63-1`ï¼‰                 |\n\n# argparseråº“\n\n## ArgumentParser\næè¿°ï¼šç”¨äºåˆ›å»ºè§£æå‘½ä»¤è¡Œå‚æ•°çš„å¯¹è±¡ã€‚\nè¯­æ³•ï¼š\n```python\nargparse.ArgumentParser(prog=None, usage=None, description=None, epilog=None, parents=[], formatter_class=<class 'argparse.HelpFormatter'>, prefix_chars='-', fromfile_prefix_chars=None, argument_default=None, conflict_handler='error', add_help=True)\n```\nç¤ºä¾‹ï¼š\n```python\nimport argparse\nparser = argparse.ArgumentParser(description=\"Example parser\")\n```\n\n## add_argumentâ€”â€”é‡ç‚¹\næè¿°ï¼šå‘ArgumentParserå¯¹è±¡æ·»åŠ å‘½ä»¤è¡Œå‚æ•°ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.add_argument(name or flags..., action='store', nargs=None, const=None, default=None, type=None, choices=None, required=False, help=None, metavar=None)\n```\nç¤ºä¾‹ï¼š\n```python\nparser.add_argument('--verbose', action='store_true', help='Increase output verbosity')\n```\n\nè¡¥å……ï¼š\n\n| é”®        | æ¥å—çš„å€¼                         | ä½œç”¨                          | ä¸¾ä¾‹                  |\n| -------- | ---------------------------- | --------------------------- | ------------------- |\n| name     | å­—ç¬¦ä¸²                          | å˜é‡çš„åå­—                       | â€˜radiusâ€™            |\n| nargs    | æ•°å­—æˆ–â€™?â€˜æˆ–â€™â€˜æˆ–â€™+â€™                | ç”¨æ¥è¯´æ˜ä¼ å…¥çš„å‚æ•°ä¸ªæ•°ï¼ˆç¬¦å·æ„ä¹‰å’Œæ­£åˆ™è¡¨è¾¾å¼é‡Œçš„ä¸€è‡´) | nargs=â€™?â€™ nargs=2   |\n| type     | list, str, tuple, set, dictç­‰ | è®¾ç½®è¯»å–å‚æ•°çš„ç±»å‹                   | type=int            |\n| default  | ç±»å‹è·Ÿtypeç»Ÿä¸€                    | è®¾ç½®é»˜è®¤å€¼                       | default=1           |\n| choices  | è£…é€‰é¡¹çš„list                     | å‚æ•°å€¼åªèƒ½ä»å‡ ä¸ªé€‰é¡¹é‡Œé¢é€‰æ‹©              | choices=[1,2,3,4]   |\n| required | Trueæˆ–False                   | è¿™ä¸ªå¯é€‰å‚æ•°æ˜¯å¦å¿…é¡»æœ‰ï¼ˆåªèƒ½ç”¨äºå¯é€‰å‚æ•°ï¼å¦åˆ™æŠ¥é”™ï¼‰  | required=True       |\n| help     | å­—ç¬¦ä¸²                          | è¯´æ˜ä¸€ä¸‹è¿™ä¸ªå‚æ•°æ˜¯å¹²å˜›çš„                | help=â€œI donâ€™t knowâ€ |\n| action   | å…­ç§å†…ç½®åŠ¨ä½œ                       | ä¸€æ—¦è¿™ä¸ªæœ‰å‚æ•°ï¼Œå°±ä¼šè§¦å‘ç›¸åº”çš„åŠ¨ä½œ           | action=â€˜store_trueâ€™ |\n\n## parse_args\næè¿°ï¼šè§£æå‘½ä»¤è¡Œå‚æ•°ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.parse_args(args=None, namespace=None)\n```\nç¤ºä¾‹ï¼š\n```python\nargs = parser.parse_args()\nprint(args.[arg name])\n```\n\n## set_defaults\næè¿°ï¼šä¸ºæŒ‡å®šçš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.set_defaults(**kwargs)\n```\nç¤ºä¾‹ï¼š\n```python\nparser.set_defaults(name=\"John Doe\", age=30)  \n```\n\n## print_help\næè¿°ï¼šæ‰“å°å¸®åŠ©ä¿¡æ¯ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.print_help()\n```\nç¤ºä¾‹ï¼š\n```python\nparser.print_help()\n```\n\n## add_subparsers\næè¿°ï¼šä¸ºArgumentParserå¯¹è±¡æ·»åŠ å­å‘½ä»¤è§£æå™¨ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.add_subparsers(dest=None, parser_class=<class 'argparse.ArgumentParser'>, required=False, help=None)\n```\nç¤ºä¾‹ï¼š\n```python\nsubparsers = parser.add_subparsers(dest='command')\n```\n\n\n> è¿™ä¸Šé¢å‡ ä¸ªæ˜¯æœ€å¸¸ç”¨çš„ã€‚\n\n---\n\n## add_mutually_exclusive_group\næè¿°ï¼šåˆ›å»ºä¸€ä¸ªäº’æ–¥çš„å‚æ•°ç»„ï¼ŒåŒä¸€æ—¶é—´åªèƒ½ä½¿ç”¨ç»„å†…ä¸€ä¸ªå‚æ•°ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.add_mutually_exclusive_group(required=False)\n```\nç¤ºä¾‹ï¼š\n```python\ngroup = parser.add_mutually_exclusive_group()\ngroup.add_argument('--foo', action='store_true')\ngroup.add_argument('--bar', action='store_true')\n```\n\n## parse_known_args\næè¿°ï¼šè§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œä½†è¿”å›ä¸€ä¸ªåŒ…å«å·²çŸ¥å‚æ•°å’ŒæœªçŸ¥å‚æ•°çš„å…ƒç»„ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.parse_known_args(args=None, namespace=None)\n```\nç¤ºä¾‹ï¼š\n```python\nargs, unknown = parser.parse_known_args()\n```\n\n## convert_arg_line_to_args\næè¿°ï¼šå°†ä»æ–‡ä»¶è¯»å–çš„ä¸€è¡Œè½¬æ¢ä¸ºå‚æ•°åˆ—è¡¨ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.convert_arg_line_to_args(arg_line)\n```\nç¤ºä¾‹ï¼š\n```python\nargs = parser.convert_arg_line_to_args(\"foo --bar=3\")\n```\n\n## error\næè¿°ï¼šåœ¨å‘½ä»¤è¡Œå‚æ•°è§£æè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.error(message)\n```\nç¤ºä¾‹ï¼š\n```python\nparser.error(\"Invalid argument\")\n```\n\n## exit\næè¿°ï¼šåœ¨è§£æå‘½ä»¤è¡Œå‚æ•°æ—¶é‡åˆ°é”™è¯¯æ—¶ï¼Œé€€å‡ºç¨‹åºã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.exit(status=0, message=None)\n```\nç¤ºä¾‹ï¼š\n```python\nparser.exit(message=\"Exiting due to error\")\n```\n\n## parse_args_from_file\næè¿°ï¼šä»æ–‡ä»¶ä¸­è¯»å–å‚æ•°å¹¶è§£æã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.parse_args_from_file(filename)\n```\nç¤ºä¾‹ï¼š\n```python\nparser.parse_args_from_file('args.txt')\n```\n\n## add_argument_group\næè¿°ï¼šåˆ›å»ºä¸€ä¸ªå‚æ•°ç»„ï¼Œç”¨äºç»„ç»‡å’Œæè¿°ç›¸å…³å‚æ•°ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.add_argument_group(title=None, description=None)\n```\nç¤ºä¾‹ï¼š\n```python\ngroup = parser.add_argument_group('Optional arguments')\ngroup.add_argument('--output', type=str, help='Output file')\n```\n\n## format_help\næè¿°ï¼šè¿”å›å½“å‰å¸®åŠ©ä¿¡æ¯çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚\nè¯­æ³•ï¼š\n```python\nArgumentParser.format_help()\n```\nç¤ºä¾‹ï¼š\n```python\nhelp_text = parser.format_help()\n```\n","tags":["python","sys","argparse"],"categories":["python"]},{"title":"å¤§èŸ’è›‡-shutilåº“","url":"/posts/22415/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\nshutilåº“ä¸»è¦ç”¨äºæ–‡ä»¶çš„é«˜çº§æ“ä½œï¼Œæ¯”å¦‚ç§»åŠ¨ã€å¤åˆ¶ã€å‹ç¼©å’Œè§£å‹\n\n## shutil.copy\næè¿°ï¼šå¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„ã€‚\nè¯­æ³•ï¼š`shutil.copy(src, dst)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.copy('source.txt', 'destination.txt')\n```\n\n## shutil.copy2\næè¿°ï¼šå¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„ï¼ŒåŒæ—¶ä¿ç•™æ–‡ä»¶çš„å…ƒæ•°æ®ã€‚\nè¯­æ³•ï¼š`shutil.copy2(src, dst)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.copy2('source.txt', 'destination.txt')\n```\n\n## shutil.copytree\næè¿°ï¼šé€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•æ ‘ã€‚\nè¯­æ³•ï¼š`shutil.copytree(src, dst)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.copytree('source_dir', 'destination_dir')\n```\n\n## shutil.move\næè¿°ï¼šç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•åˆ°æŒ‡å®šè·¯å¾„ã€‚\nè¯­æ³•ï¼š`shutil.move(src, dst)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.move('source.txt', 'destination.txt')\n```\n\n## shutil.rmtree\næè¿°ï¼šé€’å½’åˆ é™¤ç›®å½•æ ‘ã€‚æ…ç”¨ï¼ \nè¯­æ³•ï¼š`shutil.rmtree(path)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.rmtree('directory')\n```\n\n## shutil.disk_usage\næè¿°ï¼šè¿”å›ç£ç›˜çš„æ€»å®¹é‡ã€å·²ç”¨ç©ºé—´å’Œå‰©ä½™ç©ºé—´ã€‚\nè¯­æ³•ï¼š`shutil.disk_usage(path)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\ntotal, used, free = shutil.disk_usage('/')\nprint(f\"Total: {total}, Used: {used}, Free: {free}\")\n```\n\n## shutil.chown\næè¿°ï¼šæ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œç»„ã€‚\nè¯­æ³•ï¼š`shutil.chown(path, user=None, group=None)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.chown('file.txt', user='username', group='groupname')\n```\n\n## shutil.unpack_archive\næè¿°ï¼šè§£å‹å½’æ¡£æ–‡ä»¶ã€‚\nè¯­æ³•ï¼š`shutil.unpack_archive(filename, extract_dir=None)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.unpack_archive('archive.zip', 'destination_folder')\n```\n\n## shutil.get_archive_formats\næè¿°ï¼šè·å–æ”¯æŒçš„å½’æ¡£æ ¼å¼åˆ—è¡¨ã€‚\nè¯­æ³•ï¼š`shutil.get_archive_formats()`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nformats = shutil.get_archive_formats()\nprint(formats)\n```\n\n## shutil.make_archive\næè¿°ï¼šåˆ›å»ºä¸€ä¸ªå½’æ¡£æ–‡ä»¶ã€‚\nè¯­æ³•ï¼š`shutil.make_archive(base_name, format, root_dir=None, base_dir=None)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.make_archive('archive_name', 'zip', 'folder_to_compress')\n```\n\n## shutil.move\næè¿°ï¼šç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•åˆ°æŒ‡å®šè·¯å¾„ã€‚\nè¯­æ³•ï¼š`shutil.move(src, dst)`\nç¤ºä¾‹ï¼š\n```python\nimport shutil\nshutil.move('source.txt', 'destination_folder')\n```\n\n","tags":["python","shutil"],"categories":["python"]},{"title":"å¤§èŸ’è›‡-pathlibåº“","url":"/posts/63515/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n## Path()\næè¿°ï¼šåˆ›å»ºè·¯å¾„å¯¹è±¡  \nè¯­æ³•ï¼š`Path(path_str)`  \nç¤ºä¾‹ï¼š\n```python\nfrom pathlib import Path\np = Path('/home/user/docs')\n\n```\n\n## cwd()\næè¿°ï¼šè·å–å½“å‰å·¥ä½œç›®å½•\nè¯­æ³•ï¼š`Path.cwd()`\nç¤ºä¾‹ï¼š\n```python\nPath.cwd()\n\n```\n\n## home()\næè¿°ï¼šè·å–ç”¨æˆ·ä¸»ç›®å½•è·¯å¾„\nè¯­æ³•ï¼š`Path.home()`\nç¤ºä¾‹ï¼š\n```python\nPath.home()\n```\n\n## exists()\næè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨\nè¯­æ³•ï¼š`path.exists()`\nç¤ºä¾‹ï¼š\n```python\nPath('test.txt').exists()\n\n```\n\n## is_file()\næè¿°ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶\nè¯­æ³•ï¼š`path.is_file()`\nç¤ºä¾‹ï¼š\n```python\nPath('test.txt').is_file()\n\n```\n\n## is_dir()\næè¿°ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºç›®å½•\nè¯­æ³•ï¼š`path.is_dir()`\nç¤ºä¾‹ï¼š\n```python\nPath('/etc').is_dir()\n\n```\n\n## is_symlink()\næè¿°ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºç¬¦å·é“¾æ¥\nè¯­æ³•ï¼š`path.is_symlink()`\nç¤ºä¾‹ï¼š\n```python\nPath('link').is_symlink()\n\n```\n\n## iterdir()\næè¿°ï¼šåˆ—å‡ºç›®å½•å†…å®¹ï¼ˆç”Ÿæˆå™¨ï¼‰\nè¯­æ³•ï¼š`path.iterdir()`\nç¤ºä¾‹ï¼š\n```python\nfor item in Path('.').iterdir():\n    print(item)\n```\n\n## glob()\næè¿°ï¼šä½¿ç”¨é€šé…ç¬¦åŒ¹é…æ–‡ä»¶\nè¯­æ³•ï¼š`path.glob(pattern)`\nç¤ºä¾‹ï¼š\n```python\nlist(Path('.').glob('*.py'))\n```\n\n## rglob()\næè¿°ï¼šé€’å½’åŒ¹é…æ–‡ä»¶\nè¯­æ³•ï¼š`path.rglob(pattern)`\nç¤ºä¾‹ï¼š\n```python\nlist(Path('.').rglob('*.py'))\n```\n\n## mkdir()\næè¿°ï¼šåˆ›å»ºç›®å½•\nè¯­æ³•ï¼š`path.mkdir(parents=False, exist_ok=False)`\nç¤ºä¾‹ï¼š\n```python\nPath('new_dir').mkdir(exist_ok=True)\n\n```\n\n## rmdir()\næè¿°ï¼šåˆ é™¤ç©ºç›®å½•\nè¯­æ³•ï¼š`path.rmdir()`\nç¤ºä¾‹ï¼š\n```python\nPath('empty_dir').rmdir()\n\n```\n\n## unlink()\næè¿°ï¼šåˆ é™¤æ–‡ä»¶æˆ–ç¬¦å·é“¾æ¥\nè¯­æ³•ï¼š`path.unlink(missing_ok=False)`\nç¤ºä¾‹ï¼š\n```python\nPath('file.txt').unlink()\n\n```\n\n## rename()\næè¿°ï¼šé‡å‘½åæ–‡ä»¶æˆ–ç›®å½•\nè¯­æ³•ï¼š`path.rename(target)`\nç¤ºä¾‹ï¼š\n```python\nPath('old.txt').rename('new.txt')\n\n```\n\n## replace()\næè¿°ï¼šé‡å‘½åï¼ˆå¦‚ç›®æ ‡å­˜åœ¨åˆ™è¦†ç›–ï¼‰\nè¯­æ³•ï¼š`path.replace(target)`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').replace('b.txt')\n\n```\n\n## resolve()\næè¿°ï¼šè¿”å›ç»å¯¹è·¯å¾„ï¼ˆè§£æç¬¦å·é“¾æ¥ï¼‰\nè¯­æ³•ï¼š`path.resolve()`\nç¤ºä¾‹ï¼š\n```python\nPath('..').resolve()\n\n```\n\n## absolute()\næè¿°ï¼šè¿”å›ç»å¯¹è·¯å¾„ï¼ˆä¸è§£æç¬¦å·é“¾æ¥ï¼‰\nè¯­æ³•ï¼š`path.absolute()`\nç¤ºä¾‹ï¼š\n```python\nPath('file.txt').absolute()\n\n```\n\n## stat()\næè¿°ï¼šè·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯\nè¯­æ³•ï¼š`path.stat()`\nç¤ºä¾‹ï¼š\n```python\ninfo = Path('file.txt').stat()\nprint(info.st_size)\n\n```\n\n## read_text()\næè¿°ï¼šè¯»å–æ–‡æœ¬æ–‡ä»¶å†…å®¹\nè¯­æ³•ï¼š`path.read_text(encoding=None)`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').read_text()\n\n```\n\n## write_text()\næè¿°ï¼šå†™å…¥æ–‡æœ¬å†…å®¹\nè¯­æ³•ï¼š`path.write_text(data, encoding=None)`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').write_text('Hello World')\n\n```\n\n## read_bytes()\næè¿°ï¼šè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶å†…å®¹\nè¯­æ³•ï¼š`path.read_bytes()`\nç¤ºä¾‹ï¼š\n```python\ndata = Path('a.bin').read_bytes()\n\n```\n\n## write_bytes()\næè¿°ï¼šå†™å…¥äºŒè¿›åˆ¶æ•°æ®\nè¯­æ³•ï¼š`path.write_bytes(data)`\nç¤ºä¾‹ï¼š\n```python\nPath('a.bin').write_bytes(b'\\x00\\x01')\n\n```\n\n## joinpath()\næè¿°ï¼šæ‹¼æ¥è·¯å¾„\nè¯­æ³•ï¼š`path.joinpath(*other)`\nç¤ºä¾‹ï¼š\n```python\nPath('/home').joinpath('user', 'docs')\n\n```\n\n## with_name()\næè¿°ï¼šè¿”å›æ›´æ”¹æ–‡ä»¶åçš„æ–°è·¯å¾„\nè¯­æ³•ï¼š`path.with_name(name)`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').with_name('b.txt')\n\n```\n\n## with_suffix()\næè¿°ï¼šä¿®æ”¹æ–‡ä»¶æ‰©å±•å\nè¯­æ³•ï¼š`path.with_suffix(suffix)`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').with_suffix('.md')\n\n```\n\n## suffix\næè¿°ï¼šè¿”å›è·¯å¾„åç¼€\nè¯­æ³•ï¼š`path.suffix`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').suffix\n\n```\n\n## suffixes\næè¿°ï¼šè¿”å›æ‰€æœ‰åç¼€ï¼ˆåˆ—è¡¨ï¼‰\nè¯­æ³•ï¼š`path.suffixes`\nç¤ºä¾‹ï¼š\n```python\nPath('archive.tar.gz').suffixes\n\n```\n\n## stem\næè¿°ï¼šè¿”å›ä¸å¸¦åç¼€çš„æ–‡ä»¶å\nè¯­æ³•ï¼š`path.stem`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').stem\n\n```\n\n## name\næè¿°ï¼šè¿”å›æ–‡ä»¶å\nè¯­æ³•ï¼š`path.name`\nç¤ºä¾‹ï¼š\n```python\nPath('/home/user/a.txt').name\n\n```\n\n## parent\næè¿°ï¼šè¿”å›çˆ¶è·¯å¾„\nè¯­æ³•ï¼š`path.parent`\nç¤ºä¾‹ï¼š\n```python\nPath('/home/user/a.txt').parent\n\n```\n\n## parents\næè¿°ï¼šè¿”å›æ‰€æœ‰ä¸Šçº§ç›®å½•\nè¯­æ³•ï¼š`path.parents`\nç¤ºä¾‹ï¼š\n```python\nfor p in Path('/a/b/c').parents:\n    print(p)\n\n```\n\n## as_posix()\næè¿°ï¼šä»¥ POSIX æ ¼å¼è¿”å›è·¯å¾„å­—ç¬¦ä¸²\nè¯­æ³•ï¼š`path.as_posix()`\nç¤ºä¾‹ï¼š\n```python\nPath('C:\\\\a\\\\b').as_posix()\n\n```\n\n## as_uri()\næè¿°ï¼šè¿”å›æ–‡ä»¶URI\nè¯­æ³•ï¼š`path.as_uri()`\nç¤ºä¾‹ï¼š\n```python\nPath('/home/user/a.txt').as_uri()\n\n```\n\n## relative_to()\næè¿°ï¼šè¿”å›ç›¸å¯¹è·¯å¾„\nè¯­æ³•ï¼š`path.relative_to(base)`\nç¤ºä¾‹ï¼š\n```python\nPath('/home/user/docs/a.txt').relative_to('/home/user')\n\n```\n\n## match()\næè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦åŒ¹é…æ¨¡å¼\nè¯­æ³•ï¼š`path.match(pattern)`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').match('*.txt')\n\n```\n\n## touch()\næè¿°ï¼šåˆ›å»ºç©ºæ–‡ä»¶æˆ–æ›´æ–°ä¿®æ”¹æ—¶é—´\nè¯­æ³•ï¼š`path.touch(exist_ok=True)`\nç¤ºä¾‹ï¼š\n```python\nPath('a.txt').touch()\n\n```\n\n## open()\næè¿°ï¼šæ‰“å¼€æ–‡ä»¶ï¼ˆä¸å†…ç½® open ç±»ä¼¼ï¼‰\nè¯­æ³•ï¼š`path.open(mode='r', encoding=None)`\nç¤ºä¾‹ï¼š\n```python\nwith Path('a.txt').open('w') as f:\n    f.write('data')\n\n```\n","tags":["python","pathlib"],"categories":["python"]},{"title":"Pythonä¸­å…ƒç»„ã€åˆ—è¡¨ã€å­—å…¸å’Œé›†åˆçš„åŒºåˆ«","url":"/posts/53459/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\nåœ¨Pythonä¸­ï¼Œå…ƒç»„ï¼ˆTupleï¼‰ã€åˆ—è¡¨ï¼ˆListï¼‰ã€å­—å…¸ï¼ˆDictionaryï¼‰å’Œé›†åˆï¼ˆSetï¼‰æ˜¯å››ç§å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œå®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œåº”ç”¨åœºæ™¯ã€‚\n\n## åˆ—è¡¨ï¼ˆListï¼‰Â \nåˆ—è¡¨æ˜¯ä¸€ç§æœ‰åºä¸”å¯å˜çš„æ•°æ®åºåˆ—ï¼Œå…è®¸å­˜å‚¨é‡å¤å…ƒç´ ã€‚ \n- å®šä¹‰æ–¹å¼ï¼šä½¿ç”¨æ–¹æ‹¬å·Â _[]_ï¼Œä¾‹å¦‚Â _example_list = [1, 2, \"apple\", True]_ã€‚ \n- ç‰¹ç‚¹ï¼šæ”¯æŒé€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ï¼Œå¯ä»¥åŠ¨æ€æ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹å…ƒç´ ã€‚ \n- åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºéœ€è¦é¢‘ç¹ä¿®æ”¹çš„æœ‰åºæ•°æ®é›†ï¼Œä¾‹å¦‚è´­ç‰©æ¸…å•æˆ–åŠ¨æ€æ•°ç»„ã€‚\n\n## å…ƒç»„ï¼ˆTupleï¼‰Â \nå…ƒç»„æ˜¯ä¸€ç§æœ‰åºä½†ä¸å¯å˜çš„æ•°æ®åºåˆ—ï¼Œå…è®¸å­˜å‚¨é‡å¤å…ƒç´ ã€‚ \n- å®šä¹‰æ–¹å¼ï¼šä½¿ç”¨åœ†æ‹¬å·Â _()_ï¼Œä¾‹å¦‚Â _example_tuple = (1, 2, \"apple\", True)_ã€‚ \n- ç‰¹ç‚¹ï¼šä¸€æ—¦åˆ›å»ºåï¼Œå†…å®¹æ— æ³•æ›´æ”¹ï¼Œé€‚åˆå­˜å‚¨å›ºå®šä¸å˜çš„æ•°æ®ã€‚ \n- åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºéœ€è¦ä¿æŠ¤æ•°æ®ä¸è¢«ä¿®æ”¹çš„åœºæ™¯ï¼Œä¾‹å¦‚åæ ‡ç‚¹æˆ–æ•°æ®åº“æŸ¥è¯¢ç»“æœã€‚\n\n## é›†åˆï¼ˆSetï¼‰Â \né›†åˆæ˜¯ä¸€ç§æ— åºä¸”ä¸å…è®¸é‡å¤çš„å…ƒç´ é›†åˆã€‚ \n- å®šä¹‰æ–¹å¼ï¼šä½¿ç”¨å¤§æ‹¬å·Â _{}_Â æˆ–Â _set()_Â å‡½æ•°ï¼Œä¾‹å¦‚Â _example_set = {1, 2, \"apple\", True}_ã€‚ \n- ç‰¹ç‚¹ï¼šä¸æ”¯æŒç´¢å¼•è®¿é—®ï¼Œä½†å¯ä»¥è¿›è¡Œæ•°å­¦é›†åˆè¿ç®—ï¼ˆå¦‚äº¤é›†ã€å¹¶é›†ï¼‰ã€‚\n- åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºéœ€è¦å»é‡æˆ–å¿«é€Ÿåˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨çš„åœºæ™¯ï¼Œä¾‹å¦‚å¤„ç†å”¯ä¸€å€¼é›†åˆã€‚\n\n## å­—å…¸ï¼ˆDictionaryï¼‰Â \nå­—å…¸æ˜¯ä¸€ç§é”®å€¼å¯¹çš„æ˜ å°„å®¹å™¨ï¼Œå…¶ä¸­é”®å¿…é¡»å”¯ä¸€ï¼Œå€¼å¯ä»¥é‡å¤ã€‚ \n- å®šä¹‰æ–¹å¼ï¼šä½¿ç”¨å¤§æ‹¬å·Â _{}_ï¼Œä¾‹å¦‚Â _example_dict = {\"name\": \"Alice\", \"age\": 25}_ã€‚ \n- ç‰¹ç‚¹ï¼šä»Python 3.7å¼€å§‹ï¼Œå­—å…¸çš„æ’å…¥é¡ºåºä¿æŒä¸å˜ã€‚æ”¯æŒé€šè¿‡é”®å¿«é€ŸæŸ¥æ‰¾å¯¹åº”çš„å€¼ã€‚ \n- åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºå­˜å‚¨é”®å€¼æ˜ å°„å…³ç³»çš„æ•°æ®ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“è¡¨ç»“æ„ã€‚\n\n## æ€»ç»“\n- æœ‰åºæ€§ï¼šåˆ—è¡¨å’Œå…ƒç»„æ˜¯æœ‰åºçš„ï¼Œé›†åˆå’Œå­—å…¸æ— åºï¼ˆä½†å­—å…¸ä»Python 3.7èµ·ä¿æŒæ’å…¥é¡ºåºï¼‰ã€‚\n- å¯å˜æ€§ï¼šåˆ—è¡¨å’Œå­—å…¸æ˜¯å¯å˜çš„ï¼Œå…ƒç»„ä¸å¯å˜ï¼Œé›†åˆå¯å˜ä½†ä¸æ”¯æŒç´¢å¼•ã€‚\n- é‡å¤æ€§ï¼šé›†åˆä¸å…è®¸é‡å¤å…ƒç´ ï¼Œå…¶ä»–ä¸‰ç§ç»“æ„å…è®¸é‡å¤ï¼ˆå­—å…¸çš„é”®å¿…é¡»å”¯ä¸€ï¼‰ã€‚\n- åº”ç”¨åœºæ™¯ï¼šæ ¹æ®æ•°æ®çš„æœ‰åºæ€§ã€å¯å˜æ€§å’Œé‡å¤æ€§éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ã€‚","tags":["python"],"categories":["python"]},{"title":"å¤§èŸ’è›‡-osåº“","url":"/posts/37113/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n# Python `os` æ¨¡å—å‡½æ•°å¤§å…¨é€ŸæŸ¥è¡¨\n\n`os` æ¨¡å—æ˜¯ Python æ ‡å‡†åº“ä¸­ç”¨äºä¸æ“ä½œç³»ç»Ÿäº¤äº’çš„æ¥å£ï¼Œæ¶µç›–äº†æ–‡ä»¶/ç›®å½•æ“ä½œã€ç¯å¢ƒå˜é‡ç®¡ç†ã€ç³»ç»Ÿä¿¡æ¯è·å–ã€è¿›ç¨‹æ§åˆ¶ç­‰è¯¸å¤šåŠŸèƒ½ã€‚æœ¬æ–‡æ•´ç†äº†å¸¸ç”¨å‡½æ•°åŠç¤ºä¾‹ï¼Œä¾¿äºæŸ¥é˜…ä½¿ç”¨ã€‚\n\n## os.getcwd()\næè¿°ï¼šè·å–å½“å‰å·¥ä½œç›®å½•  \nè¯­æ³•ï¼š`os.getcwd()`  \nç¤ºä¾‹ï¼š\n```python\nimport os\nprint(os.getcwd())\n```\n\n## os.chdir()\næè¿°ï¼šæ”¹å˜å½“å‰å·¥ä½œç›®å½•  \nè¯­æ³•ï¼š`os.chdir(path)`  \nç¤ºä¾‹ï¼š\n```python\nos.chdir(\"/home/user\")\n```\n\n## os.listdir()\næè¿°ï¼šè¿”å›æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹åˆ—è¡¨  \nè¯­æ³•ï¼š`os.listdir(path=\".\")`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.listdir(\".\"))\n```\n\n## os.mkdir()\næè¿°ï¼šåˆ›å»ºå•å±‚ç›®å½•  \nè¯­æ³•ï¼š`os.mkdir(path)`  \nç¤ºä¾‹ï¼š\n```python\nos.mkdir(\"test\")\n```\n\n## os.makedirs()\næè¿°ï¼šåˆ›å»ºå¤šçº§ç›®å½•  \nè¯­æ³•ï¼š`os.makedirs(path, exist_ok=False)`  \nç¤ºä¾‹ï¼š\n```python\nos.makedirs(\"a/b/c\", exist_ok=True)\n```\n\n## os.rmdir()\næè¿°ï¼šåˆ é™¤ç©ºç›®å½•  \nè¯­æ³•ï¼š`os.rmdir(path)`  \nç¤ºä¾‹ï¼š\n```python\nos.rmdir(\"test\")\n```\n\n## os.removedirs()\næè¿°ï¼šåˆ é™¤å¤šçº§ç©ºç›®å½•  \nè¯­æ³•ï¼š`os.removedirs(path)`  \nç¤ºä¾‹ï¼š\n```python\nos.removedirs(\"a/b/c\")\n```\n\n## os.remove()\næè¿°ï¼šåˆ é™¤æ–‡ä»¶  \nè¯­æ³•ï¼š`os.remove(path)`  \nç¤ºä¾‹ï¼š\n```python\nos.remove(\"file.txt\")\n```\n\n## os.rename()\næè¿°ï¼šé‡å‘½åæ–‡ä»¶æˆ–ç›®å½•  \nè¯­æ³•ï¼š`os.rename(src, dst)`  \nç¤ºä¾‹ï¼š\n```python\nos.rename(\"old.txt\", \"new.txt\")\n```\n\n## os.replace()\næè¿°ï¼šé‡å‘½åæ–‡ä»¶ï¼Œå¦‚æœç›®æ ‡å·²å­˜åœ¨ä¼šè¢«è¦†ç›–  \nè¯­æ³•ï¼š`os.replace(src, dst)`  \nç¤ºä¾‹ï¼š\n```python\nos.replace(\"a.txt\", \"b.txt\")\n```\n\n## os.stat()\næè¿°ï¼šè·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯  \nè¯­æ³•ï¼š`os.stat(path)`  \nç¤ºä¾‹ï¼š\n```python\ninfo = os.stat(\"file.txt\")\nprint(info.st_size)\n```\n\n## os.walk()\næè¿°ï¼šé€’å½’éå†ç›®å½•æ ‘  \nè¯­æ³•ï¼š`os.walk(top, topdown=True, onerror=None, followlinks=False)`  \nç¤ºä¾‹ï¼š\n```python\nfor root, dirs, files in os.walk(\".\"):\n    print(root, dirs, files)\n```\nè¡¥å……ï¼š\n`top`ï¼šè¦éå†çš„é¡¶çº§ç›®å½•çš„è·¯å¾„ã€‚\n`topdown (å¯é€‰)`ï¼šå¦‚æœä¸º Trueï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™ä»é¡¶çº§å¼€å§‹å‘ä¸‹éå†ã€‚å¦‚æœä¸º Falseï¼Œåˆ™ä»åº•éƒ¨çš„å­ç›®å½•å¼€å§‹å‘ä¸Šéå†ã€‚\n`onerror (å¯é€‰)`ï¼šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºé”™è¯¯å¤„ç†ã€‚å¦‚æœæŒ‡å®šï¼Œåˆ™åº”è¯¥æ˜¯ä¸€ä¸ªæ¥å—å•ä¸ªå‚æ•°ï¼ˆå¼‚å¸¸å®ä¾‹ï¼‰çš„å‡½æ•°ã€‚å¦‚æœæœªæŒ‡å®šæˆ–ä¸º Noneï¼Œé”™è¯¯å°†è¢«å¿½ç•¥ã€‚\n`followlinks (å¯é€‰)`ï¼šå¦‚æœä¸º Trueï¼Œåˆ™ä¼šéå†ç¬¦å·é“¾æ¥æŒ‡å‘çš„ç›®å½•ã€‚\n\n## os.scandir()\næè¿°ï¼šé«˜æ•ˆè¿­ä»£ç›®å½•é¡¹  \nè¯­æ³•ï¼š`os.scandir(path=\".\")`  \nç¤ºä¾‹ï¼š\n```python\ndef traversal_files(path):\n    for item in os.scandir(path):\n        if item.is_dir():\n          dirs.append(item.path)\n\n        elif item.is_file():\n          files.append(item.path)\n\n    print('dirs:')\n    print('\\n'.join(dirs))\n\n    print()\n\n    print('files:')\n    print('\\n'.join(files))\n\ntraversal_files(r'./test')\n```\n\n## os.path.join()\næè¿°ï¼šæ‹¼æ¥è·¯å¾„  \nè¯­æ³•ï¼š`os.path.join(path, *paths)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.join(\"folder\", \"file.txt\"))\n```\n\n## os.path.abspath()\næè¿°ï¼šè·å–ç»å¯¹è·¯å¾„  \nè¯­æ³•ï¼š`os.path.abspath(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.abspath(\"test.txt\"))\n```\n\n## os.path.basename()\næè¿°ï¼šè·å–è·¯å¾„ä¸­çš„æ–‡ä»¶å  \nè¯­æ³•ï¼š`os.path.basename(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.basename(\"/home/user/file.txt\"))\n```\n\n## os.path.dirname()\næè¿°ï¼šè·å–è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†  \nè¯­æ³•ï¼š`os.path.dirname(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.dirname(\"/home/user/file.txt\"))\n```\n\n## os.path.exists()\næè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨  \nè¯­æ³•ï¼š`os.path.exists(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.exists(\"file.txt\"))\n```\n\n## os.path.isfile()\næè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºæ–‡ä»¶  \nè¯­æ³•ï¼š`os.path.isfile(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.isfile(\"file.txt\"))\n```\n\n## os.path.isdir()\næè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºç›®å½•  \nè¯­æ³•ï¼š`os.path.isdir(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.isdir(\"folder\"))\n```\n\n## os.path.splitext()\næè¿°ï¼šåˆ†ç¦»æ–‡ä»¶åä¸æ‰©å±•å  \nè¯­æ³•ï¼š`os.path.splitext(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.splitext(\"file.txt\"))\n```\n\n## os.path.getsize()\næè¿°ï¼šè·å–æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰  \nè¯­æ³•ï¼š`os.path.getsize(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.path.getsize(\"file.txt\"))\n```\n\n## os.environ\næè¿°ï¼šç¯å¢ƒå˜é‡ç›¸å…³  \nè¯­æ³•ï¼š`os.environ`  \nç¤ºä¾‹ï¼š\n```python\n# è·å–ç¯å¢ƒå˜é‡\nvalue = os.environ.get(\"HOME\") # å¦‚æœä¸å­˜åœ¨è¿”å› None\n# ä¿®æ”¹ç¯å¢ƒå˜é‡\nos.environ[\"MY_VAR\"] = \"123\"\nos.environ[\"PATH\"] = os.environ[\"PATH\"] + \":/my/custom/path\"\n# åˆ é™¤ MY_VAR\ndel os.environ[\"MY_VAR\"]  \n```\n\n## os.system()\næè¿°ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤  **ä¸æ¨èï¼Œæ¨è`subprocess`**\nè¯­æ³•ï¼š`os.system(command)`  \nç¤ºä¾‹ï¼š\n```python\nos.system(\"ls\")\n```\n\n## os.popen()\næè¿°ï¼šæ‰§è¡Œå‘½ä»¤å¹¶è·å–è¾“å‡º  \nè¯­æ³•ï¼š`os.popen(command)`  \nç¤ºä¾‹ï¼š\n```python\noutput = os.popen(\"ls\").read()\nprint(output)\n```\n\n## os.getpid()\næè¿°ï¼šè·å–å½“å‰è¿›ç¨‹ ID  \nè¯­æ³•ï¼š`os.getpid()`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.getpid())\n```\n\n## os.getppid()\næè¿°ï¼šè·å–çˆ¶è¿›ç¨‹ ID  \nè¯­æ³•ï¼š`os.getppid()`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.getppid())\n```\n\n## os.getlogin()\næè¿°ï¼šè·å–å½“å‰ç™»å½•ç”¨æˆ·  \nè¯­æ³•ï¼š`os.getlogin()`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.getlogin())\n```\n\n## os.getuid() / os.getgid()\næè¿°ï¼šè·å–å½“å‰è¿›ç¨‹ç”¨æˆ·/ç»„ ID  \nè¯­æ³•ï¼š`os.getuid()` / `os.getgid()`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.getuid(), os.getgid())\n```\n\n## os.setuid() / os.setgid()\næè¿°ï¼šè®¾ç½®ç”¨æˆ·/ç»„ ID  \nè¯­æ³•ï¼š`os.setuid(uid)` / `os.setgid(gid)`  \nç¤ºä¾‹ï¼š\n```python\nos.setuid(1000)\n```\n\n## os.umask()\næè¿°ï¼šè®¾ç½®æ–‡ä»¶åˆ›å»ºæ©ç   \nè¯­æ³•ï¼š`os.umask(mask)`  \nç¤ºä¾‹ï¼š\n```python\nos.umask(0o022)\n```\n\n## os.chmod()\næè¿°ï¼šä¿®æ”¹æ–‡ä»¶æƒé™  \nè¯­æ³•ï¼š`os.chmod(path, mode)`  \nç¤ºä¾‹ï¼š\n```python\nos.chmod(\"file.txt\", 0o644)\n```\n\n## os.link()\næè¿°ï¼šåˆ›å»ºç¡¬é“¾æ¥  \nè¯­æ³•ï¼š`os.link(src, dst)`  \nç¤ºä¾‹ï¼š\n```python\nos.link(\"a.txt\", \"b.txt\")\n```\n\n## os.symlink()\næè¿°ï¼šåˆ›å»ºç¬¦å·é“¾æ¥  \nè¯­æ³•ï¼š`os.symlink(src, dst)`  \nç¤ºä¾‹ï¼š\n```python\nos.symlink(\"a.txt\", \"link.txt\")\n```\n\n## os.readlink()\næè¿°ï¼šè·å–ç¬¦å·é“¾æ¥æŒ‡å‘çš„è·¯å¾„  \nè¯­æ³•ï¼š`os.readlink(path)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.readlink(\"link.txt\"))\n```\n\n## os.utime()\næè¿°ï¼šä¿®æ”¹æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´  \nè¯­æ³•ï¼š`os.utime(path, times=None)`  \nç¤ºä¾‹ï¼š\n```python\nos.utime(\"file.txt\", (1620000000, 1620000000))\n```\n\n## os.truncate()\næè¿°ï¼šæˆªæ–­æ–‡ä»¶åˆ°æŒ‡å®šå¤§å°  \nè¯­æ³•ï¼š`os.truncate(path, length)`  \nç¤ºä¾‹ï¼š\n```python\nos.truncate(\"file.txt\", 100)\n```\n\n## os.urandom()\næè¿°ï¼šç”Ÿæˆéšæœºå­—èŠ‚æ•°æ®  \nè¯­æ³•ï¼š`os.urandom(n)`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.urandom(16))\n```\n\n## os.cpu_count()\næè¿°ï¼šè¿”å› CPU æ ¸å¿ƒæ•°  \nè¯­æ³•ï¼š`os.cpu_count()`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.cpu_count())\n```\n\n## os.uname()\næè¿°ï¼šè¿”å›æ“ä½œç³»ç»Ÿä¿¡æ¯  \nè¯­æ³•ï¼š`os.uname()`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.uname())\n```\n\n## os.name\næè¿°ï¼šè·å–æ“ä½œç³»ç»Ÿç±»å‹æ ‡è¯†  \nè¯­æ³•ï¼š`os.name`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.name)\n```\n\n## os.sep\næè¿°ï¼šè·¯å¾„åˆ†éš”ç¬¦  \nè¯­æ³•ï¼š`os.sep`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.sep)\n```\n\n## os.linesep\næè¿°ï¼šè¡Œåˆ†éš”ç¬¦  \nè¯­æ³•ï¼š`os.linesep`  \nç¤ºä¾‹ï¼š\n```python\nprint(repr(os.linesep))\n```\n\n## os.pathsep\næè¿°ï¼šç³»ç»Ÿè·¯å¾„åˆ†éš”ç¬¦  \nè¯­æ³•ï¼š`os.pathsep`  \nç¤ºä¾‹ï¼š\n```python\nprint(os.pathsep)\n```\n\n## os.devnull\næè¿°ï¼šç©ºè®¾å¤‡è·¯å¾„ï¼Œç”¨äºä¸¢å¼ƒè¾“å‡º  \nè¯­æ³•ï¼š`os.devnull`  \nç¤ºä¾‹ï¼š\n```python\nwith open(os.devnull, \"w\") as f:\n    f.write(\"This goes nowhere\")\n```\n","tags":["python","os"],"categories":["python"]},{"title":"Linuxå†…æ ¸æ¨¡å—åˆä½“éªŒ","url":"/posts/49513/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n\n>æœ¬ç¯‡æ‘˜è‡ªé‡ç«åµŒå…¥å¼Linuxç³»åˆ—æ•™ç¨‹é©±åŠ¨å¼€å‘ç¯‡\n\n\n## å†…æ ¸æ¨¡å—åŸºæœ¬æ¦‚å¿µ\n\n### ç°ä»£å†…æ ¸æ´¾ç³»\n\nå•å†…æ ¸ï¼šå…³é”®åŠŸèƒ½å’ŒæœåŠ¡åŠŸèƒ½å‡åœ¨å†…æ ¸ç©ºé—´æä¾›\n\n - è¿è¡Œæ•ˆç‡é«˜\n - æ‰©å±•æ€§è¾ƒå·®\n\nå¾®å†…æ ¸ï¼šå†…æ ¸ç©ºé—´åªæä¾›å…³é”®åŠŸèƒ½ï¼ŒæœåŠ¡åŠŸèƒ½åœ¨ç”¨æˆ·ç©ºé—´æä¾›\n\n- è¿è¡Œæ•ˆç‡è¾ƒä½\n- å®‰å…¨æ€§ã€æ‰©å±•æ€§è¾ƒé«˜\n\nlinuxå±äºå•å†…æ ¸ï¼ŒæŒ‰ç†æ¥è¯´æ‰©å±•æ€§ä¸å¥½ï¼Œä½†å…¶çš„æ¨¡å—åŒ–è®¾è®¡åˆå¼¥è¡¥äº†è¿™ä¸€ç‚¹ã€‚\n### å†…æ ¸æ¨¡å—åŠ è½½/å¸è½½\n\n- ä½¿ç”¨insmodå‘½ä»¤åŠ è½½\n- ä½¿ç”¨rmmodå‘½ä»¤å¸è½½\n\n### å†…æ ¸æ¨¡å—å…¥å£/å‡ºå£\n\n- module_init()ï¼šåŠ è½½æ¨¡å—å¼è¯¥å‡½æ•°è‡ªåŠ¨æ‰§è¡Œï¼Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œ\n- module_exit()ï¼šå¸è½½æ¨¡å—æ—¶å‡½æ•°è‡ªåŠ¨æ‰§è¡Œï¼Œè¿›è¡Œæ¸…ç†æ“ä½œ\n\n### å†…æ ¸æ¨¡å—ä¿¡æ¯å£°æ˜\n\n- MODULE_LICENSE()ï¼šè¡¨ç¤ºæ¨¡å—ä»£ç æ¥å—çš„è½¯ä»¶è®¸å¯åè®®ï¼ŒLinuxå†…æ ¸éµå¾ªGPL V2å¼€æºåè®®ï¼Œå†…æ ¸æ¨¡å—ä¸linuxå†…æ ¸ä¿æŒä¸€è‡´å³å¯ã€‚\n- MODULE_AUTHOR()ï¼šæè¿°æ¨¡å—çš„ä½œè€…ä¿¡æ¯\n- MODULE_DESCRIPTION()ï¼šå¯¹æ¨¡å—çš„ç®€å•ä»‹ç»\n- MODULE_ALIAS()ï¼šç»™æ¨¡å—è®¾ç½®ä¸€ä¸ªåˆ«å\n\n## å†…æ ¸æ¨¡å—å®éªŒ1\n\n### å®éªŒç¯å¢ƒ\n\n- å¼€å‘æ¿çƒ§å½•å¥½Debiané•œåƒã€‚\n- SSHè¿æ¥MobaXterm\n- å¯åŠ¨å¼€å‘æ¿ï¼Œæ­å»ºå¥½SFTPã€‚\n- è·å–Debiané•œåƒçš„å†…æ ¸æºç å¹¶ç¼–è¯‘ã€‚\n\n### ç¼–è¯‘4.19.71ç‰ˆæœ¬å†…æ ¸\n\nå†…æ ¸æ¨¡å—çš„åŠŸèƒ½éœ€è¦ä¾èµ–å†…æ ¸æä¾›çš„å„ç§åº•å±‚æ¥å£\n\n1.ä¸‹è½½linuxå†…æ ¸æºç \n\nâ€‹\tgithub:\n\n```\ngit clone https://github.com/Embedfire/ebf-buster-linux.git\n```\n\nâ€‹\tgitee:\n\n```\ngit clone https://gitee.com/Embedfire/ebf-buster-linux.git\n```\n\n2.å®‰è£…å¿…è¦ç¯å¢ƒå·¥å…·åº“\n\n```\nsudo apt install make gcc-arm-linux-gnueabihf gcc bison flex libssl-dev dpkg-dev lzop\n```\n\n- gcc-arm-linux-gnueabihf äº¤å‰ç¼–è¯‘å™¨\n- bison è¯­æ³•åˆ†æå™¨\n- flex è¯æ³•åˆ†æå™¨\n- libssl-dev OpenSSLé€šç”¨åº“\n- lzop LZOå‹ç¼©åº“çš„å‹ç¼©è½¯ä»¶\n\n3.ä¸€é”®ç¼–è¯‘å†…æ ¸\n\n```\nsudo ./make_deb.sh\n```\n\n>å¦‚æœåœ¨ç”µè„‘ä¸Šç¼–è¯‘ä¸æˆåŠŸä¸”æ— æ³•è§£å†³ï¼Œå¯ä»¥é€‰æ‹©åœ¨å¼€å‘æ¿ä¸Šç¼–è¯‘ï¼Œä»£ä»·å°±æ˜¯ã€‚ã€‚ã€‚å—¯ it takes a long time\n\n4.è·å–ç¼–è¯‘å‡ºæ¥çš„å†…æ ¸ç›¸å…³æ–‡ä»¶\n\n```\nYOURPATH/ebf_linux_kernel_6ull_depth1/build_image/\n```\n\n### å†…æ ¸æ¨¡å—å¤´æ–‡ä»¶\n\n- `#include <linux/module.h>`ï¼šåŒ…å«å†…æ ¸æ¨¡å—ä¿¡æ¯å£°æ˜çš„ç›¸å…³å‡½æ•°\n- `#include <linux/init.h>`ï¼šåŒ…å«äº† module_init()å’Œ module_exit()å‡½æ•°çš„å£°æ˜\n-  `#include <linux/kernel.h>`ï¼šåŒ…å«å†…æ ¸æä¾›çš„å„ç§å‡½æ•°ï¼Œå¦‚printk\n\n### å†…æ ¸æ¨¡å—æ‰“å°å‡½æ•°\n\n- `printf`ï¼šglibcå®ç°çš„æ‰“å°å‡½æ•°ï¼Œå·¥ä½œäºç”¨æˆ·ç©ºé—´ï¼Œä¸å¯åœ¨å†…æ ¸ä½¿ç”¨\n\n- `printk`ï¼šå†…æ ¸æ¨¡å—æ— æ³•ä½¿ç”¨glibcåº“å‡½æ•°ï¼Œå†…æ ¸è‡ªèº«å®ç°çš„ä¸€ä¸ªç±»printfå‡½æ•°ï¼Œä½†æ˜¯éœ€è¦æŒ‡å®šæ‰“å°ç­‰çº§ã€‚\n  - `#define KERN_EMERG` \t\"<0>\" é€šå¸¸æ˜¯ç³»ç»Ÿå´©æºƒå‰çš„ä¿¡æ¯\n  - `#define KERN_ALERT`          \"<1>\" éœ€è¦ç«‹å³å¤„ç†çš„æ¶ˆæ¯\n  - `#define KERN_CRIT`             \"<2>\" ä¸¥é‡æƒ…å†µ\n  - `#define KERN_ERR`              \"<3>\" é”™è¯¯æƒ…å†µ\n  - `#define KERN_WARNING`      \"<4>\" æœ‰é—®é¢˜çš„æƒ…å†µ\n  - `#define KERN_NOTICE`       \"<5>\" æ³¨æ„ä¿¡æ¯\n  - `#define KERN_INFO`            \"<6>\" æ™®é€šæ¶ˆæ¯\n  - `#define KERN_DEBUG`        \"<7>\" è°ƒè¯•ä¿¡æ¯\n\næŸ¥çœ‹å½“å‰ç³»ç»Ÿprintkæ‰“å°ç­‰çº§ï¼š`cat /proc/sys/kernel/printk`\nè¾“å‡º\n```\n7       4       1       7\n```\nè¡¨ç¤ºï¼š\n- å½“å‰æ§åˆ¶å°æ—¥å¿—çº§åˆ«\n- é»˜è®¤æ¶ˆæ¯æ—¥å¿—çº§åˆ«\n- æœ€å°çš„æ§åˆ¶å°çº§åˆ«\n- é»˜è®¤æ§åˆ¶å°æ—¥å¿—çº§åˆ«\n\nå°äºç­‰äºè®¾å®šæ‰“å°ç­‰çº§çš„æ¶ˆæ¯ä¸ä¼šè¢«æ‰“å°ã€‚\næ‰“å°å†…æ ¸æ‰€æœ‰æ‰“å°ä¿¡æ¯ï¼šdmesg\n\n- å†…æ ¸logç¼“å†²åŒºå¤§å°æœ‰é™åˆ¶ï¼Œç¼“å†²åŒºæ•°æ®å¯èƒ½è¢«å†²æ‰\n\n### æºç å±•ç¤º\n\n```c\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/module.h>\nstatic int __init hello_init(void){\nÂ  Â  printk(KERN_EMERG\"[KERN_EMERG]Hello Kernel!\\n\");\nÂ  Â  printk(\"[DEFAULT]Hello Kernel!\\n\");\nÂ  Â  return 0;\n}\n\nstatic void __exit hello_exit(void){\nÂ  Â  printk(\"[DEFAULT]Goodbye Kernel!\\n\");\n}\n\nmodule_init(hello_init);\nmodule_exit(hello_exit);\n\nMODULE_LICENSE(\"MIT\");\nMODULE_AUTHOR(\"gdm\");\nMODULE_DESCRIPTION(\"print: hello kernel\");\nMODULE_ALIAS(\"test_module\");\n```\n\n### Makefileåˆ†æ\n\n```makefile\n# å®šä¹‰å†…æ ¸è·¯å¾„\nKERNEL_DIR:=/home/debian/linux/driver_learning/ebf_linux_kernel_6ull_depth1/build_image/build\n# å®šä¹‰ç¼–è¯‘å·¥å…·é›†\nARCH:=arm\nCROSS_COMPILE:=arm-linux-gnueabihf-\n# å°†å˜é‡å¯¼å‡ºï¼Œç›¸å½“äºä½œä¸ºç¯å¢ƒå˜é‡ï¼Œè®©å†…æ ¸Makefileç»§æ‰¿æ­¤å˜é‡ å¦åˆ™å˜é‡åªåœ¨å½“å‰æ–‡ä»¶å¯è§ã€‚\nexport ARCH CROSS_COMPILE\n# å†…æ ¸æ¨¡å—ç¼–è¯‘çš„æ ‡å‡†å˜é‡ï¼Œå‘Šè¯‰å†…æ ¸ç¼–è¯‘å“ªä¸ªæ¨¡å—ã€‚\nobj-m:=hellokernal.o\n# -C å‘½ä»¤æŒ‡åˆ‡æ¢åˆ°ç›®æ ‡ç›®å½•çš„makefile\n# M= å¯ä»¥ç†è§£ä¸ºmoduleï¼ŒæŒ‡å®šæ¨¡å—æ‰€åœ¨è·¯å¾„\n# modules æ˜¯å†…æ ¸makefileå®šä¹‰çš„ç›®æ ‡ï¼Œè§¦å‘â€œæ„å»ºå¤–éƒ¨æ¨¡å—â€å®Œæ•´è§„åˆ™\nall:\nÂ  Â  $(MAKE) -C $(KERNEL_DIR) M=$(CURDIR) moudules\n.PHONY:clean\nclean:\nÂ  Â  $(MAKE) -C $(KERNEL_DIR) M=$(CURDIR) clean\n```\n\n- `KERNEL_DIR`ï¼šæŒ‡å‘linuxå†…æ ¸å…·ä½“è·¯å¾„\n- `export`ï¼šå¯¼å‡ºå˜é‡ç»™å­Makefileä½¿ç”¨ \n- `obj-m` := <æ¨¡å—å>.oï¼šå®šä¹‰è¦ç”Ÿæˆçš„æ¨¡å—\n- `$(MAKE)`ï¼šMakefileçš„é»˜è®¤å˜é‡ï¼Œå€¼ä¸ºmake\n- `é€‰é¡¹â€-Câ€`ï¼šè®©makeå·¥å…·è·³è½¬åˆ°linuxå†…æ ¸ç›®å½•ä¸‹è¯»å–é¡¶å±‚Makefile\n- `M=`ï¼šè¡¨ç¤ºå†…æ ¸æ¨¡å—æºç ç›®å½•\n- `$(CURDIR)`ï¼šMakefileé»˜è®¤å˜é‡ï¼Œå€¼ä¸ºå½“å‰ç›®å½•æ‰€åœ¨è·¯å¾„\n- `make modules`ï¼šæ‰§è¡ŒLinuxé¡¶å±‚Makefileçš„ä¼ªç›®æ ‡ï¼Œå®ƒå®ç°å†…æ ¸æ¨¡å—çš„æºç è¯»å–å¹¶ç¼–è¯‘ä¸º.koæ–‡ä»¶\n\n### ç¼–è¯‘å†…æ ¸æ¨¡å—\n\n```\nmake\n```\n\n### å¼€å‘æ¿åŠ è½½å†…æ ¸æ¨¡å—\n\n```\ninsmod xxx.ko\n```\n\n\n","tags":["å†…æ ¸","å†…æ ¸ç¼–ç¨‹"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"WSL-Archlinuxå®‰è£…ååº”è¯¥åšä»€ä¹ˆï¼Ÿ","url":"/posts/17327/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n- [1. åœ¨WSLä¸Šå®‰è£…Archlinux](#1-åœ¨wslä¸Šå®‰è£…archlinux)\n- [2. æ›´æ–°ç³»ç»Ÿ](#2-æ›´æ–°ç³»ç»Ÿ)\n- [3. åŸºç¡€é…ç½®](#3-åŸºç¡€é…ç½®)\n  - [3.1. è®¾ç½®rootå¯†ç ](#31-è®¾ç½®rootå¯†ç )\n  - [3.2. åˆ›å»ºæ™®é€šç”¨æˆ·å¹¶åŠ å…¥ `wheel` ç»„ï¼ˆæ–¹ä¾¿åç»­ sudo æƒé™ï¼‰ï¼š](#32-åˆ›å»ºæ™®é€šç”¨æˆ·å¹¶åŠ å…¥-wheel-ç»„æ–¹ä¾¿åç»­-sudo-æƒé™)\n  - [3.3. ç¼–è¾‘ sudo æƒé™](#33-ç¼–è¾‘-sudo-æƒé™)\n  - [3.4. è®¾å®šé»˜è®¤ç”¨æˆ·](#34-è®¾å®šé»˜è®¤ç”¨æˆ·)\n  - [3.5. è®¾ç½®è¯­è¨€å’Œåœ°åŒº](#35-è®¾ç½®è¯­è¨€å’Œåœ°åŒº)\n  - [3.6. AUR æ”¯æŒ](#36-aur-æ”¯æŒ)\n  - [3.7. å…³äºæ¢æº](#37-å…³äºæ¢æº)\n- [4. ä¸ªæ€§åŒ–è®¾ç½®](#4-ä¸ªæ€§åŒ–è®¾ç½®)\n  - [4.1. ä½¿ç”¨zshæ›¿ä»£bash](#41-ä½¿ç”¨zshæ›¿ä»£bash)\n  - [4.2. ä½¿ç”¨oh-my-zshä¸ºzshæä¾›æ’ä»¶æœåŠ¡](#42-ä½¿ç”¨oh-my-zshä¸ºzshæä¾›æ’ä»¶æœåŠ¡)\n  - [4.3. ä½¿ç”¨oh-my-poshä¸ºzshæä¾›ä¸»é¢˜](#43-ä½¿ç”¨oh-my-poshä¸ºzshæä¾›ä¸»é¢˜)\n\n\n## 1. åœ¨WSLä¸Šå®‰è£…Archlinux\n\nè¯·å‚è§â€”â€” [åœ¨ WSL ä¸Šå®‰è£… Arch Linux - Arch Linux ä¸­æ–‡ç»´åŸº](https://wiki.archlinuxcn.org/wiki/%E5%9C%A8_WSL_%E4%B8%8A%E5%AE%89%E8%A3%85_Arch_Linux)\n\n## 2. æ›´æ–°ç³»ç»Ÿ\n\n```bash\nsudo pacman -Syu\n```\n## 3. åŸºç¡€é…ç½®\n\n### 3.1. è®¾ç½®rootå¯†ç \n```bash\npasswd\n```\n\n### 3.2. åˆ›å»ºæ™®é€šç”¨æˆ·å¹¶åŠ å…¥ `wheel` ç»„ï¼ˆæ–¹ä¾¿åç»­ sudo æƒé™ï¼‰ï¼š\n```bash\nuseradd -m -G wheel -s /bin/bash yourname\npasswd yourname\n```\n\n`-m`ï¼šè‡ªåŠ¨åˆ›å»ºç”¨æˆ·ç›®å½•\n`-G`ï¼šæŒ‡å®šç”¨æˆ·ç»„\n`-s`ï¼šæŒ‡å®šshell\n\n### 3.3. ç¼–è¾‘ sudo æƒé™\nå®‰è£… `sudo`ï¼Œå†å¯ç”¨ `wheel` ç»„ï¼š\n```bash\npacman -S sudo nano\n```\n\n```bash\nnano /etc/sudoers\n```\n\nå»æ‰ `# %wheel ALL=(ALL:ALL) ALL` å‰çš„æ³¨é‡Š\n\n>å‰é¢å¸¦%(å¦‚%wheel)åˆ™è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç”¨æˆ·ç»„ï¼Œä¸å¸¦åˆ™è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç”¨æˆ·ã€‚\n\n\n### 3.4. è®¾å®šé»˜è®¤ç”¨æˆ·\nä¸èƒ½æ€»æ˜¯ç”¨rootç”¨æˆ·ç™»å½•ã€‚\né¦–å…ˆç¡®ä¿è¯¥ç”¨æˆ·å·²è¢«åˆ›å»ºï¼Œç„¶åå°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°Â `/etc/wsl.conf`ï¼š\n\n```\n[user]\ndefault=username\n```\n\n### 3.5. è®¾ç½®è¯­è¨€å’Œåœ°åŒº\nç›®çš„æ˜¯æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡å­—ç¬¦\n```bash\nlocale-gen\necho \"LANG=en_US.UTF-8\" > /etc/locale.conf\n```\n\nè¯·å‚è§â€”â€”[ç®€ä½“ä¸­æ–‡æœ¬åœ°åŒ– - Arch Linux ä¸­æ–‡ç»´åŸº](https://wiki.archlinuxcn.org/wiki/%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%E6%9C%AC%E5%9C%B0%E5%8C%96)\n\n### 3.6. AUR æ”¯æŒ\nå¯ä»¥ä¸‹è½½æ¥è‡ªç¤¾åŒºçš„è½¯ä»¶åŒ…ï¼Œè¿™é‡Œé€‰ç”¨AURåŠ©æ‰‹ yay\né€‰æ‹©ä¸€ä¸ªæŒ‡å®šç›®å½•ç„¶åæ‰§è¡Œï¼š\n```bash\npacman -S git base-devel --needed  #<-è¿™æ˜¯åŸºæœ¬çš„å¼€å‘å·¥å…·åŒ…ï¼Œå¦‚gccã€make\ngit clone https://aur.archlinux.org/yay-bin.git\ncd yay-bin\nmakepkg -si # æ„å»ºåŒ…\n```\n`-s`ï¼šè‡ªåŠ¨å®‰è£…ä¾èµ–\n`-i`ï¼šç¼–è¯‘å®Œæˆåè‡ªåŠ¨å®‰è£…ç”Ÿæˆçš„åŒ…\n\nè¯·å‚è§â€”â€”[yay - Arch Linux ä¸­æ–‡ç»´åŸº](https://wiki.archlinuxcn.org/wiki/Yay)\n\n### 3.7. å…³äºæ¢æº\n\næ‰“å¼€`WSL-setting`ï¼ˆç›´æ¥åœ¨win11é‡Œæœç´¢ï¼‰çš„ç½‘ç»œè®¾ç½®ï¼Œå°†ç½‘ç»œæ¨¡å¼ç”±`NAT` æ”¹ä¸º `mirror`ï¼Œ åˆ™å¯ç›´æ¥ç»§æ‰¿å®¿ä¸»æœºçš„ç½‘ç»œç¯å¢ƒã€‚åœ¨å®¿ä¸»æœºä½¿ç”¨ç½‘ç»œå®‰å…¨å·¥å…·å³å¯ï¼Œå› æ­¤æš‚æ—¶æ²¡æœ‰æ¢æºã€‚\n\n## 4. ä¸ªæ€§åŒ–è®¾ç½®\n\n### 4.1. ä½¿ç”¨zshæ›¿ä»£bash\n\n```bash\nsudo pacman -S zsh\nchsh -s /bin/zsh # æ”¹å˜é»˜è®¤shell\n```\n\n### 4.2. ä½¿ç”¨oh-my-zshä¸ºzshæä¾›æ’ä»¶æœåŠ¡\n```bash\nyay -S oh-my-zsh.git\n```\n\nå®‰è£…å®Œæˆå å¯ä»¥åœ¨ `/usr/share/oh-my-zsh` ä¸­æŸ¥çœ‹ä¸»é¢˜æ–‡ä»¶å’Œæ’ä»¶ä»¥åŠå…¶æä¾›çš„`zshrc`é…ç½®æ¨¡æ¿ï¼Œç›´æ¥ä½¿ç”¨é…ç½®æ¨¡æ¿ã€‚\n```bash\ncp /usr/share/oh-my-zsh/zshrc ~/.zshrc\n```\n\nè¿›å…¥`/usr/share/oh-my-zsh\\plugins`ç›®å½• å®‰è£…è‡ªåŠ¨è¡¥å…¨ä¸è¯­æ³•é«˜äº®æ’ä»¶ï¼ˆä¸è‡ªå¸¦ï¼‰\n```bash\ngit clone https://github.com/zsh-users/zsh-autosuggestions\n```\n\n```bash\ngit clone https://github.com/zsh-users/zsh-syntax-highlighting.git\n```\n\nåœ¨ `.zshrc` é‡Œæ·»åŠ ï¼š\n```\nplugins=(git zsh-autosuggestions zsh-syntax-highlighting)\n```\n\n### 4.3. ä½¿ç”¨oh-my-poshä¸ºzshæä¾›ä¸»é¢˜\nä½ ä¹Ÿå¯ä»¥ä½¿ç”¨`oh-my-zsh`çš„ä¸»é¢˜ï¼Œåªä¸è¿‡æˆ‘æ›´å–œæ¬¢`oh-my-posh`çš„ä¸»é¢˜\n\n```bash\nyay -S oh-my-posh-bin\n```\n\nåŒæ ·ï¼Œå®‰è£…å®Œæˆå å¯ä»¥åœ¨ `/usr/share/oh-my-posh` ä¸­æŸ¥çœ‹ä¸»é¢˜æ–‡ä»¶ï¼Œ\nç¼–è¾‘`~/.zshrc`ï¼š\n```bash\n#æ³¨é‡Šæ‰ZSH_THEME=\"robbyrussell\"\neval \"$(oh-my-posh init zsh --config 'amro')\"\n```\n\n\n> å»ºè®®ä¸è¦ä½¿ç”¨ç±»ä¼¼äº `--config ~/.poshthemes/mytheme.omp.json`çš„é€‰é¡¹ï¼Œè¿™å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚\n\n\né‡æ–°åŠ è½½ï¼š\n```bash\nsource ~/.zshrc\n```\n\n","tags":["WSL2","ArchLinux"],"categories":["Linux","è®°å½•"]},{"title":"POSIX IPCï¼šSystem V çš„ç»§ä»»è€…","url":"/posts/26506/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n- [1. POSIX IPCï¼šSystem V çš„ç»§ä»»è€…](#1-posix-ipcsystem-v-çš„ç»§ä»»è€…)\n  - [1.1. POSIX æ¶ˆæ¯é˜Ÿåˆ—](#11-posix-æ¶ˆæ¯é˜Ÿåˆ—)\n    - [1.1.1. æ¶ˆæ¯é˜Ÿåˆ—å±æ€§](#111-æ¶ˆæ¯é˜Ÿåˆ—å±æ€§)\n  - [1.2. POSIX ä¿¡å·é‡](#12-posix-ä¿¡å·é‡)\n  - [1.3. POSIX å…±äº«å†…å­˜](#13-posix-å…±äº«å†…å­˜)\n\n\n## 1. POSIX IPCï¼šSystem V çš„ç»§ä»»è€…\n\n**POSIX IPC**ï¼ˆPortable Operating System Interfaceï¼‰æ˜¯ä¸€å¥—æ–°çš„ IPC æ ‡å‡†ï¼Œæ—¨åœ¨è§£å†³ **System V IPC** çš„ä¸€äº›å±€é™æ€§ã€‚å®ƒæä¾›äº†ä¸€å¥—æ›´ç»Ÿä¸€ã€æ›´ç°ä»£çš„ APIï¼Œä½¿ç”¨**æ–‡ä»¶å**ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œè€Œä¸æ˜¯ System V çš„**é”®å€¼**ï¼Œè¿™ä½¿å¾— IPC èµ„æºçš„ç®¡ç†æ›´åŠ ç›´è§‚ã€‚\n\n### 1.1. POSIX æ¶ˆæ¯é˜Ÿåˆ—\n\nä¸ System V æ¶ˆæ¯é˜Ÿåˆ—ç±»ä¼¼ï¼Œä½† API æ›´ç®€æ´ã€‚\n\n- **ç‰¹ç‚¹**ï¼š\n\n    - **åŸºäºæ–‡ä»¶**ï¼šé€šè¿‡ `/dev/mqueue` ç›®å½•ä¸‹çš„æ–‡ä»¶åæ¥æ ‡è¯†ã€‚\n\n    - **ä¼˜å…ˆçº§**ï¼šæ”¯æŒæ¶ˆæ¯ä¼˜å…ˆçº§ï¼Œé«˜ä¼˜å…ˆçº§çš„æ¶ˆæ¯ä¼šè¢«ä¼˜å…ˆå¤„ç†ã€‚\n\n    - **éé˜»å¡æ¨¡å¼**ï¼šå¯ä»¥è®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—ä¸ºéé˜»å¡æ¨¡å¼ï¼Œé˜²æ­¢ `mq_send` æˆ– `mq_receive` é˜»å¡è¿›ç¨‹ã€‚\n\n- **ä½¿ç”¨**ï¼š\n\n    - **`mq_open()`**ï¼šåˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\n    - **`mq_send()`**ï¼šå‘é€æ¶ˆæ¯ã€‚\n\n    - **`mq_receive()`**ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚\n\n    - **`mq_close()`**ï¼šå…³é—­æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\n    - **`mq_unlink()`**ï¼šåˆ é™¤æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\n#### 1.1.1. æ¶ˆæ¯é˜Ÿåˆ—å±æ€§\n\nåœ¨POSIXæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œ**æ¶ˆæ¯é˜Ÿåˆ—å±æ€§**ï¼ˆ`mq_attr`ï¼‰æ˜¯ç”¨æ¥è®¾ç½®å’Œè·å–æ¶ˆæ¯é˜Ÿåˆ—çš„ç‰¹æ€§å’Œå‚æ•°çš„ç»“æ„ä½“ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯æ§åˆ¶æ¶ˆæ¯é˜Ÿåˆ—çš„è¡Œä¸ºï¼Œä¾‹å¦‚æœ€å¤§æ¶ˆæ¯æ•°ã€æ¶ˆæ¯å¤§å°ç­‰ã€‚`mq_attr`ç»“æ„ä½“åŒ…å«äº†ä»¥ä¸‹å‡ ä¸ªå­—æ®µï¼š\n```c\nstruct mq_attr {\n    long    mq_flags;      // æ¶ˆæ¯é˜Ÿåˆ—çš„æ ‡å¿—\n    long    mq_maxmsg;     // æ¶ˆæ¯é˜Ÿåˆ—ä¸­æœ€å¤šå¯ä»¥å®¹çº³çš„æ¶ˆæ¯æ•°é‡\n    long    mq_msgsize;    // é˜Ÿåˆ—ä¸­æ¯æ¡æ¶ˆæ¯çš„æœ€å¤§å¤§å°\n    long    mq_curmsgs;    // å½“å‰é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ•°\n};\n```\n\n1. `mq_flags`\n\n\tè¿™ä¸ªå­—æ®µç”¨äºè®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—çš„æ ‡å¿—ã€‚å¸¸è§çš„æ ‡å¿—æœ‰ï¼š\n\t\n\t- **`O_NONBLOCK`**ï¼šä»¥éé˜»å¡æ¨¡å¼æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—ã€‚è¿™æ„å‘³ç€å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—ä¸ºç©ºï¼Œæ¥æ”¶æ“ä½œï¼ˆ`mq_receive()`ï¼‰ä¼šç«‹å³è¿”å›ï¼Œè€Œä¸æ˜¯é˜»å¡ç­‰å¾…ã€‚\n\t\n\t- **`O_RDWR`**ï¼šå…è®¸å¯¹æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œè¯»å†™æ“ä½œã€‚\n\t\n\tå¦‚æœæ²¡æœ‰è®¾ç½®è¿™äº›æ ‡å¿—ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°†ä¼šé»˜è®¤é˜»å¡æ¨¡å¼æ“ä½œã€‚\n\n2. `mq_maxmsg`\n\n\tè¿™ä¸ªå­—æ®µå®šä¹‰äº†æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥å®¹çº³çš„æœ€å¤§æ¶ˆæ¯æ•°é‡ã€‚å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—å·²ç»å­˜æ»¡ï¼Œä¸”æ²¡æœ‰ç©ºé—´å®¹çº³æ–°çš„æ¶ˆæ¯ï¼Œåç»­çš„æ¶ˆæ¯å‘é€ï¼ˆ`mq_send()`ï¼‰å°†ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰è¶³å¤Ÿçš„ç©ºé—´ã€‚è¿™ä¸ªå±æ€§é€šå¸¸è®¾ç½®ä¸ºä½ å¸Œæœ›æ¶ˆæ¯é˜Ÿåˆ—ä¸­èƒ½å­˜å‚¨çš„æ¶ˆæ¯ä¸ªæ•°ã€‚\n\n3. `mq_msgsize`\n\n\tæ­¤å­—æ®µå®šä¹‰æ¯æ¡æ¶ˆæ¯çš„æœ€å¤§å­—èŠ‚æ•°ã€‚åœ¨åˆ›å»ºæ¶ˆæ¯é˜Ÿåˆ—æ—¶ï¼Œå¿…é¡»ç¡®ä¿æ¶ˆæ¯å‘é€å’Œæ¥æ”¶æ“ä½œçš„æ¶ˆæ¯å¤§å°ä¸ä¼šè¶…è¿‡è¿™ä¸ªå€¼ã€‚å¦‚æœæ¶ˆæ¯è¶…è¿‡äº†è¿™ä¸ªå¤§å°ï¼Œå‘é€æ“ä½œå°†è¿”å›é”™è¯¯ã€‚\n\n4. `mq_curmsgs`\n\n\tè¿™ä¸ªå­—æ®µæ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼Œç”¨äºè·å–å½“å‰é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ•°é‡ã€‚å®ƒæ˜¯ä¸€ä¸ªåŠ¨æ€æ›´æ–°çš„å€¼ï¼Œæ¯æ¬¡è¯»å–æ—¶ä¼šè¿”å›å½“å‰æ¶ˆæ¯é˜Ÿåˆ—ä¸­å®é™…å­˜å‚¨çš„æ¶ˆæ¯æ•°ã€‚è¿™ä¸ªå­—æ®µå¯¹åº”ç”¨ç¨‹åºæ¥è¯´å¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦äº†è§£é˜Ÿåˆ—å½“å‰çŠ¶æ€çš„åœºæ™¯ã€‚\n\nè¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸¤ä¸ªä¸ç›¸å…³çš„è¿›ç¨‹å¦‚ä½•é€šè¿‡ POSIX æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ã€‚\nå‘é€æ–¹(sender.c)ï¼š\n```c\n#include <stdio.h>\n#include <stdlib.h>          /* åŠ¨æ€å†…å­˜ç®¡ç†åŠå…¶ä»–è¾…åŠ©åŠŸèƒ½å¦‚exitã€abort */\n#include <string.h>\n#include <fcntl.h>           /* æä¾› O_CREAT, O_RDWR ç”¨äºæ–‡ä»¶æ§åˆ¶ */\n#include <sys/stat.h>        /* æ–‡ä»¶å±æ€§æ“ä½œ å¦‚chmodã€umask */\n#include <mqueue.h>          /* æä¾›POSIXæ¶ˆæ¯é˜Ÿåˆ—æ”¯æŒ */\n#include <unistd.h>          /* æä¾›POSIXæ¥å£ */\n\n#define MQ_NAME \"/my_mq\"\n\nint main() {\n    mqd_t mqd;\n    struct mq_attr attr;\n    char buffer[256];\n    const char *msg = \"Hello from sender!\";\n\n    // è®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—å±æ€§\n    attr.mq_flags = 0;\n    attr.mq_maxmsg = 10;\n    attr.mq_msgsize = 256;\n    attr.mq_curmsgs = 0;\n\n    // åˆ›å»ºæˆ–æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—\n    mqd = mq_open(MQ_NAME, O_CREAT | O_WRONLY, 0666, &attr);\n    if (mqd == (mqd_t)-1) {\n        perror(\"mq_open\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Sender: Sending message...\\n\");\n\n    // å‘é€æ¶ˆæ¯ï¼Œä¼˜å…ˆçº§ä¸º1\n    if (mq_send(mqd, msg, strlen(msg) + 1, 1) == -1) {\n        perror(\"mq_send\");\n        exit(EXIT_FAILURE);\n    }\n\n    // å…³é—­æ¶ˆæ¯é˜Ÿåˆ—æè¿°ç¬¦\n    mq_close(mqd);\n\n    printf(\"Sender: Message sent and mq closed.\\n\");\n    return 0;\n}\n```\n\næ¥æ”¶æ–¹(receiver.c)ï¼š\n```c\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <mqueue.h>\n#include <unistd.h>\n\n#define MQ_NAME \"/my_mq\"\n\nint main() {\n    mqd_t mqd;\n    struct mq_attr attr;\n    char buffer[256 + 1];\n    unsigned int prio;\n\n    // æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—\n    mqd = mq_open(MQ_NAME, O_RDONLY);\n    if (mqd == (mqd_t)-1) {\n        perror(\"mq_open\");\n        exit(EXIT_FAILURE);\n    }\n\n    // è·å–æ¶ˆæ¯é˜Ÿåˆ—å±æ€§\n    mq_getattr(mqd, &attr);\n\n    printf(\"Receiver: Waiting for message...\\n\");\n\n    // æ¥æ”¶æ¶ˆæ¯\n    if (mq_receive(mqd, buffer, attr.mq_msgsize, &prio) == -1) {\n        perror(\"mq_receive\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Receiver: Received message: %s (Priority: %u)\\n\", buffer, prio);\n\n    // å…³é—­å’Œåˆ é™¤æ¶ˆæ¯é˜Ÿåˆ—\n    mq_close(mqd);\n    mq_unlink(MQ_NAME);\n\n    return 0;\n}\n```\n\n**ç¼–è¯‘å’Œè¿è¡Œ**ï¼š `gcc sender.c -o sender -lrt` `gcc receiver.c -o receiver -lrt` ï¼ˆéœ€è¦é“¾æ¥å®æ—¶åº“ `-lrt`ï¼‰ å…ˆè¿è¡Œ `./sender`ï¼Œå†è¿è¡Œ `./receiver`ã€‚\n\n### 1.2. POSIX ä¿¡å·é‡\n\nç”¨äºè¿›ç¨‹é—´çš„åŒæ­¥ï¼ŒåŠŸèƒ½ä¸ System V ä¿¡å·é‡ç±»ä¼¼ï¼Œä½†æä¾›äº†æ›´ç®€å•çš„æ¥å£ã€‚\n\n- **ç‰¹ç‚¹**ï¼š\n\n    - **æœ‰åä¿¡å·é‡**ï¼šé€šè¿‡ä¸€ä¸ªæ–‡ä»¶åæ ‡è¯†ï¼Œå¯ä»¥ç”¨äºéäº²ç¼˜è¿›ç¨‹ã€‚\n\n    - **æ— åä¿¡å·é‡**ï¼šå¸¸ç”¨äºçº¿ç¨‹é—´çš„åŒæ­¥ï¼Œå­˜æ”¾åœ¨å…±äº«å†…å­˜ä¸­ï¼Œåªèƒ½ç”¨äºæœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ã€‚\n\n- **ä½¿ç”¨**ï¼š\n\n    - **`sem_open()`**ï¼šåˆ›å»ºæˆ–æ‰“å¼€æœ‰åä¿¡å·é‡ã€‚\n\n    - **`sem_wait()`**ï¼šåŸå­æ€§åœ°å‡å°‘ä¿¡å·é‡è®¡æ•°å™¨ï¼Œå¦‚æœä¸º0åˆ™é˜»å¡ã€‚\n\n    - **`sem_post()`**ï¼šåŸå­æ€§åœ°å¢åŠ ä¿¡å·é‡è®¡æ•°å™¨ã€‚\n\n    - **`sem_close()`**ï¼šå…³é—­ä¿¡å·é‡ã€‚\n\n    - **`sem_unlink()`**ï¼šåˆ é™¤ä¿¡å·é‡ã€‚\n\nè¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ POSIX ä¿¡å·é‡æ¥åŒæ­¥ä¸¤ä¸ªè¿›ç¨‹å¯¹ä¸€ä¸ªå…±äº«èµ„æºçš„è®¿é—®ã€‚\n\nå…±äº«èµ„æºè®¿é—®ç¨‹åº (sem_client.c)ï¼š\n```c\n#include <stdio.h>\n#include <stdlib.h>\n#include <fcntl.h>           /* For O_CREAT, O_RDWR */\n#include <sys/stat.h>        /* For mode constants */\n#include <semaphore.h>\n#include <unistd.h>\n\n#define SEM_NAME \"/my_semaphore\"\n\nint main() {\n    sem_t *sem;\n    int value;\n\n    // æ‰“å¼€ä¿¡å·é‡\n    sem = sem_open(SEM_NAME, 0); // O_CREAT is not needed here\n    if (sem == SEM_FAILED) {\n        perror(\"sem_open\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Client: Waiting to get semaphore...\\n\");\n\n    // P æ“ä½œï¼šç­‰å¾…ä¿¡å·é‡ï¼Œå¦‚æœå€¼ä¸º0åˆ™é˜»å¡\n    if (sem_wait(sem) == -1) {\n        perror(\"sem_wait\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Client: Got the semaphore. Accessing shared resource...\\n\");\n    sleep(2); // æ¨¡æ‹Ÿè®¿é—®å…±äº«èµ„æº\n\n    printf(\"Client: Finished. Releasing semaphore...\\n\");\n\n    // V æ“ä½œï¼šé‡Šæ”¾ä¿¡å·é‡ï¼Œè®¡æ•°å™¨åŠ 1\n    if (sem_post(sem) == -1) {\n        perror(\"sem_post\");\n        exit(EXIT_FAILURE);\n    }\n\n    // å…³é—­ä¿¡å·é‡\n    sem_close(sem);\n\n    return 0;\n}\n```\n\nä¿¡å·é‡æ§åˆ¶ç¨‹åº (sem_main.c)ï¼š`\n```c\n#include <stdio.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <semaphore.h>\n#include <unistd.h>\n#include <sys/wait.h>\n\n#define SEM_NAME \"/my_semaphore\"\n\nint main() {\n    sem_t *sem;\n    pid_t pid;\n\n    // åˆ›å»ºå¹¶åˆå§‹åŒ–ä¿¡å·é‡ï¼Œåˆå§‹å€¼ä¸º1\n    sem = sem_open(SEM_NAME, O_CREAT, 0666, 1);\n    if (sem == SEM_FAILED) {\n        perror(\"sem_open\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Main: Semaphore created and initialized to 1.\\n\");\n\n    // åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹\n    pid = fork();\n    if (pid == 0) {\n        // å­è¿›ç¨‹è¿è¡Œå¦ä¸€ä¸ªç¨‹åºæ¥è®¿é—®ä¿¡å·é‡\n        execlp(\"./sem_client\", \"sem_client\", NULL);\n        perror(\"execlp\"); // å¦‚æœæ‰§è¡Œå¤±è´¥\n        exit(EXIT_FAILURE);\n    } else if (pid > 0) {\n        // çˆ¶è¿›ç¨‹ä¹Ÿå°è¯•è®¿é—®ä¿¡å·é‡\n        sleep(1); // ç¡®ä¿å­è¿›ç¨‹å…ˆè¿è¡Œ\n        printf(\"Main: Waiting to get semaphore...\\n\");\n        sem_wait(sem);\n        printf(\"Main: Got the semaphore. Accessing shared resource...\\n\");\n        sleep(2);\n        printf(\"Main: Finished. Releasing semaphore...\\n\");\n        sem_post(sem);\n\n        wait(NULL); // ç­‰å¾…å­è¿›ç¨‹ç»“æŸ\n\n        // åˆ é™¤ä¿¡å·é‡\n        sem_unlink(SEM_NAME);\n        printf(\"Main: Child process finished. Semaphore unlinked.\\n\");\n    }\n\n    // å…³é—­ä¿¡å·é‡\n    sem_close(sem);\n\n    return 0;\n}\n```\n\n**ç¼–è¯‘å’Œè¿è¡Œ**ï¼š `gcc sem_client.c -o sem_client -lrt` `gcc sem_main.c -o sem_main -lrt` ï¼ˆåŒæ ·éœ€è¦é“¾æ¥å®æ—¶åº“ `-lrt`ï¼‰ è¿è¡Œ `./sem_main`ã€‚\n\n\n\n### 1.3. POSIX å…±äº«å†…å­˜\n\nå’Œ System V å…±äº«å†…å­˜ä¸€æ ·ï¼Œéƒ½æ˜¯æœ€å¿«çš„ IPC æ–¹å¼ï¼Œä½† POSIX ç‰ˆæœ¬ä½¿ç”¨äº†æ–‡ä»¶æè¿°ç¬¦ã€‚\n\n- **ç‰¹ç‚¹**ï¼š\n\n    - **åŸºäºæ–‡ä»¶**ï¼šé€šè¿‡ `shm_open` åˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªå…±äº«å†…å­˜å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚\n\n    - **å†…å­˜æ˜ å°„**ï¼šé€šè¿‡ `mmap()` å°†æ–‡ä»¶æè¿°ç¬¦å¯¹åº”çš„å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚\n\n- **ä½¿ç”¨**ï¼š\n\n    - **`shm_open()`**ï¼šåˆ›å»ºæˆ–æ‰“å¼€å…±äº«å†…å­˜å¯¹è±¡ã€‚\n\n    - **`ftruncate()`**ï¼šè°ƒæ•´å…±äº«å†…å­˜å¯¹è±¡çš„å¤§å°ã€‚\n\n    - **`mmap()`**ï¼šå°†å…±äº«å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´ã€‚\n\n    - **`munmap()`**ï¼šè§£é™¤æ˜ å°„ã€‚\n\n    - **`shm_unlink()`**ï¼šåˆ é™¤å…±äº«å†…å­˜å¯¹è±¡ã€‚\n\nè¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸¤ä¸ªè¿›ç¨‹å¦‚ä½•é€šè¿‡ POSIX å…±äº«å†…å­˜æ¥å…±äº«ä¸€å—å†…å­˜åŒºåŸŸï¼Œå¹¶ç”¨ä¸€ä¸ªä¿¡å·é‡æ¥åŒæ­¥ã€‚\n\nå†™å…¥æ–¹ (shm_writer.c)\n```c\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <semaphore.h>\n#include <unistd.h>\n\n#define SHM_NAME \"/my_shm\"\n#define SEM_NAME \"/my_shm_sem\"\n#define SHM_SIZE 4096\n\nint main() {\n    int shm_fd;\n    void *ptr;\n    sem_t *sem;\n    const char *msg = \"Hello from shm writer!\";\n\n    // åˆ›å»º/æ‰“å¼€å…±äº«å†…å­˜å¯¹è±¡\n    shm_fd = shm_open(SHM_NAME, O_CREAT | O_RDWR, 0666);\n    if (shm_fd == -1) {\n        perror(\"shm_open\");\n        exit(EXIT_FAILURE);\n    }\n\n    // è®¾ç½®å…±äº«å†…å­˜å¤§å°\n    ftruncate(shm_fd, SHM_SIZE);\n\n    // å°†å…±äº«å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´\n    ptr = mmap(0, SHM_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, shm_fd, 0);\n    if (ptr == MAP_FAILED) {\n        perror(\"mmap\");\n        exit(EXIT_FAILURE);\n    }\n\n    // åˆ›å»º/æ‰“å¼€ä¿¡å·é‡ï¼Œç”¨äºåŒæ­¥\n    sem = sem_open(SEM_NAME, O_CREAT, 0666, 0); // åˆå§‹å€¼ä¸º0ï¼Œè¡¨ç¤ºä¸å¯è®¿é—®\n    if (sem == SEM_FAILED) {\n        perror(\"sem_open\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Writer: Writing to shared memory...\\n\");\n    // å†™å…¥æ•°æ®\n    sprintf(ptr, \"%s\", msg);\n\n    // V æ“ä½œï¼šé‡Šæ”¾ä¿¡å·é‡ï¼Œé€šçŸ¥è¯»è€…å¯ä»¥è¯»å–äº†\n    sem_post(sem);\n    printf(\"Writer: Data written and semaphore posted.\\n\");\n\n    // å…³é—­\n    sem_close(sem);\n    munmap(ptr, SHM_SIZE);\n    close(shm_fd);\n\n    return 0;\n}\n```\n\nè¯»å–æ–¹ (shm_reader.c)ï¼š\n```c\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <semaphore.h>\n#include <unistd.h>\n\n#define SHM_NAME \"/my_shm\"\n#define SEM_NAME \"/my_shm_sem\"\n#define SHM_SIZE 4096\n\nint main() {\n    int shm_fd;\n    void *ptr;\n    sem_t *sem;\n\n    // æ‰“å¼€å…±äº«å†…å­˜å¯¹è±¡\n    shm_fd = shm_open(SHM_NAME, O_RDONLY, 0666);\n    if (shm_fd == -1) {\n        perror(\"shm_open\");\n        exit(EXIT_FAILURE);\n    }\n\n    // å°†å…±äº«å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´\n    ptr = mmap(0, SHM_SIZE, PROT_READ, MAP_SHARED, shm_fd, 0);\n    if (ptr == MAP_FAILED) {\n        perror(\"mmap\");\n        exit(EXIT_FAILURE);\n    }\n\n    // æ‰“å¼€ä¿¡å·é‡\n    sem = sem_open(SEM_NAME, 0);\n    if (sem == SEM_FAILED) {\n        perror(\"sem_open\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Reader: Waiting for writer...\\n\");\n    // P æ“ä½œï¼šç­‰å¾…ä¿¡å·é‡ï¼Œç›´åˆ°æœ‰æ•°æ®å¯ç”¨\n    sem_wait(sem);\n\n    printf(\"Reader: Data received: %s\\n\", (char *)ptr);\n\n    // å…³é—­å’Œæ¸…ç†\n    sem_close(sem);\n    sem_unlink(SEM_NAME); // åˆ é™¤ä¿¡å·é‡\n    munmap(ptr, SHM_SIZE);\n    close(shm_fd);\n    shm_unlink(SHM_NAME); // åˆ é™¤å…±äº«å†…å­˜å¯¹è±¡\n\n    return 0;\n}\n```\n\n**ç¼–è¯‘å’Œè¿è¡Œ**ï¼š `gcc shm_writer.c -o shm_writer -lrt` `gcc shm_reader.c -o shm_reader -lrt` ï¼ˆåŒæ ·éœ€è¦é“¾æ¥å®æ—¶åº“ `-lrt`ï¼‰ å…ˆè¿è¡Œ `./shm_writer`ï¼Œå†è¿è¡Œ `./shm_reader`ã€‚\n\n\n\n","tags":["Linux","IPC","POSIX"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"æ·±å…¥æµ…å‡º Linux IPCï¼šè¿›ç¨‹é—´é€šä¿¡çš„è‰ºæœ¯","url":"/posts/46571/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n- [1. ä¸ºä»€ä¹ˆéœ€è¦ IPCï¼Ÿ](#1-ä¸ºä»€ä¹ˆéœ€è¦-ipc)\n- [2. å¸¸è§çš„ Linux IPC æœºåˆ¶](#2-å¸¸è§çš„-linux-ipc-æœºåˆ¶)\n  - [2.1. ç®¡é“ï¼ˆPipesï¼‰](#21-ç®¡é“pipes)\n  - [2.2. FIFOï¼ˆå‘½åç®¡é“ï¼‰](#22-fifoå‘½åç®¡é“)\n  - [2.3. ä¿¡å·](#23-ä¿¡å·)\n    - [2.3.1. ä¿¡å·çš„åˆ†ç±»](#231-ä¿¡å·çš„åˆ†ç±»)\n    - [2.3.2. ä¿¡å·ä¸ IPC çš„å…³ç³»](#232-ä¿¡å·ä¸-ipc-çš„å…³ç³»)\n    - [2.3.3. ä¿¡å·çš„ä¸‰ç§å¤„ç†æ–¹å¼](#233-ä¿¡å·çš„ä¸‰ç§å¤„ç†æ–¹å¼)\n    - [2.3.4. å¦‚ä½•ä½¿ç”¨ä¿¡å·ï¼Ÿ](#234-å¦‚ä½•ä½¿ç”¨ä¿¡å·)\n      - [2.3.4.1. å‘é€ä¿¡å·ï¼š`kill()` å‡½æ•°](#2341-å‘é€ä¿¡å·kill-å‡½æ•°)\n      - [2.3.4.2. æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°ï¼š`signal()` å’Œ `sigaction()`](#2342-æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°signal-å’Œ-sigaction)\n  - [2.4. ä¿¡å·é›†ï¼ˆSignal Setï¼‰å’Œé˜»å¡](#24-ä¿¡å·é›†signal-setå’Œé˜»å¡)\n    - [2.4.1. ä¿¡å·é›†æ“ä½œå‡½æ•°](#241-ä¿¡å·é›†æ“ä½œå‡½æ•°)\n    - [2.4.2. é˜»å¡ä¿¡å·ï¼š`sigprocmask()`](#242-é˜»å¡ä¿¡å·sigprocmask)\n  - [2.5. System V IPC (System V IPC)\\[^1\\]](#25-system-v-ipc-system-v-ipc)\n    - [2.5.1. æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queuesï¼‰](#251-æ¶ˆæ¯é˜Ÿåˆ—message-queues)\n    - [2.5.2. ä¿¡å·é‡ï¼ˆSemaphoresï¼‰](#252-ä¿¡å·é‡semaphores)\n    - [2.5.3. å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰](#253-å…±äº«å†…å­˜shared-memory)\n  - [2.6. IPC æ€»ç»“ä¸é€‰æ‹©](#26-ipc-æ€»ç»“ä¸é€‰æ‹©)\n\n\nåœ¨ Linux ä¸–ç•Œä¸­ï¼Œè¿›ç¨‹æ˜¯ç‹¬ç«‹çš„æ‰§è¡Œå•å…ƒï¼Œæ‹¥æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ã€‚ä½†å¾ˆå¤šæ—¶å€™ï¼Œä¸ºäº†å®Œæˆä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ï¼Œä¸åŒçš„è¿›ç¨‹éœ€è¦ååŒå·¥ä½œï¼Œäº¤æ¢æ•°æ®ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦**è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPC, Inter-Process Communicationï¼‰**ã€‚IPC å°±åƒæ˜¯è¿›ç¨‹ä¹‹é—´çš„ä¸€åº§æ¡¥æ¢ï¼Œè®©å®ƒä»¬èƒ½å¤Ÿç›¸äº’â€œäº¤è°ˆâ€ï¼Œå…±äº«ä¿¡æ¯ã€‚\n\næœ¬æ–‡å°†å¸¦ä½ æ·±å…¥äº†è§£ Linux ä¸­å¸¸è§çš„ IPC æœºåˆ¶ï¼Œå¹¶ä»¥**ä½¿ç”¨ä¸ºå¯¼å‘**ï¼Œç»“åˆä»£ç ç¤ºä¾‹ï¼Œè®©ä½ èƒ½å¤Ÿå¿«é€ŸæŒæ¡è¿™äº›â€œé€šä¿¡â€æŠ€æœ¯ã€‚\n\n## 1. ä¸ºä»€ä¹ˆéœ€è¦ IPCï¼Ÿ\n\næƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼šä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ã€‚ä¸€ä¸ªä¸»è¿›ç¨‹è´Ÿè´£ç›‘å¬ç½‘ç»œè¯·æ±‚ï¼Œä½†å¤„ç†è¿™äº›è¯·æ±‚éå¸¸è€—æ—¶ã€‚å¦‚æœä¸»è¿›ç¨‹è‡ªå·±å¤„ç†ï¼ŒæœåŠ¡å™¨å°±ä¼šå˜å¾—å¾ˆæ…¢ï¼Œæ— æ³•å“åº”æ–°çš„è¯·æ±‚ã€‚ä¸€ä¸ªæ›´å¥½çš„è®¾è®¡æ˜¯ï¼Œä¸»è¿›ç¨‹æ¯æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹æˆ–å°†è¯·æ±‚å‘é€ç»™ä¸€ä¸ªå·¥ä½œè¿›ç¨‹æ± æ¥å¤„ç†ã€‚è¿™æ ·ï¼Œä¸»è¿›ç¨‹å¯ä»¥ç«‹å³å›å»ç›‘å¬æ–°çš„è¿æ¥ï¼Œè€Œå·¥ä½œè¿›ç¨‹åˆ™ä¸“æ³¨äºå¤„ç†ä»»åŠ¡ã€‚\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸»è¿›ç¨‹éœ€è¦å°†è¯·æ±‚æ•°æ®ä¼ é€’ç»™å·¥ä½œè¿›ç¨‹ã€‚è¿™å°±æ˜¯ IPC å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚\n\n## 2. å¸¸è§çš„ Linux IPC æœºåˆ¶\n\nLinux æä¾›äº†å¤šç§ IPC æœºåˆ¶ï¼Œæ¯ç§éƒ½æœ‰å…¶ç‹¬ç‰¹çš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚æˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬åˆ†ä¸ºä¸¤å¤§ç±»ï¼š**åŸºäºæ–‡ä»¶**å’Œ**åŸºäºå†…å­˜**ã€‚\n\n### 2.1. ç®¡é“ï¼ˆPipesï¼‰\n\nç®¡é“å¯èƒ½æ˜¯æœ€ç®€å•ã€æœ€å¤è€çš„ IPC å½¢å¼ã€‚å®ƒå°±åƒä¸€ä¸ªå•å‘çš„â€œæ°´ç®¡â€ï¼Œä¸€ç«¯ç”¨äºå†™å…¥ï¼Œå¦ä¸€ç«¯ç”¨äºè¯»å–ã€‚\n\n- **ç‰¹ç‚¹**ï¼š\n\n    - **å•å‘é€šä¿¡**ï¼šæ•°æ®åªèƒ½ä»ä¸€ç«¯æµå‘å¦ä¸€ç«¯ã€‚\n\n    - **çˆ¶å­è¿›ç¨‹é€šä¿¡**ï¼šç®¡é“é€šå¸¸ç”¨äºæœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ä¹‹é—´ï¼Œæ¯”å¦‚çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ã€‚\n\n    - **åŠåŒå·¥**ï¼šè™½ç„¶æ˜¯å•å‘ï¼Œä½†å¦‚æœåˆ›å»ºä¸¤ä¸ªç®¡é“ï¼Œå°±å¯ä»¥å®ç°åŒå‘é€šä¿¡ã€‚\n\n- **ä½¿ç”¨**ï¼š\n\n    - **`pipe()` å‡½æ•°**ï¼šè¿™æ˜¯åˆ›å»ºç®¡é“çš„æ ¸å¿ƒå‡½æ•°ã€‚\n\n    ```c\n    #include <unistd.h>\n    int pipe(int pipefd[2]);\n    ```\n\n    `pipefd` æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„æ•°ç»„ï¼Œ`pipefd[0]` ç”¨äºè¯»å–ï¼Œ`pipefd[1]` ç”¨äºå†™å…¥ã€‚\n\n- **ä»£ç ç¤ºä¾‹**ï¼šä¸€ä¸ªç®€å•çš„çˆ¶å­è¿›ç¨‹é€šä¿¡ã€‚\n\n```c\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <sys/wait.h>\n\nint main() {\n    int pipefd[2];\n    pid_t pid;\n    char buf[20];\n    const char *msg = \"Hello from parent!\";\n\n    if (pipe(pipefd) == -1) {\n        perror(\"pipe\");\n        exit(EXIT_FAILURE);\n    }\n\n    pid = fork();\n    if (pid == -1) {\n        perror(\"fork\");\n        exit(EXIT_FAILURE);\n    }\n\n    if (pid > 0) { // çˆ¶è¿›ç¨‹\n        close(pipefd[0]); // å…³é—­è¯»å–ç«¯\n        write(pipefd[1], msg, strlen(msg) + 1);\n        close(pipefd[1]); // å…³é—­å†™å…¥ç«¯ï¼Œå¦‚æœä¸å…³ï¼Œå­è¿›ç¨‹è¯»ç«¯æ”¶ä¸åˆ°EOFä¿¡å·ï¼Œåˆ™ä¼šä¸€ç›´è¯»å¯¼è‡´ç¨‹åºé˜»å¡\n        wait(NULL);\n    } else { // å­è¿›ç¨‹\n        close(pipefd[1]); // å…³é—­å†™å…¥ç«¯ï¼Œå¦‚æœä¸å…³\n        read(pipefd[0], buf, sizeof(buf));\n        printf(\"Child received: %s\\n\", buf);\n        close(pipefd[0]); // å…³é—­è¯»å–ç«¯\n    }\n\n    return 0;\n}\n```\n\n### 2.2. FIFOï¼ˆå‘½åç®¡é“ï¼‰\n\nç®¡é“åªèƒ½ç”¨äºæœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ï¼Œé‚£å¦‚æœä¸¤ä¸ªæ¯«ä¸ç›¸å…³çš„è¿›ç¨‹æƒ³é€šä¿¡æ€ä¹ˆåŠï¼Ÿç­”æ¡ˆå°±æ˜¯ **FIFO (First-In, First-Out)**ï¼Œä¹Ÿå«**å‘½åç®¡é“**ã€‚\n\n- **ç‰¹ç‚¹**ï¼š\n\n    - **æ–‡ä»¶ç³»ç»Ÿè·¯å¾„**ï¼šå®ƒåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªè·¯å¾„åï¼Œä¸åŒäºåŒ¿åç®¡é“ã€‚\n\n    - **éäº²ç¼˜è¿›ç¨‹é€šä¿¡**ï¼šä»»æ„ä¸¤ä¸ªè¿›ç¨‹éƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªè·¯å¾„åæ‰“å¼€å¹¶é€šä¿¡ã€‚\n\n    - **å•å‘**ï¼šå’Œç®¡é“ä¸€æ ·ï¼ŒFIFO ä¹Ÿæ˜¯å•å‘çš„ï¼Œéœ€è¦ä¸¤ä¸ª FIFO æ¥å®ç°åŒå‘é€šä¿¡ã€‚\n\n- **ä½¿ç”¨**ï¼š\n\n    - **`mkfifo()` å‡½æ•°**æˆ– **`mkfifo` å‘½ä»¤**ï¼šç”¨æ¥åˆ›å»º FIFOã€‚\n\n\n    ```c\n    #include <sys/types.h>\n    #include <sys/stat.h>\n    int mkfifo(const char *pathname, mode_t mode);\n    ```\n\n    - **`open()`, `read()`, `write()` å‡½æ•°**ï¼šåƒæ“ä½œæ™®é€šæ–‡ä»¶ä¸€æ ·æ¥æ“ä½œ FIFOã€‚\n\n- **ä»£ç ç¤ºä¾‹**ï¼š\n\n    - **`writer.c`**ï¼š\n\n    ```c\n    #include <stdio.h>\n    #include <stdlib.h>\n    #include <fcntl.h>\n    #include <sys/stat.h>\n    #include <unistd.h>\n\n    #define FIFO_NAME \"my_fifo\"\n\n    int main() {\n        int fd;\n        char *msg = \"Hello from writer!\";\n\n        mkfifo(FIFO_NAME, 0666);\n        fd = open(FIFO_NAME, O_WRONLY);\n        write(fd, msg, strlen(msg) + 1);\n        close(fd);\n        unlink(FIFO_NAME); // åˆ é™¤å‘½åç®¡é“æ–‡ä»¶\n        return 0;\n    }\n    ```\n\n    - **`reader.c`**ï¼š\n\n    ```c\n    #include <stdio.h>\n    #include <stdlib.h>\n    #include <fcntl.h>\n    #include <sys/stat.h>\n    #include <unistd.h>\n\n    #define FIFO_NAME \"my_fifo\"\n\n    int main() {\n        int fd;\n        char buf[20];\n\n        mkfifo(FIFO_NAME, 0666); // ä¿è¯æ–‡ä»¶å­˜åœ¨\n        fd = open(FIFO_NAME, O_RDONLY);\n        read(fd, buf, sizeof(buf));\n        printf(\"Reader received: %s\\n\", buf);\n        close(fd);\n        return 0;\n    }\n    ```\n\n    ä½ å¯ä»¥å…ˆè¿è¡Œ `writer.c`ï¼Œå†è¿è¡Œ `reader.c`ã€‚\n\n\n\n### 2.3. ä¿¡å·\n\n**ä¿¡å·ï¼ˆSignalï¼‰** æ˜¯ä¸€ç§æ›´è½»é‡çº§ã€æ›´å¼‚æ­¥çš„è¿›ç¨‹é—´é€šä¿¡å’Œäº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚å®ƒå°±åƒä¸€ä¸ªâ€œè½¯ä¸­æ–­â€ï¼Œç”¨æ¥é€šçŸ¥è¿›ç¨‹å‘ç”Ÿäº†æŸä¸ªäº‹ä»¶ã€‚\n\næƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨ä¸“æ³¨åœ°å·¥ä½œï¼Œçªç„¶æœ‰äººæ‹äº†ä½ ä¸€ä¸‹è‚©è†€ã€‚ä½ åœä¸‹æ‰‹ä¸­çš„æ´»ï¼Œè½¬å¤´çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Œç„¶åæ ¹æ®æƒ…å†µåšå‡ºååº”ï¼ˆæ¯”å¦‚ï¼Œå¯¹æ–¹æ˜¯åŒäº‹ï¼Œä½ å¯èƒ½å’Œä»–èŠä¸¤å¥ï¼›å¯¹æ–¹æ˜¯é¢†å¯¼ï¼Œä½ å¯èƒ½é©¬ä¸Šç«™èµ·æ¥ï¼‰ã€‚\n\nåœ¨ Linux ä¸­ï¼Œ**ä¿¡å·**å°±æ˜¯é‚£ä¸ªâ€œæ‹è‚©è†€â€çš„åŠ¨ä½œã€‚å½“ä¸€ä¸ªè¿›ç¨‹æ”¶åˆ°ä¸€ä¸ªä¿¡å·æ—¶ï¼Œå®ƒä¼šæš‚åœå½“å‰æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè½¬è€Œå»å¤„ç†è¿™ä¸ªä¿¡å·ï¼Œå¤„ç†å®Œåå†æ¢å¤æ‰§è¡Œã€‚\n\n- **å‘é€è€…**ï¼šå¯ä»¥æ˜¯å†…æ ¸ï¼ˆæ¯”å¦‚ä½ æŒ‰ä¸‹ `Ctrl+C`ï¼Œå†…æ ¸ä¼šå‘é€ `SIGINT` ä¿¡å·ç»™å‰å°è¿›ç¨‹ï¼‰ã€ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–è¿›ç¨‹ï¼ˆä½¿ç”¨ `kill()` å‡½æ•°ï¼‰ã€‚\n\n- **æ¥æ”¶è€…**ï¼šä»»ä½•ä¸€ä¸ªè¿›ç¨‹éƒ½å¯ä»¥æ¥æ”¶ä¿¡å·ã€‚\n\n\n#### 2.3.1. ä¿¡å·çš„åˆ†ç±»\n\nä¿¡å·æœ‰å¾ˆå¤šç§ï¼Œæ¯ç§éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨é€”ã€‚å¸¸è§çš„ä¿¡å·åŠå…¶ä½œç”¨å¦‚ä¸‹ï¼š\n\n|ä¿¡å·åç§°|é»˜è®¤è¡Œä¸º|è§£é‡Š|\n|---|---|---|\n|**`SIGHUP` (1)**|ç»ˆæ­¢è¿›ç¨‹|å½“ç»ˆç«¯å…³é—­æ—¶å‘é€ç»™å…³è”çš„è¿›ç¨‹ã€‚|\n|**`SIGINT` (2)**|ç»ˆæ­¢è¿›ç¨‹|æ¥è‡ªé”®ç›˜ä¸­æ–­ï¼Œé€šå¸¸æ˜¯ `Ctrl+C`ã€‚|\n|**`SIGQUIT` (3)**|ç»ˆæ­¢å¹¶ç”Ÿæˆæ ¸å¿ƒè½¬å‚¨æ–‡ä»¶|æ¥è‡ªé”®ç›˜é€€å‡ºï¼Œé€šå¸¸æ˜¯ `Ctrl+\\\\`ã€‚|\n|**`SIGKILL` (9)**|å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹|æ— æ³•è¢«æ•è·ã€é˜»å¡æˆ–å¿½ç•¥ï¼Œå¼ºåˆ¶æ€æ­»è¿›ç¨‹ã€‚|\n|**`SIGTERM` (15)**|ç»ˆæ­¢è¿›ç¨‹|å‹å¥½çš„ç»ˆæ­¢è¯·æ±‚ï¼Œå¯ä»¥è¢«æ•è·ã€‚`kill` å‘½ä»¤é»˜è®¤å‘é€æ­¤ä¿¡å·ã€‚|\n|**`SIGCHLD`**|å¿½ç•¥|å­è¿›ç¨‹ç»ˆæ­¢æˆ–åœæ­¢æ—¶å‘é€ç»™çˆ¶è¿›ç¨‹ã€‚|\n|**`SIGSTOP`**|åœæ­¢è¿›ç¨‹|æ— æ³•è¢«æ•è·ã€å¿½ç•¥ï¼Œæš‚åœè¿›ç¨‹ã€‚|\n|**`SIGCONT`**|ç»§ç»­è¿›ç¨‹|ä½¿åœæ­¢çš„è¿›ç¨‹ç»§ç»­è¿è¡Œã€‚|\n\n#### 2.3.2. ä¿¡å·ä¸ IPC çš„å…³ç³»\n\n- **å¼‚æ­¥é€šçŸ¥**ï¼šä¿¡å·æ˜¯å…¸å‹çš„å¼‚æ­¥ IPC æœºåˆ¶ï¼Œå®ƒä¸åƒç®¡é“æˆ–å…±äº«å†…å­˜é‚£æ ·ä¼ é€’æ•°æ®ï¼Œè€Œæ˜¯**ä¼ é€’äº‹ä»¶ä¿¡æ¯**ã€‚\n\n- **è½»é‡çº§**ï¼šç›¸æ¯”äºå…¶ä»– IPCï¼Œä¿¡å·çš„å¼€é”€éå¸¸å°ã€‚\n\n- **åŒæ­¥**ï¼šä¿¡å·ä¹Ÿå¯ä»¥ç”¨äºåŒæ­¥ç›®çš„ï¼Œä¾‹å¦‚ `SIGCHLD` ä¿¡å·å¸¸ç”¨äºçˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹ç»“æŸã€‚\n\n\nç†è§£ä¿¡å·ï¼Œç‰¹åˆ«æ˜¯ä¿¡å·é›†å’Œé˜»å¡çš„æ¦‚å¿µï¼Œå¯¹äºç¼–å†™å¥å£®çš„å¤šè¿›ç¨‹æˆ–å¤šçº¿ç¨‹ç¨‹åºè‡³å…³é‡è¦ã€‚å®ƒèƒ½è®©ä½ æ›´å¥½åœ°æ§åˆ¶ç¨‹åºå¯¹å¤–éƒ¨äº‹ä»¶çš„å“åº”ã€‚\n\n\n#### 2.3.3. ä¿¡å·çš„ä¸‰ç§å¤„ç†æ–¹å¼\n\nå½“è¿›ç¨‹æ”¶åˆ°ä¸€ä¸ªä¿¡å·æ—¶ï¼Œå®ƒå¯ä»¥æœ‰ä¸‰ç§å¤„ç†æ–¹å¼ï¼š\n\n1. **æ‰§è¡Œé»˜è®¤åŠ¨ä½œï¼ˆDefaultï¼‰**ï¼šå¤§å¤šæ•°ä¿¡å·éƒ½æœ‰ä¸€ä¸ªé¢„å®šä¹‰çš„é»˜è®¤è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œ`SIGINT` çš„é»˜è®¤è¡Œä¸ºå°±æ˜¯ç»ˆæ­¢è¿›ç¨‹ã€‚\n\n2. **å¿½ç•¥ä¿¡å·ï¼ˆIgnoreï¼‰**ï¼šæœ‰äº›ä¿¡å·å¯ä»¥è¢«å¿½ç•¥ï¼Œå³è¿›ç¨‹æ”¶åˆ°ä¿¡å·åä¸åšä»»ä½•å¤„ç†ã€‚`SIGCHLD` ä¿¡å·çš„é»˜è®¤è¡Œä¸ºå°±æ˜¯å¿½ç•¥ã€‚\n\n3. **æ•è·ä¿¡å·ï¼ˆCatchï¼‰**ï¼šè¿™æ˜¯æœ€çµæ´»çš„æ–¹å¼ã€‚è¿›ç¨‹å¯ä»¥ä¸ºæŸä¸ªä¿¡å·æ³¨å†Œä¸€ä¸ª**ä¿¡å·å¤„ç†å‡½æ•°ï¼ˆSignal Handlerï¼‰**ã€‚å½“ä¿¡å·åˆ°æ¥æ—¶ï¼Œè¿›ç¨‹ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°æ¥å¤„ç†ä¿¡å·ï¼Œè€Œä¸æ˜¯æ‰§è¡Œé»˜è®¤åŠ¨ä½œã€‚\n\n!!! caution\n    **æ³¨æ„**ï¼š`SIGKILL` å’Œ `SIGSTOP` è¿™ä¸¤ä¸ªä¿¡å·æ˜¯**ä¸èƒ½è¢«æ•è·ã€å¿½ç•¥æˆ–é˜»å¡**çš„ã€‚å®ƒä»¬æ˜¯ç³»ç»Ÿç®¡ç†å‘˜å¼ºåˆ¶ç»ˆæ­¢æˆ–åœæ­¢è¿›ç¨‹çš„â€œæœ€åæ‰‹æ®µâ€ã€‚\n\n\n\n#### 2.3.4. å¦‚ä½•ä½¿ç”¨ä¿¡å·ï¼Ÿ\n\n##### 2.3.4.1. å‘é€ä¿¡å·ï¼š`kill()` å‡½æ•°\n\nä½ å¯ä»¥ä½¿ç”¨ `kill()` å‡½æ•°å‘å¦ä¸€ä¸ªè¿›ç¨‹å‘é€ä¿¡å·ã€‚\n\n```c\n#include <sys/types.h>\n#include <signal.h>\nint kill(pid_t pid, int sig);\n```\n\n- `pid`ï¼šç›®æ ‡è¿›ç¨‹çš„ IDã€‚\n\n- `sig`ï¼šè¦å‘é€çš„ä¿¡å·ç¼–å·ã€‚\n\n\n##### 2.3.4.2. æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°ï¼š`signal()` å’Œ `sigaction()`\n\n- **`signal()` å‡½æ•°**ï¼šè¿™æ˜¯æœ€ç®€å•çš„æ³¨å†Œæ–¹å¼ï¼Œä½†å®ƒåœ¨ä¸åŒç³»ç»Ÿä¸Šçš„è¡Œä¸ºå¯èƒ½ä¸ä¸€è‡´ï¼Œä¸æ¨èåœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ã€‚\n\n- **`sigaction()` å‡½æ•°**ï¼šè¿™æ˜¯ POSIX æ ‡å‡†æ¨èçš„æ–¹å¼ï¼Œæ›´å¼ºå¤§ï¼Œæ›´å¯é ã€‚\n\n\n```c\n#include <signal.h>\nint sigaction(int signum, const struct sigaction *act, struct sigaction *oldact);\n```\n\n- `signum`ï¼šè¦æ•è·çš„ä¿¡å·ç¼–å·ã€‚\n\n- `act`ï¼šæŒ‡å‘ `struct sigaction` ç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“å®šä¹‰äº†æ–°çš„ä¿¡å·å¤„ç†è¡Œä¸ºã€‚\n\n- `oldact`ï¼šå¯é€‰ï¼Œç”¨äºä¿å­˜æ—§çš„ä¿¡å·å¤„ç†è¡Œä¸ºã€‚\n\n\n**`struct sigaction` ç»“æ„ä½“**ï¼š\n```c\nstruct sigaction {\n    void (*sa_handler)(int);  // ä¿¡å·å¤„ç†å‡½æ•°\n    sigset_t sa_mask;         // ä¿¡å·é›†ï¼Œåœ¨ä¿¡å·å¤„ç†å‡½æ•°æ‰§è¡ŒæœŸé—´éœ€è¦é˜»å¡çš„ä¿¡å·\n    int sa_flags;             // æ ‡å¿—ä½\n};\n```\n\n### 2.4. ä¿¡å·é›†ï¼ˆSignal Setï¼‰å’Œé˜»å¡\n\nå½“ä½ åœ¨å¤„ç†ä¸€ä¸ªä¿¡å·æ—¶ï¼Œä½ å¯èƒ½ä¸å¸Œæœ›è¢«å…¶ä»–ä¿¡å·æ‰“æ–­ã€‚**ä¿¡å·é›†ï¼ˆ`sigset_t`ï¼‰** å°±æ˜¯ç”¨æ¥ç®¡ç†ä¸€ç»„ä¿¡å·çš„ã€‚é€šè¿‡æ“ä½œä¿¡å·é›†ï¼Œä½ å¯ä»¥**é˜»å¡ï¼ˆBlockï¼‰** æŸäº›ä¿¡å·ï¼Œè®©å®ƒä»¬åœ¨è¿›ç¨‹å¤„ç†å®Œå½“å‰ä»»åŠ¡åæ‰è¢«ä¼ é€’ã€‚\n\n#### 2.4.1. ä¿¡å·é›†æ“ä½œå‡½æ•°\n\n- **`sigemptyset()`**ï¼šåˆå§‹åŒ–ä¸€ä¸ªç©ºçš„ä¿¡å·é›†ã€‚\n\n- **`sigaddset()`**ï¼šå‘ä¿¡å·é›†ä¸­æ·»åŠ ä¸€ä¸ªä¿¡å·ã€‚\n\n- **`sigdelset()`**ï¼šä»ä¿¡å·é›†ä¸­åˆ é™¤ä¸€ä¸ªä¿¡å·ã€‚\n\n- **`sigismember()`**ï¼šæ£€æŸ¥ä¸€ä¸ªä¿¡å·æ˜¯å¦åœ¨ä¿¡å·é›†ä¸­ã€‚\n\n\n#### 2.4.2. é˜»å¡ä¿¡å·ï¼š`sigprocmask()`\n\n`sigprocmask()` å‡½æ•°ç”¨æ¥è®¾ç½®è¿›ç¨‹çš„**ä¿¡å·é˜»å¡æ©ç ï¼ˆSignal Maskï¼‰**ã€‚\n\n```c\n#include <signal.h>\nint sigprocmask(int how, const sigset_t *set, sigset_t *oldset);\n```\n\n- `how`ï¼šæŒ‡å®šå¦‚ä½•ä¿®æ”¹ä¿¡å·é˜»å¡æ©ç ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š\n\n    - `SIG_BLOCK`ï¼šå°† `set` ä¸­çš„ä¿¡å·æ·»åŠ åˆ°é˜»å¡æ©ç ä¸­ã€‚\n\n    - `SIG_UNBLOCK`ï¼šå°† `set` ä¸­çš„ä¿¡å·ä»é˜»å¡æ©ç ä¸­ç§»é™¤ã€‚\n\n    - `SIG_SETMASK`ï¼šå°†é˜»å¡æ©ç è®¾ç½®ä¸º `set`ã€‚\n\n- `set`ï¼šåŒ…å«è¦é˜»å¡æˆ–è§£é™¤é˜»å¡çš„ä¿¡å·é›†ã€‚\n\n- `oldset`ï¼šå¯é€‰ï¼Œç”¨äºä¿å­˜æ—§çš„é˜»å¡æ©ç ã€‚\n\n\n**ç¤ºä¾‹**ï¼šåœ¨å¤„ç†å…³é”®ä»£ç æ®µæ—¶ä¸´æ—¶é˜»å¡ `SIGINT`ã€‚\n\n```c\n#include <stdio.h>\n#include <signal.h>\n#include <unistd.h>\n\nvoid my_handler(int sig) {\n    printf(\"Caught signal %d\\n\", sig);\n}\n\nint main() {\n    sigset_t block_mask, old_mask;\n\n    // 1. è®¾ç½®è¦é˜»å¡çš„ä¿¡å·é›†\n    sigemptyset(&block_mask);\n    sigaddset(&block_mask, SIGINT);\n\n    // 2. é˜»å¡ SIGINT ä¿¡å·\n    sigprocmask(SIG_BLOCK, &block_mask, &old_mask);\n\n    printf(\"SIGINT is blocked. Press Ctrl+C...\\n\");\n    sleep(10); // åœ¨è¿™10ç§’å†…ï¼ŒCtrl+Cä¸ä¼šç»ˆæ­¢è¿›ç¨‹\n\n    printf(\"Unblocking SIGINT...\\n\");\n    // 3. è§£é™¤é˜»å¡ï¼Œæ¢å¤æ—§çš„ä¿¡å·æ©ç \n    sigprocmask(SIG_SETMASK, &old_mask, NULL);\n\n    printf(\"SIGINT is unblocked. Press Ctrl+C again.\\n\");\n\n    // 4. æ³¨å†Œä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°\n    struct sigaction sa;\n    sa.sa_handler = my_handler;\n    sigemptyset(&sa.sa_mask);\n    sa.sa_flags = 0;\n    sigaction(SIGINT, &sa, NULL);\n\n    while(1) {\n        printf(\"Running...\\n\");\n        sleep(1);\n    }\n\n    return 0;\n}\n```\n\nè¿è¡Œè¿™æ®µä»£ç ï¼Œä½ ä¼šçœ‹åˆ°åœ¨é˜»å¡æœŸé—´ï¼Œ`Ctrl+C` æ— æ³•ç»ˆæ­¢è¿›ç¨‹ã€‚å½“è§£é™¤é˜»å¡åï¼Œ`Ctrl+C` æ‰èƒ½è§¦å‘ä¿¡å·å¤„ç†å‡½æ•°ã€‚\n\n\n### 2.5. System V IPC (System V IPC)[^1]\n\nSystem V IPC æ˜¯ Linux ç³»ç»Ÿä¸­ä¸€ç»„æ›´é«˜çº§ã€æ›´å¼ºå¤§çš„ IPC æœºåˆ¶ï¼ŒåŒ…æ‹¬æ¶ˆæ¯é˜Ÿåˆ—ã€ä¿¡å·é‡å’Œå…±äº«å†…å­˜ã€‚å®ƒä»¬éƒ½æ˜¯**åŸºäºå†…æ ¸**çš„ï¼Œéœ€è¦ä¸€ä¸ªå”¯ä¸€çš„é”®å€¼ï¼ˆkeyï¼‰æ¥æ ‡è¯†ã€‚\n\n#### 2.5.1. æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queuesï¼‰\n\næ¶ˆæ¯é˜Ÿåˆ—å°±åƒä¸€ä¸ªé“¾è¡¨ï¼Œå…è®¸è¿›ç¨‹å‘å…¶ä¸­æ·»åŠ æ¶ˆæ¯æˆ–ä»ä¸­è¯»å–æ¶ˆæ¯ã€‚\n\n- **ç‰¹ç‚¹**ï¼š\n\n    - **å¼‚æ­¥é€šä¿¡**ï¼šå‘é€è¿›ç¨‹å¯ä»¥å‘é€æ¶ˆæ¯åç«‹å³è¿”å›ï¼Œä¸éœ€è¦ç­‰å¾…æ¥æ”¶è¿›ç¨‹ã€‚\n\n    - **å¸¦ç±»å‹**ï¼šæ¶ˆæ¯å¯ä»¥å¸¦æœ‰ç±»å‹ï¼Œæ¥æ”¶è¿›ç¨‹å¯ä»¥åªæ¥æ”¶ç‰¹å®šç±»å‹çš„æ¶ˆæ¯ã€‚\n\n    - **å­˜å‚¨åœ¨å†…æ ¸ä¸­**ï¼šå³ä½¿å‘é€è¿›ç¨‹ç»“æŸï¼Œæ¶ˆæ¯ä¾ç„¶ä¿ç•™åœ¨é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°è¢«è¯»å–ã€‚\n\n- **ä½¿ç”¨**ï¼š\n\n    - **`ftok()`**ï¼šå°†æ–‡ä»¶è·¯å¾„å’Œæ•´æ•°è½¬æ¢ä¸ºä¸€ä¸ªå”¯ä¸€çš„ IPC é”®å€¼ã€‚\n\n    - **`msgget()`**ï¼šåˆ›å»ºæˆ–è·å–ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\n    - **`msgsnd()`**ï¼šå‘é€æ¶ˆæ¯ã€‚\n\n    - **`msgrcv()`**ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚\n\n    - **`msgctl()`**ï¼šæ§åˆ¶æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚åˆ é™¤ã€‚\n\n\n#### 2.5.2. ä¿¡å·é‡ï¼ˆSemaphoresï¼‰\n\nä¿¡å·é‡ä¸»è¦ç”¨äº**åŒæ­¥**ï¼Œæ§åˆ¶å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚å®ƒæœ¬èº«ä¸ä¼ é€’æ•°æ®ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ç§â€œè®¡æ•°å™¨â€ã€‚\n\n- **ç‰¹ç‚¹**ï¼š\n\n    - **äº’æ–¥å’ŒåŒæ­¥**ï¼šå¸¸ç”¨äºå®ç°äº’æ–¥é”ï¼Œç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¿›ç¨‹è®¿é—®å…±äº«èµ„æºã€‚\n\n    - **åŸå­æ“ä½œ**ï¼šä¿¡å·é‡çš„æ“ä½œï¼ˆP/Væ“ä½œï¼‰æ˜¯åŸå­çš„ï¼Œä¸ä¼šè¢«ä¸­æ–­ã€‚\n\n- **ä½¿ç”¨**ï¼š\n\n    - **`semget()`**ï¼šåˆ›å»ºæˆ–è·å–ä¸€ç»„ä¿¡å·é‡ã€‚\n\n    - **`semop()`**ï¼šå¯¹ä¿¡å·é‡è¿›è¡Œæ“ä½œï¼Œå¦‚åŠ /å‡è®¡æ•°ã€‚\n\n    - **`semctl()`**ï¼šæ§åˆ¶ä¿¡å·é‡ã€‚\n\n\n#### 2.5.3. å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰\n\nå…±äº«å†…å­˜æ˜¯æœ€é«˜æ•ˆçš„ IPC æ–¹å¼ã€‚å®ƒå…è®¸ä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹å…±äº«åŒä¸€å—ç‰©ç†å†…å­˜ã€‚\n\n- **ç‰¹ç‚¹**ï¼š\n\n    - **æœ€é«˜æ•ˆ**ï¼šä¸€æ—¦æ˜ å°„åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œè¯»å†™æ“ä½œå°±åƒè®¿é—®æ™®é€šå†…å­˜ä¸€æ ·ï¼Œä¸éœ€è¦å†…æ ¸çš„å‚ä¸ã€‚\n\n    - **éœ€è¦åŒæ­¥**ï¼šç”±äºå¤šä¸ªè¿›ç¨‹åŒæ—¶è®¿é—®ï¼Œéœ€è¦ç”¨**ä¿¡å·é‡**ç­‰æœºåˆ¶æ¥åŒæ­¥è®¿é—®ï¼Œé˜²æ­¢æ•°æ®ç«äº‰ã€‚\n\n- **ä½¿ç”¨**ï¼š\n\n    - **`shmget()`**ï¼šåˆ›å»ºæˆ–è·å–ä¸€ä¸ªå…±äº«å†…å­˜æ®µã€‚\n\n    - **`shmat()`**ï¼šå°†å…±äº«å†…å­˜æ®µé™„åŠ åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚\n\n    - **`shmdt()`**ï¼šå°†å…±äº«å†…å­˜æ®µä»è¿›ç¨‹çš„åœ°å€ç©ºé—´åˆ†ç¦»ã€‚\n\n    - **`shmctl()`**ï¼šæ§åˆ¶å…±äº«å†…å­˜ï¼Œå¦‚åˆ é™¤ã€‚\n\n### 2.6. IPC æ€»ç»“ä¸é€‰æ‹©\n\n|æœºåˆ¶|é€‚ç”¨åœºæ™¯|ä¼˜ç‚¹|ç¼ºç‚¹|\n|---|---|---|---|\n|**ç®¡é“**|æœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹|ç®€å•ï¼Œæ˜“äºä½¿ç”¨|å•å‘ï¼Œä»…é™äºäº²ç¼˜è¿›ç¨‹|\n|**FIFO**|æ— äº²ç¼˜å…³ç³»çš„è¿›ç¨‹|å¯ä»¥åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­å‘½åï¼Œçµæ´»|å•å‘ï¼Œéœ€è¦åŒæ­¥ï¼Œè¯»å†™æ—¶æœ‰é˜»å¡|\n|**æ¶ˆæ¯é˜Ÿåˆ—**|å¼‚æ­¥é€šä¿¡ï¼Œå°‘é‡æ•°æ®|æ¶ˆæ¯å¸¦ç±»å‹ï¼Œæ— éœ€åŒæ­¥|æ•ˆç‡è¾ƒä½ï¼Œæœ‰å¤§å°é™åˆ¶|\n|**ä¿¡å·é‡**|è¿›ç¨‹é—´åŒæ­¥ï¼Œäº’æ–¥|ç”¨äºæ§åˆ¶è®¿é—®ï¼Œé˜²æ­¢ç«äº‰|ä¸ä¼ é€’æ•°æ®|\n|**å…±äº«å†…å­˜**|å¤§é‡æ•°æ®ä¼ è¾“|æœ€é«˜æ•ˆï¼Œè¯»å†™é€Ÿåº¦å¿«|å¿…é¡»é…åˆå…¶ä»–åŒæ­¥æœºåˆ¶ä½¿ç”¨|\n\n**å¦‚ä½•é€‰æ‹©ï¼Ÿ**\n\n- å¦‚æœæ˜¯çˆ¶å­è¿›ç¨‹ä¹‹é—´å°‘é‡æ•°æ®çš„é€šä¿¡ï¼Œ**ç®¡é“**æ˜¯æœ€ä½³é€‰æ‹©ã€‚\n\n- å¦‚æœæ˜¯ä¸¤ä¸ªä¸ç›¸å…³çš„è¿›ç¨‹ï¼Œä¸”æ•°æ®é‡ä¸å¤§ï¼Œ**æ¶ˆæ¯é˜Ÿåˆ—**æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ¡ˆã€‚\n\n- å¦‚æœéœ€è¦ä¼ è¾“å¤§é‡æ•°æ®ï¼Œä¸”å¯¹æ€§èƒ½è¦æ±‚æé«˜ï¼Œ**å…±äº«å†…å­˜**æ˜¯é¦–é€‰ï¼Œä½†**å¿…é¡»**ç»“åˆ**ä¿¡å·é‡**æˆ–å…¶ä»–åŒæ­¥æœºåˆ¶ã€‚\n\n- å¦‚æœä½ åªæƒ³è§£å†³èµ„æºè®¿é—®çš„åŒæ­¥é—®é¢˜ï¼Œ**ä¿¡å·é‡**æ˜¯ä¸“é—¨ä¸ºæ­¤è®¾è®¡çš„ã€‚\n\n\näº†è§£è¿™äº› IPC æœºåˆ¶ï¼Œå°±å¦‚åŒæŒæ¡äº†è¿›ç¨‹ä¹‹é—´â€œæ²Ÿé€šâ€çš„å¤šç§è¯­è¨€ã€‚åœ¨å¼€å‘æ—¶ï¼Œé€‰æ‹©åˆé€‚çš„â€œè¯­è¨€â€èƒ½è®©ä½ çš„ç¨‹åºæ›´åŠ å¥å£®ã€é«˜æ•ˆã€‚ç°åœ¨ï¼Œä½ å¯ä»¥å°è¯•ç”¨è¿™äº›æœºåˆ¶æ¥è§£å†³ä½ é‡åˆ°çš„å®é™…é—®é¢˜äº†ï¼\n\n[^1]: ä½œäº†è§£ï¼Œé‡ç‚¹ä½¿ç”¨POSIX IPCã€‚","tags":["Linux","IPC"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"Linux-Process","url":"/posts/43741/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n!!! info \"\"\n    AI è¾…åŠ©åˆ›ä½œ\n\n\nåœ¨ Linux ç¼–ç¨‹ä¸­ï¼Œ**è¿›ç¨‹ï¼ˆProcessï¼‰** æ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºå’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ã€ä»£ç æ®µã€æ•°æ®æ®µå’Œæ‰§è¡Œä¸Šä¸‹æ–‡ã€‚å¤šä¸ªè¿›ç¨‹ä¹‹é—´å¸¸å¸¸éœ€è¦åä½œï¼Œè¿™å°±æ¶‰åŠåˆ° **è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPC, Inter-Process Communicationï¼‰**ã€‚æœ¬ç¯‡åšå®¢ä¼šç³»ç»Ÿä»‹ç»è¿›ç¨‹çš„åŸºç¡€æ“ä½œï¼Œå¹¶å¯¹å¸¸è§çš„ IPC æ–¹å¼è¿›è¡Œè¯¦ç»†è§£é‡Šä¸ç¤ºä¾‹ï¼Œå¸¦ä½ ä»é›¶å¼€å§‹æŒæ¡ã€‚\n\n---\n\n## 1. è¿›ç¨‹ä¸ PID\n\næ¯ä¸ªè¿›ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„ **è¿›ç¨‹å·ï¼ˆPIDï¼‰**ï¼Œå¯ä»¥é€šè¿‡ `getpid()` è·å–å½“å‰è¿›ç¨‹å·ï¼Œé€šè¿‡ `getppid()` è·å–çˆ¶è¿›ç¨‹å·ã€‚è¿™åœ¨è°ƒè¯•å’Œè¿›ç¨‹ç®¡ç†æ—¶éå¸¸é‡è¦ã€‚\n\n```c\n#include <stdio.h>\n#include <unistd.h>\n\nint main() {\n    printf(\"å½“å‰è¿›ç¨‹PID=%d, çˆ¶è¿›ç¨‹PID=%d\\n\", getpid(), getppid());\n    return 0;\n}\n```\n\nâš ï¸ æ³¨æ„ï¼šå¦‚æœçˆ¶è¿›ç¨‹å…ˆé€€å‡ºï¼Œå­è¿›ç¨‹ä¼šè¢« `init` è¿›ç¨‹æ¥ç®¡ï¼Œ`ppid` ä¼šå˜ä¸º 1ã€‚\n\n## 2. åˆ›å»ºè¿›ç¨‹ â€” `fork()`\n\n`fork()` æ˜¯åˆ›å»ºæ–°è¿›ç¨‹çš„ä¸»è¦æ–¹å¼ã€‚å®ƒä¼šå¤åˆ¶å½“å‰è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰çš„å¤§éƒ¨åˆ†å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªå‡ ä¹ä¸€æ¨¡ä¸€æ ·çš„å­è¿›ç¨‹ã€‚\n\n```c\npid_t pid = fork();\n```\n\n- **åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œ`fork()` è¿”å›å­è¿›ç¨‹çš„ PIDã€‚**\n    \n- **åœ¨å­è¿›ç¨‹ä¸­ï¼Œ`fork()` è¿”å› 0ã€‚**\n    \n- å¦‚æœå¤±è´¥ï¼Œè¿”å› -1ã€‚\n    \n\nç¤ºä¾‹ï¼š\n\n```c\n#include <stdio.h>\n#include <unistd.h>\n\nint main() {\n    pid_t pid = fork();\n    if (pid == 0) {\n        printf(\"[å­è¿›ç¨‹] pid=%d, ppid=%d\\n\", getpid(), getppid());\n    } else if (pid > 0) {\n        printf(\"[çˆ¶è¿›ç¨‹] pid=%d, å­è¿›ç¨‹pid=%d\\n\", getpid(), pid);\n    } else {\n        perror(\"fork å¤±è´¥\");\n    }\n    return 0;\n}\n```\n\n!!! caution\n    - å­è¿›ç¨‹ä¸ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„æ‰€æœ‰èµ„æºï¼Œä¾‹å¦‚æ–‡ä»¶é”ã€‚\n    \n    - `fork()` ä¹‹åï¼Œçˆ¶å­è¿›ç¨‹æ‰§è¡Œé¡ºåºä¸ç¡®å®šï¼Œéœ€è¦é€šè¿‡ `wait()` æˆ–å…¶ä»–æœºåˆ¶æ§åˆ¶ã€‚\n\n\n## 3. ç¨‹åºæ›¿æ¢ â€” `exec()` ç³»åˆ—\n\nå­è¿›ç¨‹å¸¸å¸¸éœ€è¦è¿è¡Œä¸€ä¸ªæ–°çš„ç¨‹åºï¼Œè¿™å°±éœ€è¦ `exec()` ç³»åˆ—å‡½æ•°ï¼ˆå¦‚ `execlp`, `execvp` ç­‰ï¼‰ã€‚\n`exec` ç³»åˆ—å‡½æ•°çš„ä½œç”¨æ˜¯ï¼š**ç”¨æ–°çš„ç¨‹åºæ›¿æ¢å½“å‰è¿›ç¨‹çš„ä»£ç æ®µ**ï¼Œè€Œè¿›ç¨‹çš„ PIDã€æ–‡ä»¶æè¿°ç¬¦ï¼ˆé™¤éè®¾ç½®äº† `FD_CLOEXEC`ï¼‰ç­‰ä¿æŒä¸å˜ã€‚å®ƒä¸ä¼šåˆ›å»ºæ–°è¿›ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰è¿›ç¨‹å†…åŠ è½½å¹¶è¿è¡Œæ–°ç¨‹åºã€‚\n### å¸¸è§å‡½æ•°\n\n`exec` ç³»åˆ—ä¸€å…±æœ‰ 6 ä¸ªå¸¸ç”¨å‡½æ•°ï¼Œä¸»è¦åŒºåˆ«åœ¨äº **å‚æ•°ä¼ é€’æ–¹å¼** å’Œ **æ˜¯å¦ä¾èµ– PATH ç¯å¢ƒå˜é‡**ã€‚\n\n|å‡½æ•°|å‚æ•°ä¼ é€’æ–¹å¼|æ˜¯å¦æœç´¢ PATH|è¯´æ˜|\n|---|---|---|---|\n|`execl(path, arg0, arg1, ..., NULL)`|åˆ—è¡¨ï¼ˆé€ä¸ªä¼ å‚ï¼‰|å¦|æœ€å¸¸è§ï¼Œå‚æ•°ä»¥ä¸å®šé•¿åˆ—è¡¨å½¢å¼ä¼ é€’ï¼Œæœ€åå¿…é¡»ä»¥ `NULL` ç»“å°¾ã€‚|\n|`execv(path, argv[])`|æ•°ç»„|å¦|å‚æ•°é€šè¿‡å­—ç¬¦ä¸²æ•°ç»„ä¼ é€’ï¼Œæ–¹ä¾¿åŠ¨æ€æ„é€ å‚æ•°ã€‚|\n|`execlp(file, arg0, arg1, ..., NULL)`|åˆ—è¡¨|æ˜¯|ä¸ `execl` ç±»ä¼¼ï¼Œä½†ä¼šåœ¨ `PATH` ä¸­æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚|\n|`execvp(file, argv[])`|æ•°ç»„|æ˜¯|ä¸ `execv` ç±»ä¼¼ï¼Œä½†ä¼šåœ¨ `PATH` ä¸­æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚|\n|`execle(path, arg0, arg1, ..., NULL, envp[])`|åˆ—è¡¨|å¦|å¯ä»¥è‡ªå®šä¹‰ç¯å¢ƒå˜é‡ï¼Œæœ€åå‚æ•°éœ€æä¾› `envp`ã€‚|\n|`execve(path, argv[], envp[])`|æ•°ç»„|å¦|æœ€åº•å±‚çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå…¶å®ƒ `exec` å‡½æ•°æœ€ç»ˆéƒ½è°ƒç”¨å®ƒã€‚|\n\nè¯´æ˜ï¼š\n- `PATH`ï¼šç³»ç»Ÿç¯å¢ƒå˜é‡\n- `path`ï¼šè¦æ‰§è¡Œçš„ç¨‹åºè·¯å¾„ï¼ˆå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼‰ã€‚\n- `arg`ï¼šç¨‹åºè¦è¾“å…¥çš„å‚æ•°\n### ä½¿ç”¨ç¤ºä¾‹\n\n1. **execlï¼šç”¨ç»å¯¹è·¯å¾„è°ƒç”¨ç¨‹åº**\n\n```c\n#include <unistd.h>\n#include <stdio.h> \n\nint main() {     \nprintf(\"Before exec\\n\");     \nexecl(\"/bin/ls\", \"ls\", \"-l\", NULL);     \n// åªæœ‰ exec è°ƒç”¨å¤±è´¥æ—¶æ‰ä¼šç»§ç»­æ‰§è¡Œ    \nperror(\"execl failed\");     \nreturn 1; }\n```\n\n2. **execvpï¼šåœ¨ PATH ä¸­æœç´¢å‘½ä»¤**\n    \n```c\n#include <unistd.h>\n#include <stdio.h>\n\nint main() {\n    char *argv[] = {\"ls\", \"-a\", NULL};\n    execvp(\"ls\", argv);\n    perror(\"execvp failed\");\n    return 1;\n}\n```\n\n3. **execleï¼šä¼ å…¥è‡ªå®šä¹‰ç¯å¢ƒå˜é‡**\n    \n```c\n#include <unistd.h>\n#include <stdio.h>\n\nint main() {\n    char *envp[] = {\"MYVAR=HelloExec\", NULL};\n    execl(\"/usr/bin/env\", \"env\", NULL, envp);\n    perror(\"execle failed\");\n    return 1;\n}\n```\n\n### æ³¨æ„äº‹é¡¹\n\n- `exec` ç³»åˆ— **ä¸ä¼šè¿”å›**ï¼Œé™¤éè°ƒç”¨å¤±è´¥ã€‚\n    \n- è‹¥è°ƒç”¨æˆåŠŸï¼ŒåŸè¿›ç¨‹çš„ä»£ç å’Œæ•°æ®æ®µä¼šè¢«æ–°ç¨‹åºæ›¿æ¢ã€‚\n    \n- **æ–‡ä»¶æè¿°ç¬¦é»˜è®¤ç»§æ‰¿**ï¼Œå¯ä»¥ç”¨äºåœ¨çˆ¶è¿›ç¨‹ä¸­è®¾ç½®å¥½ç®¡é“/é‡å®šå‘ï¼Œè®©å­è¿›ç¨‹åœ¨ exec åç»§ç»­ä½¿ç”¨ã€‚\n    \n- éœ€è¦ä¿è¯å‚æ•°åˆ—è¡¨æœ€åæœ‰ `NULL`ï¼Œå¦åˆ™ä¼šå¼•å‘ä¸å¯é¢„æœŸé”™è¯¯ã€‚\n    \n\n## 4. ç­‰å¾…å­è¿›ç¨‹ â€” `wait()` / `waitpid()`\n\n**çˆ¶è¿›ç¨‹éœ€è¦å›æ”¶å­è¿›ç¨‹é€€å‡ºæ—¶çš„èµ„æºï¼Œå¦åˆ™å­è¿›ç¨‹ä¼šæˆä¸º åƒµå°¸è¿›ç¨‹ï¼ˆZombieï¼‰ã€‚**\n\nè¿™ä¸¤ä¸ªå‡½æ•°ç”¨äº **çˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹ç»“æŸ** å¹¶**å›æ”¶èµ„æº**ï¼Œé¿å…åƒµå°¸è¿›ç¨‹ã€‚\n\n### 1. wait()\n\n```c\n#include <sys/types.h>\n#include <sys/wait.h>\n#include <unistd.h>\n\npid_t wait(int *status);\n```\n\n- **å‚æ•°**\n    \n    - `status`ï¼šæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨å­è¿›ç¨‹é€€å‡ºçŠ¶æ€ã€‚å¦‚æœä¸å…³å¿ƒçŠ¶æ€ï¼Œå¯ä»¥ä¼  `NULL`ã€‚\n        \n- **è¿”å›å€¼**\n    \n    - æˆåŠŸï¼šè¿”å›ç»“æŸçš„å­è¿›ç¨‹ PID\n        \n    - å¤±è´¥ï¼šè¿”å› -1ï¼ˆä¾‹å¦‚æ²¡æœ‰å­è¿›ç¨‹å­˜åœ¨æ—¶ï¼‰\n        \n- **ä½¿ç”¨ç¤ºä¾‹**\n\n```c\n#include <stdio.h>\n#include <sys/wait.h>\n#include <unistd.h>\n\nint main() {\n    pid_t pid = fork();\n    if (pid == 0) { // å­è¿›ç¨‹\n        printf(\"Child running...\\n\");\n        return 42;\n    } else { // çˆ¶è¿›ç¨‹\n        int status;\n        pid_t cpid = wait(&status); // ç­‰å¾…å­è¿›ç¨‹\n        if (WIFEXITED(status)) {   // åˆ¤æ–­æ˜¯å¦æ­£å¸¸é€€å‡º\n            printf(\"Child %d exited with code %d\\n\", cpid, WEXITSTATUS(status));\n        }\n    }\n    return 0;\n}\n```\n\n!!! caution   \n    - `wait()` ä¼šé˜»å¡çˆ¶è¿›ç¨‹ï¼Œç›´åˆ°ä»»æ„ä¸€ä¸ªå­è¿›ç¨‹é€€å‡ºã€‚\n        \n    - å¦‚æœçˆ¶è¿›ç¨‹æ²¡æœ‰å­è¿›ç¨‹ï¼Œè¿”å› -1 å¹¶è®¾ç½® `errno = ECHILD`ã€‚\n        \n\n### 2. waitpid()\n\n```c\n#include <sys/types.h>\n#include <sys/wait.h>\n#include <unistd.h>\n\npid_t waitpid(pid_t pid, int *status, int options);\n```\n\n- **å‚æ•°**\n    - `pid`ï¼š\n        \n        - `>0` ï¼šç­‰å¾…æŒ‡å®š PID çš„å­è¿›ç¨‹\n            \n        - -1 ï¼šç­‰å¾…ä»»æ„å­è¿›ç¨‹ï¼ˆåŠŸèƒ½ç±»ä¼¼ `wait()`ï¼‰\n            \n        - 0 ï¼šç­‰å¾…ä¸è°ƒç”¨è¿›ç¨‹åŒç»„çš„ä»»æ„å­è¿›ç¨‹\n            \n        - <-1ï¼šç­‰å¾…è¿›ç¨‹ç»„ ID = |pid| çš„ä»»æ„å­è¿›ç¨‹\n            \n    - `status`ï¼šæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆï¼Œç”¨äºä¿å­˜é€€å‡ºçŠ¶æ€\n        \n    - `options`ï¼šæ§åˆ¶å‡½æ•°è¡Œä¸ºï¼Œå¸¸ç”¨å€¼ï¼š\n        \n        - `0`ï¼šé˜»å¡ç­‰å¾…ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰\n            \n        - `WNOHANG`ï¼šéé˜»å¡ï¼Œå¦‚æœæ²¡æœ‰å­è¿›ç¨‹é€€å‡ºç«‹å³è¿”å› 0\n            \n        - `WUNTRACED`ï¼šè¿”å›è¢«æš‚åœçš„å­è¿›ç¨‹ï¼ˆæ”¶åˆ° SIGSTOPï¼‰\n            \n        - `WCONTINUED`ï¼šè¿”å›ç»§ç»­è¿è¡Œçš„å­è¿›ç¨‹ï¼ˆæ”¶åˆ° SIGCONTï¼‰\n            \n- **è¿”å›å€¼**\n    \n    - æˆåŠŸï¼šè¿”å›å­è¿›ç¨‹ PID\n        \n    - éé˜»å¡ä¸”æ²¡æœ‰å­è¿›ç¨‹é€€å‡ºï¼šè¿”å› 0\n        \n    - å¤±è´¥ï¼šè¿”å› -1ï¼Œå¹¶è®¾ç½® `errno`\n        \n- **ä½¿ç”¨ç¤ºä¾‹**\n    \n\n```c\n#include <stdio.h>\n#include <sys/wait.h>\n#include <unistd.h>\n\nint main() {\n    pid_t pid = fork();\n    if (pid == 0) { // å­è¿›ç¨‹\n        sleep(2);\n        return 100;\n    } else { // çˆ¶è¿›ç¨‹\n        int status;\n        pid_t cpid;\n        while ((cpid = waitpid(pid, &status, WNOHANG)) == 0) {\n            printf(\"Child still running...\\n\");\n            sleep(1);\n        }\n        if (WIFEXITED(status)) {\n            printf(\"Child %d exited with code %d\\n\", cpid, WEXITSTATUS(status));\n        }\n    }\n    return 0;\n}\n```\n\n!!! caution \n    - `waitpid()` å¯ä»¥å®ç° **éé˜»å¡ç­‰å¾…**ï¼Œé€‚åˆçˆ¶è¿›ç¨‹åŒæ—¶ç®¡ç†å¤šä¸ªå­è¿›ç¨‹ã€‚\n        \n    - `WIFEXITED(status)` åˆ¤æ–­å­è¿›ç¨‹æ˜¯å¦æ­£å¸¸é€€å‡ºã€‚\n        \n    - `WIFSIGNALED(status)` åˆ¤æ–­å­è¿›ç¨‹æ˜¯å¦è¢«ä¿¡å·ç»ˆæ­¢ã€‚\n        \n    - ä½¿ç”¨ `waitpid()` å¯ä»¥ç²¾å‡†å›æ”¶æŒ‡å®šå­è¿›ç¨‹ï¼Œé¿å…åƒµå°¸è¿›ç¨‹ç§¯ç´¯ã€‚\n        \n\n!!! note \"tips\"\n    - çˆ¶è¿›ç¨‹åªéœ€è¦ç­‰å¾…ä»»æ„å­è¿›ç¨‹ â†’ ç”¨ `wait()` å³å¯ã€‚\n    \n    - çˆ¶è¿›ç¨‹éœ€è¦ç²¾ç¡®æ§åˆ¶æˆ–éé˜»å¡ â†’ ç”¨ `waitpid()`ã€‚\n    \n    - è°ƒç”¨å‰ä¸€å®šè¦ç†è§£ **é˜»å¡ vs éé˜»å¡**ï¼Œé¿å…çˆ¶è¿›ç¨‹è¢«å¡ä½ã€‚\n\n## 5. è¿›ç¨‹é€€å‡º â€” `exit()` ä¸ `_exit()`\n\n- `exit()`ï¼šä¼šåˆ·æ–°ç¼“å†²åŒºï¼Œæ‰§è¡Œæ¸…ç†å‡½æ•°ã€‚\n    \n- `_exit()`ï¼šç«‹å³é€€å‡ºï¼Œä¸åšæ¸…ç†ï¼Œé€šå¸¸åœ¨å­è¿›ç¨‹ `fork()` åçš„é”™è¯¯å¤„ç†ä¸­ä½¿ç”¨ã€‚\n    \n\nâš ï¸ åŒºåˆ«ï¼š`exit()` é€‚åˆæ™®é€šé€€å‡ºï¼Œ`_exit()` é€‚åˆåœ¨ `fork()` åä¸å¸Œæœ›å½±å“çˆ¶è¿›ç¨‹çš„ç¯å¢ƒæ—¶ä½¿ç”¨ã€‚\n\n!!! caution\n    - å­è¿›ç¨‹æ‰§è¡Œé€€å‡ºå‡½æ•°åï¼Œå­è¿›ç¨‹ç»“æŸå¹¶å˜ä¸ºåƒµå°¸ğŸ§Ÿï¼Œå†…æ ¸ä¿ç•™å­è¿›ç¨‹åœ¨è¿›ç¨‹è¡¨ä¸­çš„éƒ¨åˆ†ä¿¡æ¯ï¼ˆPIDã€é€€å‡ºç ç­‰ï¼‰å ç”¨å°‘é‡ç³»ç»Ÿèµ„æºï¼Œä½†ä¸ä¼šå†è¿è¡Œã€‚éœ€è¦çˆ¶è¿›ç¨‹è°ƒç”¨waité‡Šæ”¾å­è¿›ç¨‹èµ„æºï¼Œå‡€åŒ–åƒµå°¸ï¼Œé‡Šæ”¾çµé­‚ğŸ‘»\n\n\n## 6. ps å‘½ä»¤ç®€è¿°\n\n### `ps` å‘½ä»¤çš„å¸¸è§ç”¨æ³•\n\n#### 1. æŸ¥çœ‹å½“å‰ç»ˆç«¯ä¸­çš„è¿›ç¨‹\n\nè¿™æ˜¯æœ€ç®€å•çš„ç”¨æ³•ï¼Œä¸åŠ ä»»ä½•é€‰é¡¹ï¼Œ`ps` å‘½ä»¤åªä¼šæ˜¾ç¤ºå½“å‰ç»ˆç«¯ä¼šè¯ä¸­è¿è¡Œçš„è¿›ç¨‹ã€‚\n\n```bash\nps\n```\n\nè¿è¡Œåä½ å¯èƒ½ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š\n\n```bash\nPID TTY          TIME CMD\n1234 pts/0    00:00:00 bash\n5678 pts/0    00:00:00 ps\n```\n\n- **PID**ï¼šè¿›ç¨‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆProcess IDï¼‰ã€‚\n    \n- **TTY**ï¼šè¿›ç¨‹è¿è¡Œæ‰€åœ¨çš„ç»ˆç«¯ã€‚\n    \n- **TIME**ï¼šè¿›ç¨‹ä½¿ç”¨çš„ CPU æ—¶é—´ã€‚\n    \n- **CMD**ï¼šå¯åŠ¨è¿›ç¨‹çš„å‘½ä»¤ã€‚\n    \n\n#### 2. æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹\n\nå¦‚æœä½ æƒ³æŸ¥çœ‹ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ `-e` é€‰é¡¹ï¼ˆä»£è¡¨æ‰€æœ‰è¿›ç¨‹ï¼‰æˆ– `-a` é€‰é¡¹ï¼ˆä»£è¡¨æ‰€æœ‰è¿›ç¨‹ï¼Œé™¤äº†ä¼šè¯å¼•å¯¼è¿›ç¨‹ï¼‰ã€‚\n\n```bash\nps -e\n```\n\næˆ–è€…ä½¿ç”¨ `-ef` ç»„åˆï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„ç»„åˆä¹‹ä¸€ï¼Œå®ƒæä¾›äº†æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼š\n\n```bash\nps -ef\n```\n\n- **UID**ï¼šå¯åŠ¨è¿›ç¨‹çš„ç”¨æˆ· IDã€‚\n    \n- **PID**ï¼šè¿›ç¨‹ IDã€‚\n    \n- **PPID**ï¼šçˆ¶è¿›ç¨‹ IDã€‚\n    \n- **C**ï¼šCPU åˆ©ç”¨ç‡ã€‚\n    \n- **STIME**ï¼šè¿›ç¨‹å¯åŠ¨æ—¶é—´ã€‚\n    \n- **TTY**ï¼šè¿›ç¨‹æ‰€åœ¨çš„ç»ˆç«¯ã€‚\n    \n- **TIME**ï¼šè¿›ç¨‹ä½¿ç”¨çš„ CPU æ—¶é—´ã€‚\n    \n- **CMD**ï¼šå¯åŠ¨è¿›ç¨‹çš„å‘½ä»¤ã€‚\n    \n\n#### 3. æŸ¥çœ‹ç”¨æˆ·è¿›ç¨‹\n\nå¦‚æœä½ åªæƒ³æŸ¥çœ‹æŸä¸ªç‰¹å®šç”¨æˆ·ï¼ˆä¾‹å¦‚ `root`ï¼‰çš„è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ `-u` é€‰é¡¹ã€‚\n\n```bash\nps -u root\n```\n\n#### 4. é€šè¿‡ç®¡é“å’Œ `grep` æŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹\n\nåœ¨å®é™…å·¥ä½œä¸­ï¼Œä½ é€šå¸¸ä¼šéœ€è¦æŸ¥æ‰¾æŸä¸ªç‰¹å®šçš„è¿›ç¨‹ï¼Œæ¯”å¦‚ Nginx æˆ– MySQLã€‚è¿™æ—¶ï¼Œ`ps` å‘½ä»¤é€šå¸¸ä¼šé…åˆ `grep` å‘½ä»¤ä¸€èµ·ä½¿ç”¨ã€‚`grep` å¯ä»¥ä» `ps` çš„è¾“å‡ºä¸­è¿‡æ»¤å‡ºä½ æƒ³è¦çš„ä¿¡æ¯ã€‚\n\nä¾‹å¦‚ï¼ŒæŸ¥æ‰¾æ‰€æœ‰ä¸ Nginx ç›¸å…³çš„è¿›ç¨‹ï¼š\n\n```bash\nps -ef | grep nginx\n```\n\nè¿™é‡Œçš„ `|` æ˜¯ç®¡é“ç¬¦ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°† `ps -ef` å‘½ä»¤çš„è¾“å‡ºä½œä¸º `grep` å‘½ä»¤çš„è¾“å…¥ã€‚\n\n### `ps` å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹æ€»ç»“\n\n| é€‰é¡¹   | æè¿°                   |\n| ---- | -------------------- |\n| -e   | æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹               |\n| -f   | æ˜¾ç¤ºå®Œæ•´æ ¼å¼çš„åˆ—è¡¨            |\n| -a   | æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼ˆä¸åŒ…æ‹¬ä¼šè¯å¼•å¯¼è¿›ç¨‹ï¼‰    |\n| -u   | æŒ‰ç”¨æˆ·è¿‡æ»¤è¿›ç¨‹              |\n| -aux | æœ€ç»å…¸çš„ç»„åˆï¼Œæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†è¿›ç¨‹ä¿¡æ¯ |\n\n### å®é™…åº”ç”¨ç¤ºä¾‹\n\nå‡è®¾ä½ æƒ³æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­ CPU æˆ–å†…å­˜å ç”¨æœ€é«˜çš„å‡ ä¸ªè¿›ç¨‹ï¼Œ`ps` å‘½ä»¤å¯ä»¥ä¸ `head`ã€`sort` ç­‰å‘½ä»¤ç»“åˆä½¿ç”¨ã€‚\n\n**æŸ¥çœ‹ CPU å ç”¨æœ€é«˜çš„ 5 ä¸ªè¿›ç¨‹ï¼š**\n\n```bash\nps -aux --sort=-%cpu | head -n 6\n```\n\nè¿™é‡Œçš„ `--sort=-%cpu` è¡¨ç¤ºæŒ‰ CPU å ç”¨ç‡é™åºæ’åˆ—ï¼Œ`head -n 6` åˆ™å–å‰ 6 è¡Œï¼ˆåŒ…æ‹¬æ ‡é¢˜è¡Œï¼‰ã€‚\n\n### è§£æ `ps -aux` å‘½ä»¤çš„è¾“å‡º\n\nå½“ä½ è¿è¡Œ `ps -aux` å‘½ä»¤æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªåŒ…å«å¤šä¸ªåˆ—çš„è¡¨æ ¼ã€‚æ¯ä¸€åˆ—éƒ½æä¾›äº†å…³äºè¿›ç¨‹çš„é‡è¦ä¿¡æ¯ã€‚ä¸‹é¢æ˜¯å¯¹è¿™äº›åˆ—çš„è¯¦ç»†è§£é‡Šï¼š\n\n- **USER**ï¼šå¯åŠ¨è¯¥è¿›ç¨‹çš„ç”¨æˆ·ã€‚\n    \n- **PID**ï¼šè¿›ç¨‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆ**P**rocess **ID**ï¼‰ã€‚å½“ä½ éœ€è¦æ€æ­»ä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œé€šå¸¸ä¼šç”¨åˆ°è¿™ä¸ª IDã€‚\n    \n- **%CPU**ï¼šè¿›ç¨‹åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…ä½¿ç”¨çš„ **CPU** å ç”¨ç‡ã€‚\n    \n- **%MEM**ï¼šè¿›ç¨‹ä½¿ç”¨çš„ **ç‰©ç†å†…å­˜** å ç”¨ç‡ã€‚\n    \n- **VSZ**ï¼šè¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜å¤§å°ï¼ˆ**V**irtual **S**izeï¼‰ï¼Œå•ä½ä¸ºåƒå­—èŠ‚ï¼ˆKBï¼‰ã€‚\n    \n- **RSS**ï¼šè¿›ç¨‹ä½¿ç”¨çš„ **ç‰©ç†å†…å­˜** å¤§å°ï¼ˆ**R**esident **S**et **S**izeï¼‰ï¼Œå•ä½ä¸ºåƒå­—èŠ‚ï¼ˆKBï¼‰ã€‚\n    \n- **TTY**ï¼šè¿›ç¨‹è¿è¡Œæ‰€åœ¨çš„ç»ˆç«¯ã€‚å¦‚æœæ˜¾ç¤º `?`ï¼Œè¡¨ç¤ºè¯¥è¿›ç¨‹æ²¡æœ‰å…³è”çš„ç»ˆç«¯ï¼Œé€šå¸¸æ˜¯ç³»ç»Ÿè¿›ç¨‹ã€‚\n    \n- **STAT**ï¼šè¿›ç¨‹çš„å½“å‰çŠ¶æ€ï¼ˆ**STAT**usï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„åˆ—ï¼Œå¸¸ç”¨çš„çŠ¶æ€ç æœ‰ï¼š\n    \n    - **R**ï¼šæ­£åœ¨è¿è¡Œï¼ˆ**R**unningï¼‰æˆ–å¯è¿è¡Œï¼ˆ**R**unnableï¼‰ã€‚\n        \n    - **S**ï¼šå¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ï¼ˆ**S**leepingï¼‰ã€‚\n        \n    - **D**ï¼šä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ï¼ˆ**D**isk sleepï¼‰ï¼Œé€šå¸¸è¡¨ç¤ºè¿›ç¨‹æ­£åœ¨ç­‰å¾… I/O æ“ä½œã€‚\n        \n    - **Z**ï¼šåƒµå°¸è¿›ç¨‹ï¼ˆ**Z**ombieï¼‰ï¼Œè¿›ç¨‹å·²ç»ˆæ­¢ï¼Œä½†å…¶çˆ¶è¿›ç¨‹è¿˜æœªå¯¹å…¶è¿›è¡Œå–„åå¤„ç†ã€‚\n        \n    - **T**ï¼šåœæ­¢ï¼ˆ**S**toppedï¼‰ï¼Œè¿›ç¨‹è¢«ä¿¡å·åœæ­¢ã€‚\n        \n    - **<**ï¼šé«˜ä¼˜å…ˆçº§è¿›ç¨‹ã€‚\n        \n    - **N**ï¼šä½ä¼˜å…ˆçº§è¿›ç¨‹ã€‚\n        \n- **START**ï¼šè¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ã€‚\n    \n- **TIME**ï¼šè¿›ç¨‹å·²ç»æ¶ˆè€—çš„ **CPU æ—¶é—´** æ€»é‡ã€‚è¿™ä¸ %CPU ä¸åŒï¼Œ%CPU æ˜¯ç¬æ—¶å€¼ï¼Œè€Œ TIME æ˜¯ç´¯ç§¯å€¼ã€‚\n    \n- **COMMAND**ï¼šå¯åŠ¨è¯¥è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ï¼ŒåŒ…æ‹¬æ‰€æœ‰å‚æ•°ã€‚\n    \n\n### ç¤ºä¾‹è§£æ\n\nå‡è®¾ä½ è¿è¡Œ `ps -aux` çœ‹åˆ°ä»¥ä¸‹ä¸€è¡Œè¾“å‡ºï¼š\n\n```bash\nroot      1234  0.0  0.1 23456 1234 ?        S    Sep01  0:05 /usr/sbin/sshd -D\n```\n\n- **USER**ï¼š`root` ç”¨æˆ·ã€‚\n    \n- **PID**ï¼šè¿›ç¨‹ ID æ˜¯ `1234`ã€‚\n    \n- **%CPU**ï¼šCPU å ç”¨ç‡æ˜¯ `0.0%`ã€‚\n    \n- **%MEM**ï¼šå†…å­˜å ç”¨ç‡æ˜¯ `0.1%`ã€‚\n    \n- **VSZ**ï¼šè™šæ‹Ÿå†…å­˜å¤§å°æ˜¯ `23456 KB`ã€‚\n    \n- **RSS**ï¼šç‰©ç†å†…å­˜å¤§å°æ˜¯ `1234 KB`ã€‚\n    \n- **TTY**ï¼š`?`ï¼Œè¡¨ç¤ºæ²¡æœ‰å…³è”çš„ç»ˆç«¯ã€‚\n    \n- **STAT**ï¼š`S`ï¼Œè¡¨ç¤ºè¿›ç¨‹å¤„äºå¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ã€‚\n    \n- **START**ï¼šå¯åŠ¨æ—¶é—´æ˜¯ `Sep01`ã€‚\n    \n- **TIME**ï¼šæ€» CPU æ—¶é—´æ˜¯ `0:05`ï¼ˆ5ç§’ï¼‰ã€‚\n    \n- **COMMAND**ï¼šå®Œæ•´çš„å‘½ä»¤æ˜¯ `/usr/sbin/sshd -D`ï¼Œè¿™æ˜¯ä¸€ä¸ª SSH æœåŠ¡å®ˆæŠ¤è¿›ç¨‹ã€‚\n    \n\né€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œä½ å¯ä»¥å¿«é€Ÿäº†è§£ä¸€ä¸ªè¿›ç¨‹æ˜¯ç”±è°è¿è¡Œçš„ã€å®ƒæ¶ˆè€—äº†å¤šå°‘èµ„æºã€å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Œä»¥åŠå®ƒæ˜¯ä»€ä¹ˆç¨‹åºã€‚è¿™å¯¹äºç³»ç»Ÿç›‘æ§å’Œæ•…éšœæ’é™¤éå¸¸æœ‰å¸®åŠ©ã€‚","tags":["Linux","å†…æ ¸","è¿›ç¨‹"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"Linux Cæ ‡å‡†IOæ“ä½œ","url":"/posts/45385/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n# ğŸ“Œ C æ ‡å‡†åº“ I/O å‡½æ•°ï¼ˆåŸºäº `<stdio.h>`ï¼‰\n\n## 1. æ‰“å¼€å’Œå…³é—­æ–‡ä»¶\n\n```c\n#include <stdio.h>  \nFILE *fopen(const char *filename, const char *mode); \nint fclose(FILE *stream);\n```\n\n- **fopen å‚æ•° mode å¸¸ç”¨å€¼ï¼š**\n    \n    - `\"r\"`ï¼šåªè¯»ï¼ˆæ–‡ä»¶å¿…é¡»å­˜åœ¨ï¼‰\n        \n    - `\"w\"`ï¼šåªå†™ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™æ¸…ç©ºï¼‰\n        \n    - `\"a\"`ï¼šè¿½åŠ å†™ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰\n        \n    - `\"r+\"`ï¼šè¯»å†™ï¼ˆå¿…é¡»å­˜åœ¨ï¼‰\n        \n    - `\"w+\"`ï¼šè¯»å†™ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™æ¸…ç©ºï¼‰\n        \n    - `\"a+\"`ï¼šè¯»å†™ï¼ˆè¿½åŠ æ¨¡å¼ï¼‰\n        \n\n---\n\n## 2. è¯»å†™å­—ç¬¦\n\n```c\nint fgetc(FILE *stream);     // è¯»å–ä¸€ä¸ªå­—ç¬¦\nint fputc(int c, FILE *stream);  // å†™å…¥ä¸€ä¸ªå­—ç¬¦\n```\n\nç¤ºä¾‹ï¼š\n\n```c\nchar c = fgetc(fp);\nfputc('A', fp);\n```\n\n---\n\n## 3. è¯»å†™å­—ç¬¦ä¸²\n\n```c\nchar *fgets(char *s, int size, FILE *stream); // è¯»å–ä¸€è¡Œï¼ˆæœ€å¤š size-1 ä¸ªå­—ç¬¦ï¼‰ \nint fputs(const char *s, FILE *stream);       // å†™å…¥å­—ç¬¦ä¸²\n```\n\nç¤ºä¾‹ï¼š\n\n```c\nchar buf[100]; fgets(buf, sizeof(buf), fp); \nfputs(\"Hello\\n\", fp);\n```\n\n---\n\n## 4. æ ¼å¼åŒ– I/O\n\n```c\nint fprintf(FILE *stream, const char *format, ...);  // æ ¼å¼åŒ–è¾“å‡ºåˆ°æ–‡ä»¶ \nint fscanf(FILE *stream, const char *format, ...);   // æ ¼å¼åŒ–è¯»å–\n```\n\nç¤ºä¾‹ï¼š\n\n```c\nfprintf(fp, \"name=%s age=%d\\n\", \"Tom\", 20); \nfscanf(fp, \"%s %d\", name, &age);\n```\n\n---\n\n## 5. å—è¯»å†™ï¼ˆé€‚åˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰\n\n```c\nsize_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream); \nsize_t fwrite(const void *ptr, size_t size, size_t nmemb, FILE *stream);\n```\n\nç¤ºä¾‹ï¼š\n\n```c\nint data[10]; fwrite(data, sizeof(int), 10, fp); // å†™10ä¸ªæ•´æ•° \nfread(data, sizeof(int), 10, fp);  // è¯»10ä¸ªæ•´æ•°\n```\n\n---\n\n## 6. æ–‡ä»¶å®šä½\n\n```c\nint fseek(FILE *stream, long offset, int whence);  // ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆ\nlong ftell(FILE *stream);                         // è·å–å½“å‰ä½ç½® \nvoid rewind(FILE *stream);                        // å›åˆ°å¼€å¤´`\n```\n\n`whence` å¯å–ï¼š\n\n- `SEEK_SET`ï¼šæ–‡ä»¶å¼€å¤´\n    \n- `SEEK_CUR`ï¼šå½“å‰ä½ç½®\n    \n- `SEEK_END`ï¼šæ–‡ä»¶æœ«å°¾\n    \n\n---\n\n## 7. ç¼“å†²åˆ·æ–°\n\n```c\nint fflush(FILE *stream);  // å¼ºåˆ¶æŠŠç¼“å†²åŒºå†™å…¥æ–‡ä»¶\n```\n\nå¸¸ç”¨äºå†™æ—¥å¿—ï¼Œé¿å…å¼‚å¸¸é€€å‡ºæ—¶ä¸¢æ•°æ®ã€‚\n","tags":["Linux","å†…æ ¸","IO"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"Linux ç³»ç»ŸIOç¼–ç¨‹","url":"/posts/7076/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\n## æ–‡ä»¶æè¿°ç¬¦ï¼šå†…æ ¸åˆ†å‘çš„èº«ä»½è¯\n\nåœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ**æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼Œç®€ç§° FDï¼‰æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°**ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯æ™®é€šæ–‡ä»¶ã€ç›®å½•ã€ç½‘ç»œå¥—æ¥å­—ï¼ˆsocketï¼‰ï¼Œç”šè‡³æ˜¯è®¾å¤‡ï¼ˆå¦‚é”®ç›˜ã€æ˜¾ç¤ºå™¨ï¼‰ã€‚\n\næ–‡ä»¶æè¿°ç¬¦çš„è®¾è®¡ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š\n\n1. **ç®€åŒ–äº† I/O æ¥å£**ï¼šæ— è®ºæ˜¯è¯»å†™æœ¬åœ°æ–‡ä»¶ï¼Œè¿˜æ˜¯è¿›è¡Œç½‘ç»œé€šä¿¡ï¼Œå¼€å‘è€…éƒ½å¯ä»¥ä½¿ç”¨ä¸€å¥—ç»Ÿä¸€çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆ`read`, `write`, `close` ç­‰ï¼‰ï¼Œè€Œæ— éœ€å…³å¿ƒåº•å±‚çš„å…·ä½“ç±»å‹ã€‚è¿™ç§â€œä¸€åˆ‡çš†æ–‡ä»¶â€çš„è®¾è®¡å“²å­¦æ˜¯ Linux ç®€æ´å’Œå¼ºå¤§çš„ä½“ç°ã€‚\n    \n2. **éš”ç¦»äº†åº”ç”¨ç¨‹åºä¸å†…æ ¸**ï¼šåº”ç”¨ç¨‹åºåªçŸ¥é“ä¸€ä¸ªç®€å•çš„æ•´æ•°ï¼Œè€Œä¸éœ€è¦çŸ¥é“æ–‡ä»¶åœ¨ç£ç›˜ä¸Šçš„ç‰©ç†ä½ç½®ï¼Œä¹Ÿä¸ç”¨å…³å¿ƒå†…æ ¸æ˜¯å¦‚ä½•ç®¡ç†æ–‡ä»¶çš„ã€‚æ‰€æœ‰å¤æ‚çš„æ“ä½œéƒ½ç”±å†…æ ¸åœ¨å¹•åå®Œæˆã€‚\n    \n3. **ç®¡ç†ç³»ç»Ÿèµ„æº**ï¼šå†…æ ¸é€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¡¨æ¥ç®¡ç†æ¯ä¸ªè¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ã€‚å½“ä¸€ä¸ªè¿›ç¨‹ç»“æŸæ—¶ï¼Œå†…æ ¸å¯ä»¥æ ¹æ®è¿™ä¸ªè¡¨è‡ªåŠ¨å…³é—­æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶ï¼Œé¿å…èµ„æºæ³„éœ²ã€‚\n\næ–‡ä»¶æè¿°ç¬¦çš„å‡ ä¸ªé‡è¦ç‰¹ç‚¹ï¼š\n\n- **å”¯ä¸€æ€§**ï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œæ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ–‡ä»¶æè¿°ç¬¦ã€‚\n\n- **éè´Ÿæ•´æ•°**ï¼šæ–‡ä»¶æè¿°ç¬¦çš„å€¼é€šå¸¸ä» 3 å¼€å§‹åˆ†é…ï¼Œå› ä¸º 0ã€1ã€2 è¿™ä¸‰ä¸ªæè¿°ç¬¦è¢«ç³»ç»Ÿé¢„ç•™ç»™æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ã€‚\n    \n    - **0**ï¼šæ ‡å‡†è¾“å…¥ï¼ˆ`stdin`ï¼‰ï¼Œé€šå¸¸æ˜¯é”®ç›˜ã€‚\n        \n    - **1**ï¼šæ ‡å‡†è¾“å‡ºï¼ˆ`stdout`ï¼‰ï¼Œé€šå¸¸æ˜¯æ˜¾ç¤ºå™¨ã€‚\n        \n    - **2**ï¼šæ ‡å‡†é”™è¯¯ï¼ˆ`stderr`ï¼‰ï¼Œä¹Ÿé€šå¸¸æ˜¯æ˜¾ç¤ºå™¨ã€‚\n        \n- **è¿›ç¨‹ç§æœ‰**ï¼šæ–‡ä»¶æè¿°ç¬¦æ˜¯åœ¨è¿›ç¨‹å†…éƒ¨ä½¿ç”¨çš„ï¼Œä¸åŒè¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦äº’ä¸å½±å“ã€‚ä¾‹å¦‚ï¼Œè¿›ç¨‹ A çš„æ–‡ä»¶æè¿°ç¬¦ 3 å’Œè¿›ç¨‹ B çš„æ–‡ä»¶æè¿°ç¬¦ 3 å¯èƒ½æŒ‡å‘å®Œå…¨ä¸åŒçš„æ–‡ä»¶ã€‚\n\n## æœ€åŸºç¡€çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°\n\n **Linux I/O ç¼–ç¨‹ä¸­å¸¸è§çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°**ï¼Œè¿™äº›å‡½æ•°ä½äº **`unistd.h`**ï¼ˆä»¥åŠ `fcntl.h` ç­‰ï¼‰ä¸­ï¼Œæ˜¯ç”¨æˆ·æ€å’Œå†…æ ¸æ€äº¤äº’çš„åŸºç¡€æ¥å£ã€‚\n\n### 1. `open`\n\n```c\n#include <fcntl.h>    // open flags\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n\nint open(const char *pathname, int flags);\nint open(const char *pathname, int flags, mode_t mode);\n```\n\n#### ä½œç”¨\n\næ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè¿”å›ä¸€ä¸ª **æ–‡ä»¶æè¿°ç¬¦**ï¼ˆfdï¼Œæ•´æ•°ï¼‰ï¼Œåç»­ I/O éƒ½ä¾èµ–å®ƒã€‚\n#### å‚æ•°\n\n- `pathname`ï¼šæ–‡ä»¶è·¯å¾„ã€‚\n    \n- `flags`ï¼šæ‰“å¼€æ–¹å¼ï¼Œå¸¸ç”¨å€¼ï¼š\n    \n    - `O_RDONLY`ï¼šåªè¯»\n        \n    - `O_WRONLY`ï¼šåªå†™\n        \n    - `O_RDWR`ï¼šè¯»å†™\n        \n    - `O_CREAT`ï¼šè‹¥æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œéœ€è¦é…åˆ `mode` å‚æ•°\n        \n    - `O_TRUNC`ï¼šæ‰“å¼€æ—¶æ¸…ç©ºæ–‡ä»¶\n        \n    - `O_APPEND`ï¼šå†™æ—¶è¿½åŠ åˆ°æ–‡ä»¶å°¾éƒ¨\n\n\t- `O_NOBLOCK`ï¼šéé˜»å¡æ¨¡å¼\n        \n- `mode`ï¼šåˆ›å»ºæ–‡ä»¶æ—¶çš„æƒé™ï¼ˆå¦‚ `0666`ï¼Œå— umask å½±å“ï¼‰ã€‚\n#### è¿”å›å€¼\n\n- æˆåŠŸï¼šæ–‡ä»¶æè¿°ç¬¦ï¼ˆéè´Ÿæ•´æ•°ï¼‰\n    \n- å¤±è´¥ï¼š`-1`ï¼Œå¹¶è®¾ç½® `errno`\n\n---\n\n### 2. `write`\n\n```c\n#include <unistd.h>\n\nssize_t write(int fd, const void *buf, size_t count);\n```\n\n#### ä½œç”¨\n\nå‘æ–‡ä»¶ï¼ˆæˆ–è®¾å¤‡ï¼‰å†™å…¥æ•°æ®ã€‚\n#### å‚æ•°\n\n- `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦\n    \n- `buf`ï¼šè¦å†™å…¥çš„æ•°æ®ç¼“å†²åŒºæŒ‡é’ˆ\n    \n- `count`ï¼šè¦å†™å…¥çš„å­—èŠ‚æ•°\n#### è¿”å›å€¼\n\n- æˆåŠŸï¼šå®é™…å†™å…¥çš„å­—èŠ‚æ•°ï¼ˆå¯èƒ½å°äº `count`ï¼‰\n    \n- å¤±è´¥ï¼š`-1`\n#### æ³¨æ„\n\n- å¯¹äºæ™®é€šæ–‡ä»¶ï¼Œé€šå¸¸ä¼šå†™å…¥å…¨éƒ¨æ•°æ®ã€‚\n    \n- å¯¹äºç®¡é“ã€socket ç­‰ï¼Œå¯èƒ½åˆ†å¤šæ¬¡å†™å…¥ï¼Œéœ€è¦å¾ªç¯å†™ã€‚\n\n---\n\n### 3. `read`\n\n```c\n#include <unistd.h>\n  \nssize_t read(int fd, void *buf, size_t count);\n```\n#### ä½œç”¨\n\nä»æ–‡ä»¶ï¼ˆæˆ–è®¾å¤‡ï¼‰è¯»å–æ•°æ®ã€‚\n#### å‚æ•°\n\n- `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦\n    \n- `buf`ï¼šå­˜æ”¾è¯»å‡ºæ•°æ®çš„ç¼“å†²åŒº\n    \n- `count`ï¼šæœ€å¤§è¯»å–å­—èŠ‚æ•°\n#### è¿”å›å€¼\n\n- æˆåŠŸï¼šå®é™…è¯»å–çš„å­—èŠ‚æ•°\n    \n    - `0` è¡¨ç¤ºåˆ°è¾¾æ–‡ä»¶ç»“å°¾ (EOF)\n        \n- å¤±è´¥ï¼š`-1`\n#### æ³¨æ„\n\n- å®é™…è¯»å–å­—èŠ‚æ•°å¯èƒ½å°äº `count`ã€‚\n    \n- å¯¹äºé˜»å¡ I/Oï¼Œå¦‚æœæ²¡æœ‰æ•°æ®ï¼Œå¯èƒ½ä¼šæŒ‚èµ·ç­‰å¾…ã€‚\n\n---\n\n### 4. `lseek`\n\n```c\n#include <unistd.h>  \n\noff_t lseek(int fd, off_t offset, int whence);\n```\n\n#### ä½œç”¨\n\nç§»åŠ¨æ–‡ä»¶è¯»å†™ä½ç½®ï¼ˆæ–‡ä»¶æŒ‡é’ˆï¼‰ã€‚\n#### å‚æ•°\n\n- `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦\n    \n- `offset`ï¼šåç§»é‡ï¼ˆå¯æ­£å¯è´Ÿï¼‰\n    \n- `whence`ï¼šåç§»èµ·å§‹ç‚¹\n    \n    - `SEEK_SET`ï¼šä»æ–‡ä»¶å¼€å¤´\n        \n    - `SEEK_CUR`ï¼šä»å½“å‰ä½ç½®\n        \n    - `SEEK_END`ï¼šä»æ–‡ä»¶æœ«å°¾\n#### è¿”å›å€¼\n\n- æˆåŠŸï¼šæ–°çš„æ–‡ä»¶åç§»ä½ç½®\n    \n- å¤±è´¥ï¼š`-1`\n#### æ³¨æ„\n\n- å¸¸ç”¨æ¥å®ç°éšæœºè¯»å†™ã€‚\n    \n- å¯¹æŸäº›è®¾å¤‡æ–‡ä»¶å¯èƒ½ä¸æ”¯æŒï¼ˆå¦‚ç®¡é“ï¼‰ã€‚\n    \n\n---\n\n### 5. `close`\n\n```c\n#include <unistd.h>\n\nint close(int fd);\n```\n\n#### ä½œç”¨\n\nå…³é—­ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé‡Šæ”¾å†…æ ¸èµ„æºã€‚\n#### å‚æ•°\n\n- `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦\n#### è¿”å›å€¼\n\n- æˆåŠŸï¼š`0`\n    \n- å¤±è´¥ï¼š`-1`\n\n## å¸¸è§å‡½æ•°æŸ¥æ‰¾è¡¨\n\n| å‡½æ•°      | å¤´æ–‡ä»¶                       | åŠŸèƒ½                      | ä¸»è¦å‚æ•°                                                                        | è¿”å›å€¼                       | å¸¸è§ç”¨é€”                |\n| ------- | ------------------------- | ----------------------- | --------------------------------------------------------------------------- | ------------------------- | ------------------- |\n| `open`  | `<fcntl.h>`, `<unistd.h>` | æ‰“å¼€æˆ–åˆ›å»ºæ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶æè¿°ç¬¦         | `pathname`ï¼šè·¯å¾„`flags`ï¼šæ‰“å¼€æ–¹å¼ï¼ˆå¦‚ `O_RDONLY`ï¼‰`mode`ï¼šæƒé™ï¼ˆå¦‚ `0644`ï¼Œä»…åœ¨ `O_CREAT` æ—¶æœ‰æ•ˆï¼‰ | æˆåŠŸï¼šæ–‡ä»¶æè¿°ç¬¦ (â‰¥0)å¤±è´¥ï¼š`-1`      | æ‰“å¼€æ–‡ä»¶/è®¾å¤‡ï¼Œè·å¾— `fd`     |\n| `write` | `<unistd.h>`              | å‘æ–‡ä»¶å†™å…¥æ•°æ®                 | `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦`buf`ï¼šæ•°æ®ç¼“å†²åŒº`count`ï¼šè¦å†™å…¥å­—èŠ‚æ•°                                         | æˆåŠŸï¼šå®é™…å†™å…¥å­—èŠ‚æ•°å¤±è´¥ï¼š`-1`         | å‘æ–‡ä»¶ã€ç®¡é“ã€socket å†™æ•°æ®   |\n| `read`  | `<unistd.h>`              | ä»æ–‡ä»¶è¯»å–æ•°æ®                 | `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦`buf`ï¼šå­˜æ”¾æ•°æ®çš„ç¼“å†²åŒº`count`ï¼šæœ€å¤§è¯»å–å­—èŠ‚æ•°                                     | æˆåŠŸï¼šå®é™…è¯»å–å­—èŠ‚æ•°`0`ï¼šæ–‡ä»¶ç»“å°¾å¤±è´¥ï¼š`-1` | è¯»å–æ–‡ä»¶ã€é”®ç›˜è¾“å…¥ã€ç½‘ç»œæ•°æ®      |\n| `lseek` | `<unistd.h>`              | æ”¹å˜æ–‡ä»¶è¯»å†™ä½ç½®ï¼ˆæ–‡ä»¶æŒ‡é’ˆï¼‰          | `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦`offset`ï¼šåç§»é‡`whence`ï¼šå‚è€ƒä½ç½®ï¼ˆ`SEEK_SET`/`SEEK_CUR`/`SEEK_END`ï¼‰       | æˆåŠŸï¼šæ–°çš„åç§»ä½ç½®å¤±è´¥ï¼š`-1`          | éšæœºè¯»å†™æ–‡ä»¶ã€è·å–æ–‡ä»¶å¤§å°       |\n| `close` | `<unistd.h>`              | å…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼Œé‡Šæ”¾èµ„æº            | `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦                                                                  | æˆåŠŸï¼š`0`å¤±è´¥ï¼š`-1`             | ç¨‹åºç»“æŸæˆ–æ–‡ä»¶ä¸å†ä½¿ç”¨æ—¶å…³é—­      |\n| `sync`  | `<unistd.h>`              | å°†å†…æ ¸ç¼“å†²åŒºä¸­æ‰€æœ‰ä¿®æ”¹è¿‡çš„æ•°æ®ï¼ˆè„é¡µï¼‰å†™å…¥ç£ç›˜ | æ—                                                                            | æ— è¿”å›å€¼                      | å…¨å±€åˆ·æ–°ï¼Œå½±å“æ‰€æœ‰æ–‡ä»¶ï¼Œæ•ˆç‡è¾ƒä½    |\n| `fsync` | `<unistd.h>`              | å°†æŒ‡å®šæ–‡ä»¶çš„ç¼“å­˜æ•°æ®å¼ºåˆ¶å†™å…¥ç£ç›˜        | `fd`ï¼šæ–‡ä»¶æè¿°ç¬¦                                                                  | æˆåŠŸï¼š`0`ï¼Œå¤±è´¥ï¼š`-1`            | ç²¾ç¡®åˆ°å•ä¸ªæ–‡ä»¶ï¼Œå¸¸ç”¨äºæ•°æ®åº“ã€æ—¥å¿—å†™å…¥ |\n|`pipe`   | `<unistd.h>`               |åˆ›å»ºåŒ¿åç®¡é“ï¼Œç”¨äºè¿›ç¨‹é—´é€šä¿¡|`int pipefd[2]`|æˆåŠŸï¼š0ï¼Œå¤±è´¥ï¼š-1|`pipefd[0]` è¯»ç«¯ï¼Œ`pipefd[1]` å†™ç«¯|\n|`unlink` | `<unistd.h>`               |åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ï¼ˆç›®å½•ç”¨ `rmdir`ï¼‰|`pathname`ï¼šæ–‡ä»¶è·¯å¾„|æˆåŠŸï¼š0ï¼Œå¤±è´¥ï¼š-1|å®é™…åˆ é™¤åœ¨å¼•ç”¨è®¡æ•°å½’é›¶æ—¶å‘ç”Ÿ|\n|`access` | `<unistd.h>`               |  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨åŠæƒé™      |`pathname, mode`|æˆåŠŸï¼š0ï¼Œå¤±è´¥ï¼š-1 | `mode` å¯å– `R_OK, W_OK, X_OK, F_OK`|\n\n\n## å¯¹æ¯”C æ ‡å‡†åº“IOæ“ä½œ\n\nä½¿ç”¨cæ ‡å‡†åº“çš„IOæ“ä½œï¼Œå°é‡é¢‘ç¹è¯»å†™çš„æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå…¶å†…éƒ¨è‡ªå¸¦æœ‰ç¼“å†²åŒºã€‚\nè¿™å¯ä»¥ç†è§£ä¸ºåœ¨ç³»ç»ŸIOä¸Šæœ‰å°è£…äº†ä¸€å±‚ï¼Œè¿›è¡Œæ–‡ä»¶æ“ä½œæ—¶å†™å…¥Cè‡ªå¸¦ç¼“å†²åŒºï¼Œæ»¡è¶³ä¸€å®šæ¡ä»¶å†è°ƒç”¨ç³»ç»ŸIOï¼Œå°†ç¼“å†²åŒºçš„å†…å®¹å†™å…¥IOç¼“å­˜åŒºï¼Œå†åˆ°å†…æ ¸çš„é¡µç¼“å­˜åŒºï¼Œæœ€ååˆ°ç‰©ç†çš„ç£ç›˜ã€‚\n\n| ç‰¹æ€§       | Linux ç³»ç»Ÿè°ƒç”¨ I/O                            | C æ ‡å‡†åº“æ–‡ä»¶æ“ä½œ                                                          |\n| -------- | ----------------------------------------- | ------------------------------------------------------------------ |\n| **å¤´æ–‡ä»¶**  | `<unistd.h>`, `<fcntl.h>`                 | `<stdio.h>`                                                        |\n| **å‡½æ•°ç¤ºä¾‹** | `open`, `read`, `write`, `lseek`, `close` | `fopen`, `fread`, `fwrite`, `fseek`, `fclose`, `fprintf`, `fscanf` |\n| **è¿”å›å€¼**  | ç›´æ¥è¿”å›å­—èŠ‚æ•°ã€æ–‡ä»¶æè¿°ç¬¦ç­‰ï¼Œæˆ– `-1`                     | è¿”å› `FILE*` æŒ‡é’ˆï¼Œæˆ– `EOF` ç­‰é”™è¯¯ç                                          |\n| **æ•°æ®å•ä½** | ä»¥ **å­—èŠ‚ï¼ˆbyteï¼‰** ä¸ºå•ä½                        | ä»¥ **ç¼“å†²åŒº / ç»“æ„åŒ–æ•°æ®** ä¸ºå•ä½ï¼ˆæœ‰ç¼“å†²æœºåˆ¶ï¼‰                                       |\n| **ç¼“å†²**   | **æ— ç”¨æˆ·æ€ç¼“å†²**ï¼Œç›´æ¥åœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´é—´ä¼ é€’æ•°æ®              | **å¸¦ç¼“å†²åŒº**ï¼ˆstdio åº“å†…éƒ¨ç»´æŠ¤ç¼“å­˜ï¼ŒåŠ é€Ÿå°å—è¯»å†™ï¼‰                                     |\n| **å±‚æ¬¡**   | æ“ä½œç³»ç»Ÿå†…æ ¸æä¾›çš„ **åº•å±‚æ¥å£**                        | åŸºäºç³»ç»Ÿè°ƒç”¨çš„ **å°è£…åº“å‡½æ•°**                                                  |\n| **çµæ´»æ€§**  | å¯æ“ä½œæ™®é€šæ–‡ä»¶ã€è®¾å¤‡æ–‡ä»¶ã€socketã€ç®¡é“                    | ä¸»è¦æ“ä½œæ™®é€šæ–‡ä»¶å’Œæ ‡å‡†è¾“å…¥è¾“å‡º                                                    |\n| **å¯ç§»æ¤æ€§** | åå‘ Unix/Linux ç³»ç»Ÿ                          | è·¨å¹³å°ï¼ˆç¬¦åˆ ANSI C æ ‡å‡†ï¼ŒWindows/Linux é€šç”¨ï¼‰                                 |\n| **å…¸å‹ç”¨é€”** | é©±åŠ¨å¼€å‘ã€ç³»ç»Ÿç¼–ç¨‹ã€ç²¾ç¡®æ§åˆ¶ I/O                        | åº”ç”¨å±‚æ–‡ä»¶è¯»å†™ã€æ–‡æœ¬å¤„ç†ã€å¿«é€Ÿå¼€å‘                                                  |\n\n\n","tags":["Linux","å†…æ ¸","IO"],"categories":["Linux","å†…æ ¸ç¼–ç¨‹"]},{"title":"MakeFileç®€æ˜æŒ‡å—","url":"/posts/4341/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n\n</details>\n\n---\n\nåœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œé¡¹ç›®é€šå¸¸åŒ…å«å¾ˆå¤šæºæ–‡ä»¶ï¼Œå¦‚æœæ¯æ¬¡ç¼–è¯‘éƒ½æ‰‹åŠ¨æ•²å‘½ä»¤ï¼Œä¸ä»…ç¹çï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚  \n**Makefile** å¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨åŒ–æ„å»ºæµç¨‹ï¼Œå¤§å¹…æå‡æ•ˆç‡ã€‚æœ¬æ–‡å°†ä»‹ç» Makefile çš„åŸºç¡€è¯­æ³•ä¸å¸¸ç”¨ç”¨æ³•ã€‚\n\n---\n\n- [1. åŸºç¡€ç”¨æ³•](#1-åŸºç¡€ç”¨æ³•)\n- [2. æ‰§è¡Œé€»è¾‘^1](#2-æ‰§è¡Œé€»è¾‘1)\n  - [2.1. ğŸ”„ æ‰§è¡Œæµç¨‹ç¤ºæ„å›¾](#21--æ‰§è¡Œæµç¨‹ç¤ºæ„å›¾)\n- [3. ä¼ªç›®æ ‡ .PHONY](#3-ä¼ªç›®æ ‡-phony)\n- [4. å˜é‡](#4-å˜é‡)\n  - [4.1. èµ‹å€¼ç¬¦å·](#41-èµ‹å€¼ç¬¦å·)\n- [5. éšå«è§„åˆ™ä¸é€šé…ç¬¦](#5-éšå«è§„åˆ™ä¸é€šé…ç¬¦)\n- [6. æ¡ä»¶åˆ†æ”¯](#6-æ¡ä»¶åˆ†æ”¯)\n  - [6.1. è¯­æ³•](#61-è¯­æ³•)\n  - [6.2. ç¤ºä¾‹ä¸€ï¼šæ ¹æ®å¹³å°é€‰æ‹©cleanæ‰§è¡Œæ–¹å¼](#62-ç¤ºä¾‹ä¸€æ ¹æ®å¹³å°é€‰æ‹©cleanæ‰§è¡Œæ–¹å¼)\n  - [6.3. ç¤ºä¾‹äºŒï¼šè°ƒè¯•æ¨¡å¼ä¸å‘å¸ƒæ¨¡å¼](#63-ç¤ºä¾‹äºŒè°ƒè¯•æ¨¡å¼ä¸å‘å¸ƒæ¨¡å¼)\n- [7. å‡½æ•°](#7-å‡½æ•°)\n  - [7.1. `subst` â€”â€” å­—ç¬¦ä¸²æ›¿æ¢](#71-subst--å­—ç¬¦ä¸²æ›¿æ¢)\n  - [7.2. `patsubst` â€”â€” æ¨¡å¼æ›¿æ¢](#72-patsubst--æ¨¡å¼æ›¿æ¢)\n  - [7.3. `wildcard` â€”â€” è·å–æ–‡ä»¶åˆ—è¡¨](#73-wildcard--è·å–æ–‡ä»¶åˆ—è¡¨)\n  - [7.4. `notdir` â€”â€” å»æ‰è·¯å¾„ï¼Œåªä¿ç•™æ–‡ä»¶å](#74-notdir--å»æ‰è·¯å¾„åªä¿ç•™æ–‡ä»¶å)\n  - [7.5. `dir` â€”â€” è·å–è·¯å¾„éƒ¨åˆ†](#75-dir--è·å–è·¯å¾„éƒ¨åˆ†)\n  - [7.6. `basename` ã€ `addsuffix` å’Œ `addprefix` â€”â€” æ‰¹é‡å¤„ç†æ–‡ä»¶å](#76-basename--addsuffix-å’Œ-addprefix--æ‰¹é‡å¤„ç†æ–‡ä»¶å)\n  - [7.7. `shell` â€”â€” æ‰§è¡Œ shell å‘½ä»¤](#77-shell--æ‰§è¡Œ-shell-å‘½ä»¤)\n- [8. å®Œæ•´ç¤ºä¾‹ç¨‹åº](#8-å®Œæ•´ç¤ºä¾‹ç¨‹åº)\n\n\n## 1. åŸºç¡€ç”¨æ³•\n\nä¸€ä¸ªå…¸å‹çš„è§„åˆ™æ ¼å¼å¦‚ä¸‹ï¼š\n\n```make\ntarget: dependencies\n<TAB> command\n```\n\n- targetï¼šç›®æ ‡æ–‡ä»¶ï¼Œæ¯”å¦‚å¯æ‰§è¡Œæ–‡ä»¶æˆ–ä¸­é—´æ–‡ä»¶ã€‚\n- dependenciesï¼šä¾èµ–æ–‡ä»¶ï¼ˆæºæ–‡ä»¶ã€å¤´æ–‡ä»¶ç­‰ï¼‰ã€‚\n- commandï¼šç”Ÿæˆç›®æ ‡æ‰€éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆå¿…é¡»ä»¥ TAB ç¼©è¿› å¼€å¤´ï¼‰ã€‚\n\nç¤ºä¾‹ï¼š\n```make\nmain.o: main.c\n\tgcc -c main.c -o main.o\n```\n\n!!! warning\n    ç”±äºmakfileå¯¹ç©ºæ ¼ã€tabæå…¶æ•æ„Ÿï¼Œå»ºè®®ç¼–å†™æ—¶æ‰“å¼€ç¼–è¾‘å™¨çš„ç©ºæ ¼ã€tabæ˜¾ç¤ºï¼Œå¹¶é¿å…ä¸å¿…è¦çš„ç©ºæ ¼ï¼Œè§„èŒƒåŒ–ä¹¦å†™ã€‚\n\n\n## 2. æ‰§è¡Œé€»è¾‘[^1]\n\nå½“æˆ‘ä»¬æ‰§è¡Œ `make` æ—¶ï¼Œå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š\n\n1. **è§£æ Makefile**\n   - `make` ä¼šä»å½“å‰ç›®å½•å¯»æ‰¾ `Makefile` æˆ– `makefile` æ–‡ä»¶ã€‚\n   - è¯»å–å…¶ä¸­çš„è§„åˆ™ã€å˜é‡ã€ä¼ªç›®æ ‡ç­‰å®šä¹‰ã€‚\n\n2. **ç¡®å®šé»˜è®¤ç›®æ ‡**\n   - ä¸€èˆ¬æ˜¯æ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªç›®æ ‡ï¼ˆä¾‹å¦‚ `app`ï¼‰ã€‚\n   - ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡ŒæŒ‡å®šï¼Œä¾‹å¦‚ï¼š  \n```bash\nmake clean\n```\n\n3. **æ£€æŸ¥ä¾èµ–å…³ç³»**\n   - ä»ç›®æ ‡å¼€å§‹ï¼Œé€å±‚æ£€æŸ¥ä¾èµ–æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€æ˜¯å¦æ¯”ç›®æ ‡æ–‡ä»¶æ›´æ–°ã€‚\n   - å¦‚æœä¾èµ–æ–‡ä»¶æ¯”ç›®æ ‡æ–‡ä»¶â€œæ–°â€ï¼Œè¯´æ˜ç›®æ ‡éœ€è¦é‡æ–°ç”Ÿæˆã€‚\n\n4. **æ‰§è¡Œå‘½ä»¤**\n   - å¯¹éœ€è¦æ›´æ–°çš„ç›®æ ‡ï¼Œæ‰§è¡Œå…¶è§„åˆ™ä¸­å®šä¹‰çš„å‘½ä»¤ã€‚\n   - å‘½ä»¤å¿…é¡»ä»¥ **TAB ç¼©è¿›** å¼€å¤´ã€‚\n\n5. **é€’å½’æ„å»º**\n   - å¦‚æœä¾èµ–æ–‡ä»¶æœ¬èº«ä¹Ÿæ˜¯å…¶ä»–è§„åˆ™çš„ç›®æ ‡ï¼Œåˆ™ä¼šé€’å½’æ£€æŸ¥å’Œæ‰§è¡Œã€‚\n   - ç›´åˆ°æ‰€æœ‰ä¾èµ–æ»¡è¶³ï¼Œæ‰æœ€ç»ˆç”Ÿæˆç›®æ ‡ã€‚\n\n6. **ç»“æŸ**\n   - å¦‚æœæ‰€æœ‰ç›®æ ‡éƒ½å·²æ˜¯æœ€æ–°ï¼Œåˆ™ `make` ä¼šæç¤ºï¼š\n```\nmake: 'app' is up to date.\n```\n\n### 2.1. ğŸ”„ æ‰§è¡Œæµç¨‹ç¤ºæ„å›¾\n\n```text\n          make\n           â”‚\n           â–¼\n   è¯»å–å¹¶è§£æ Makefile\n           â”‚\n           â–¼\n   ç¡®å®šè¦æ„å»ºçš„ç›®æ ‡ (é»˜è®¤/æŒ‡å®š)\n           â”‚\n           â–¼\n   æ£€æŸ¥ç›®æ ‡çš„ä¾èµ–æ–‡ä»¶\n           â”‚\n    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚               â”‚\nä¾èµ–æ¯”ç›®æ ‡æ—§      ä¾èµ–æ¯”ç›®æ ‡æ–°/ä¸å­˜åœ¨\n    â”‚               â”‚\nç›®æ ‡å·²æ˜¯æœ€æ–°    æ‰§è¡Œè§„åˆ™å‘½ä»¤ â†’ ç”Ÿæˆæ–°ç›®æ ‡\n```\n\n!!! info \"tips\"\n    å¯ä»¥ä½¿ç”¨ make -f [makefile_name] æŒ‡å®šä½¿ç”¨æŸä¸ªmakefileæ–‡ä»¶ã€‚\n    \n    \n## 3. ä¼ªç›®æ ‡ .PHONY\n\næœ‰äº›ç›®æ ‡ä¸æ˜¯å®é™…æ–‡ä»¶ï¼Œè€Œåªæ˜¯ä¸€ä¸ªæ“ä½œï¼Œä¾‹å¦‚ `clean`ã€‚  \nè¿™æ—¶å»ºè®®ä½¿ç”¨ **.PHONY** å£°æ˜ï¼š\n\n```make\n.PHONY:Â clean  \nclean:  \n\trm -r Â [filepath]\n```\næŒ‡å®šmakeç›®æ ‡æ–‡ä»¶ï¼š\n```make\nmake clean\n```\n\n## 4. å˜é‡\n\nMakefile æ”¯æŒå˜é‡ï¼Œå¸¸ç”¨äºä¿å­˜ç¼–è¯‘å™¨æˆ–ç¼–è¯‘é€‰é¡¹ã€‚\nä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š\n```make\nCC = gcc\nCFLAGS = -Wall -g\n\napp: main.o utils.o\n\t$(CC) $(CFLAGS) main.o utils.o -o app\n\nmain.o: main.c\n\t$(CC) $(CFLAGS) -c main.c -o main.o\n\nutils.o: utils.c\n\t$(CC) $(CFLAGS) -c utils.c -o utils.o\n```\n\n### 4.1. èµ‹å€¼ç¬¦å·\n\n- **=** \n\tæˆ‘ç§°ä¹‹ä¸ºæœ€ç»ˆèµ‹å€¼ï¼ŒåŒä¸€ä¸ªå˜é‡æ— è®ºè¢«èµ‹å€¼å¤šæ¬¡ï¼Œæ°¸è¿œå–æœ€åæŒ‡å®šçš„å€¼ã€‚\nç¤ºä¾‹ï¼š\n```make\nVIR_A = A\nVIR_B = $(VIR_A) B\nVIR_A = AA\n```\næœ€åVIR_Bçš„å€¼æ˜¯AA Bã€‚\n- **:=**\n\tç«‹å³èµ‹å€¼ï¼Œæ­£å¸¸é€»è¾‘çš„èµ‹å€¼å·ï¼Œç±»ä¼¼äºcè¯­è¨€çš„èµ‹å€¼å·ã€‚\n- **?=**\n\tå¦‚æœå˜é‡åœ¨ä¹‹å‰æ²¡æœ‰è¢«èµ‹å€¼åˆ™èµ‹å€¼ã€‚\n\tå¯ä»¥ç†è§£ä¸º\n\t```\n\t#ifndef\n\t#define ...\n\t#endif\n\t```\n- **+=**\n\tè¿½åŠ èµ‹å€¼ï¼Œå°†å€¼è¿½åŠ åˆ°å˜é‡ä¸­ã€‚\n\n## 5. éšå«è§„åˆ™ä¸é€šé…ç¬¦\n\nMake å†…ç½®äº†ä¸€äº›è§„åˆ™ï¼Œå¯ä»¥ç”¨ç®€å†™æ–¹å¼ï¼š\n- `$@`ï¼šç›®æ ‡æ–‡ä»¶å\n- `$<`ï¼šç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶\n- `$^`ï¼šæ‰€æœ‰ä¾èµ–æ–‡ä»¶\n\n`%` è¡¨ç¤ºå¯ä»¥åŒ¹é…ä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œç”¨äºå®šä¹‰ä¸€ç±»æ–‡ä»¶çš„ç”Ÿæˆè§„åˆ™ã€‚ä¾‹å¦‚ï¼š\n```make\n%.o: %.c     \n\tgcc -c $< -o $@\n```\n- å«ä¹‰ï¼š\n    - `%.o` è¡¨ç¤ºæ‰€æœ‰ä»¥ `.o` ç»“å°¾çš„ç›®æ ‡æ–‡ä»¶ã€‚\n    - `%.c` è¡¨ç¤ºæ‰€æœ‰ä»¥ `.c` ç»“å°¾çš„æºæ–‡ä»¶ã€‚\n    - `$<` æ˜¯ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶ï¼ˆè¿™é‡Œæ˜¯ `.c` æ–‡ä»¶ï¼‰ã€‚\n    - `$@` æ˜¯ç›®æ ‡æ–‡ä»¶ï¼ˆè¿™é‡Œæ˜¯ `.o` æ–‡ä»¶ï¼‰ã€‚\n- ä½œç”¨ï¼šè¿™æ¡è§„åˆ™è¡¨ç¤ºï¼Œæ‰€æœ‰ `.c` æ–‡ä»¶å¯ä»¥é€šè¿‡ç¼–è¯‘ç”Ÿæˆå¯¹åº”çš„ `.o` æ–‡ä»¶ã€‚\n\n---\n\n`%` å¯ä»¥åŒ¹é…æ–‡ä»¶åçš„æŸä¸€éƒ¨åˆ†ï¼Œç”¨äºç®€åŒ–è§„åˆ™ã€‚ä¾‹å¦‚ï¼š\n```\nbuild/%: src/%     \n\tcp $< $@\n```\n- å«ä¹‰ï¼š\n    - `build/%` è¡¨ç¤ºç›®æ ‡æ–‡ä»¶åœ¨ `build/` ç›®å½•ä¸‹ã€‚\n    - `src/%` è¡¨ç¤ºä¾èµ–æ–‡ä»¶åœ¨ `src/` ç›®å½•ä¸‹ã€‚\n    - `$<` æ˜¯ä¾èµ–æ–‡ä»¶ï¼Œ`$@` æ˜¯ç›®æ ‡æ–‡ä»¶ã€‚\n- ä½œç”¨ï¼šè¿™æ¡è§„åˆ™è¡¨ç¤ºï¼Œå°† `src/` ç›®å½•ä¸‹çš„æ–‡ä»¶å¤åˆ¶åˆ° `build/` ç›®å½•ä¸‹ã€‚\n\n---\n\nåœ¨æ¨¡å¼è§„åˆ™ä¸­ï¼Œ`%` å¯ä»¥ç”¨äºå®šä¹‰å¤šä¸ªç›®æ ‡ã€‚ä¾‹å¦‚ï¼š\n```\n%.a: %.b %.c     \n\tcat $^ > $@`\n```\n- å«ä¹‰ï¼š\n    - `%.a` æ˜¯ç›®æ ‡æ–‡ä»¶ã€‚\n    - `%.b` å’Œ `%.c` æ˜¯ä¾èµ–æ–‡ä»¶ã€‚\n    - `$^` è¡¨ç¤ºæ‰€æœ‰ä¾èµ–æ–‡ä»¶ï¼Œ`$@` æ˜¯ç›®æ ‡æ–‡ä»¶ã€‚\n- ä½œç”¨ï¼šè¿™æ¡è§„åˆ™è¡¨ç¤ºï¼Œå°† `.b` å’Œ `.c` æ–‡ä»¶åˆå¹¶ç”Ÿæˆ `.a` æ–‡ä»¶ã€‚\n\n---\n\n## 6. æ¡ä»¶åˆ†æ”¯\n\nåœ¨ Makefile ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¡ä»¶è¯­å¥æ¥æ ¹æ®ä¸åŒæƒ…å†µæ‰§è¡Œä¸åŒè§„åˆ™æˆ–å®šä¹‰å˜é‡ã€‚å¸¸è§çš„æœ‰ `ifeq`ã€`ifneq`ã€`ifdef`ã€`ifndef`ã€‚\n### 6.1. è¯­æ³•\n```make\nifeq (æ¡ä»¶1, æ¡ä»¶2)\n    # å½“ æ¡ä»¶1 == æ¡ä»¶2 æ—¶æ‰§è¡Œè¿™é‡Œ\nelse\n    # å¦åˆ™æ‰§è¡Œè¿™é‡Œ\nendif\n\nifneq (æ¡ä»¶1, æ¡ä»¶2)\n    # å½“ æ¡ä»¶1 != æ¡ä»¶2 æ—¶æ‰§è¡Œè¿™é‡Œ\nendif\n\nifdef å˜é‡å\n    # å½“å˜é‡å·²å®šä¹‰æ—¶æ‰§è¡Œè¿™é‡Œ\nendif\n\nifndef å˜é‡å\n    # å½“å˜é‡æœªå®šä¹‰æ—¶æ‰§è¡Œè¿™é‡Œ\nendif\n```\n\n### 6.2. ç¤ºä¾‹ä¸€ï¼šæ ¹æ®å¹³å°é€‰æ‹©cleanæ‰§è¡Œæ–¹å¼\n```make\n# é»˜è®¤å˜é‡\nCC = gcc\n\n# åˆ¤æ–­ç³»ç»Ÿ\nifeq ($(OS), Windows_NT)\n    RM = del\nelse\n    RM = rm -f\nendif\n\napp: main.o\n\t$(CC) main.o -o app\n\nclean:\n\t$(RM) *.o app\n```\n\n### 6.3. ç¤ºä¾‹äºŒï¼šè°ƒè¯•æ¨¡å¼ä¸å‘å¸ƒæ¨¡å¼\n```make\n# è®¾ç½®ç¼–è¯‘é€‰é¡¹\nCFLAGS = -Wall\n\nifeq ($(MODE), debug)\n    CFLAGS += -g\nelse\n    CFLAGS += -O2\nendif\n\napp: main.o\n\t$(CC) $(CFLAGS) main.o -o app\n```\nä½¿ç”¨æ–¹å¼ï¼š\n```bash\nmake MODE=debug   # è°ƒè¯•æ¨¡å¼ï¼Œå¸¦è°ƒè¯•ä¿¡æ¯\nmake MODE=release # é»˜è®¤ä¼˜åŒ–æ¨¡å¼\n```\n\n## 7. å‡½æ•°\n\nMakefile å†…ç½®äº†è®¸å¤šå‡½æ•°ï¼Œç”¨æ¥å¤„ç†å­—ç¬¦ä¸²ã€æ–‡ä»¶åã€è·¯å¾„ç­‰ã€‚  \nå¸¸è§å‡½æ•°æ ¼å¼ä¸ºï¼š\n\n```make\n$(å‡½æ•°å å‚æ•°1 å‚æ•°2 ...)\n```\n\nä¸‹é¢ä»‹ç»ä¸€äº›**å¸¸ç”¨å‡½æ•°**\n\n### 7.1. `subst` â€”â€” å­—ç¬¦ä¸²æ›¿æ¢\n\n```make\n$(subst from,to,text)\n```\n\n- åŠŸèƒ½ï¼šå°† `text` ä¸­çš„ `from` æ›¿æ¢ä¸º `to`ã€‚\n    \n- ç¤ºä¾‹ï¼š\n\n```\nSRC = main.c utils.c \nOBJ = $(subst .c,.o,$(SRC)) \n\n# ç»“æœï¼šOBJ = main.o utils.o\n```\n\n---\n\n### 7.2. `patsubst` â€”â€” æ¨¡å¼æ›¿æ¢\n\n```make\n$(patsubst pattern,replacement,text)\n```\n\n- åŠŸèƒ½ï¼šæ›´çµæ´»çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ”¯æŒé€šé…ç¬¦ `%`ã€‚\n    \n- ç¤ºä¾‹ï¼š\n```make\nSRC = main.c utils.c test.c\nOBJ = $(patsubst %.c,%.o,$(SRC))\n\n# ç»“æœï¼šOBJ = main.o utils.o test.o\n```\n\n---\n\n### 7.3. `wildcard` â€”â€” è·å–æ–‡ä»¶åˆ—è¡¨\n\n```make\n$(wildcard pattern)\n```\n\n- åŠŸèƒ½ï¼šåŒ¹é…ç¬¦åˆæ¨¡å¼çš„æ–‡ä»¶ã€‚\n    \n- ç¤ºä¾‹ï¼š\n```make\nSRC = $(wildcard *.c)\n# ç»“æœï¼šSRC = å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ .c æ–‡ä»¶\n```\n\n---\n\n### 7.4. `notdir` â€”â€” å»æ‰è·¯å¾„ï¼Œåªä¿ç•™æ–‡ä»¶å\n\n```make\nFILES = src/main.c src/utils.c\nNAMES = $(notdir $(FILES))\n# ç»“æœï¼šNAMES = main.c utils.c\n```\n---\n\n### 7.5. `dir` â€”â€” è·å–è·¯å¾„éƒ¨åˆ†\n\n```make\nFILES = src/main.c src/utils.c\nPATHS = $(dir $(FILES))\n# ç»“æœï¼šPATHS = src/ src/\n```\n\n---\n\n### 7.6. `basename` ã€ `addsuffix` å’Œ `addprefix` â€”â€” æ‰¹é‡å¤„ç†æ–‡ä»¶å\n\n```make\nFILES = main.c utils.c\n\n# å»æ‰åç¼€\nNAMES = $(basename $(FILES))\n# NAMES = main utils\n\n# æ‰¹é‡æ·»åŠ åç¼€\nOBJS = $(addsuffix .o,$(NAMES))\n# OBJS = main.o utils.o\n\n# æ‰¹é‡æ·»åŠ å‰ç¼€\nOBJS = $(addprefix -I,$(NAMES))\n# OBJS = -Imain -Iutils\n```\n\n---\n\n### 7.7. `shell` â€”â€” æ‰§è¡Œ shell å‘½ä»¤\n\n```make\nDATE = $(shell date +%Y-%m-%d)\n```\n\nè¿™æ ·å¯ä»¥åœ¨ Makefile ä¸­ç›´æ¥ä½¿ç”¨ç³»ç»Ÿå‘½ä»¤çš„è¾“å‡ºã€‚\n\n## 8. å®Œæ•´ç¤ºä¾‹ç¨‹åº\n\nè¿™æ˜¯ä¸€ä¸ªå®Œæ•´Makefileç¤ºä¾‹ç¨‹åºï¼Œç”¨äºå°†cè¯­è¨€ç¨‹åºç¼–è¯‘ä¸ºå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶binæ–‡ä»¶ã€‚å®ƒå¯ä»¥åˆ¶æˆé•œåƒä¾›SoCçƒ§å½•ã€‚\n\n```make\n#0###########################################################\n\n# è®¾ç½®ç›®å½•å˜é‡ï¼Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†å’Œä¿®æ”¹\n# å½“å‰æ ¹ç›®å½•:\nROOT_DIR := .\n\n# ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆ.oï¼‰è¾“å‡ºç›®å½•:\nBUILD_DIR := build\n\n# æœ€ç»ˆç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆ.binï¼‰ç›®å½•:\nBIN_DIR := bin\n\n# å·¥ç¨‹å\nNAME := key\n\n# æŒ‡å®šé“¾æ¥è„šæœ¬\nLDS = imx.lds\n\n#############################################################\n\n#1###########################################################\n\n# è‡ªåŠ¨æŸ¥æ‰¾ src/ ç›®å½•ä¸‹çš„æ‰€æœ‰ .c æ–‡ä»¶\nSRCS = $(shell find $(ROOT_DIR) -name \"*.c\")\n\n# å°† SRCä¸­çš„ xxx.c è½¬æ¢ä¸º build/xxx.o\n# åŒæ—¶æ·»åŠ  build/startup.oï¼ˆæ±‡ç¼–å¯åŠ¨æ–‡ä»¶ï¼‰\nOBJS = $(BUILD_DIR)/startup.o\nOBJS += $(patsubst %.c,$(BUILD_DIR)/%.o,$(SRCS))\n\n# è‡ªåŠ¨æŸ¥æ‰¾æ‰€æœ‰åŒ…å«å¤´æ–‡ä»¶çš„ç›®å½•\nINC_DIRS = $(shell find $(ROOT_DIR) -type f -name \"*.h\" -exec dirname {} \\; | sort -u)\nINCLUDES = $(addprefix -I, $(INC_DIRS))\n\n#############################################################\n\n#2###########################################################\n\n# è®¾ç½®ç¼–è¯‘å·¥å…·ï¼ˆä½¿ç”¨ ARM çš„äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼‰\nCC := arm-none-eabi-\n\n# ç¼–è¯‘å™¨ï¼ˆç”¨äº .c å’Œ .S æ–‡ä»¶ï¼‰:\nGCC := $(CC)gcc\n\n# é“¾æ¥å™¨:\nLD := $(CC)ld\n\n# ç”¨äºå°† elf è½¬ä¸º bin æ ¼å¼:\nOBJCOPY := $(CC)objcopy\n\n# ç”¨äºåæ±‡ç¼–\nOBJDUMP := $(CC)objdump\n\n# ç¼–è¯‘é€‰é¡¹ï¼ˆGCC ç¼–è¯‘é˜¶æ®µï¼‰\n# -Iï¼šæŒ‡å®šå¤´æ–‡ä»¶æœç´¢ç›®å½•\n# -Wallï¼šæ‰“å¼€æ‰€æœ‰è­¦å‘Š\n# -O2ï¼šä¼˜åŒ–ç­‰çº§ 2ï¼ˆæ¨èç”¨äº releaseï¼‰\n# -nostdlibï¼šä¸é“¾æ¥æ ‡å‡†åº“ï¼ˆé€‚ç”¨äºè£¸æœºï¼‰\n# -cï¼šåªç¼–è¯‘ï¼Œä¸é“¾æ¥\nGCC_FLAGS = $(INCLUDES) -Wall -nostdlib -c\n\n# é“¾æ¥å™¨é€‰é¡¹\nLD_FLAGS = -T$(LDS)\n\n# ä½¿ç”¨ objdump å·¥å…·å¯¹ç”Ÿæˆçš„ ELF æ–‡ä»¶è¿›è¡Œåæ±‡ç¼–\n# -Dï¼šåæ±‡ç¼–æ‰€æœ‰èŠ‚ï¼ˆåŒ…æ‹¬ä»£ç æ®µã€å¯åŠ¨ä»£ç ç­‰ï¼‰\n# -m armï¼šæŒ‡å®šç›®æ ‡æ¶æ„ä¸º ARM\n# .elfï¼šè¾“å…¥çš„å¯æ‰§è¡Œæ–‡ä»¶\n# > .disï¼šå°†åæ±‡ç¼–ç»“æœè¾“å‡ºä¸º .dis æ–‡æœ¬æ–‡ä»¶\nOBJDUMP_FLAGS = -D -m arm $(BUILD_DIR)/$(NAME).elf > $(BUILD_DIR)/$(NAME).dis\n\n#############################################################\n\n#3###########################################################\n\n# ç›®æ ‡ï¼šç”Ÿæˆæœ€ç»ˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ bin/$(NAME).bin\n$(BIN_DIR)/$(NAME).bin: $(OBJS)\n\t# é“¾æ¥æ‰€æœ‰ .o æ–‡ä»¶ç”Ÿæˆ elf æ ¼å¼å¯æ‰§è¡Œæ–‡ä»¶\nÂ  Â  $(LD) $(LD_FLAGS) $(OBJS) -o $(BUILD_DIR)/$(NAME).elf\n\t# åæ±‡ç¼– è°ƒè¯•ç”¨\nÂ  Â  $(OBJDUMP) $(OBJDUMP_FLAGS)\n\t# æŠŠ elf æ–‡ä»¶è½¬æ¢ä¸ºè£¸æœºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæ— ç¬¦å·ã€æ— å¤´ä¿¡æ¯ï¼‰\nÂ  Â  $(OBJCOPY) -O binary -S $(BUILD_DIR)/$(NAME).elf $@\n \n# ç¼–è¯‘æ±‡ç¼–å¯åŠ¨æ–‡ä»¶ startup.Sï¼Œç”Ÿæˆ build/startup.o\n$(BUILD_DIR)/startup.o: startup.S\n\t# æ³¨æ„ startup.S æ˜¯æ±‡ç¼–æ–‡ä»¶ï¼Œç”¨ gcc ç¼–è¯‘ä¹Ÿå¯ä»¥ï¼Œé»˜è®¤ä¼šè°ƒç”¨æ±‡ç¼–å™¨\nÂ  Â  $(GCC) $(GCC_FLAGS) $< -o $@\n\n# ç¼–è¯‘æ¯ä¸ª .c æ–‡ä»¶åˆ° build/xxx.o\n# $@ï¼šç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ build/main.oï¼‰\n# $<ï¼šä¾èµ–çš„æºæ–‡ä»¶ï¼ˆä¾‹å¦‚ src/main.cï¼‰\n$(BUILD_DIR)/%.o: %.c\n\t# ä¿®å¤ç”±äºæ²¡æœ‰æ–‡ä»¶å¤¹æŠ¥é”™\nÂ  Â  mkdir -p $(dir $@)\nÂ  Â  $(GCC) $(GCC_FLAGS) -c $< -o $@\n\n#############################################################\n\n.PHONY: clean\nclean:\nÂ  Â  rm -r $(BUILD_DIR)/* $(BIN_DIR)/*\n```\n\nä¸€ä¸ªæ›´é€šç”¨çš„æ¨¡æ¿\n```make\n# é€šç”¨ Makefile æ¨¡æ¿\n\n# 1. ç¼–è¯‘å™¨åŠé€‰é¡¹\nCC      := gcc             # C ç¼–è¯‘å™¨ (å¯æ”¹æˆ g++)\nCFLAGS  := -Wall -O2       # ç¼–è¯‘å‚æ•°\nLDFLAGS :=                 # é“¾æ¥å‚æ•° (åº“è·¯å¾„)\nLDLIBS  := -lm             # ä¾èµ–çš„åº“ (-lpthread, -lrt ç­‰)\n\n# 2. ç›®å½•ç»“æ„\nSRC_DIR := src             # æºç ç›®å½•\nOBJ_DIR := build           # ç›®æ ‡æ–‡ä»¶ç›®å½•\nBIN_DIR := bin             # å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•\n\n# 3. è‡ªåŠ¨æ”¶é›†æºæ–‡ä»¶\nSRCS := $(wildcard $(SRC_DIR)/*.c)\nOBJS := $(patsubst $(SRC_DIR)/%.c,$(OBJ_DIR)/%.o,$(SRCS))\nTARGET := $(BIN_DIR)/app   # ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å\n\n# 4. é»˜è®¤ç›®æ ‡\nall: $(TARGET)\n\n# 5. é“¾æ¥è§„åˆ™\n$(TARGET): $(OBJS) | $(BIN_DIR)\n\t$(CC) $(LDFLAGS) -o $@ $^ $(LDLIBS)\n\n# 6. ç¼–è¯‘è§„åˆ™\n$(OBJ_DIR)/%.o: $(SRC_DIR)/%.c | $(OBJ_DIR)\n\t$(CC) $(CFLAGS) -c $< -o $@\n\n# 7. ç›®å½•ç”Ÿæˆ\n$(OBJ_DIR) $(BIN_DIR):\n\tmkdir -p $@\n\n# 8. æ¸…ç†\n.PHONY: clean run\nclean:\n\trm -rf $(OBJ_DIR) $(BIN_DIR)\n\n# 9. è¿è¡Œ (å¯é€‰)\nrun: all\n\t./$(TARGET)\n\n```\n\n[^1]: ä»…ä½œäº†è§£\n\n","tags":["MakeFile"],"categories":["Linux","é¡¹ç›®ç®¡ç†"]},{"title":"äº¤å‰ç¼–è¯‘å™¨ç›¸å…³çŸ¥è¯†æ¢³ç†","url":"/posts/27939/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n</details>\n\n---\n\n\n\n"},{"title":"å…³äºLinuxå¼€å‘æ¿ä¸ä¸Šä½æœºçš„è¿æ¥æ–¹å¼","url":"/posts/32814/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n!!! warning\n    æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n</details>\n\n---\n\n\n\n>æœ¬æ–‡æ—¨åœ¨è®°å½•è‡ªå·±çš„IMX6ULLå¼€å‘æ¿ä¸Šä½æœºè¿æ¥çš„è¿‡ç¨‹ã€‚~~ä¸ºä»€ä¹ˆæ„Ÿè§‰æ˜¯åç«¯è¿™ä¸€å—å‘¢ï¼Ÿ~~\n\n## 1. å‰ææ¡ä»¶\n\n\n>- è£…æœ‰Debian/Ubuntuç³»ç»Ÿçš„ã€å®‰è£…äº†sshæœåŠ¡çš„ã€å¸¦æœ‰ç½‘ç»œè®¾å¤‡åŠé©±åŠ¨çš„å¼€å‘æ¿\n>- MobaXtermå·¥å…·\n>- ç›®å‰ä½¿ç”¨çš„ä¸Šä½æœºæ˜¯Win11å¹³å°ï¼Œåç»­å†ç ”ç©¶Linuxå¹³å°ã€‚\n\n\n\n## 2. åŸºæœ¬æ“ä½œ\n\n### 2.1. æŸ¥è¯¢è®¾å¤‡ç½‘ç»œè¿æ¥çŠ¶æ€åŠipåœ°å€\n`ifconfig` å‘½ä»¤\n\n### 2.2. è¿æ¥æµ‹è¯•\n`ping` å‘½ä»¤\n\n### 2.3. åŠ¨æ€åˆ†é…ip/ä¸»åŠ¨ç”³è¯·ipåœ°å€\n```bash\nudhcpc -i eth0\n```\n\n**`udhcpc`**\n- å…¨ç§°æ˜¯ _Micro DHCP Client_ï¼Œæ˜¯ BusyBox æä¾›çš„ä¸€ä¸ªè½»é‡çº§ DHCP å®¢æˆ·ç«¯å·¥å…·ã€‚\n- å®ƒä¼šå‘å±€åŸŸç½‘é‡Œçš„ DHCP æœåŠ¡å™¨ï¼ˆæ¯”å¦‚è·¯ç”±å™¨ã€ä¸»æœºä¸Šçš„ Internet Connection Sharing æœåŠ¡ï¼‰å‘é€è¯·æ±‚ï¼Œè¯·æ±‚ä¸€ä¸ª IP åœ°å€ã€‚\n\n**`-i eth0`**\n- æŒ‡å®šè¦ä½¿ç”¨çš„ç½‘ç»œæ¥å£ï¼Œè¿™é‡Œæ˜¯ `eth0`ï¼ˆå¼€å‘æ¿ä¸Šçš„ä»¥å¤ªç½‘ç½‘å¡ï¼‰ã€‚\n- å¦‚æœä½ ç”¨çš„æ˜¯å…¶ä»–ç½‘å¡ï¼ˆæ¯”å¦‚ `eth1` æˆ– `enp0s3`ï¼‰ï¼Œéœ€è¦æ”¹æˆå¯¹åº”åå­—ã€‚\n\næˆåŠŸçš„è¯ï¼Œå®ƒä¼šæ˜¾ç¤ºç±»ä¼¼ï¼š\n```bash\nudhcpc: sending discover\nudhcpc: sending select for 192.168.137.2\nudhcpc: lease of 192.168.137.2 obtained, lease time 86400\n```\nè¿™è¡¨ç¤ºç½‘å¡å·²ç»ä» DHCP æœåŠ¡å™¨é‚£é‡Œæ‹¿åˆ°äº† IPï¼ˆè¿™é‡Œæ˜¯ `192.168.137.2`ï¼‰ã€‚å¦‚æœæ²¡æœ‰ DHCP æœåŠ¡å™¨å“åº”ï¼Œå°±ä¼šä¸€ç›´ `sending discover`ï¼Œè¯´æ˜æ²¡æœ‰å¯åˆ†é… IPã€‚\n\n### 2.4. æ‰‹åŠ¨è®¾ç½®è®¾å¤‡ipåœ°å€\n\n```bash\nifconfig eth0 192.168.10.2 netmask 255.255.255.0 up\n```\n\n`up` æŒ‡å¯ç”¨\n\n### 2.5. æŸ¥è¯¢sshæ˜¯å¦å¼€å¯\n\n```bash\nsudo systemctl status ssh\n```\n\n### 2.6. å¼€å¯sshæœåŠ¡\n\n```bash\nsystemctl start ssh\n```\næˆ–\n```bash\n/etc/init.d/ssh start\n```\n\n### 2.7. sshè¿œç¨‹è¿æ¥\n\n```bash\nssh [username]@[ip-addr/hostname]\n```\n\n### 2.8. é€šè¿‡MobaXtermè¿æ¥\nå¡«å¥½å³å¯ã€‚\n![](Snipaste_2025-09-07_19-20-07.png)\n\n`hostname` å¯ä»¥è¾“å…¥åŒåæŒ‡ä»¤æŸ¥çœ‹ã€‚\n\n## 3. æ–¹å¼ä¸€ï¼šæ— çº¿ç½‘ç»œè¿æ¥\n\n>\"ä¼˜ç‚¹\"ï¼šæ— çº¿é€šä¿¡ã€‚\n\"ç¼ºç‚¹\"ï¼šå»¶è¿Ÿå¯èƒ½è¾ƒé«˜ã€‚\n\n\n### 3.1. åŒä¸€ç½‘ç»œä¸‹\n\nåœ¨åŒä¸€ç½‘æ®µä¸‹ï¼ˆè¿æ¥åŒä¸€ä¸ªWIFIï¼‰ï¼Œé€šè¿‡sshå»ºç«‹è¿æ¥ã€‚ç®€ç®€å•å•ã€‚\n\n### 3.2. ä¸åŒç½‘ç»œä¸‹\n\n>å¾…è¡¥å……ã€‚\n\n## 4. æ–¹å¼äºŒï¼šé€šè¿‡ç½‘çº¿ä¸Winç”µè„‘è¿æ¥\n\n>\"ä¼˜ç‚¹\"ï¼šå»¶è¿Ÿä½ã€‚\n\"ç¼ºç‚¹\"ï¼šæœ‰çº¿é€šä¿¡ã€‚\n\n### 4.1. ç‚¹å¯¹ç‚¹é€šä¿¡ï¼ˆæ— éœ€å…±äº«ç”µè„‘ç½‘ç»œï¼‰\n\n>\"ä¼˜ç‚¹\"ï¼šæ“ä½œç®€å•ã€‚\n\"ç¼ºç‚¹\"ï¼šå¼€å‘æ¿ä¸èƒ½å…±äº«ç”µè„‘ç½‘ç»œã€‚\n\nå°†å¼€å‘æ¿ç½‘å£å’Œç”µè„‘ç½‘å£ç”¨ç½‘çº¿è¿æ¥ï¼Œè¿›å…¥ç”µè„‘`ç½‘ç»œå’ŒInternet`è®¾ç½®ï¼Œé€‰æ‹©`ä»¥å¤ªç½‘`\n\nipåˆ†é…æ”¹ä¸ºæ‰‹åŠ¨ï¼Œipåœ°å€å¯ä»¥åˆ†é…ä¸º`192.168.10.1`\næ©ç ä¸º`255.255.255.0`\n![](Snipaste_2025-09-07_19-29-57.png)\n\nå¼€å‘æ¿ç«¯åŒæ ·æŒ‡å®šipåœ°å€å’Œæ©ç ï¼Œé¡»åœ¨åŒä¸€ç½‘æ®µï¼Œä¾‹å¦‚`192.168.10.7` ã€‚è¿™æ ·ä¸¤ä¸ªè®¾å¤‡å°±èƒ½äº’ç›¸æ‰¾åˆ°äº†ã€‚\nå†åœ¨ç”µè„‘ä¸Šè¿›è¡Œpingæµ‹è¯•ã€‚èƒ½pingé€šç”¨ssh/MobaXtermè¿æ¥å³å¯ã€‚\n\n### 4.2. ç‚¹å¯¹ç‚¹é€šä¿¡å¹¶å…±äº«ç”µè„‘ç½‘ç»œï¼ˆç”µè„‘æˆç½‘å…³ï¼‰\n\n>\"ä¼˜ç‚¹\"ï¼šå¼€å‘æ¿ä¸ä»…å¯ä»¥ä¸ç”µè„‘å»ºç«‹é€šä¿¡ï¼Œè¿˜èƒ½å…±äº«ç”µè„‘ç½‘ç»œã€‚\n\"ç¼ºç‚¹\"ï¼šæ“ä½œè¾ƒå¤æ‚ã€‚\n\nç”µè„‘é€šè¿‡wifiè¿æ¥ç½‘ç»œï¼Œé€šè¿‡ä»¥å¤ªç½‘æ¥å£è¿æ¥å¼€å‘æ¿ã€‚\nåœ¨ç”µè„‘æ§åˆ¶é¢æ¿>ç½‘ç»œå’ŒInternet>ç½‘ç»œå’Œå…±äº«ä¸­å¿ƒ å³ä¾§æ›´æ”¹é€‚é…å™¨è®¾ç½®ï¼ŒåŒå‡»æ— çº¿ç½‘å¡è®¾å¤‡ï¼ˆè¿æ¥ç½‘ç»œçš„é‚£ä¸ªè®¾å¤‡ï¼‰é€‰æ‹©å±æ€§> å…±äº«é€‰é¡¹å¡ å‹¾é€‰\n![](Snipaste_2025-09-07_19-41-42.png)\n\næç¤ºï¼š\n![](Snipaste_2025-09-07_19-41-53.png)\n\næ„æ€æ˜¯ï¼šå½“è¯¥åŠŸèƒ½è¢«å¯ç”¨æ—¶ï¼Œä½ çš„LANå£ ipåœ°å€ è‡ªåŠ¨è¢«è®¾ç½®ä¸º `192.168.137.1`ï¼Œè¦é€šè¿‡è¿™ä¸ªLANå£è¿æ¥ç½‘ç»œçš„è®¾å¤‡éœ€å°†è‡ªå·±ipåœ°å€è®¾ç½®ä¸ºåŠ¨æ€è·å–ï¼Œä¹Ÿå°±æ˜¯åœ¨å¼€å‘æ¿æ‰§è¡Œå‰é¢çš„åŠ¨æ€è·å–ipåœ°å€çš„å‘½ä»¤ã€‚\n\nå½“å¼€å‘ç‰ˆæˆåŠŸè·å–åˆ°ipåœ°å€ï¼ˆè§åŸºæœ¬æ“ä½œèŠ‚ åˆ†é…ipåœ°å€ï¼‰åï¼Œåˆ™å¯ä»¥æ­£å¸¸å»ºç«‹è¿æ¥ã€‚","tags":["Linux","ç½‘ç»œ","é€šä¿¡"],"categories":["Linux","è®°å½•"]},{"title":"æ— èŠéšä¾¿æ‰“ç‚¹å­—","url":"/posts/7593/","content":"\n---\n\n# å’Œæ—¶é—´èµ›è·‘ æ—æ¸…ç„\n\nè¯»å°å­¦çš„æ—¶å€™ï¼Œæˆ‘çš„å¤–ç¥–æ¯å»ä¸–äº†ã€‚å¤–ç¥–æ¯ç”Ÿå‰æœ€ç–¼çˆ±æˆ‘ã€‚æˆ‘æ— æ³•æ’é™¤è‡ªå·±çš„å¿§ä¼¤ï¼Œæ¯å¤©åœ¨å­¦æ ¡çš„æ“åœºä¸Šä¸€åœˆä¸€åœˆåœ°è·‘ç€ï¼Œè·‘å¾—ç´¯å€’åœ¨åœ°ä¸Šï¼Œæ‰‘åœ¨è‰åªä¸Šç—›å“­ã€‚\n\né‚£å“€ç—›çš„æ—¥å­æŒç»­äº†å¾ˆä¹…ï¼Œçˆ¸çˆ¸å¦ˆå¦ˆä¹Ÿä¸çŸ¥é“å¦‚ä½•å®‰æ…°æˆ‘ã€‚ä»–ä»¬çŸ¥é“ä¸å…¶æ¬ºéª—æˆ‘è¯´å¤–ç¥–æ¯ç¡ç€äº†ï¼Œè¿˜ä¸å¦‚å¯¹æˆ‘è¯´å®è¯ï¼šå¤–ç¥–æ¯æ°¸è¿œä¸ä¼šå›æ¥äº†ã€‚\n\nâ€œä»€ä¹ˆæ˜¯æ°¸è¿œä¸ä¼šå›æ¥äº†å‘¢ï¼Ÿâ€æˆ‘é—®ã€‚\n\nâ€œæ‰€æœ‰æ—¶é—´é‡Œçš„äº‹ç‰©ï¼Œéƒ½æ°¸è¿œä¸ä¼šå›æ¥äº†ï¼Œä½ çš„æ˜¨å¤©è¿‡å»äº†ï¼Œå®ƒå°±æ°¸è¿œå˜æˆæ˜¨å¤©ï¼Œä½ å†ä¹Ÿä¸èƒ½å›åˆ°æ˜¨å¤©äº†ã€‚çˆ¸çˆ¸ä»¥å‰å’Œä½ ä¸€æ ·å°ï¼Œç°åœ¨å†ä¹Ÿä¸èƒ½å›åˆ°ä½ è¿™ä¹ˆå°çš„ç«¥å¹´äº†ã€‚æœ‰ä¸€å¤©ä½ ä¼šé•¿å¤§ï¼Œä½ ä¹Ÿä¼šåƒå¤–ç¥–æ¯ä¸€æ ·è€ï¼Œæœ‰ä¸€å¤©ä½ åº¦è¿‡äº†ä½ çš„æ‰€æœ‰æ—¶é—´ï¼Œä¹Ÿä¼šåƒå¤–ç¥–æ¯ä¸€æ ·æ°¸è¿œä¸èƒ½å›æ¥äº†ã€‚â€çˆ¸çˆ¸è¯´ã€‚\n\nçˆ¸çˆ¸ç­‰äºç»™æˆ‘è¯´äº†ä¸€ä¸ªè°œï¼Œè¿™ä¸ªè°œæ¯”â€œä¸€å¯¸å…‰é˜´ä¸€å¯¸é‡‘ï¼Œå¯¸é‡‘éš¾ä¹°å¯¸å…‰é˜´â€è¿˜è®©æˆ‘æ„Ÿåˆ°å¯æ€•ï¼Œæ¯”â€œå…‰é˜´ä¼¼ç®­ï¼Œæ—¥æœˆå¦‚æ¢­â€æ›´è®©æˆ‘æœ‰ä¸€ç§è¯´ä¸å‡ºçš„æ»‹å‘³ã€‚\n\nä»¥åï¼Œæˆ‘æ¯å¤©æ”¾å­¦å›å®¶ï¼Œåœ¨åº­é™¢æ—¶çœ‹ç€å¤ªé˜³ä¸€å¯¸ä¸€å¯¸åœ°æ²‰è¿›äº†å±±å¤´ï¼Œå°±çŸ¥é“ä¸€å¤©çœŸçš„è¿‡å®Œäº†ã€‚è™½ç„¶æ˜å¤©è¿˜ä¼šæœ‰æ–°çš„å¤ªé˜³ï¼Œä½†æ°¸è¿œä¸ä¼šæœ‰ä»Šå¤©çš„å¤ªé˜³äº†ã€‚\n\næˆ‘çœ‹åˆ°é¸Ÿå„¿é£åˆ°å¤©ç©ºï¼Œå®ƒä»¬é£å¾—å¤šå—å‘€ã€‚æ˜å¤©å®ƒä»¬å†é£è¿‡åŒæ ·çš„è·¯çº¿ï¼Œä¹Ÿæ°¸è¿œä¸æ˜¯ä»Šå¤©äº†ã€‚æˆ–è®¸æ˜å¤©é£è¿‡è¿™æ¡è·¯çº¿çš„ï¼Œä¸æ˜¯è€é¸Ÿï¼Œè€Œæ˜¯å°é¸Ÿäº†ã€‚\n\næ—¶é—´è¿‡å¾—é£å¿«ï¼Œä½¿æˆ‘çš„å°å¿ƒçœ¼ä¸åªæ˜¯ç€æ€¥ï¼Œè¿˜æœ‰æ‚²ä¼¤ã€‚æœ‰ä¸€å¤©æˆ‘æ”¾å­¦å›å®¶ï¼Œçœ‹åˆ°å¤ªé˜³å¿«è½å±±äº†ï¼Œå°±ä¸‹å†³å¿ƒè¯´ï¼šâ€œæˆ‘è¦æ¯”å¤ªé˜³æ›´å¿«åœ°å›å®¶ã€‚â€æˆ‘ç‹‚å¥”å›å»ï¼Œç«™åœ¨åº­é™¢é‡Œå–˜æ°”çš„æ—¶å€™ï¼Œçœ‹åˆ°å¤ªé˜³è¿˜éœ²ç€åŠè¾¹è„¸ï¼Œæˆ‘é«˜å…´åœ°è·³èµ·æ¥ã€‚é‚£ä¸€å¤©æˆ‘è·‘èµ¢äº†å¤ªé˜³ã€‚ä»¥åæˆ‘å¸¸åšè¿™æ ·çš„æ¸¸æˆï¼Œæœ‰æ—¶å’Œå¤ªé˜³èµ›è·‘ï¼Œæœ‰æ—¶å’Œè¥¿åŒ—é£æ¯”èµ›ï¼Œæœ‰æ—¶ä¸€ä¸ªæš‘å‡çš„ä½œä¸šï¼Œæˆ‘åå¤©å°±åšå®Œäº†ã€‚é‚£æ—¶æˆ‘ä¸‰å¹´çº§ï¼Œå¸¸æŠŠå“¥å“¥äº”å¹´çº§çš„ä½œä¸šæ‹¿æ¥åšã€‚æ¯ä¸€æ¬¡æ¯”èµ›èƒœè¿‡æ—¶é—´ï¼Œæˆ‘å°±å¿«ä¹å¾—ä¸çŸ¥é“æ€ä¹ˆå½¢å®¹ã€‚\n\nåæ¥äºŒåå¹´é‡Œï¼Œæˆ‘å› æ­¤å—ç›Šæ— ç©·ã€‚è™½ç„¶æˆ‘çŸ¥é“äººæ°¸è¿œè·‘ä¸è¿‡æ—¶é—´ï¼Œä½†æ˜¯å¯ä»¥æ¯”åŸæ¥è·‘å¿«ä¸€æ­¥ï¼Œå¦‚æœåŠ æŠŠåŠ²ï¼Œæœ‰æ—¶å¯ä»¥å¿«å¥½å‡ æ­¥ã€‚é‚£å‡ æ­¥è™½ç„¶å¾ˆå°å¾ˆå°ï¼Œç”¨é€”å´å¾ˆå¤§å¾ˆå¤§ã€‚\n\nå¦‚æœå°†æ¥æˆ‘æœ‰ä»€ä¹ˆè¦æ•™ç»™å­©å­ï¼Œæˆ‘ä¼šå‘Šè¯‰ä»–ï¼šå‡è‹¥ä½ ä¸€ç›´å’Œæ—¶é—´èµ›è·‘ï¼Œä½ å°±å¯ä»¥æˆåŠŸã€‚\n\n# ç§‹å¤©çš„æ€€å¿µ å²é“ç”Ÿ\n\nåŒè…¿ç˜«ç—ªåï¼Œæˆ‘çš„è„¾æ°”å˜å¾—æš´æ€’æ— å¸¸ã€‚æœ›ç€æœ›ç€å¤©ä¸ŠåŒ—å½’çš„é›é˜µï¼Œæˆ‘ä¼šçªç„¶æŠŠé¢å‰çš„ç»ç’ƒç ¸ç¢ï¼›å¬ç€å¬ç€æè°·ä¸€ç”œç¾çš„æ­Œå£°ï¼Œæˆ‘ä¼šçŒ›åœ°æŠŠæ‰‹è¾¹çš„ä¸œè¥¿æ‘”å‘å››å‘¨çš„å¢™å£ã€‚æ¯äº²å°±æ‚„æ‚„åœ°èº²å‡ºå»ï¼Œåœ¨æˆ‘çœ‹ä¸è§çš„åœ°æ–¹å·å·åœ°å¬ç€æˆ‘çš„åŠ¨é™ã€‚å½“ä¸€åˆ‡æ¢å¤æ²‰å¯‚ï¼Œå¥¹åˆæ‚„æ‚„åœ°è¿›æ¥ï¼Œçœ¼è¾¹çº¢çº¢çš„ï¼Œçœ‹ç€æˆ‘ã€‚â€œå¬è¯´åŒ—æµ·çš„èŠ±å„¿éƒ½å¼€äº†ï¼Œæˆ‘æ¨ä½ å»èµ°èµ°ã€‚â€å¥¹æ€»æ˜¯è¿™ä¹ˆè¯´ã€‚æ¯äº²å–œæ¬¢èŠ±ï¼Œå¯è‡ªä»æˆ‘åŒè…¿ç˜«ç—ªåï¼Œå¥¹ä¾å¼„çš„é‚£äº›èŠ±éƒ½æ­»äº†ã€‚â€œä¸ï¼Œæˆ‘ä¸å»ï¼â€æˆ‘ç‹ å‘½åœ°æ¶æ‰“è¿™ä¸¤æ¡å¯æ¨çš„è…¿ï¼Œå–Šç€ï¼šâ€œæˆ‘æ´»ç€æœ‰ä»€ä¹ˆåŠ²ï¼â€æ¯äº²æ‰‘è¿‡æ¥æŠ“ä½æˆ‘çš„æ‰‹ï¼Œå¿ä½å“­å£°è¯´ï¼šâ€œå’±å¨˜å„¿ä¿©åœ¨ä¸€å—å„¿ï¼Œå¥½å¥½å„¿æ´»â€¦â€¦â€å¯æˆ‘å´ä¸€ç›´éƒ½ä¸çŸ¥é“ï¼Œå¥¹çš„ç—…å·²ç»åˆ°äº†é‚£æ­¥ç”°åœ°ã€‚åæ¥å¦¹å¦¹å‘Šè¯‰æˆ‘ï¼Œå¥¹å¸¸å¸¸è‚ç–¼å¾—æ•´å®¿æ•´å®¿ç¿»æ¥è¦†å»åœ°ç¡ä¸äº†è§‰ã€‚\n\né‚£å¤©æˆ‘åˆç‹¬è‡ªååœ¨å±‹é‡Œï¼Œçœ‹ç€çª—å¤–çš„æ ‘å¶â€œå”°å”°å•¦å•¦â€åœ°é£˜è½ã€‚æ¯äº²è¿›æ¥äº†ï¼ŒæŒ¡åœ¨çª—å‰ï¼šâ€œåŒ—æµ·åœ°èŠèŠ±å¼€äº†ï¼Œæˆ‘æ¨ç€ä½ å»çœ‹çœ‹å§ã€‚â€å¥¹æ†”æ‚´çš„è„¸ä¸Šç°å‡ºå¤®æ±‚èˆ¬çš„ç¥è‰²ã€‚â€œä»€ä¹ˆæ—¶å€™ï¼Ÿâ€ä½ è¦æ˜¯æ„¿æ„ï¼Œå°±æ˜å¤©ï¼Ÿâ€œå¥¹è¯´ã€‚æˆ‘çš„å›ç­”å·²ç»è®©å¥¹å–œå‡ºæœ›å¤–äº†ã€‚â€å¥½å§ï¼Œå°±æ˜å¤©ã€‚â€œæˆ‘è¯´ã€‚å¥¹é«˜å…´å¾—ä¸€ä¼šåä¸‹ï¼Œä¸€ä¼šç«™èµ·ï¼šâ€é‚£å°±èµ¶ç´§å‡†å¤‡å‡†å¤‡ã€‚â€œâ€å”‰å‘€ï¼Œçƒ¦ä¸çƒ¦ï¼Ÿå‡ æ­¥è·¯ï¼Œæœ‰ä»€ä¹ˆå¥½å‡†å¤‡çš„ï¼â€œå¥¹ä¹Ÿç¬‘äº†ï¼Œååœ¨æˆ‘èº«è¾¹ï¼Œçµ®çµ®å¨å¨åœ°è¯´ç€â€çœ‹å®ŒèŠèŠ±ï¼Œå’±ä»¬å°±å»â€˜ä»¿è†³â€™ï¼Œä½ å°æ—¶å€™æœ€çˆ±åƒé‚£å„¿çš„è±Œè±†é»„å„¿ã€‚è¿˜è®°å¾—é‚£å›æˆ‘å¸¦ä½ å»åŒ—æµ·å—ï¼Ÿä½ åè¯´é‚£æ¨æ ‘èŠ±æ˜¯æ¯›æ¯›è™«ï¼Œè·‘ç€ï¼Œä¸€è„šè¸©æ‰ä¸€ä¸ªâ€¦â€¦â€œå¥¹å¿½ç„¶ä¸è¯´äº†ã€‚å¯¹äºâ€è·‘â€œå’Œâ€è¸©â€œä¸€ç±»çš„å­—çœ¼å„¿ã€‚å¥¹æ¯”æˆ‘è¿˜æ•æ„Ÿã€‚å¥¹åˆæ‚„æ‚„å‡ºå»äº†ã€‚\n\nå¥¹å‡ºå»äº†ã€‚å°±å†ä¹Ÿæ²¡å›æ¥ã€‚\n\né‚»å±…ä»¬æŠŠå¥¹æŠ¬åˆ°è½¦ä¸Šæ—¶ï¼Œå¥¹è¿˜åœ¨å¤§å£å¤§å£åœ°åç€é²œè¡€ã€‚æˆ‘æ²¡æƒ³åˆ°å¥¹å·²ç»ç—…æˆé‚£æ ·ã€‚çœ‹ç€ä¸‰è½®è½¦è¿œå»ï¼Œä¹Ÿç»æ²¡æœ‰æƒ³åˆ°é‚£ç«Ÿæ˜¯æ°¸è¿œçš„è¯€åˆ«ã€‚\n\né‚»å±…çš„å°ä¼™å­èƒŒç€æˆ‘å»çœ‹å¥¹çš„æ—¶å€™ï¼Œå¥¹æ­£è‰°éš¾åœ°å‘¼å¸ç€ï¼Œåƒå¥¹é‚£ä¸€ç”Ÿè‰°éš¾çš„ç”Ÿæ´»ã€‚åˆ«äººå‘Šè¯‰æˆ‘ï¼Œä»–æ˜è¿·å‰çš„æœ€åä¸€å¥è¯æ˜¯ï¼šâ€æˆ‘é‚£ä¸ªæœ‰ç—…çš„å„¿å­å’Œæˆ‘é‚£ä¸ªæœªæˆå¹´çš„å¥³å„¿â€¦â€¦â€œ\n\nåˆæ˜¯ç§‹å¤©ï¼Œå¦¹å¦¹æ¨ç€æˆ‘å»åŒ—æµ·çœ‹äº†èŠèŠ±ã€‚é»„è‰²çš„èŠ±æ·¡é›…ã€ç™½è‰²çš„èŠ±é«˜æ´ã€ç´«çº¢è‰²çš„èŠ±çƒ­çƒˆè€Œæ·±æ²‰ï¼Œæ³¼æ³¼æ´’æ´’ï¼Œç§‹é£ä¸­æ­£å¼€çš„çƒ‚æ¼«ã€‚æˆ‘æ‡‚å¾—æ¯äº²æ²¡æœ‰è¯´å®Œçš„è¯ï¼Œå¦¹å¦¹ä¹Ÿæ‡‚ã€‚æˆ‘ä¿©åœ¨ä¸€å—å„¿ï¼Œè¦å¥½å¥½å„¿æ´»â€¦â€¦","categories":["å…¶ä»–"]},{"title":"I-MX6ULLçš„ä¸­æ–­å®éªŒï¼ˆä¸‹ï¼‰","url":"/posts/33465/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## Cè¯­è¨€ä¸‹ä¸­æ–­æ¨¡å—\n\n### æ ¸å¿ƒæ€è·¯ï¼š\næ¯ä¸ªä¸­æ–­å¯¹è±¡åŒ…å«ï¼š1ä¸ªä¸­æ–­å¤„ç†å‡½æ•°å’Œéœ€è¦ä¼ å…¥çš„å‚æ•°â€”â€”ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ+ä¸€ä¸ªæœªå®šä¹‰ç±»å‹æŒ‡é’ˆã€‚æ‰€ä»¥å°†ä¸­æ–­å¯¹è±¡æ‰“åŒ…æˆä¸€ä¸ªç»“æ„ä½“ï¼š\n```c\n/* å®šä¹‰ä¸­æ–­å¤„ç†å‡½æ•°åŸå‹ */\ntypedef void (*sys_irq_handler_t)(unsigned int id, void *para);\n\n/* å®šä¹‰ä¸­æ–­å‡½æ•°ç»“æ„ä½“ */\ntypedef struct _sys_irq_handle{\nÂ  Â  sys_irq_handler_t irqHandler;\nÂ  Â  void* usrPara;\n}sys_irq_handle_t;\n```\n\næŒ‡å®šä¸€ä¸ªé»˜è®¤ä¸­æ–­å¤„ç†å‡½æ•°ï¼š\n```c\n/* å®šä¹‰é»˜è®¤ä¸­æ–­å¤„ç†å‡½æ•° */\nstatic void default_irqHandler(unsigned int id, void *para){\nÂ  Â  while(1);\n}\n```\n\nå°†æ‰€æœ‰ä¸­æ–­å¯¹è±¡å½’å…¥ä¸€ä¸ªè¡¨ä¸­ï¼ŒæŒ‰ä¸­æ–­idç´¢å¼•ï¼š\n```c\n#define NUM_OF_IT_VECTORS 160\nstatic sys_irq_handle_t irqTable[NUM_OF_IT_VECTORS];\n```\n\nåç»­å¯èƒ½æ¶‰åŠåˆ°ä¸­æ–­åµŒå¥—ï¼Œå› æ­¤å®šä¹‰ä¸€ä¸ªä¸­æ–­åµŒå¥—è®¡æ•°å™¨ï¼š\n```c\nstatic unsigned int irqNesting; //ä¸­æ–­åµŒå¥—è®¡æ•°å™¨\n```\n\nåˆå§‹åŒ–ä¸­æ–­å¯¹è±¡è¡¨ï¼š\n```c\n/* åˆå§‹åŒ–ä¸­æ–­å¤„ç†è¡¨ */\nstatic void sys_iqrTable_init(void){\nÂ  Â  unsigned char i = 0;\nÂ  Â  irqNesting = 0; //ä¸­æ–­åµŒå¥—è®¡æ•°å™¨\nÂ  Â  for(i = 0; i< NUM_OF_IT_VECTORS; i++){\nÂ  Â  Â  Â  irqTable[i].irqHandler = default_irqHandler;\nÂ  Â  Â  Â  irqTable[i].usrPara = NULL;\nÂ  Â  }\n}\n```\n\nåœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†å½“è¿›å…¥ä¸­æ–­æ—¶è·³å…¥ä¸€ä¸ªåä¸º`system_irqhandler`çš„å‡½æ•°å¤„ç†ä¸­æ–­ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å®šä¹‰è¯¥å‡½æ•°ï¼š\n```c\n/// @brief ä¸­æ–­å¤„ç†å‡½æ•°\n/// @param gicciar å¯„å­˜å™¨gicciarçš„å€¼\n/// @note è¿›å…¥irqä¸­æ–­åè‡ªåŠ¨è°ƒç”¨\nvoid system_irqhandler(unsigned int gicciar){ \nÂ  Â  uint32_t id = gicciar & 0x3ff; //ä»gicciarå¯„å­˜å™¨ä¸­è¯»å–ä¸­æ–­idå·ï¼ˆ0~9ä½ æ•…& 0x3ffï¼‰\nÂ  Â  /* å®‰å…¨æ£€æŸ¥ */\nÂ  Â  if(id == 1023 || id >= NUM_OF_IT_VECTORS) return; //1023å³æ²¡æœ‰ä¸­æ–­ï¼Œå³0~9ä½å…¨ä¸º1\nÂ  Â  irqNesting++;\nÂ  Â  /* å¼€å§‹å¤„ç† */\nÂ  Â  irqTable[id].irqHandler(id, irqTable[id].usrPara);\nÂ  Â  irqNesting--;\n}\n```\n\næˆ‘ä»¬ä¸å¯èƒ½åªç”¨é»˜è®¤ä¸­æ–­å¤„ç†å‡½æ•°ï¼Œè‚¯å®šè¦è‡ªå·±è‡ªå®šä¹‰ï¼Œè‡ªå®šä¹‰å®Œå¤„ç†å‡½æ•°åï¼Œå°†è¯¥å‡½æ•°æ³¨å†Œç»™ä¸­æ–­å¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç”¨äºæ³¨å†Œçš„å‡½æ•°ï¼š\n```c\n/// @brief ç”¨äºæ³¨å†Œä½ è‡ªå®šä¹‰çš„ä¸­æ–­å¤„ç†å‡½æ•°\n/// @param irq_id ä½ ä¸ºå“ªä¸ªä¸­æ–­å†™å¥½äº†å¤„ç†å‡½æ•°ï¼Œå†™å…¥id\n/// @param handler ä½ å†™çš„å¤„ç†å‡½æ•°çš„åœ°å€\n/// @param para è¦ä¼ å…¥çš„å‚æ•°\nvoid register_irqHandler(IRQn_Type irq_id, sys_irq_handler_t handler, void *para){\nÂ  Â  irqTable[irq_id].irqHandler = handler;\nÂ  Â  irqTable[irq_id].usrPara = para;\n}\n```\n\n\n## é…ç½®gpioå¤–éƒ¨ä¸­æ–­\n\né€šè¿‡åŸç†å›¾å¯çŸ¥ï¼Œåº”é…ç½®ä¸ºä¸Šå‡æ²¿è§¦å‘ã€‚\n\n### é…ç½®GPIO_ICRå¯„å­˜å™¨\nå¯„å­˜å™¨ç”¨äºæŒ‡å®šè§¦å‘æ–¹å¼â€”â€”ä¸Šå‡æ²¿è§¦å‘ã€‚\næˆ‘çš„å¼€å‘æ¿åº”æŒ‡å®šGOIO5_ICR1_icr1 ä¸º 10ã€‚\n\n### é…ç½®GPIO_IMRå¯„å­˜å™¨\nè¯¥å¯„å­˜å™¨ç”¨äºä½¿èƒ½ä¸­æ–­ã€‚\næˆ‘çš„å¼€å‘æ¿åº”æŒ‡å®šGPIO5_IMR_imr1 ä¸º 1â€”â€”UNMASKED\n\n## ä¸­æ–­åæ¸…é™¤ä¸­æ–­æ ‡å¿—ä½\nå‚è€ƒæ‰‹å†Œä¸­æŒ‡å‡ºï¼Œå¤„ç†å®Œä¸­æ–­åï¼Œéœ€æ¸…é™¤GPIO_ISRå¯„å­˜å™¨çš„ç›¸åº”ä½ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯**é€šè¿‡å¯¹è¯¥ä½å†™1æ¸…é™¤ã€‚**\n\n## GIC é…ç½®\n\njust like NVIC... you must know cubemx rightï¼Ÿ\n\n### ä½¿èƒ½ç›¸åº”çš„ä¸­æ–­ID\nGPIO5_1å¯¹åº”çš„ä¸­æ–­idä¸º74\n![](Snipaste_2025-08-24_23-51-22.png)\nä½†æ˜¯æ³¨æ„è¿™æ®µè¯ï¼š\n![](Snipaste_2025-08-24_23-53-41.png)\n\nå‘Šè¯‰æˆ‘ä»¬å‰é¢è¿˜æœ‰32ä¸ªä¸­æ–­æ¥åˆ°äº†CPUçš„æ¥å£ æ‰€ä»¥ä¸­æ–­IDä¸º 74+32 = 106ã€‚\n\n### é…ç½®ä¸­æ–­ä¼˜å…ˆçº§\n\n## æ³¨å†Œä¸­æ–­å¤„ç†å‡½æ•°\n","tags":["åµŒå…¥å¼","Linux"],"categories":["Linux","è®°å½•"]},{"title":"I-MX6ULLçš„ä¸­æ–­å®éªŒï¼ˆä¸Šï¼‰","url":"/posts/32440/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n:::info\nå­¦ä¹ ç¬”è®°è®°å½•ï¼Œéæ•™ç¨‹ã€‚\n:::\n\n- [1. Cortex-A7ä¸­æ–­ç³»ç»Ÿ](#1-cortex-a7ä¸­æ–­ç³»ç»Ÿ)\n  - [1.1. Cortex-Aä¸­æ–­å‘é‡è¡¨](#11-cortex-aä¸­æ–­å‘é‡è¡¨)\n  - [1.2. ä¸­æ–­å‘é‡è¡¨åç§»](#12-ä¸­æ–­å‘é‡è¡¨åç§»)\n  - [1.3. GIC v2ä¸­æ–­æ§åˆ¶å™¨](#13-gic-v2ä¸­æ–­æ§åˆ¶å™¨)\n    - [1.3.1. GIC çš„ä¸»è¦åŠŸèƒ½](#131-gic-çš„ä¸»è¦åŠŸèƒ½)\n    - [1.3.2. æ ¸å¿ƒç»“æ„](#132-æ ¸å¿ƒç»“æ„)\n    - [1.3.3. æ ¸å¿ƒåŸç†ï¼ˆç®€å•ç‰ˆï¼‰](#133-æ ¸å¿ƒåŸç†ç®€å•ç‰ˆ)\n  - [1.4. ä¸­æ–­å·](#14-ä¸­æ–­å·)\n- [2. æ·»åŠ ä¸­æ–­å‘é‡è¡¨](#2-æ·»åŠ ä¸­æ–­å‘é‡è¡¨)\n- [3. å¤ä½ä¸­æ–­å‡½æ•°çš„ç¼–å†™](#3-å¤ä½ä¸­æ–­å‡½æ•°çš„ç¼–å†™)\n  - [3.1. æ“ä½œCP15åå¤„ç†å™¨](#31-æ“ä½œcp15åå¤„ç†å™¨)\n  - [3.2. ä¸­æ–­å‘é‡è¡¨åç§»](#32-ä¸­æ–­å‘é‡è¡¨åç§»)\n  - [3.3. è®¾ç½®spæŒ‡é’ˆ](#33-è®¾ç½®spæŒ‡é’ˆ)\n  - [3.4. æ¸…é™¤.bssæ®µ](#34-æ¸…é™¤bssæ®µ)\n- [4. IRQä¸­æ–­å‡½æ•°çš„ç¼–å†™](#4-irqä¸­æ–­å‡½æ•°çš„ç¼–å†™)\n  - [4.1. ä¿å­˜ä¸­æ–­ç°åœºï¼ˆé˜²æ­¢ç ´ååŸä»»åŠ¡çŠ¶æ€ï¼‰](#41-ä¿å­˜ä¸­æ–­ç°åœºé˜²æ­¢ç ´ååŸä»»åŠ¡çŠ¶æ€)\n  - [4.2. ä» GICï¼ˆé€šç”¨ä¸­æ–­æ§åˆ¶å™¨ï¼‰è¯»å–ä¸­æ–­å·](#42-ä»-gicé€šç”¨ä¸­æ–­æ§åˆ¶å™¨è¯»å–ä¸­æ–­å·)\n  - [4.3. åˆ‡æ¢åˆ° SVC æ¨¡å¼æ‰§è¡Œ C è¯­è¨€ä¸­æ–­å¤„ç†å‡½æ•°](#43-åˆ‡æ¢åˆ°-svc-æ¨¡å¼æ‰§è¡Œ-c-è¯­è¨€ä¸­æ–­å¤„ç†å‡½æ•°)\n  - [4.4. ç»“æŸä¸­æ–­å¹¶æ¢å¤ç°åœº](#44-ç»“æŸä¸­æ–­å¹¶æ¢å¤ç°åœº)\n- [5. æ•´ä¸ªå¯åŠ¨æ–‡ä»¶](#5-æ•´ä¸ªå¯åŠ¨æ–‡ä»¶)\n\n\n## 1. Cortex-A7ä¸­æ–­ç³»ç»Ÿ\n\n### 1.1. Cortex-Aä¸­æ–­å‘é‡è¡¨\nCortex-Aä¸­æ–­å‘é‡[^1]è¡¨æœ‰8ä¸ªä¸­æ–­ï¼Œå…¶ä¸­é‡ç‚¹å…³æ³¨IRQã€‚Cortex-Açš„ä¸­æ–­å‘é‡è¡¨éœ€è¦ç”¨æˆ·è‡ªå·±å»å®šä¹‰ã€‚\n\n![](Snipaste_2025-08-11_21-20-27.png)\n\nå„ä¸­æ–­çš„ç®€å•ä»‹ç»ï¼š\n![](Snipaste_2025-08-11_21-27-07.png)\n\nå…¶ä¸­IRQä¸­æ–­ä¸ºéå‘é‡ä¸­æ–­ï¼Œæ‰€æœ‰ä¸­æ–­å…±äº«åŒä¸€å…¥å£ï¼Œå†è½¯ä»¶åˆ¤æ–­æ¥æºã€‚\nå¤§æ¦‚æ˜¯è¿™æ ·ï¼š\n![](Snipaste_2025-08-11_21-27-26.png)\n\n### 1.2. ä¸­æ–­å‘é‡è¡¨åç§»\n\né€šè¿‡è®¾ç½®ä¸­æ–­å‘é‡è¡¨åç§»ï¼ŒæŒ‡å®šä¸­æ–­å‘é‡è¡¨çš„åœ°å€ã€‚\n\n### 1.3. GIC v2ä¸­æ–­æ§åˆ¶å™¨\n\nç±»ä¼¼äºSTM32çš„NVICï¼ŒCortexA7ä½¿ç”¨ GIC v2 ä½œä¸ºä¸­æ–­æ§åˆ¶å™¨ï¼Œæ¯”NVICæ›´å¼ºå¤§å› ä¸ºGICèƒ½å¤„ç†å¤šæ ¸çš„ä¸­æ–­ã€‚\n#### 1.3.1. GIC çš„ä¸»è¦åŠŸèƒ½\n\n1. **æ”¶é›†ä¸­æ–­**  \n    æ¥æ”¶æ¥è‡ªå¤–è®¾å’Œ CPU å†…éƒ¨çš„å„ç§ä¸­æ–­è¯·æ±‚ï¼ˆSPIã€PPIã€SGIï¼‰ã€‚\n2. **ä¼˜å…ˆçº§ç®¡ç†**  \n    æŒ‰ä¼˜å…ˆçº§è£å®šå“ªä¸ªä¸­æ–­å…ˆè¢«å¤„ç†ã€‚\n3. **ç›®æ ‡é€‰æ‹©**  \n    æŠŠä¸­æ–­å‘ç»™æŒ‡å®šçš„ CPU æ ¸ï¼Œæˆ–å¹¿æ’­ç»™å¤šä¸ªæ ¸ã€‚\n4. **ä¸­æ–­å±è”½ä¸ä½¿èƒ½**  \n    è½¯ä»¶å¯é€‰æ‹©å±è”½æŸä¸ªä¸­æ–­æˆ–æ‰€æœ‰ä¸­æ–­ã€‚\n5. **ç¡®è®¤ä¸ç»“æŸ**  \n    CPU æ ¸å¿ƒåœ¨å¤„ç†å‰å‘ GIC ç¡®è®¤ï¼ˆacknowledgeï¼‰ï¼Œå¤„ç†å®Œå‘ GIC æŠ¥å‘Šç»“æŸï¼ˆend of interruptï¼‰ã€‚\n#### 1.3.2. æ ¸å¿ƒç»“æ„\n\nARM GIC ä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š\n- **Distributorï¼ˆåˆ†å‘å™¨ï¼‰**  \n    è´Ÿè´£æ¥æ”¶æ‰€æœ‰å¤–è®¾ä¸­æ–­ï¼Œå†³å®šé€åˆ°å“ªä¸€ä¸ª CPUã€‚\n- **CPU Interfaceï¼ˆCPU æ¥å£ï¼‰**  \n    æ¯ä¸ª CPU æ ¸å¯¹åº”ä¸€ä¸ªæ¥å£ï¼Œè´Ÿè´£å’Œ Distributor é€šä¿¡ï¼Œæ¥æ”¶/ç¡®è®¤/ç»“æŸä¸­æ–­ã€‚\n\n#### 1.3.3. æ ¸å¿ƒåŸç†ï¼ˆç®€å•ç‰ˆï¼‰\n\nGIC çš„æ ¸å¿ƒæµç¨‹åŸºæœ¬å°±æ˜¯ä¸‰æ­¥ï¼š\n1. **æ¥æ”¶ä¸­æ–­è¯·æ±‚**  \n    å¤–è®¾ï¼ˆSPIï¼‰ã€ç‰¹å®š CPU ç›¸å…³çš„ä¸­æ–­ï¼ˆPPIï¼‰ã€æ ¸é—´ä¸­æ–­ï¼ˆSGIï¼‰éƒ½é€è¿› GICã€‚  \n2. **ä»²è£ä¼˜å…ˆçº§ + é€‰æ‹©ç›®æ ‡ CPU**  \n    - æ¯”è¾ƒä¸­æ–­ä¼˜å…ˆçº§ï¼ˆPriorityï¼‰        \n    - æ£€æŸ¥ä¸­æ–­æ˜¯å¦è¢«å±è”½ï¼ˆEnable Maskï¼‰    \n    - æ ¹æ®ç›®æ ‡ CPU é…ç½®ï¼ˆTarget CPU Maskï¼‰å†³å®šå‘ç»™è°    \n3. **é€šçŸ¥ CPU â†’ CPU å“åº” â†’ å®Œæˆæ±‡æŠ¥**\n    - å‘ä¿¡å·åˆ°ç›®æ ‡ CPU æ¥å£ \n    - CPU è¯»å–ä¸­æ–­å·ï¼ˆacknowledgeï¼‰å¹¶æ‰§è¡Œ ISR   \n    - ISR ç»“æŸå CPU é€šçŸ¥ GICï¼ˆend of interruptï¼‰\n\n### 1.4. ä¸­æ–­å·\nä¸­æ–­çš„ ID Cardã€‚\n![](Snipaste_2025-08-11_21-54-28.png)\n\n\n## 2. æ·»åŠ ä¸­æ–­å‘é‡è¡¨\n\n- **å‘é‡è¡¨çš„â€œè¡¨é¡¹â€æ˜¯æŒ‡ä»¤ï¼Œä¸æ˜¯çº¯åœ°å€ã€‚**\n    \n- æ¯ä¸ªå‘é‡å…¥å£çš„æŒ‡ä»¤éƒ½æŒ‡å‘æŸä¸ªå…·ä½“çš„å¤„ç†å‡½æ•°ï¼ˆReset_Handlerã€IRQ_Handler ç­‰ï¼‰ã€‚\n    \n- å½“å‘ç”Ÿå¼‚å¸¸ï¼ŒCPU ç¡¬ä»¶ä¼šå–æŒ‡æ‰§è¡Œå…¥å£æŒ‡ä»¤ â†’ `ldr pc, =xxx` â†’ è·³åˆ°çœŸæ­£çš„å¤„ç†å‡½æ•°ã€‚\n    \n\nè¿™æ ·ï¼Œ**åªè¦ä¾æ¬¡å†™å¥½è¿™äº›è·³è½¬æŒ‡ä»¤ï¼Œåç»­å†å‘Šè¯‰cpuè¿™äº›æŒ‡ä»¤åœ¨å“ªä¸ªä½ç½®ï¼Œå°±ç­‰äºå‘Šè¯‰ CPUâ€œå„ç§å¼‚å¸¸è¯¥å»å“ªâ€**ã€‚\n\n:::danger\n**ä¸­æ–­å‘é‡è¡¨å¿…é¡»æŒ‰å›ºå®šé¡ºåºæ¥å®šä¹‰**ï¼Œé¡ºåºæ˜¯ç”± ARM ç¡¬ä»¶æ¶æ„è§„å®šçš„ï¼Œä¸æ˜¯éšä¾¿æ’åˆ—çš„ã€‚è¿™æ ·CPUæ‰èƒ½æ­£ç¡®å¤„ç†ä¸åŒçš„å¼‚å¸¸\n:::\n\n```asm\n/* è®¾ç½®ä¸­æ–­å‘é‡è¡¨ï¼Œå½“ä¸­æ–­æ¥æ—¶ï¼ŒCPUå°±ä¼šæ‰§è¡Œå¯¹åº”æŒ‡ä»¤ */\n\nÂ  Â  /* é¡ºåºä¸èƒ½æ”¹å˜ï¼Œåå­—å¯ä»¥æ”¹å˜ï¼ */\n\nÂ  Â  ldr pc, =Reset_Handler Â  Â  Â /* å¤ä½ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  */ Â \n\nÂ  Â  ldr pc, =Undefined_Handler Â /* æœªå®šä¹‰ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\n\nÂ  Â  ldr pc, =SVC_Handler Â  Â  Â  Â /* SVC(Supervisor)ä¸­æ–­ Â  Â  Â  Â */\n\nÂ  Â  ldr pc, =PrefAbort_Handler Â /* é¢„å–ç»ˆæ­¢ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  */\n\nÂ  Â  ldr pc, =DataAbort_Handler Â /* æ•°æ®ç»ˆæ­¢ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  */\n\nÂ  Â  ldr pc, =NotUsed_Handler Â  Â /* æœªä½¿ç”¨ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\n\nÂ  Â  ldr pc, =IRQ_Handler Â  Â  Â  Â /* IRQä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\n\nÂ  Â  ldr pc, =FIQ_Handler Â  Â  Â  Â /* FIQ(å¿«é€Ÿä¸­æ–­)æœªå®šä¹‰ä¸­æ–­ Â  Â  Â  Â  Â  */\n```\n\n## 3. å¤ä½ä¸­æ–­å‡½æ•°çš„ç¼–å†™\n\n### 3.1. æ“ä½œCP15åå¤„ç†å™¨\n\n**å…³é—­Iã€D Cache å’ŒMMU**\n\n<details>\n\n<summary>ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ</summary>\n\nCP15 æ˜¯ Cortex-A ç³»åˆ—å¤„ç†å™¨çš„ **ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨é›†**ï¼Œå…¶ä¸­ **SCTLRï¼ˆSystem Control Register, c1ï¼‰** æ§åˆ¶äº†å¤„ç†å™¨çš„ä¸€äº›æ ¸å¿ƒè¡Œä¸ºï¼Œä¾‹å¦‚ï¼š\n\n| ä½   | åŠŸèƒ½                              |\n| --- | ------------------------------- |\n| M   | MMU ä½¿èƒ½ä½ï¼ˆMemory Management Unitï¼‰ |\n| C   | æ•°æ®ç¼“å­˜ä½¿èƒ½ä½                         |\n| I   | æŒ‡ä»¤ç¼“å­˜ä½¿èƒ½ä½                         |\n| A   | å¯¹é½æ£€æŸ¥ï¼ˆAlignmentï¼‰ä½¿èƒ½               |\n| Z   | ç¼“å­˜æ¸…é›¶ / å‹ç¼©ä¹˜æ³•æŒ‡ä»¤                   |\n| V   | é«˜é€Ÿå¼‚å¸¸å‘é‡è¡¨                         |\n| â€¦   | å…¶ä»–ä¸€äº›è°ƒè¯•ã€å¼‚å¸¸è¡Œä¸ºæ§åˆ¶                   |\n\nåœ¨å¤ä½åï¼ŒSCTLR å¯„å­˜å™¨çš„åˆå§‹å€¼ä¸ä¸€å®šæ˜¯ä½ æƒ³è¦çš„è¿è¡ŒçŠ¶æ€ã€‚ä¸åŒçš„ SoC æˆ–æ¿çº§æ”¯æŒåŒ…å¯èƒ½é»˜è®¤å€¼ä¸åŒï¼Œæœ‰äº›ä½å¯èƒ½ **é»˜è®¤å¯ç”¨æŸäº›åŠŸèƒ½ä½†ä¸é€‚åˆè£¸æœºå¯åŠ¨é˜¶æ®µ**ã€‚\n\nåœ¨è£¸æœºå¯åŠ¨é˜¶æ®µï¼Œä½ é€šå¸¸éœ€è¦ï¼š\n\n1. **ç¦ç”¨ MMU å’Œç¼“å­˜**ï¼š\n    \n    - åœ¨åˆå§‹åŒ–é¡µè¡¨å’Œå†…å­˜æ˜ å°„å‰ï¼Œå¯ç”¨ MMU ä¼šå¯¼è‡´è®¿é—®éæ³•åœ°å€æˆ–äº§ç”Ÿæœªå®šä¹‰è¡Œä¸ºã€‚\n    - æ•°æ®ç¼“å­˜å¦‚æœæ²¡æœ‰æ­£ç¡®åˆå§‹åŒ–ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®å†™å…¥å†…å­˜ä¸ä¸€è‡´ã€‚\n        \n2. **å…³é—­å¯¹é½æ£€æŸ¥**ï¼š\n    \n    - å¯¹é½æ£€æŸ¥åœ¨è£¸æœºå¯åŠ¨é˜¶æ®µå¯èƒ½ä¼šå¯¼è‡´å¼‚å¸¸ï¼Œå› ä¸ºå¯åŠ¨ä»£ç å¯èƒ½ä½¿ç”¨éå¯¹é½è®¿é—®ã€‚\n        \n3. **ä¿è¯æŒ‡ä»¤æ‰§è¡Œé¡ºåºä¸€è‡´**ï¼š\n    \n    - SCTLR çš„æŸäº›ä½ä¼šå½±å“æŒ‡ä»¤ç¼“å­˜å’Œæµæ°´çº¿è¡Œä¸ºã€‚\n    - åœ¨ç³»ç»Ÿåˆå§‹åŒ–é˜¶æ®µï¼Œç¡®ä¿ç¼“å­˜å’Œ MMUå…³é—­å¯ä»¥è®©ä½ æ›´å®¹æ˜“è°ƒè¯•å’Œä¿è¯ä»£ç æ‰§è¡Œé¡ºåºã€‚\n        \n4. **ç»Ÿä¸€ç³»ç»Ÿè¡Œä¸º**ï¼š\n    \n    - ä¸åŒèŠ¯ç‰‡å¯èƒ½åœ¨å¤ä½å SCTLR å¯„å­˜å™¨çš„é»˜è®¤å€¼ä¸åŒã€‚\n    - æ˜¾å¼åˆå§‹åŒ–å¯ä»¥ä¿è¯å¯åŠ¨ä»£ç åœ¨å„ç§èŠ¯ç‰‡ä¸Šè¡Œä¸ºä¸€è‡´ã€‚\n\nå¦‚æœä¸é‡ç½®è¿™äº›ä½å¯èƒ½çš„é£é™©ï¼š\n\n- **è®¿é—®æœªå®šä¹‰**ï¼š\n    \n    - å¦‚æœ MMU é»˜è®¤å¯ç”¨ä½†é¡µè¡¨æœªåˆå§‹åŒ–ï¼Œè®¿é—®å†…å­˜å¯èƒ½è§¦å‘æ•°æ®å¼‚å¸¸ã€‚\n        \n- **æ•°æ®ä¸ä¸€è‡´**ï¼š\n    \n    - ç¼“å­˜å¯ç”¨ä½†æœªæ­£ç¡®è®¾ç½®ç¼“å­˜ç­–ç•¥ï¼Œè¯»å†™å†…å­˜å¯èƒ½å¾—åˆ°é”™è¯¯æ•°æ®ã€‚\n        \n- **å¼‚å¸¸é¢‘å‘**ï¼š\n    \n    - å¯¹é½æ£€æŸ¥é»˜è®¤å¯ç”¨ï¼Œè€Œå¯åŠ¨ä»£ç ä¸­å¯èƒ½æœ‰éå¯¹é½è®¿é—®ï¼Œå¯¼è‡´å¼‚å¸¸ã€‚\n        \n- **è°ƒè¯•å›°éš¾**ï¼š\n    \n    - ç¨‹åºæ‰§è¡Œè¡Œä¸ºä¸ç¡®å®šï¼Œéš¾ä»¥å®šä½å¯åŠ¨é—®é¢˜ã€‚\n\n\n</details>\n\nä»£ç å¦‚ä¸‹ï¼š\n```asm\n* ç¦ç”¨MMUã€cacheã€å¯¹é½æ£€æŸ¥ç­‰ï¼Œé…ç½®é€‚åˆè£¸æœºå¯åŠ¨çš„ç¯å¢ƒï¼Œè¿™æ ·çš„å¯åŠ¨ä»£ç ç§»æ¤æ€§æ›´å¥½ */\n\nÂ  Â  mrc Â  Â  p15, 0, r0, c1, c0, 0 Â  Â  /* Â è¯»å–CP15ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨ Â  */\n\nÂ  Â  bic Â  Â  r0, Â r0, #0x1000 Â  Â  Â  Â  Â /* Â æ¸…é™¤ç¬¬12ä½ï¼ˆIä½ï¼‰ç¦ç”¨ I Cache Â */\n\nÂ  Â  bic Â  Â  r0, Â r0, #0x4 Â  Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬ 2ä½ï¼ˆCä½ï¼‰ç¦ç”¨ D Cache Â */\n\nÂ  Â  bic Â  Â  r0, Â r0, #0x2 Â  Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬ 1ä½ï¼ˆAä½ï¼‰ç¦æ­¢ä¸¥æ ¼å¯¹é½ Â  */\n\nÂ  Â  bic Â  Â  r0, Â r0, #0x800 Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬11ä½ï¼ˆZä½ï¼‰åˆ†æ”¯é¢„æµ‹ Â  */\n\nÂ  Â  bic Â  Â  r0, Â r0, #0x1 Â  Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬ 0ä½ï¼ˆMä½ï¼‰ç¦ç”¨ MMU Â  */\n\nÂ  Â  mcr Â  Â  p15, 0, r0, c1, c0, 0 Â  Â  /* Â å°†ä¿®æ”¹åçš„å€¼å†™å›CP15å¯„å­˜å™¨ Â  */\n```\n\n### 3.2. ä¸­æ–­å‘é‡è¡¨åç§»\n\nè®¿é—®CP15 VBARï¼ˆVector Base Address Registerï¼‰å¯„å­˜å™¨ï¼Œè¯¥å¯„å­˜å™¨æ˜¯ä¸“é—¨æŒ‡å®šä¸­æ–­å‘é‡è¡¨åç§»é¦–åœ°å€çš„ã€‚\n- `dsb`ï¼ˆData Synchronization Barrierï¼‰ä¿è¯æ‰€æœ‰æ•°æ®è®¿é—®æŒ‡ä»¤æ‰§è¡Œå®Œå†ç»§ç»­ã€‚\n- `isb`ï¼ˆInstruction Synchronization Barrierï¼‰ä¿è¯æ–°çš„ VBAR è®¾ç½®é©¬ä¸Šç”Ÿæ•ˆï¼Œä¸ä¼šè¢« CPU æŒ‡ä»¤æµæ°´çº¿é‡Œçš„æ—§æŒ‡ä»¤å½±å“ã€‚\n\n```asm\n/* è®¿é—®CP15 VBARå¯„å­˜å™¨ è®¾ç½®ä¸­æ–­å‘é‡è¡¨åç§» */\n\nÂ  Â  ldr r0, =0x80000000\n\nÂ  Â  dsb\n\nÂ  Â  isb /* æ•°æ®åŒæ­¥æŒ‡ä»¤ */\n\nÂ  Â  mcr p15, 0, r0, c12, c0, 0\n\nÂ  Â  dsb\n\nÂ  Â  isb\n```\n\n### 3.3. è®¾ç½®spæŒ‡é’ˆ\n\nå†…æ ¸å·¥ä½œåœ¨ä¸åŒæ¨¡å¼ä¸‹ï¼ŒUseræ¨¡å¼å’Œæ˜¯Sysæ¨¡å¼å…±ç”¨spå¯„å­˜å™¨ï¼Œè€Œå…¶ä»–æ¨¡å¼æ˜¯ç‹¬äº«ä¸€ä¸ªspå¯„å­˜å™¨ã€‚\n- ARMv7-A æ¯ä¸ªå¼‚å¸¸æ¨¡å¼éƒ½æœ‰è‡ªå·±çš„æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œå¦‚æœä¸è®¾ç½®ï¼Œè¿›å…¥è¯¥æ¨¡å¼æ—¶å¯èƒ½ç ´åæœªçŸ¥å†…å­˜ã€‚\n- ç»™æ¯ç§æ¨¡å¼å•ç‹¬åˆ†é…å†…å­˜ç©ºé—´ï¼Œå¯ä»¥é˜²æ­¢ä¸­æ–­åµŒå¥—ã€å‡½æ•°è°ƒç”¨ç­‰æ“ä½œæ—¶æ ˆäº’ç›¸å†²çªã€‚\n\n\n### 3.4. æ¸…é™¤.bssæ®µ\n\n<details>\n\n<summary>bssæ®µæ˜¯ä»€ä¹ˆï¼Ÿ</summary>\n\nåœ¨ç¼–è¯‘é“¾æ¥åï¼Œç¨‹åºçš„å†…å­˜å¸ƒå±€é€šå¸¸åˆ†ä¸ºå‡ ä¸ªä¸»è¦æ®µï¼š\n\n- **.text**ï¼šå­˜æ”¾ä»£ç ï¼ˆåªè¯»ï¼‰ã€‚\n    \n- **.data**ï¼šå­˜æ”¾å·²åˆå§‹åŒ–çš„å…¨å±€/é™æ€å˜é‡ï¼ˆåˆå§‹å€¼ä¸ä¸º 0ï¼‰ã€‚\n    \n- **.bss**ï¼šå­˜æ”¾**æœªåˆå§‹åŒ–çš„**æˆ–è€…**åˆå§‹åŒ–ä¸º 0** çš„å…¨å±€/é™æ€å˜é‡ã€‚\n\n`.bss` åªåœ¨è¿è¡Œæ—¶éœ€è¦åˆ†é…å†…å­˜ï¼Œç¼–è¯‘äº§ç‰©ä¸­ä¸å ç”¨å­˜å‚¨ç©ºé—´ï¼ˆåªæ˜¯è®°å½•äº†å¤§å°ï¼‰ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯ã€‚\n\n</details>\n\n<details>\n\n<summary>ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ</summary>\n\næ ¹æ® **C è¯­è¨€æ ‡å‡†**ï¼š\n\n> æ‰€æœ‰æœªæ˜¾å¼åˆå§‹åŒ–çš„å…¨å±€å˜é‡ã€é™æ€å˜é‡åœ¨ç¨‹åºå¼€å§‹æ‰§è¡Œå‰å¿…é¡»è¢«åˆå§‹åŒ–ä¸º 0ã€‚\n\nè¿™æ„å‘³ç€ï¼š\n\n- å¦‚æœ `bss` æ®µä¸­çš„å†…å®¹ä¸æ˜¯å…¨ 0ï¼Œç¨‹åºå¯èƒ½ä¼šè¯»åˆ°**éšæœºçš„æ—§å†…å­˜å†…å®¹**ã€‚\n    \n- ç¡¬ä»¶ä¸Šï¼ŒRAM å¯åŠ¨åå¯èƒ½æ˜¯**æ‚ä¹±çš„å€¼**ï¼ˆä¸Šç”µçŠ¶æ€ã€ä¸Šæ¬¡è¿è¡Œæ®‹ç•™ã€è°ƒè¯•å™¨å†™å…¥ç­‰ï¼‰ã€‚\n    \n\nå› æ­¤ï¼Œ**å¯åŠ¨ä»£ç ï¼ˆcrt0 æˆ–æ±‡ç¼– startup.sï¼‰é€šå¸¸ä¼šåœ¨ `main()` ä¹‹å‰æ¸…é›¶ bss æ®µ**ï¼Œä¿è¯æ‰€æœ‰è¿™äº›å˜é‡æ˜¯å¹²å‡€çš„ 0ã€‚\n\n</details>\n\n```asm\n/* æ¸…é™¤bssæ®µ é˜²æ­¢æœªåˆå§‹åŒ–å˜é‡ç­‰æ•°æ®è®¿é—®é”™è¯¯ */\n\nÂ  Â  ldr r0, =__bss_start\n\nÂ  Â  ldr r1, =__bss_end\n\nÂ  Â  mov r2, #0\n\nbss_clear: Â  Â  Â  Â  Â /* ia: increse after */\n\nÂ  Â  stmia r0!, {r2} /* stmia: ä»r0æ‰€å­˜åœ°å€å¼€å§‹ï¼Œå°†r2çš„å€¼å†™å…¥è¯¥åœ°å€ï¼Œå†™å…¥ååœ°å€è‡ªåŠ¨é€’å¢ */\n\nÂ  Â  cmp r0, r1\n\nÂ  Â  ble bss_clear /* less & equal */\n```\n\n\n## 4. IRQä¸­æ–­å‡½æ•°çš„ç¼–å†™\n\n\n<details>\n\n<summary>ä¸­æ–­å‡½æ•°å®ç°äº†ä»€ä¹ˆï¼Ÿï¼ˆè¯¦ç»†ç‰ˆï¼‰</summary>\n\n### 4.1. ä¿å­˜ä¸­æ–­ç°åœºï¼ˆé˜²æ­¢ç ´ååŸä»»åŠ¡çŠ¶æ€ï¼‰\n\nä¸€æ—¦ CPU è¿›å…¥ IRQ æ¨¡å¼ï¼Œä¸­æ–­å¤„ç†ä»£ç é¦–å…ˆï¼š\n\n- æŠŠ `lr`ï¼ˆä¸­æ–­è¿”å›åœ°å€ï¼‰ã€`r0`~`r3`ã€`r12` ç­‰æ˜“è¢«ç ´åçš„å¯„å­˜å™¨å‹æ ˆä¿å­˜ã€‚\n    \n- ä¿å­˜ `SPSR`ï¼ˆä¸­æ–­è¿›å…¥æ—¶çš„ CPSR çŠ¶æ€ï¼‰ï¼Œä»¥ä¾¿ä¸­æ–­ç»“æŸæ—¶æ¢å¤åŸä»»åŠ¡çš„è¿è¡ŒçŠ¶æ€ã€‚\n    \n\n**ç›®çš„**ï¼šé˜²æ­¢ä¸­æ–­æœåŠ¡è¿‡ç¨‹ç ´åè¢«ä¸­æ–­çš„ç¨‹åºçš„å¯„å­˜å™¨å†…å®¹å’Œè¿è¡ŒçŠ¶æ€ã€‚\n\n---\n\n### 4.2. ä» GICï¼ˆé€šç”¨ä¸­æ–­æ§åˆ¶å™¨ï¼‰è¯»å–ä¸­æ–­å·\n\n- è¯»å– **GICC_IAR**ï¼ˆInterrupt Acknowledge Registerï¼‰å¯„å­˜å™¨ã€‚\n    \n- è¿™ä¸ªå¯„å­˜å™¨ä¼šè¿”å›å½“å‰è§¦å‘çš„ä¸­æ–­ IDï¼ˆæ˜¯å“ªä¸€ä¸ªå¤–è®¾è§¦å‘çš„ IRQï¼‰ã€‚\n    \n\n**ç›®çš„**ï¼šç¡®å®šæ˜¯å“ªä¸ªå…·ä½“ä¸­æ–­æºå‘ç”Ÿäº† IRQã€‚\n\n---\n\n### 4.3. åˆ‡æ¢åˆ° SVC æ¨¡å¼æ‰§è¡Œ C è¯­è¨€ä¸­æ–­å¤„ç†å‡½æ•°\n\n- ARMv7-A çš„ IRQ æ¨¡å¼ä¸é€‚åˆç›´æ¥è¿è¡Œé€šç”¨ C ä»£ç ï¼ˆæ ˆã€å¯„å­˜å™¨ä¸ç»Ÿä¸€ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œåˆ‡åˆ° SVC æ¨¡å¼ã€‚\n    \n- åœ¨ SVC æ¨¡å¼ä¸‹è°ƒç”¨ `system_irqhandler`ï¼ˆC å†™çš„æ€»ä¸­æ–­å¤„ç†å‡½æ•°ï¼‰ã€‚\n    \n- `system_irqhandler` ä¼šæ ¹æ®ä¸­æ–­å·å»è°ƒç”¨å…·ä½“å¤–è®¾çš„ä¸­æ–­å¤„ç†ä¾‹ç¨‹ã€‚\n    \n\n**ç›®çš„**ï¼šç»Ÿä¸€ç”¨ SVC æ¨¡å¼çš„æ ˆå’Œç¯å¢ƒæ‰§è¡Œä¸­æ–­é€»è¾‘ï¼Œæ–¹ä¾¿ç”¨ C è¯­è¨€å†™ ISR åˆ†å‘å™¨ã€‚\n\n---\n\n### 4.4. ç»“æŸä¸­æ–­å¹¶æ¢å¤ç°åœº\n\n- åˆ‡å› IRQ æ¨¡å¼ã€‚\n    \n- å‘ GIC å†™ **EOIR**ï¼ˆEnd of Interrupt Registerï¼‰ï¼Œé€šçŸ¥ GIC è¿™ä¸ªä¸­æ–­å¤„ç†å®Œæˆï¼Œå¯ä»¥æ¥æ”¶æ–°çš„ä¸­æ–­ã€‚\n    \n- ä»æ ˆä¸­å¼¹å‡ºå¯„å­˜å™¨å’Œ `SPSR`ï¼Œæ¢å¤è¿›å…¥ä¸­æ–­å‰çš„çŠ¶æ€ã€‚\n    \n- ç”¨ `subs pc, lr, #4` è¿”å›åˆ°ä¸­æ–­å‘ç”Ÿå‰çš„æŒ‡ä»¤ä½ç½®ç»§ç»­è¿è¡Œã€‚\n    \n\n**ç›®çš„**ï¼š\n\n- å‘Šè¯‰ä¸­æ–­æ§åˆ¶å™¨â€œæˆ‘å¤„ç†å®Œäº†â€ã€‚\n    \n- è®© CPU å®Œæ•´å›åˆ°è¢«æ‰“æ–­çš„ç¨‹åºï¼Œåƒä¸­æ–­æ²¡å‘ç”Ÿä¸€æ ·ç»§ç»­æ‰§è¡Œã€‚\n\n</details>\n\nçœæµç‰ˆï¼š\nå½“ä¸€ä¸ªç¨‹åºåœ¨ **SVC æ¨¡å¼** ä¸‹è¿è¡Œæ—¶ï¼Œå¦‚æœæ¥äº† IRQï¼š\n1. CPU è‡ªåŠ¨åˆ‡åˆ° IRQ æ¨¡å¼ã€‚\n2. æŠŠ **SVC æ¨¡å¼çš„ CPSR** å­˜è¿› **IRQ æ¨¡å¼çš„ SPSR**ã€‚\n3. æŠŠè¿”å›åœ°å€æ”¾è¿› IRQ æ¨¡å¼çš„ LRã€‚\n4. å¼€å§‹æ‰§è¡Œ IRQ æ¨¡å¼çš„å‘é‡å…¥å£ä»£ç ï¼ˆä¹Ÿå°±æ˜¯ `IRQ_Handler`ï¼‰ã€‚\nirq_handler:\n- ä¿å­˜ç°åœº\n- æŸ¥ä¸­æ–­å·\n- åˆ‡æ¢åˆ°svcæ¨¡å¼ è°ƒç”¨ç”¨cè¯­è¨€ç¼–å†™çš„ä¸­æ–­åˆ†å‘å‡½æ•° æ ¹æ®ä¸­æ–­å·åˆ†å‘åˆ°ä¸­æ–­å¤„ç†å‡½æ•° æ¥æ‰§è¡Œä¸­æ–­å¤„ç†\n- ç»“æŸä¸­æ–­ã€æ¢å¤ç°åœº\npsï¼š æœ€åä¸€è¡ŒsubsæŒ‡ä»¤æœ‰ç‚¹æŠ½è±¡ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚\n\n\n## 5. æ•´ä¸ªå¯åŠ¨æ–‡ä»¶\n\n```asm\n.global _start\n/* ä»¥ä¸‹ä¸¤ä¸ªå˜é‡åœ¨é“¾æ¥è„šæœ¬ä¸­å®šä¹‰ */\n.global __bss_start\n.global __bss_end\n_start:\nÂ  Â  @ /* 1.è®¾ç½®å¤„ç†å™¨æ¨¡å¼ä¸ºSVCæ¨¡å¼(å…¶å®CotexAå†…æ ¸ä¸Šç”µé»˜è®¤å³ä¸ºSVCæ¨¡å¼æ•…ä¸éœ€è¦å†™) */\nÂ  Â  @ mrs r0, cpsr Â  Â  Â  Â  Â  Â  Â  Â /* è¯»å–cpsråˆ°r0 */\nÂ  Â  @ bic r0, r0, #0x1f Â  Â  Â  Â  Â  /* bic bit-clearä½æ¸…é›¶ */ Â  Â  Â  Â  Â \nÂ  Â  @ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  /* ç­‰åŒäºR0 = R0 & (~Operand2) è¿™ä¸ªæ“ä½œæ•°2è‡ªå·±æ¨ç®—*/\nÂ  Â  @ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  /* ç°åœ¨è¿™ä¸ªæ“ä½œç›¸å½“äºå°†r0çš„å‰5ä½æ¸…é›¶äº† */\nÂ  Â  @ orr r0, r0, #0x13 Â  Â  Â  Â  Â  /* orr æŒ‰ä½æˆ– */\nÂ  Â  @ msr cpsr, r0 Â  Â  Â  Â  Â  Â  Â  Â /* å†™å…¥cpsr */  \nÂ  Â  /* è®¾ç½®ä¸­æ–­å‘é‡è¡¨ï¼Œå½“ä¸­æ–­æ¥æ—¶ï¼ŒCPUå°±ä¼šæ‰§è¡Œå¯¹åº”æŒ‡ä»¤ */\nÂ  Â  /* é¡ºåºä¸èƒ½æ”¹å˜ï¼Œåå­—å¯ä»¥æ”¹å˜ï¼ */\nÂ  Â  ldr pc, =Reset_Handler Â  Â  Â /* å¤ä½ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  */ Â \nÂ  Â  ldr pc, =Undefined_Handler Â /* æœªå®šä¹‰ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\nÂ  Â  ldr pc, =SVC_Handler Â  Â  Â  Â /* SVC(Supervisor)ä¸­æ–­ Â  Â  Â  Â */\nÂ  Â  ldr pc, =PrefAbort_Handler Â /* é¢„å–ç»ˆæ­¢ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  */\nÂ  Â  ldr pc, =DataAbort_Handler Â /* æ•°æ®ç»ˆæ­¢ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  */\nÂ  Â  ldr pc, =NotUsed_Handler Â  Â /* æœªä½¿ç”¨ä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\nÂ  Â  ldr pc, =IRQ_Handler Â  Â  Â  Â /* IRQä¸­æ–­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\nÂ  Â  ldr pc, =FIQ_Handler Â  Â  Â  Â /* FIQ(å¿«é€Ÿä¸­æ–­)æœªå®šä¹‰ä¸­æ–­ Â  Â  Â  Â  Â  */\nReset_Handler:  \nÂ  Â  cpsid i Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  /* Change Processor State Interrupt or abort Disable irq */\n\nÂ  Â  /* ç¦ç”¨MMUã€cacheã€å¯¹é½æ£€æŸ¥ç­‰ï¼Œé…ç½®é€‚åˆè£¸æœºå¯åŠ¨çš„ç¯å¢ƒï¼Œè¿™æ ·çš„å¯åŠ¨ä»£ç ç§»æ¤æ€§æ›´å¥½ */\nÂ  Â  mrc Â  Â  p15, 0, r0, c1, c0, 0 Â  Â  /* Â è¯»å–CP15ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨ Â  */\nÂ  Â  bic Â  Â  r0, Â r0, #0x1000 Â  Â  Â  Â  Â /* Â æ¸…é™¤ç¬¬12ä½ï¼ˆIä½ï¼‰ç¦ç”¨ I Cache Â */\nÂ  Â  bic Â  Â  r0, Â r0, #0x4 Â  Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬ 2ä½ï¼ˆCä½ï¼‰ç¦ç”¨ D Cache Â */\nÂ  Â  bic Â  Â  r0, Â r0, #0x2 Â  Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬ 1ä½ï¼ˆAä½ï¼‰ç¦æ­¢ä¸¥æ ¼å¯¹é½ Â  */\nÂ  Â  bic Â  Â  r0, Â r0, #0x800 Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬11ä½ï¼ˆZä½ï¼‰åˆ†æ”¯é¢„æµ‹ Â  */\nÂ  Â  bic Â  Â  r0, Â r0, #0x1 Â  Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬ 0ä½ï¼ˆMä½ï¼‰ç¦ç”¨ MMU Â  */\nÂ  Â  mcr Â  Â  p15, 0, r0, c1, c0, 0 Â  Â  /* Â å°†ä¿®æ”¹åçš„å€¼å†™å›CP15å¯„å­˜å™¨ Â  */\nÂ  Â  /* è®¿é—®CP15 VBARå¯„å­˜å™¨ è®¾ç½®ä¸­æ–­å‘é‡è¡¨åç§» */\nÂ  Â  ldr r0, =0x80000000\nÂ  Â  dsb\nÂ  Â  isb /* æ•°æ®åŒæ­¥æŒ‡ä»¤ */\nÂ  Â  mcr p15, 0, r0, c12, c0, 0\nÂ  Â  dsb\nÂ  Â  isb\nÂ  Â  /* æ¸…é™¤bssæ®µ é˜²æ­¢æœªåˆå§‹åŒ–å˜é‡ç­‰æ•°æ®è®¿é—®é”™è¯¯ */\nÂ  Â  ldr r0, =__bss_start\nÂ  Â  ldr r1, =__bss_end\nÂ  Â  mov r2, #0\nbss_clear: Â  Â  Â  Â  Â /* ia: increse after */\nÂ  Â  stmia r0!, {r2} /* stmia: ä»r0æ‰€å­˜åœ°å€å¼€å§‹ï¼Œå°†r2çš„å€¼å†™å…¥è¯¥åœ°å€ï¼Œå†™å…¥ååœ°å€è‡ªåŠ¨é€’å¢ */\nÂ  Â  cmp r0, r1\nÂ  Â  ble bss_clear /* less & equal */  \nÂ  Â  /* è®¾ç½®å„ä¸ªæ¨¡å¼ä¸‹çš„æ ˆæŒ‡é’ˆï¼Œ\nÂ  Â  Â * æ³¨æ„ï¼šIMX6ULçš„å †æ ˆæ˜¯å‘ä¸‹å¢é•¿çš„ï¼\nÂ  Â  Â * å †æ ˆæŒ‡é’ˆåœ°å€ä¸€å®šè¦æ˜¯4å­—èŠ‚åœ°å€å¯¹é½çš„ï¼ï¼ï¼\nÂ  Â  Â * DDRèŒƒå›´:0X80000000~0X9FFFFFFF\nÂ  Â  Â */\nÂ  Â  /* è¿›å…¥IRQæ¨¡å¼ */\nÂ  Â  mrs r0, cpsr\nÂ  Â  bic r0, r0, #0x1f Â  /* å°†r0å¯„å­˜å™¨ä¸­çš„ä½5ä½æ¸…é›¶ï¼Œä¹Ÿå°±æ˜¯cpsrçš„M0~M4 Â */\nÂ  Â  orr r0, r0, #0x12 Â  /* r0æˆ–ä¸Š0x13,è¡¨ç¤ºä½¿ç”¨IRQæ¨¡å¼ Â  Â  Â  Â  Â  Â  Â  Â  Â  */\nÂ  Â  msr cpsr, r0 Â  Â  Â  Â /* å°†r0 çš„æ•°æ®å†™å…¥åˆ°cpsr_cä¸­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\nÂ  Â  ldr sp, =0x80600000 /* è®¾ç½®IRQæ¨¡å¼ä¸‹çš„æ ˆé¦–åœ°å€ä¸º0X80600000,å¤§å°ä¸º2MB */\nÂ  Â  /* è¿›å…¥SYSæ¨¡å¼ */\nÂ  Â  mrs r0, cpsr\nÂ  Â  bic r0, r0, #0x1f Â  /* å°†r0å¯„å­˜å™¨ä¸­çš„ä½5ä½æ¸…é›¶ï¼Œä¹Ÿå°±æ˜¯cpsrçš„M0~M4 Â */\nÂ  Â  orr r0, r0, #0x1f Â  /* r0æˆ–ä¸Š0x13,è¡¨ç¤ºä½¿ç”¨SYSæ¨¡å¼ Â  Â  Â  Â  Â  Â  Â  Â  Â  */\nÂ  Â  msr cpsr, r0 Â  Â  Â  Â /* å°†r0 çš„æ•°æ®å†™å…¥åˆ°cpsr_cä¸­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\nÂ  Â  ldr sp, =0x80500000 /* è®¾ç½®SYSæ¨¡å¼ä¸‹çš„æ ˆé¦–åœ°å€ä¸º0X80400000,å¤§å°ä¸º2MB */\nÂ  Â  /* è¿›å…¥SVCæ¨¡å¼ */\nÂ  Â  mrs r0, cpsr\nÂ  Â  bic r0, r0, #0x1f Â  /* å°†r0å¯„å­˜å™¨ä¸­çš„ä½5ä½æ¸…é›¶ï¼Œä¹Ÿå°±æ˜¯cpsrçš„M0~M4 Â */\nÂ  Â  orr r0, r0, #0x13 Â  /* r0æˆ–ä¸Š0x13,è¡¨ç¤ºä½¿ç”¨SVCæ¨¡å¼ Â  Â  Â  Â  Â  Â  Â  Â  Â  */\nÂ  Â  msr cpsr, r0 Â  Â  Â  Â /* å°†r0 çš„æ•°æ®å†™å…¥åˆ°cpsr_cä¸­ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\nÂ  Â  ldr sp, =0X80400000 /* è®¾ç½®SVCæ¨¡å¼ä¸‹çš„æ ˆé¦–åœ°å€ä¸º0X80200000,å¤§å°ä¸º2MB */\nÂ  Â  cpsie i Â  Â  Â  Â  Â  Â  /* æ‰“å¼€å…¨å±€ä¸­æ–­ */\nÂ  Â  /* è·³è½¬åˆ°mainå‡½æ•° */\nÂ  Â  b main\n/* æœªå®šä¹‰ä¸­æ–­ */\nUndefined_Handler:\nÂ  Â  ldr r0, =Undefined_Handler\nÂ  Â  bx r0\n/* SVCä¸­æ–­ */\nSVC_Handler:\nÂ  Â  ldr r0, =SVC_Handler\nÂ  Â  bx r0\n/* é¢„å–ç»ˆæ­¢ä¸­æ–­ */\nPrefAbort_Handler:\nÂ  Â  ldr r0, =PrefAbort_Handler Â \nÂ  Â  bx r0\n/* æ•°æ®ç»ˆæ­¢ä¸­æ–­ */\nDataAbort_Handler:\nÂ  Â  ldr r0, =DataAbort_Handler\nÂ  Â  bx r0  \n/* æœªä½¿ç”¨çš„ä¸­æ–­ */\nNotUsed_Handler:\nÂ  Â  ldr r0, =NotUsed_Handler\nÂ  Â  bx r0  \n/* IRQä¸­æ–­ï¼é‡ç‚¹ï¼ï¼ï¼ï¼ï¼ */\nIRQ_Handler:\nÂ  Â  /* ä¿æŠ¤ç°åœº */\nÂ  Â  push {lr} Â  Â  Â  Â  Â  Â  Â  Â  Â  /* ä¿å­˜lråœ°å€ */\nÂ  Â  push {r0-r3, r12} Â  Â  Â  Â  Â  /* ä¿å­˜r0-r3ï¼Œr12å¯„å­˜å™¨ */\nÂ  Â  mrs r0, spsr Â  Â  Â  Â  Â  Â  Â  Â /* è¯»å–spsrå¯„å­˜å™¨ */\nÂ  Â  push {r0} Â  Â  Â  Â  Â  Â  Â  Â  Â  /* ä¿å­˜spsrå¯„å­˜å™¨ */ \n\nÂ  Â  /* è¯»å–GICæ§åˆ¶å™¨åŸºåœ°å€ */\nÂ  Â  mrc p15, 4, r1, c15, c0, 0 /* ä»CP15çš„C0å¯„å­˜å™¨å†…çš„å€¼åˆ°R1å¯„å­˜å™¨ä¸­\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  * å‚è€ƒæ–‡æ¡£ARM Cortex-A(armV7)ç¼–ç¨‹æ‰‹å†ŒV4.0.pdf P49\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  * Cortex-A7 Technical ReferenceManua.pdf P68 P138\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  */ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ  Â  add r1, r1, #0X2000 Â  Â  Â  Â  /* GICåŸºåœ°å€åŠ 0X2000ï¼Œä¹Ÿå°±æ˜¯GICçš„CPUæ¥å£ç«¯åŸºåœ°å€ */\nÂ  Â  /* æŸ¥è¯¢ä¸­æ–­å· */\nÂ  Â  ldr r0, [r1, #0XC] Â  Â  Â  Â  Â /* GICçš„CPUæ¥å£ç«¯åŸºåœ°å€åŠ 0X0Cå°±æ˜¯GICC_IARå¯„å­˜å™¨ï¼Œ\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â * GICC_IARå¯„å­˜å™¨ä¿å­˜è¿™å½“å‰å‘ç”Ÿä¸­æ–­çš„ä¸­æ–­å·ï¼Œæˆ‘ä»¬è¦æ ¹æ®\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â * è¿™ä¸ªä¸­æ–­å·æ¥ç»å¯¹è°ƒç”¨å“ªä¸ªä¸­æ–­æœåŠ¡å‡½æ•°\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â */\nÂ  Â  push {r0, r1} Â  Â  Â  Â  Â  Â  Â  /* ä¿å­˜r0,r1 */\nÂ  Â  cps #0x13 Â  Â  Â  Â  Â  Â  Â  Â  Â  /* è¿›å…¥SVCæ¨¡å¼ï¼Œå…è®¸å…¶ä»–ä¸­æ–­å†æ¬¡è¿›å» */\nÂ  Â  push {lr} Â  Â  Â  Â  Â  Â  Â  Â  Â  /* ä¿å­˜SVCæ¨¡å¼çš„lrå¯„å­˜å™¨ */\nÂ  Â  ldr r2, =system_irqhandler Â /* åŠ è½½Cè¯­è¨€ä¸­æ–­å¤„ç†å‡½æ•°åˆ°r2å¯„å­˜å™¨ä¸­*/\nÂ  Â  blx r2 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â /* è¿è¡ŒCè¯­è¨€ä¸­æ–­å¤„ç†å‡½æ•°ï¼Œå¸¦æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¿å­˜åœ¨R0å¯„å­˜å™¨ä¸­ */\nÂ  Â  pop {lr} Â  Â  Â  Â  Â  Â  Â  Â  Â  Â /* æ‰§è¡Œå®ŒCè¯­è¨€ä¸­æ–­æœåŠ¡å‡½æ•°ï¼Œlrå‡ºæ ˆ */\nÂ  Â  cps #0x12 Â  Â  Â  Â  Â  Â  Â  Â  Â  /* è¿›å…¥IRQæ¨¡å¼ */\nÂ  Â  pop {r0, r1} Â  Â  Â  Â  Â  Â  Â  Â \nÂ  Â  str r0, [r1, #0X10] Â  Â  Â  Â  /* ä¸­æ–­æ‰§è¡Œå®Œæˆï¼Œå†™EOIRï¼Œç›¸å½“äºç¡®è®¤ä¸­æ–­æ‰§è¡Œå®Œæˆ */\nÂ  Â  pop {r0} Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ  Â  msr spsr_cxsf, r0 Â  Â  Â  Â  Â  /* æ¢å¤spsr */\nÂ  Â  pop {r0-r3, r12} Â  Â  Â  Â  Â  Â /* r0-r3,r12å‡ºæ ˆ */\nÂ  Â  pop {lr} Â  Â  Â  Â  Â  Â  Â  Â  Â  Â /* lrå‡ºæ ˆ */\nÂ  Â  subs pc, lr, #4 Â  Â  Â  Â  Â  Â  /* å°†lr-4èµ‹ç»™pc */\n/* FIQä¸­æ–­ */\nFIQ_Handler:\nÂ  Â  ldr r0, =FIQ_Handler Â  Â \nÂ  Â  bx r0\nloop:\nÂ  Â  b loop\n```\n\n\n[^1]: ä¸­æ–­å‘é‡ï¼Œè‹±æ–‡åä¸ºInterrupt Vectorï¼Œåœ¨æ—©æœŸè®¡ç®—æœºä½“ç³»ç»“æ„é‡Œï¼Œâ€œvectorâ€å¸¸è¢«ç”¨ä½œâ€œæŒ‡é’ˆ/åœ°å€ç´¢å¼•â€çš„æ„æ€ï¼Œæ‰€ä»¥â€å‘é‡â€œå®é™…ä¸Šå°±æ˜¯åœ°å€æŒ‡é’ˆçš„æ„æ€ã€‚","tags":["åµŒå…¥å¼","Linux"],"categories":["Linux","è®°å½•"]},{"title":"I-MX6ULLä¸»é¢‘ä¸æ—¶é’Ÿé…ç½®å®éªŒ","url":"/posts/33477/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n:::info\nå­¦ä¹ ç¬”è®°è®°å½•ï¼Œéæ•™ç¨‹ã€‚\n:::\n\n\n## ç³»ç»Ÿæ—¶é’Ÿæµ…æ\n\n### 7è·¯PLL\n\nä¸ºäº†æ–¹ä¾¿ç”Ÿæˆæ—¶é’Ÿï¼Œ6ä»24MHzæ™¶æŒ¯ç”Ÿå‡ºæ¥7è·¯PLLã€‚è¿™7è·¯PLLä¸­æœ‰çš„åˆç”Ÿå‡ºæ¥PFDã€‚\n- `PLL1`ï¼šARM PLLä¾›ç»™ARMå†…æ ¸ã€‚\n- `PLL2`ï¼šsysytem PLLï¼Œ528MHzï¼Œ528_PLLï¼Œæ­¤è·¯PLLåˆ†å‡ºäº†4è·¯PFDï¼Œåˆ†åˆ«ä¸ºPLL2_PFD0~PFD3\n- `PLL3`: USB1 PLLï¼Œ480MHz 480_PLLï¼Œæ­¤è·¯PLLåˆ†å‡ºäº†4è·¯PFDï¼Œåˆ†åˆ«ä¸ºPLL3_PFD0~PFD3ã€‚\n- `PLL4`: Audio PLLï¼Œä¸»ä¾›éŸ³é¢‘ä½¿ç”¨ã€‚\n- `PLL5`: Video PLLï¼Œä¸»ä¾›è§†é¢‘å¤–è®¾ï¼Œæ¯”å¦‚RGB LCDæ¥å£ï¼Œå’Œå›¾åƒå¤„ç†æœ‰å…³çš„å¤–è®¾ã€‚\n- `PLL6`ï¼šENET PLLï¼Œä¸»ä¾›ç½‘ç»œå¤–è®¾ã€‚\n- `PLL7`: USB2_PLL ,480MHzï¼Œæ— PFDã€‚\n\nè¯¦è§ IMX6ULLå‚è€ƒæ‰‹å†Œ Chapter 18 Clock Controller Module (CCM)\n\né™„ æ—¶é’Ÿæ ‘å›¾ï¼š\ntå½¢ä¸ºå¤šè·¯é€‰æ‹©å™¨\n\n![](Snipaste_2025-08-06_22-02-07.png)\n![](Snipaste_2025-08-06_22-03-45.png)\n\n\n### è¦åˆå§‹åŒ–çš„PLLå’ŒPFD\n\n- PLL1ï¼Œ\n- PLL2ï¼Œä»¥åŠPLL2_PFD0~PFD3.\n- PLL3ä»¥åŠPLL3_PFD0~PFD3.\nå…¶ä»–éœ€è¦æ—¶å†è®¾ç½®ã€‚\nä¸€èˆ¬æŒ‰ç…§æ—¶é’Ÿæ ‘é‡Œé¢çš„å€¼è¿›è¡Œè®¾ç½®ã€‚\n\n## å…·ä½“é…ç½®\n\n### ç³»ç»Ÿä¸»é¢‘çš„é…ç½®\n\næ ¹æ®æ—¶é’Ÿæ ‘æ¥è®¾å®šç³»ç»Ÿä¸»é¢‘ã€‚å…·ä½“æ—¶é’Ÿé…ç½®çš„è¯´æ˜å¯ä»¥å‚è§ IMX6ULLå‚è€ƒæ‰‹å†Œ 18.5.1.5\nCCM internal clock generation \nä¸‹å›¾ä¸ºæ—¶é’Ÿåˆ‡æ¢å™¨ ï¼ˆCCM_CLK_SWITCHERï¼‰ æ§åˆ¶è¾“å‡ºçš„ç¤ºæ„å›¾ã€‚\n\n![](Snipaste_2025-08-07_10-00-08.png)\n\n1. è¦è®¾ç½®ARMå†…æ ¸ä¸»é¢‘ä¸º528MHzï¼Œè®¾ç½®CACRRå¯„å­˜å™¨çš„ARM_PODFä½ä¸º2åˆ†é¢‘ï¼Œç„¶åè®¾ç½®PLL1=1056MHzå³å¯ã€‚CACRRçš„bit3~0ä¸ºARM_PODFä½ï¼Œå¯è®¾ç½®0~7ï¼Œåˆ†åˆ«å¯¹åº”1~8åˆ†é¢‘ã€‚åº”è¯¥è®¾ç½®CACRRå¯„å­˜å™¨çš„ARM_PODF=1ã€‚\n\n2. åˆ‡æ¢æ—¶é’Ÿæºã€‚PLL1è¾“å‡ºä¸ºpll1_sw_clkã€‚pll1_sw_clkæœ‰ä¸¤è·¯å¯ä»¥é€‰æ‹©ï¼Œåˆ†åˆ«ä¸ºpll1_main_clkï¼Œå’Œstep_clkï¼Œé€šè¿‡CCSRå¯„å­˜å™¨çš„pll1_sw_clk_selä½(bit2)æ¥é€‰æ‹©ã€‚ä¸º0çš„æ—¶å€™é€‰æ‹©pll1_main_clkï¼Œä¸º1çš„æ—¶å€™é€‰é¢step_clkã€‚\n\n3. åœ¨ä¿®æ”¹PLL1çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®ç³»ç»Ÿæ—¶é’Ÿçš„æ—¶å€™éœ€è¦ç»™6ULLä¸€ä¸ªä¸´æ—¶çš„æ—¶é’Ÿï¼Œä¹Ÿå°±æ˜¯step_clkã€‚åœ¨ä¿®æ”¹PLL1çš„æ—¶å€™éœ€è¦å°†pll1_sw_clkåˆ‡æ¢åˆ°step_clkä¸Šã€‚\n\n4. è®¾ç½®step_clkã€‚Step_clkä¹Ÿæœ‰ä¸¤è·¯æ¥æºï¼Œç”±CCSRçš„step_selä½(bit8)æ¥è®¾ç½®ï¼Œä¸º0çš„æ—¶å€™è®¾ç½®step_clkä¸ºosc=24MHzã€‚ä¸º1çš„æ—¶å€™ä¸é‡è¦ï¼Œä¸ç”¨ã€‚\n\n5. æ—¶é’Ÿåˆ‡æ¢æˆåŠŸä»¥åå°±å¯ä»¥ä¿®æ”¹PLL1çš„å€¼ã€‚\n\n6. é€šè¿‡CCM_ANALOG_PLL_ARMå¯„å­˜å™¨çš„DIV_SELECTä½(bit6~0)æ¥è®¾ç½®PLL1çš„é¢‘ç‡ï¼Œå…¬å¼ä¸ºï¼š\n\n\t\tOutput = fref*DIV_SEL/2Â  1056=24*DIV_SEL/2=>DIEV_SEL=88ã€‚\n\t\t\n\t\tè®¾ç½®CCM_ANALOG_PLL_ARMå¯„å­˜å™¨çš„DIV_SELECTä½=88å³å¯ã€‚PLL1=1056MHz\n\t\t\n\t\tè¿˜è¦è®¾ç½®CCM_ANALOG_PLL_ARMå¯„å­˜å™¨çš„ENABLEä½(bit13)ä¸º1ï¼Œä¹Ÿå°±æ˜¯ä½¿èƒ½è¾“å‡ºã€‚\n\n7. åœ¨åˆ‡æ¢å›PLL1ä¹‹å‰ï¼Œè®¾ç½®ç½®CACRRå¯„å­˜å™¨çš„ARM_PODF=1ï¼ï¼åˆ‡è®°ã€‚\n\n### å…¶ä»–PLLè®¾ç½®\n\nPLL2å’ŒPLL3ã€‚PLL2å›ºå®šä¸º528MHzï¼ŒPLL3å›ºå®šä¸º480MHzã€‚\n\n1. åˆå§‹åŒ–PLL2_PFD0~PFD3ã€‚å¯„å­˜å™¨CCM_ANALOG_PFD_528ç”¨äºè®¾ç½®4è·¯PFDçš„æ—¶é’Ÿã€‚æ¯”å¦‚PFD0= 528 * 18 / PFD0_FRACã€‚ è®¾ç½®PFD0_FRACä½å³å¯ã€‚æ¯”å¦‚PLL2_PFD0=352M=528 *  18 / PFD0_FRACï¼Œå› æ­¤FPD0_FRAC=27ã€‚\n2. åŒç†åˆå§‹åŒ–PLL3_PFD0~PFD3\n\n## å¤–è®¾æ—¶é’Ÿ\n\nAHB_CLK_ROOTã€PERCLK_CLK_ROOTä»¥åŠIPG_CLK_ROOTã€‚\n\nå› ä¸ºPERCLK_CLK_ROOTå’ŒIPG_CLK_ROOTè¦ç”¨åˆ°AHB_CLK_ROOTï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆå§‹åŒ–AHB_CLK_ROOTã€‚\n\n### AHB_CLK_ROOTçš„åˆå§‹åŒ–\n\nAHB_CLK_ROOT=132MHzã€‚\n\nè®¾ç½®CBCMRå¯„å­˜å™¨çš„PRE_PERIPH_CLK_SELä½ï¼Œè®¾ç½®CBCDRå¯„å­˜å™¨çš„PERIPH_CLK_SELä½0ã€‚è®¾ç½®CBCDRå¯„å­˜å™¨çš„AHB_PODFä½ä¸º2ï¼Œä¹Ÿå°±æ˜¯3åˆ†é¢‘ï¼Œå› æ­¤396/3=132MHzã€‚\n\n### IPG_CLK_ROOTåˆå§‹åŒ–\n\nè®¾ç½®CBCDRå¯„å­˜å™¨IPG_PODF=1ï¼Œä¹Ÿå°±æ˜¯2åˆ†é¢‘ã€‚\n\n### PERCLK_CLK_ROOTåˆå§‹åŒ–\n\nè®¾ç½®CSCMR1å¯„å­˜å™¨çš„PERCLK_CLK_SELä½ä¸º0ï¼Œè¡¨ç¤ºPERCLKçš„æ—¶é’Ÿæºä¸ºIPGã€‚\n\n\n## è¿™ç¯‡æ–‡ç« å†™å¾—å¾ˆä¸é”™,æ‘˜å½•ä¸€äº›\n\n[ã€åµŒå…¥å¼Linuxã€‘i.MX6ULL æ—¶é’Ÿæ ‘â€”â€”ç†è®ºåˆ†æ-CSDNåšå®¢](https://blog.csdn.net/Beihai_Van/article/details/139868239)\n\n### æ€»ç»“PFDé…ç½®å¯„å­˜å™¨:\n\nCCM_ANALOG_PFD_528n å¯„å­˜å™¨æ§åˆ¶ç€ i.MX 6ULL å¤„ç†å™¨ä¸­å››ä¸ªåˆ†æ•°åˆ†é¢‘å™¨çš„é…ç½®ï¼ŒåŒ…æ‹¬æ—¶é’Ÿé—¨æ§ã€ç¨³å®šæ€§çŠ¶æ€å’Œåˆ†æ•°åˆ†é¢‘å€¼ã€‚è¿™äº›åˆ†é¢‘å™¨ç”¨äºç”Ÿæˆä¸åŒé¢‘ç‡çš„æ—¶é’Ÿä¿¡å·ï¼Œä»¥æ»¡è¶³å„ç§å¤–è®¾çš„éœ€æ±‚ã€‚\n\n1. CLKGATE ä½ (Clock Gate): æ—¶é’Ÿé—¨æ§\n- ä½œç”¨: CLKGATE ä½æ§åˆ¶ç€å¯¹åº” PFD çš„æ—¶é’Ÿä¿¡å·æ˜¯å¦è¢«å¼€å¯æˆ–å…³é—­ã€‚\n- å€¼:\n\t- 0: æ—¶é’Ÿä¿¡å·å¼€å¯ï¼ŒPFD æ­£å¸¸å·¥ä½œï¼Œå¯ä»¥è¾“å‡ºåˆ†é¢‘åçš„æ—¶é’Ÿä¿¡å·ã€‚\n\t- 1: æ—¶é’Ÿä¿¡å·å…³é—­ï¼ŒPFD å¤„äºå…³é—­çŠ¶æ€ï¼Œä¸è¾“å‡ºæ—¶é’Ÿä¿¡å·ã€‚\n- ç›®çš„:\n\t- çœç”µ: å½“æŸä¸ªå¤–è®¾ä¸éœ€è¦æ—¶é’Ÿä¿¡å·æ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® CLKGATE ä½ä¸º 1 æ¥å…³é—­è¯¥ PFD çš„æ—¶é’Ÿï¼Œä»è€Œå‡å°‘åŠŸè€—ã€‚\n\t- æ§åˆ¶æ—¶é’Ÿä¿¡å·: åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦åŠ¨æ€åœ°æ§åˆ¶æŸä¸ªå¤–è®¾çš„æ—¶é’Ÿä¿¡å·ï¼Œä¾‹å¦‚åœ¨ç³»ç»Ÿå¯åŠ¨æˆ–è¿›å…¥ä½åŠŸè€—æ¨¡å¼æ—¶ã€‚\n2. STABLE ä½ (Stable): ç¨³å®šæ€§çŠ¶æ€\n\n- ä½œç”¨: STABLE ä½æŒ‡ç¤ºå¯¹åº” PFD çš„è¾“å‡ºæ—¶é’Ÿä¿¡å·æ˜¯å¦å·²ç»ç¨³å®šã€‚\n- å€¼:\n\tå½“æ–°çš„åˆ†æ•°åˆ†é¢‘å€¼ç”Ÿæ•ˆæ—¶ï¼Œä½åŸŸçš„å€¼ä¼šåè½¬ï¼ˆä» 0 å˜ä¸º 1 æˆ–ä» 1 å˜ä¸º 0ï¼‰ã€‚è¿™ä¸ªåè½¬å°±åƒä¸€ä¸ªä¿¡å·ï¼Œè¡¨æ˜åˆ†é¢‘å™¨å·²ç»å®Œæˆè°ƒæ•´ã€‚\n- ç›®çš„:\n\t- è¯Šæ–­: STABLE ä½æ˜¯ä¸€ä¸ªåªè¯»ä½ï¼Œç”¨äºè¯Šæ–­ PFD çš„ç¨³å®šæ€§ã€‚\n\t- ç¡®ä¿æ—¶é’Ÿä¿¡å·è´¨é‡: åœ¨ä¿®æ”¹ PFD çš„åˆ†æ•°åˆ†é¢‘å€¼åï¼Œéœ€è¦ç­‰å¾… STABLE ä½åè½¬ï¼Œæ‰èƒ½ç¡®ä¿è¾“å‡ºçš„æ—¶é’Ÿä¿¡å·ç¨³å®šå¯é ã€‚\n\n### i.MX6U èŠ¯ç‰‡ PLL æ—¶é’Ÿè¯¦è§£\n\ni.MX6U èŠ¯ç‰‡æ‹¥æœ‰å¤šä¸ª PLLï¼ˆPhase-Locked Loopï¼Œé”ç›¸ç¯ï¼‰æ¨¡å—ï¼Œç”¨äºç”Ÿæˆå„ç§é¢‘ç‡çš„æ—¶é’Ÿä¿¡å·ï¼Œä¸ºèŠ¯ç‰‡å†…éƒ¨çš„ä¸åŒæ¨¡å—å’Œå¤–è®¾æä¾›æ—¶é’Ÿæºã€‚ä¸‹é¢æ•´ç†äº† i.MX6U èŠ¯ç‰‡çš„ 7 ä¸ªä¸»è¦ PLLï¼š\n\n1. ARM_PLL (PLL1)\n\t- ç”¨é€”: ä¸º ARM å†…æ ¸æä¾›æ—¶é’Ÿä¿¡å·ã€‚\n\t- å€é¢‘: å¯ç¼–ç¨‹ï¼Œæœ€é«˜å¯å€é¢‘è‡³ 1.3GHzã€‚\n\t- ç‰¹ç‚¹: ARM å†…æ ¸çš„è¿è¡Œé€Ÿåº¦ç›´æ¥å–å†³äºæ­¤ PLL çš„è¾“å‡ºé¢‘ç‡ã€‚\n2. 528_PLL (PLL2)\n\t- ç”¨é€”: ä¸ºç³»ç»Ÿæ€»çº¿ã€å†…éƒ¨é€»è¾‘å•å…ƒã€DDR æ¥å£ã€NAND/NOR æ¥å£ç­‰æä¾›æ—¶é’Ÿæºã€‚\n\t- å€é¢‘: å›ºå®š 22 å€é¢‘ï¼Œä¸å¯ç¼–ç¨‹ã€‚\n\t- è¾“å‡ºé¢‘ç‡: 24MHz * 22 = 528MHzã€‚\n\t- ç‰¹ç‚¹: è¯¥ PLL ä»¥åŠå…¶ç”Ÿæˆçš„ 4 è·¯ PFD (PLL2_PFD0~PLL2_PFD3) æ˜¯ i.MX6U å†…éƒ¨ç³»ç»Ÿæ€»çº¿çš„æ ¸å¿ƒæ—¶é’Ÿæºã€‚\n3. USB1_PLL (PLL3)\n\t- ç”¨é€”: ä¸»è¦ç”¨äº USB1PHYï¼Œä½†ä¹Ÿå¯ä½œä¸ºå…¶ä»–å¤–è®¾çš„æ—¶é’Ÿæºã€‚\n\t- å€é¢‘: å›ºå®š 20 å€é¢‘ã€‚\n\t- è¾“å‡ºé¢‘ç‡: 24MHz * 20 = 480MHzã€‚\n\t- ç‰¹ç‚¹: è¯¥ PLL ä»¥åŠå…¶ç”Ÿæˆçš„ 4 è·¯ PFD (PLL3_PFD0~PLL3_PFD3) å¯ç”¨äºå¤šç§å¤–è®¾ã€‚\n4. USB2_PLL (PLL7)\n\t- ç”¨é€”: ä¸º USB2PHY æä¾›æ—¶é’Ÿä¿¡å·ã€‚\n\t- å€é¢‘: å›ºå®š 20 å€é¢‘ã€‚\n\t- è¾“å‡ºé¢‘ç‡: 24MHz * 20 = 480MHzã€‚\n\t- ç‰¹ç‚¹: è™½ç„¶åºå·æ ‡ä¸º 4ï¼Œä½†å®é™…æ˜¯ PLL7ã€‚\n5. ENET_PLL (PLL6)\n\t- ç”¨é€”: ç”¨äºç”Ÿæˆç½‘ç»œæ‰€éœ€çš„æ—¶é’Ÿä¿¡å·ã€‚\n\t- å€é¢‘: å›ºå®š 20+5/6 å€é¢‘ã€‚\n\t- è¾“å‡ºé¢‘ç‡: 24MHz * (20+5/6) = 500MHzã€‚\n\t- ç‰¹ç‚¹: å¯åœ¨æ­¤ PLL çš„åŸºç¡€ä¸Šç”Ÿæˆ 25/50/100/125MHz çš„ç½‘ç»œæ—¶é’Ÿã€‚\n6. VIDEO_PLL (PLL5)\n\t- ç”¨é€”: ç”¨äºæ˜¾ç¤ºç›¸å…³å¤–è®¾ï¼Œä¾‹å¦‚ LCDã€‚\n\t- å€é¢‘: å¯è°ƒæ•´ï¼Œè¾“å‡ºèŒƒå›´åœ¨ 650MHz~1300MHzã€‚\n\t- åˆ†é¢‘: å¯é€‰ 1/2/4/8/16 åˆ†é¢‘ã€‚\n\t- ç‰¹ç‚¹: å¯æ ¹æ®æ˜¾ç¤ºè®¾å¤‡çš„éœ€æ±‚è°ƒæ•´è¾“å‡ºé¢‘ç‡å’Œåˆ†é¢‘æ¯”ã€‚\n7. AUDIO_PLL (PLL4)\n\t- ç”¨é€”: ç”¨äºéŸ³é¢‘ç›¸å…³å¤–è®¾ã€‚\n\t- å€é¢‘: å¯è°ƒæ•´ï¼Œè¾“å‡ºèŒƒå›´åœ¨ 650MHz~1300MHzã€‚\n\t- åˆ†é¢‘: å¯é€‰ 1/2/4 åˆ†é¢‘ã€‚\n\t- ç‰¹ç‚¹: å¯æ ¹æ®éŸ³é¢‘è®¾å¤‡çš„éœ€æ±‚è°ƒæ•´è¾“å‡ºé¢‘ç‡å’Œåˆ†é¢‘æ¯”ã€‚\næ€»ç»“:\n\ni.MX6U èŠ¯ç‰‡é€šè¿‡å¤šä¸ª PLL æ¨¡å—ï¼Œç”Ÿæˆå„ç§é¢‘ç‡çš„æ—¶é’Ÿä¿¡å·ï¼Œä¸ºèŠ¯ç‰‡å†…éƒ¨çš„ä¸åŒæ¨¡å—å’Œå¤–è®¾æä¾›æ—¶é’Ÿæºã€‚æ¯ä¸ª PLL çš„å€é¢‘å’Œåˆ†é¢‘éƒ½å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œé…ç½®ï¼Œä»¥æ»¡è¶³ä¸åŒå¤–è®¾çš„éœ€æ±‚ã€‚\n","tags":["åµŒå…¥å¼","Linux"],"categories":["Linux","è®°å½•"]},{"title":"I-MX6ULLå¼€å‘æ¿Cè¯­è¨€è¿è¡Œç¯å¢ƒæ­å»ºå¹¶ç‚¹ç¯","url":"/posts/2969/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n:::info\nå­¦ä¹ ç¬”è®°è®°å½•ï¼Œéæ•™ç¨‹ã€‚\n:::\n\n## Cè¯­è¨€è¿è¡Œç¯å¢ƒæ­å»º\n\nå‰é¢æˆ‘ä»¬è®²è§£äº†å¦‚ä½•ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™ LED ç¯å®éªŒï¼Œä½†æ˜¯å®é™…å¼€å‘è¿‡ç¨‹ä¸­æ±‡ç¼–ç”¨çš„å¾ˆå°‘ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ C è¯­è¨€å¼€å‘ï¼Œæ±‡ç¼–åªæ˜¯ç”¨æ¥å®Œæˆ C è¯­è¨€ç¯å¢ƒçš„åˆå§‹åŒ–ã€‚æœ¬æ–‡æˆ‘ä»¬å°±æ¥å­¦ä¹ å¦‚ä½•ç”¨æ±‡ç¼–æ¥å®Œæˆ C è¯­è¨€ç¯å¢ƒçš„åˆå§‹åŒ–å·¥ä½œï¼Œç„¶åä»æ±‡ç¼–è·³è½¬åˆ° C è¯­è¨€ä»£ç é‡Œé¢å»ã€‚\n\n### è®¾ç½®å¤„ç†å™¨æ¨¡å¼\n\nå¯¹äºCortex-Aå¤„ç†å™¨ï¼Œæœ‰å¤šç§è¿è¡Œæ¨¡å¼ï¼Œä¾‹å¦‚Useræ¨¡å¼ã€ä¸­æ–­æ¨¡å¼ç­‰ã€‚é™¤ç”¨æˆ·ï¼ˆUserï¼‰æ¨¡å¼ä¸ºéç‰¹æƒæ¨¡å¼ï¼Œå…¶ä½™å‡ä¸ºç‰¹æƒæ¨¡å¼ï¼Œç‰¹æƒæ¨¡å¼ä¸‹ç¨‹åºå¯ä»¥è®¿é—®æ‰€æœ‰ç³»ç»Ÿèµ„æºï¼Œè¿˜æœ‰è‡ªå·±ç‹¬æœ‰çš„å¯„å­˜å™¨ç»„ï¼Œè€Œéç‰¹æƒæ¨¡å¼ä¸‹è®¿é—®å—é™ã€‚\n\n![](Snipaste_2025-07-28_17-13-11.png)\n\nè€Œç°åœ¨æˆ‘ä»¬éœ€è¦å°†å¤„ç†å™¨æ¨¡å¼è®¾ç½®ä¸ºSVCæ¨¡å¼ã€‚\nè¿™å°±éœ€è¦äº†è§£åˆ°å†…æ ¸å¯„å­˜å™¨ç»„ä¸­çš„CPSRå¯„å­˜å™¨ï¼Œå…¶ä½å››ä½ä¸ºå¤„ç†å™¨è¿è¡Œæ¨¡å¼æ§åˆ¶ä½ã€‚\n\n![](Snipaste_2025-07-28_17-16-59.png)\n\n![](Snipaste_2025-07-28_17-19-33%201.png)\n\n![](Snipaste_2025-07-28_17-20-27.png)\n\nè®¾ç½®CPSRå¯„å­˜å™¨çš„bit4-0ï¼Œä¹Ÿå°±æ˜¯M[4:0]ä¸º10011=0X13ã€‚è¯»å†™çŠ¶æ€å¯„å­˜å™¨éœ€è¦ç”¨åˆ° MRS[^1] å’Œ MSR[^2] æŒ‡ä»¤ã€‚MRSå°†CPSRå¯„å­˜å™¨æ•°æ®è¯»å‡ºåˆ°é€šç”¨å¯„å­˜å™¨é‡Œé¢ï¼ŒMSRæŒ‡ä»¤å°†é€šç”¨å¯„å­˜å™¨çš„å€¼å†™å…¥åˆ°CPSRå¯„å­˜å™¨é‡Œé¢å»ã€‚\n\nä¸ºå•¥ä¸ç”¨SDRã€LDRï¼Ÿå› ä¸ºè¿™ä»–å¦ˆå±äºå¤„ç†å™¨å†…éƒ¨è‡ªå·±åœ¨ä¼ è¾“æ•°æ®ï¼Œè€Œä¸æ˜¯ä»å¯„å­˜å™¨ä¸å­˜å‚¨å™¨ï¼è€Œä¸”å®ƒåªèƒ½æ“ä½œé€šç”¨å¯„å­˜å™¨ã€‚\n\n![](Snipaste_2025-07-28_17-26-03.png)\n\n### è®¾ç½®spå¯„å­˜å™¨\n\nä¹Ÿå°±æ˜¯æ ˆçš„èµ·å§‹åœ°å€ã€‚\nSpå¯ä»¥æŒ‡å‘å†…éƒ¨RAMï¼Œä¹Ÿå¯ä»¥æŒ‡å‘DDRï¼Œæˆ‘ä»¬å°†å…¶æŒ‡å‘DDRã€‚Spè®¾ç½®åˆ°å“ªé‡Œï¼Ÿ512MBçš„èŒƒå›´0x80000000~0x9FFFFFFFã€‚æ ˆå¤§å°ï¼Œ0x200000=2MBï¼Œå¾ˆå¤§å¤§å¤§å¤§äº†ã€‚\n\nå†æä¸€å˜´ï¼Œç”±äºNXPç»™æˆ‘ä»¬æä¾›çš„SDKåŒ…é‡Œé¢æœ‰åˆå§‹åŒ–DDRç­‰ä¸€ç³»åˆ—æ“ä½œï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„è®¾ç½®spå¯„å­˜å™¨ï¼Œå…¶ä»–å¤„ç†å™¨ï¼ˆå¯åŠ¨æ–¹å¼è®¾ç½®ä¸ºDDRçš„æƒ…å†µä¸‹ï¼‰å¦‚æœæ²¡æœ‰åˆå§‹åŒ–DDRï¼Œè¿˜éœ€è¦å…ˆåˆå§‹åŒ–DDRã€‚\n\nè¿™é‡Œå†è¯´ä¸€ä¸‹æ ˆçš„ç‰¹æ€§ï¼Œæœ‰ç‚¹æŠ½è±¡â€¦â€¦\n- å‘ä¸Šå¢é•¿ï¼šå³ä»ä½åœ°å€å¾€é«˜åœ°å€å¢é•¿ã€‚ä»¥æ­¤åˆ¤æ–­å³å¯ã€‚\n- å‘ä¸‹å¢é•¿ï¼šä»é«˜åœ°å€å¾€ä½åœ°å€å¢é•¿ã€‚\n- æ ˆåº•ï¼šæ ˆçš„èµ·å§‹ä½ç½®ã€‚æ ¹æ®å®šä¹‰ï¼Œå¦‚æœæ˜¯å‘ä¸‹å¢é•¿çš„ï¼Œé‚£ä¹ˆæ ˆåº•ä¸ºé«˜åœ°å€ã€‚ä»¥æ­¤ç±»æ¨ã€‚\n- æ ˆé¡¶ï¼šç¨‹åºè¿è¡Œæ—¶spæŒ‡é’ˆæ‰€æŒ‡ç¤ºçš„ä½ç½®ï¼Œä¸æ–­å˜åŒ–ã€‚\nå¤„ç†å™¨æ ˆå¢é•¿æ–¹å¼ï¼Œå¯¹äºA7è€Œè¨€æ˜¯å‘ä¸‹å¢é•¿çš„ã€‚è®¾ç½®spæŒ‡å‘0x80200000ã€‚\n\n\n\n### è·³è½¬åˆ°Cè¯­è¨€\n\nä½¿ç”¨bæŒ‡ä»¤ï¼Œè·³è½¬åˆ°Cè¯­è¨€å‡½æ•°ï¼Œæ¯”å¦‚mainå‡½æ•°ã€‚\n\nå…¶å®æˆ‘ä»¬åœ¨stm32çš„å¯åŠ¨æ–‡ä»¶ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°è¿™äº›æ“ä½œï¼Œæä¸€å˜´â€¦â€¦\n\n## å®æ“\n\næˆ‘çš„æ–‡ä»¶ç»“æ„é•¿è¿™æ ·ï¼š\n```\nproject/\nâ”œâ”€â”€ Makefileã€lds\nâ”œâ”€â”€ src/\nâ”‚   â””â”€â”€ main.c\nâ”œâ”€â”€ inc/\nâ”‚   â””â”€â”€ main.h\nâ”œâ”€â”€ build/\nâ””â”€â”€ bin/\n```\n\nåŒæ—¶ä¸ºäº†å­¦ä¹ makefileï¼Œmakefileå°±å†™å¾—æ¯”è¾ƒå¤æ‚ï¼š\næ³¨æ„makefileæ–‡ä»¶å¯¹ç¼©è¿›ã€ç©ºæ ¼éå¸¸æ•æ„Ÿï¼\n```Makefile\n# è®¾ç½®ç›®å½•å˜é‡ï¼Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†å’Œä¿®æ”¹\n# æºä»£ç ç›®å½•:\nSRC_DIR := src\n# å¤´æ–‡ä»¶ç›®å½•:\nINC_DIR := inc\n# ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆ.oï¼‰è¾“å‡ºç›®å½•:\nBUILD_DIR := build\n# æœ€ç»ˆç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆ.binï¼‰ç›®å½•:\nBIN_DIR := bin\n\n# è®¾ç½®ç¼–è¯‘å·¥å…·ï¼ˆä½¿ç”¨ ARM çš„äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼‰\n# ç¼–è¯‘å™¨ï¼ˆç”¨äº .c å’Œ .S æ–‡ä»¶ï¼‰:\nCC = arm-none-eabi-gcc\n# é“¾æ¥å™¨:\nLD = arm-none-eabi-ld\n# ç”¨äºå°† elf è½¬ä¸º bin æ ¼å¼:\nOBJCOPY = arm-none-eabi-objcopy\n\n# ç¼–è¯‘é€‰é¡¹ï¼ˆGCC ç¼–è¯‘é˜¶æ®µï¼‰\n# -Iï¼šæŒ‡å®šå¤´æ–‡ä»¶æœç´¢ç›®å½•\n# -Wallï¼šæ‰“å¼€æ‰€æœ‰è­¦å‘Š\n# -nostdlibï¼šä¸é“¾æ¥æ ‡å‡†åº“ï¼ˆé€‚ç”¨äºè£¸æœºï¼‰\n# -cï¼šåªç¼–è¯‘ï¼Œä¸é“¾æ¥\nGCC_FLAGS = -I$(INC_DIR) -Wall -nostdlib -c\n\n# é“¾æ¥å™¨é€‰é¡¹\n# -Ttext=0x80000000ï¼šè®¾ç½®ä»£ç æ®µçš„èµ·å§‹åœ°å€ï¼ˆä½ è®¾å¤‡ä¸Šè¿è¡Œç¨‹åºçš„å…¥å£åœ°å€ï¼‰\n# -e _startï¼šæ˜¾å¼è®¾ç½®ç¨‹åºå…¥å£ç‚¹ï¼ˆé˜²æ­¢é“¾æ¥å™¨çŒœæµ‹ï¼‰\nLD_FLAGS = -Timx.lds\n\n# è‡ªåŠ¨æŸ¥æ‰¾ src/ ç›®å½•ä¸‹çš„æ‰€æœ‰ .c æ–‡ä»¶\nSRCS = $(wildcard $(SRC_DIR)/*.c)\n\n# å°† src/xxx.c è½¬æ¢ä¸º build/xxx.o\n# ä¾‹å¦‚ï¼šsrc/main.c â†’ build/main.o\n# åŒæ—¶æ·»åŠ  build/startup.oï¼ˆæ±‡ç¼–å¯åŠ¨æ–‡ä»¶ï¼‰\n# è¿™é‡Œæ³¨æ„æ˜¯æŒ‰é¡ºåºé“¾æ¥çš„ï¼Œæ‰€ä»¥startupä¸€å®šè¦åœ¨ç¬¬ä¸€ä¸ªå¦åˆ™é“¾æ¥åˆ°çš„åœ°å€ä¸å¯¹ï¼ˆæŸ¥çœ‹åæ±‡ç¼–å¯çŸ¥ï¼‰\nOBJS = $(BUILD_DIR)/startup.o\nOBJS += $(patsubst $(SRC_DIR)/%.c,$(BUILD_DIR)/%.o,$(SRCS))\n\n# ç›®æ ‡ï¼šç”Ÿæˆæœ€ç»ˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ bin/ledc.bin\n$(BIN_DIR)/ledc.bin: $(OBJS)\n# é“¾æ¥æ‰€æœ‰ .o æ–‡ä»¶ç”Ÿæˆ elf æ ¼å¼å¯æ‰§è¡Œæ–‡ä»¶\nÂ  Â  $(LD) $(LD_FLAGS) $(OBJS) -o $(BUILD_DIR)/ledc.elf\n# åæ±‡ç¼– è°ƒè¯•ç”¨\nÂ  Â  arm-none-eabi-objdump -D -m arm $(BUILD_DIR)/ledc.elf > $(BUILD_DIR)/ledc.dis\n# æŠŠ elf æ–‡ä»¶è½¬æ¢ä¸ºè£¸æœºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæ— ç¬¦å·ã€æ— å¤´ä¿¡æ¯ï¼‰\nÂ  Â  $(OBJCOPY) -O binary -S $(BUILD_DIR)/ledc.elf $@\n\n# ç¼–è¯‘æ±‡ç¼–å¯åŠ¨æ–‡ä»¶ startup.Sï¼Œç”Ÿæˆ build/startup.o\n$(BUILD_DIR)/startup.o: startup.S\n# æ³¨æ„ startup.S æ˜¯æ±‡ç¼–æ–‡ä»¶ï¼Œç”¨ gcc ç¼–è¯‘ä¹Ÿå¯ä»¥ï¼Œé»˜è®¤ä¼šè°ƒç”¨æ±‡ç¼–å™¨\nÂ  Â  $(CC) $(GCC_FLAGS) $< -o $@\n\n# ç¼–è¯‘æ¯ä¸ª .c æ–‡ä»¶åˆ° build/xxx.o\n# $@ï¼šç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ build/main.oï¼‰\n# $<ï¼šä¾èµ–çš„æºæ–‡ä»¶ï¼ˆä¾‹å¦‚ src/main.cï¼‰\n$(BUILD_DIR)/%.o: $(SRC_DIR)/%.c\nÂ  Â  $(CC) $(GCC_FLAGS) $< -o $@\n\n.PHONY: clean\nclean:\nÂ  Â  rm $(BUILD_DIR)/*.o $(BUILD_DIR)/*.elf $(BIN_DIR)/*.bin $(BUILD_DIR)/*.dis\n```\n\nmain.c\n```c\n#include \"main.h\"\n\nvoid clk_enable(void){\nÂ  Â  LED_CLK_REG = 0xffffffff;\n}\n\nvoid led_init(void){\nÂ  Â  LED_MUX_REG = 0x5; Â  Â  Â  Â  Â //å¤ç”¨ä¸ºGPIO1_IO4\nÂ  Â  LED_PAD_REG = 0x10b0; Â  Â  Â  //è®¾ç½®ç”µæ°”å±æ€§\nÂ  Â  LED_GPIO_DIR_REG = 0x10; Â  Â //io4è®¾ç½®ä¸ºè¾“å‡º\n}\n\nint main(void){\nÂ  Â  clk_enable();\nÂ  Â  led_init();\nÂ  Â  LED_GPIO_DATA_REG = 0x0; Â  Â  Â //è¾“å‡ºä¸ºä½ç”µå¹³\nÂ  Â  while(1);\nÂ  Â  return 0;\n}\n```\n\nmain.h\n```c\n#ifndef __MAIN_H_ Â \n#define __MAIN_H_\n\n#define LED_CLK_REG *((volatile unsigned int*)0x020c406c)\n#define LED_MUX_REG *((volatile unsigned int*)0x020e006c)\n#define LED_PAD_REG *((volatile unsigned int*)0x020e02f8)\n#define LED_GPIO_DIR_REG *((volatile unsigned int*)0x0209c004)\n#define LED_GPIO_DATA_REG *((volatile unsigned int*)0x0209c000)\n\n#endif\n```\n\nstartup.S\n```asm\n  \n.global _start\n\n_start:\n\nÂ  Â  @ /* 1.è®¾ç½®å¤„ç†å™¨æ¨¡å¼ä¸ºSVCæ¨¡å¼(å…¶å®CotexAå†…æ ¸ä¸Šç”µé»˜è®¤å³ä¸ºSVCæ¨¡å¼æ•…ä¸éœ€è¦å†™) */\nÂ  Â  @ mrs r0, cpsr Â  Â  Â  Â  Â  Â  Â  Â /* è¯»å–cpsråˆ°r0 */\nÂ  Â  @ bic r0, r0, #0x1f Â  Â  Â  Â  Â  /* bic bit-clearä½æ¸…é›¶ */ Â  Â  Â  Â  Â \nÂ  Â  @ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  /* ç­‰åŒäºR0 = R0 & (~Operand2) è¿™ä¸ªæ“ä½œæ•°2è‡ªå·±æ¨ç®—*/\nÂ  Â  @ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  /* ç°åœ¨è¿™ä¸ªæ“ä½œç›¸å½“äºå°†r0çš„å‰5ä½æ¸…é›¶äº† */\nÂ  Â  @ orr r0, r0, #0x13 Â  Â  Â  Â  Â  /* orr æŒ‰ä½æˆ– */\n\nÂ  Â  @ msr cpsr, r0 Â  Â  Â  Â  Â  Â  Â  Â /* å†™å…¥cpsr */\nÂ  Â  @ä¸‹é¢è¿™æ®µæ˜¯é‡ç½®CP15å¯„å­˜å™¨çš„ä¸€äº›ä½ï¼Œå¥½åƒåŠ äº†æ›´ä¿é™©ä¸€äº›ã€‚ç›®å‰è¿˜æ²¡å¼„æ˜ç™½ï¼Œä½†æ˜¯å®æµ‹ä¸éœ€è¦ä¹Ÿå¯ä»¥è¿è¡Œã€‚\nÂ  Â  @ mrc Â  Â  p15, 0, r0, c1, c0, 0 Â  Â  /*è¯»å–CP15ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨ Â  */\nÂ  Â  @ bic Â  Â  r0, Â r0, #0x1000 Â  Â  /* Â æ¸…é™¤ç¬¬12ä½ï¼ˆIä½ï¼‰ç¦ç”¨ I Cache Â */\nÂ  Â  @ bic Â  Â  r0, Â r0, #0x4 Â  Â  /* Â æ¸…é™¤ç¬¬ 2ä½ï¼ˆCä½ï¼‰ç¦ç”¨ D Cache Â */\nÂ  Â  @ bic Â  Â  r0, Â r0, #0x2 Â  Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬ 1ä½ï¼ˆAä½ï¼‰ç¦æ­¢ä¸¥æ ¼å¯¹é½ Â  */\nÂ  Â  @ bic Â  Â  r0, Â r0, #0x800 Â  Â  /* Â æ¸…é™¤ç¬¬11ä½ï¼ˆZä½ï¼‰åˆ†æ”¯é¢„æµ‹ Â  */\nÂ  Â  @ bic Â  Â  r0, Â r0, #0x1 Â  Â  Â  Â  Â  Â  /* Â æ¸…é™¤ç¬¬ 0ä½ï¼ˆMä½ï¼‰ç¦ç”¨ MMU Â  */\nÂ  Â  @ mcr Â  Â  p15, 0, r0, c1, c0, 0 Â  Â  /* Â å°†ä¿®æ”¹åçš„å€¼å†™å›CP15å¯„å­˜å™¨ Â  */\n\nÂ  Â  /* 2.è®¾ç½®spå¯„å­˜å™¨ */\nÂ  Â  ldr sp, =0x80100000 Â  Â  Â  Â  /* æ ˆå¤§å°1M */\nÂ  Â  \nÂ  Â  /* 3.è·³è½¬åˆ°mainå‡½æ•° */\nÂ  Â  b main\nloop:\nÂ  Â  b loop\n```\n\né“¾æ¥è„šæœ¬ï¼š\n```lds\n\nENTRY(_start)\nSECTIONS {\n    . = 0x80000000;\n    \n    . = ALIGN(4);\n    .text :\n    {\n        build/startup.o\n        *(.text)\n    }\n\n    . = ALIGN(4);\n    .rodata : \n    {\n        *(.rodata*)\n    }\n    \n    . = ALIGN(4);\n    .data : \n    {\n        *(.data)\n    }\n\n    . = ALIGN(4);\n    __bss_start = .;  \n    .bss :\n    {\n        *(.bss)\n        *(COMMON)\n    }\n    __bss_end = .;\n }\n\n```\n\n[^1]: **M**ove toÂ **R**egister fromÂ **S**pecial register.Â  åŠ è½½åˆ°é€šç”¨å¯„å­˜å™¨\n[^2]: **M**ove toÂ **S**pecialÂ register fromÂ **R**egister.Â  æ¢å¤åˆ°ç‰¹æ®Šå¯„å­˜å™¨","tags":["åµŒå…¥å¼","Linux"],"categories":["Linux","è®°å½•"]},{"title":"æµ…æIMXé•œåƒæ–‡ä»¶ç»“æ„","url":"/posts/undefined/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n:::info\nå­¦ä¹ ç¬”è®°è®°å½•ï¼Œéæ•™ç¨‹ã€‚\n:::\n\n## å½“ä½¿ç”¨å†…éƒ¨BootROMå¯åŠ¨æ—¶ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ\n\nå½“æˆ‘ä»¬é€šè¿‡è®¾ç½®BOOT_MODE[1:0]ä¸ºå†…éƒ¨å¯åŠ¨æ¨¡å¼æ—¶ï¼Œå³èŠ¯ç‰‡é€šè¿‡æ‰§è¡Œå†…éƒ¨çš„bootROMå›ºæœ‰çš„ä»£ç æ¥å¯åŠ¨ï¼Œåœ¨æ­¤æ¨¡å¼ä¸‹ï¼ŒèŠ¯ç‰‡ä¼šæ‰§è¡Œå†…éƒ¨çš„ boot ROM ä»£ç ï¼Œè¿™æ®µ boot ROM ä»£ç ä¼šè¿›è¡Œç¡¬ä»¶åˆå§‹åŒ–(ä¸€éƒ¨åˆ†å¤–è®¾)ï¼Œç„¶åä» boot è®¾å¤‡(å°±æ˜¯å­˜æ”¾ä»£ç çš„è®¾å¤‡ã€æ¯”å¦‚ SD/EMMCã€NAND)ä¸­å°†ä»£ç æ‹·è´å‡ºæ¥å¤åˆ¶åˆ°æŒ‡å®šçš„ RAM ä¸­ï¼Œä¸€èˆ¬æ˜¯ DDRã€‚\n\n- è®¾ç½®å†…æ ¸æ—¶é’Ÿä¸º396MHzã€‚ä½¿èƒ½MMUå’ŒCacheï¼Œä½¿èƒ½L1cacheã€L2 cacheã€MMUï¼Œç›®çš„å°±ä¸ºäº†åŠ é€Ÿå¯åŠ¨ã€‚\n- ä»BOOT_CFGè®¾ç½®çš„å¤–ç½®å­˜å‚¨ä¸­ï¼Œè¯»å–imageï¼Œç„¶ååšç›¸åº”çš„å¤„ç†ã€‚\n\n![](Snipaste_2025-07-14_19-59-23.png)![](Snipaste_2025-07-14_20-01-17.png)\nå…¶ä¸­å†…å­˜ç®¡ç†å•å…ƒï¼ˆMemory Management Unitï¼‰ç”¨äºå°†ç‰©ç†åœ°å€ç¿»è¯‘ä¸ºè™šæ‹Ÿå†…å­˜åœ°å€ï¼Œä»¥åŠé€šè¿‡è™šæ‹Ÿå†…å­˜è®¿é—®å®é™…ç‰©ç†å†…å­˜ã€‚è€Œåˆå§‹åŒ–é«˜é€Ÿç¼“å­˜åˆ™æ˜¯åŠ é€Ÿæ•°æ®è®¿é—®ã€‚\n\n## é•œåƒæ–‡ä»¶ç»“æ„\n\nåœ¨ä¸Šä¸€èŠ‚[ã€ç‚¹ç¯å¤§å¸ˆã€‘ç‚¹äº®I.MX6ULLå¼€å‘æ¿çš„LEDç¯](https://blog.godmao.top/posts/43400/)æåˆ°è¿‡ï¼Œé€šè¿‡æ±‡ç¼–ç”Ÿæˆçš„binæ–‡ä»¶å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œè¿˜éœ€è¦æ·»åŠ é¢å¤–çš„å¤´æ–‡ä»¶ä¿¡æ¯ã€‚æˆ‘ä»¬ä½¿ç”¨VSCODEï¼ˆéœ€è¦æ‰©å±•hex-editorï¼‰æ‰“å¼€ç”Ÿæˆçš„imgæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ä¸Šä¸€èŠ‚æˆ‘ä»¬ä½¿ç”¨`mkimage.sh`ç”Ÿæˆçš„ã€‚æˆ‘ä»¬å¯ä»¥å…ˆæŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªshæ–‡ä»¶æ–¹ä¾¿ç†è§£ï¼š\næˆ‘ä»¬åªæˆªå–é€šè¿‡sdå¡å¯åŠ¨çš„é…ç½®å‚æ•°ï¼š\n```shell\nelif [ \"$1\" == \"sd\" ]; then\nÂ  Â  ../bin/$IMG_BUILDER --combine base_addr=0x80000000 ivt_offset=0x400 app_offset=0x2000 dcd_file=dcd.bin app_file=sdk20-app.bin ofile=sdk20-app.img image_entry_point=0x80002000\n```\n\nå¯ä»¥çœ‹åˆ°ï¼Œè¯¥è„šæœ¬ä¸ºæˆ‘ä»¬é»˜è®¤è®¾ç½®çš„åŸºå€ä¸º0x80000000ï¼Œä¹Ÿå°±æ˜¯ç»å¯¹çš„èµ·å§‹åœ°å€ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œåç§»app_offsetå³ä¸ºåº”ç”¨ç¨‹åºçš„èµ·å§‹åœ°å€ã€‚å› æ­¤ç¨‹åºçš„èµ·å§‹åœ°å€ï¼ˆbinçš„èµ·å§‹åœ°å€ï¼‰ä¸º0x80002000ï¼Œivtè¡¨åˆ™æ˜¯åç§»äº†1024å­—èŠ‚ï¼Œ0x400ã€‚\n![](Snipaste_2025-07-14_21-25-46.png)\næ¥ä¸‹æ¥æˆ‘ä»¬çœ‹imgæ–‡ä»¶çš„å†…å®¹ï¼š\n![](Snipaste_2025-07-14_21-34-13.png)","tags":["Linux","boot"],"categories":["Linux","è®°å½•"]},{"title":"ã€ç‚¹ç¯å¤§å¸ˆã€‘ç‚¹äº®I.MX6ULLå¼€å‘æ¿çš„LEDç¯","url":"/posts/43400/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n:::info\nå­¦ä¹ ç¬”è®°è®°å½•ï¼Œéæ•™ç¨‹ã€‚\n:::\n\n- [1. æ±‡ç¼–LEDåŸç†åˆ†æ](#1-æ±‡ç¼–ledåŸç†åˆ†æ)\n- [2. åˆå§‹åŒ–æµç¨‹](#2-åˆå§‹åŒ–æµç¨‹)\n  - [2.1. STM32çš„å¤§è‡´IOåˆå§‹åŒ–æµç¨‹](#21-stm32çš„å¤§è‡´ioåˆå§‹åŒ–æµç¨‹)\n  - [2.2. I.MX6ULL IOåˆå§‹åŒ–](#22-imx6ull-ioåˆå§‹åŒ–)\n- [3. æ±‡ç¼–è¯­è¨€å®ç°](#3-æ±‡ç¼–è¯­è¨€å®ç°)\n- [4. é“¾æ¥ä¸æ ¼å¼è½¬æ¢](#4-é“¾æ¥ä¸æ ¼å¼è½¬æ¢)\n  - [4.1. é“¾æ¥](#41-é“¾æ¥)\n  - [4.2. æ ¼å¼è½¬æ¢](#42-æ ¼å¼è½¬æ¢)\n- [5. ä½¿ç”¨å®˜æ–¹SDKåŒ…ç”Ÿæˆé•œåƒæ–‡ä»¶](#5-ä½¿ç”¨å®˜æ–¹sdkåŒ…ç”Ÿæˆé•œåƒæ–‡ä»¶)\n- [6. å®‰è£…SDKåŒ…](#6-å®‰è£…sdkåŒ…)\n  - [6.1. ï¼ˆå¯é€‰ï¼‰æ£€æŸ¥å¯ç”¨æ€§](#61-ï¼ˆå¯é€‰ï¼‰æ£€æŸ¥å¯ç”¨æ€§)\n  - [6.2. ç”Ÿæˆé•œåƒæ–‡ä»¶](#62-ç”Ÿæˆé•œåƒæ–‡ä»¶)\n- [7. çƒ§å½•åˆ°SDå¡](#7-çƒ§å½•åˆ°sdå¡)\n- [8. è¾¾æˆæˆå°±ã€ç‚¹ç¯å¤§å¸ˆã€‘](#8-è¾¾æˆæˆå°±ç‚¹ç¯å¤§å¸ˆ)\n- [9. å‚è€ƒèµ„æ–™](#9-å‚è€ƒèµ„æ–™)\n\n\n## 1. æ±‡ç¼–LEDåŸç†åˆ†æ\n\nä¸ºä»€ä¹ˆä¸åƒSTM32é‚£æ ·ç›´æ¥ä½¿ç”¨cè¯­è¨€ï¼Ÿ\n\nç­”ï¼šå› ä¸ºSTå·²ç»ä¸ºä½ ç”¨æ±‡ç¼–å†™å¥½äº†åˆå§‹åŒ–è¿‡ç¨‹ï¼Œæ¯”å¦‚åˆå§‹åŒ–æ—¶é’Ÿç­‰ç­‰å¤–è®¾ï¼Œåˆå§‹åŒ–Ramï¼Œè®¾ç½®spæŒ‡é’ˆï¼Œé…ç½®å¥½cè¯­è¨€è¿è¡Œç¯å¢ƒç­‰ç­‰ã€‚è€Œä¸€èˆ¬è¿™äº›ä¸€å—CortexAæ¶æ„çš„æ¿å­æ˜¯ä¸æä¾›çš„ã€‚\n\næ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨æ±‡ç¼–ï¼š\n\n1. åˆå§‹åŒ–ä¸€äº›SOCå¤–è®¾ã€‚\n2. åˆå§‹åŒ–DDR[^1]ã€‚\n>è¿™ä¸ªI.MX6Uå€’æ˜¯ä¸éœ€è¦ã€‚I.MXå†…éƒ¨çš„ROMå­˜æ”¾äº†è‡ªå·±ç¼–å†™çš„å¯åŠ¨ä»£ç ï¼Œè¿™äº›å¯åŠ¨ä»£ç å¯ä»¥è¯»å–DDRé…ç½®ä¿¡æ¯ï¼Œå¹¶å®Œæˆå…¶çš„åˆå§‹åŒ–ã€‚\n3. è®¾ç½®spæŒ‡é’ˆï¼Œä¸€èˆ¬æŒ‡å‘DDRï¼Œè®¾ç½®å¥½Cè¯­è¨€è¿è¡Œç¯å¢ƒã€‚\n\n\n## 2. åˆå§‹åŒ–æµç¨‹\n\n> å…·ä½“åŸç†ã€å¯„å­˜å™¨è¯¦ç»†ä½è®²è§£å¯ä»¥çœ‹æ­£ç‚¹åŸå­çš„Linuxé©±åŠ¨å¼€å‘æŒ‡å—ã€‚\n\nè¿™é‡Œæˆ‘ä»¬å¯¹æ¯”STM32çš„IOåˆå§‹åŒ–æµç¨‹æ¥å­¦ä¹ I.MXçš„åˆå§‹åŒ–æµç¨‹\n\n### 2.1. STM32çš„å¤§è‡´IOåˆå§‹åŒ–æµç¨‹\n1. ä½¿èƒ½æ—¶é’Ÿ\n2. è®¾ç½®IOå¤ç”¨ï¼Œå¤ç”¨ä¸ºGPIO\n3. é…ç½®GPIOçš„ç”µæ°”å±æ€§\n4. ä½¿ç”¨GPIOâ€”â€”åˆ©ç”¨æ§åˆ¶å¯„å­˜å™¨è®¾ç½®GPIOçš„è¾“å…¥è¾“å‡ºåŠŸèƒ½\n\n### 2.2. I.MX6ULL IOåˆå§‹åŒ–\n\nåŒæ ·çš„ï¼ŒIOçš„ä½¿ç”¨åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼ŒCONFIGå’ŒCONTROL\n\nCONFIGéƒ¨åˆ†ï¼ŒI.MXçš„æ¯ä¸ªIOéƒ½æœ‰ä¸¤ä¸ªå¯„å­˜å™¨æ¥é…ç½®ï¼Œåˆ†åˆ«æ˜¯å¤šè·¯å¤ç”¨å¯„å­˜å™¨ï¼ˆIOMUXC_SW_MUX_CTL_PAD_XX_XXï¼‰å’Œé…ç½®ç”µæ°”ç‰¹æ€§çš„å¯„å­˜å™¨ï¼ˆIOMUXC_SW_PAD_CTL_PAD_XX_XXï¼‰å®ƒä»¬åœ¨å‘½åçš„ç¬¬ä¸‰ä¸ªå­—æ®µåŠ ä»¥åŒºåˆ†ã€‚æˆ‘ä»¬å¯ä»¥æŸ¥é˜…æ­£ç‚¹åŸå­çš„Linuxé©±åŠ¨å¼€å‘æŒ‡å—ä»¥åŠå®˜æ–¹çš„å‚è€ƒæ‰‹å†ŒæŸ¥çœ‹æ¯ä¸€ä½çš„æ„ä¹‰ã€‚\n\nCONTROLéƒ¨åˆ†ï¼Œä¹Ÿæœ‰å„ç§å¯„å­˜å™¨ï¼Œæ¥æ§åˆ¶IOçš„å„ä¸ªåŠŸèƒ½ï¼Œæ¯”å¦‚*GPIOx_DR*å¯„å­˜å™¨å°±æ˜¯æ§åˆ¶è¾“å…¥è¾“å‡ºçš„é«˜ä½ç”µå¹³ï¼Œå…±æœ‰32ä½ï¼Œæ¯ä¸€ä½æ§åˆ¶ç¬¬xç»„IOå„ä¸ªå¼•è„šçš„é«˜ä½ç”µå¹³ã€‚\n\nä½¿èƒ½æ—¶é’Ÿï¼ŒCCGR0~CCGR6è¿™7ä¸ªå¯„å­˜å™¨æ§åˆ¶ç€6ULLæ‰€æœ‰å¤–è®¾æ—¶é’Ÿçš„ä½¿èƒ½ã€‚ï¼ˆå‚è€ƒã€ŠI.MX6UL å‚è€ƒæ‰‹å†Œã€‹çš„ç¬¬ 18 ç« â€œChapter 18: ClockController Module(CCM)â€ï¼‰\n\næ€»ç»“ä¸€ä¸‹ï¼ŒI.MX6ULLçš„åˆå§‹åŒ–ä¸€ä¸ªIOæµç¨‹å¦‚ä¸‹ï¼š\n\n1. ä½¿èƒ½æ—¶é’Ÿï¼ŒCCGR0~CCGR6è¿™7ä¸ªå¯„å­˜å™¨æ§åˆ¶ç€6ULLæ‰€æœ‰å¤–è®¾æ—¶é’Ÿçš„ä½¿èƒ½ã€‚ä¸ºäº†ç®€å•ï¼Œè®¾ç½®CCGR0~CCGR6è¿™7ä¸ªå¯„å­˜å™¨å…¨éƒ¨ä¸º0XFFFFFFFFï¼Œç›¸å½“äºä½¿èƒ½æ‰€æœ‰å¤–è®¾æ—¶é’Ÿã€‚\n2. IOå¤ç”¨ï¼Œå°†å¯„å­˜å™¨IOMUXC_SW_MUX_CTL_PAD_GPIO1_IO03çš„bit3~0è®¾ç½®ä¸º0101=5ï¼Œè¿™æ ·GPIO1_IO03å°±å¤ç”¨ä¸ºGPIOã€‚\n3. å¯„å­˜å™¨IOMUXC_SW_PAD_CTL_PAD_GPIO1_IO03æ˜¯è®¾ç½®GPIO1_IO03çš„ç”µæ°”å±æ€§ã€‚åŒ…æ‹¬å‹æ‘†ç‡ã€é€Ÿåº¦ã€é©±åŠ¨èƒ½åŠ›ã€å¼€æ¼ã€ä¸Šä¸‹æ‹‰ç­‰ã€‚\n4. é…ç½®GPIOåŠŸèƒ½ï¼Œè®¾ç½®è¾“å…¥è¾“å‡ºã€‚è®¾ç½®GPIO1_GDIRå¯„å­˜å™¨bit3ä¸º1ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®ä¸ºè¾“å‡ºæ¨¡å¼ã€‚è®¾ç½®GPIO1_DRå¯„å­˜å™¨çš„bit3ï¼Œä¸º1è¡¨ç¤ºè¾“å‡ºé«˜ç”µå¹³ï¼Œä¸º0è¡¨ç¤ºè¾“å‡ºä½ç”µå¹³ã€‚\n\n## 3. æ±‡ç¼–è¯­è¨€å®ç°\n\nåœ¨äº†è§£ä¸Šè¿°å†…å®¹åæˆ‘ä»¬å¯ä»¥æ­£å¼å¼€å§‹å†™ä»£ç äº†ï¼Œåœ¨Linuxç¯å¢ƒä¸‹æ–°å»º`led.s`æ±‡ç¼–æ–‡ä»¶ã€‚\nå†…å®¹å¯ä»¥å‚è€ƒå¦‚ä¸‹\n```asm\n/* ç‚¹äº®ledæ±‡ç¼–ä»£ç  */\n\n.global _start @å…¨å±€æ ‡å·\n\n_start:\n\n@1.ä½¿èƒ½æ—¶é’Ÿ\nÂ  Â  @æŸ¥æ‰¾åŸç†å›¾å’Œå‚è€ƒæ‰‹å†Œå¯çŸ¥ï¼ŒLED1è¿æ¥GPIO1-io4ï¼ŒGPIO1çš„æ—¶é’Ÿå±äºCCM_CCGR1 CG13ï¼ˆ26-27ä½ï¼‰\n\nldr r0, =0x020c406c @å°†å¯„å­˜å™¨åœ°å€åŠ è½½åˆ°r0\nldr r1, =0xFFFFFFF  @ä¸ºäº†æ–¹ä¾¿æ‰“å¼€å…¨éƒ¨æ—¶é’Ÿï¼Œç›¸åº”çš„åŠŸè€—ä¹Ÿæœ‰æ‰€å¢åŠ \nstr r1, [r0] @å°†r1ä¸­çš„å€¼å­˜å…¥ä»¥r0ä¸­çš„å€¼ä¸ºåœ°å€çš„å¯„å­˜å™¨ä¸­\n  \n2.è®¾ç½®ioå¼•è„šå¤ç”¨ä¸ºgpio\n  \nldr r0, =0x020e006c @å°†å¯„å­˜å™¨åœ°å€åŠ è½½åˆ°r0\nmov r1, #5 @å°†å¯„å­˜å™¨è¦è®¾ç½®çš„å€¼åŠ è½½åˆ°r1\nstr r1, [r0]\n\n\n@3.è®¾ç½®ioç”µæ°”å±æ€§\n\nÂ  Â  /*\n\nÂ  Â  Â * bit0 Â  Â  SREå‹æ‘†ç‡ Â  Â  Â  0 Â  Â  Â  disable\n\nÂ  Â  Â * bit5:3 Â  DSE ioé©±åŠ¨èƒ½åŠ› Â 110 Â  Â  R0/6\n\nÂ  Â  Â * bit7:6 Â  speed Â  Â  Â  Â  Â 10 Â  Â  Â 100MHz\n\nÂ  Â  Â * bit11 Â  Â ODE å¼€è·¯è¾“å‡º Â  Â  0 Â  Â  Â disable\n\nÂ  Â  Â * bit12 Â  Â PKE ä½¿èƒ½pull/keeper 1 Â  enable\n\nÂ  Â  Â * bit13 Â  Â PUE pull or keeper 0 Â  keeper\n\nÂ  Â  Â * bit15:14 ä¸Šä¸‹æ‹‰ç”µé˜» Â  Â  Â  00 Â  Â  Â 100Kä¸‹æ‹‰\n\nÂ  Â  Â * bit16 Â  Â HYS Â  Â  Â  Â  Â  Â  0 Â  Â  Â  disable\n\nÂ  Â  Â */\n\nldr r0, =0x020e02f8\nldr r1, =0x10b0 @å°†å¯„å­˜å™¨è¦è®¾ç½®çš„å€¼åŠ è½½åˆ°r1\nstr r1, [r0]\n \n@4.è®¾ç½®GPIOåŠŸèƒ½\nÂ  Â  @è®¾ç½®ä¸ºè¾“å‡º GDIRå¯„å­˜å™¨\n\nldr r0, =0x0209c004\nmov r1, #16\nstr r1, [r0] @å°†GPIO1ç»„çš„ç¬¬4ä¸ªioå£è®¾ç½®ä¸ºè¾“å‡ºæ¨¡å¼\n\nÂ  Â  @è®¾ç½®ä¸ºè¾“å‡ºä½ç”µå¹³ DRå¯„å­˜å™¨\n\nldr r0, =0x0209c000\nmov r1, #0\nstr r1, [r0] @å°†GPIO1ç»„çš„ç¬¬4ä¸ªioå£è®¾ç½®ä¸ºè¾“å‡ºä½ç”µå¹³  \n\n@5.é˜²æ­¢CPUè¿›å…¥æœªçŸ¥çŠ¶æ€\n\nÂ  Â  @å†™å…¥æ­»å¾ªç¯\nloop:\nÂ  Â  b loop\nÂ  Â  \n/* Finally! END! */\n```\n\n\n## 4. é“¾æ¥ä¸æ ¼å¼è½¬æ¢\n\n> é»˜è®¤å·²å®‰è£…äº†`arm-linux-gnueabihf`ç¼–è¯‘å¥—ä»¶\n\n### 4.1. é“¾æ¥\nä½¿ç”¨å‘½ä»¤\n```zsh\narm-linux-gnueabihf-ld -Ttext 0X80000000 led.o -o led.elf\n```\nä¸Šè¿°å‘½ä»¤ä¸­-Ttext å°±æ˜¯æŒ‡å®šé“¾æ¥èµ·å§‹åœ°å€ï¼Œâ€œ-oâ€ï¼Œæˆ‘ç†è§£ä¸ºoutputï¼ŒæŒ‡å®šé“¾æ¥ç”Ÿæˆçš„ elf æ–‡ä»¶åï¼Œè¿™é‡Œæˆ‘ä»¬å‘½åä¸º led.elfã€‚ä¸Šè¿°å‘½ä»¤æ‰§è¡Œå®Œä»¥åå°±ä¼šåœ¨å·¥ç¨‹ç›®å½•ä¸‹å¤šä¸€ä¸ª led.elf æ–‡ä»¶ã€‚\nè¿™ä¸ªelfç›¸å½“äºwinä¸­çš„exeï¼Œæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚\n\n### 4.2. æ ¼å¼è½¬æ¢\nä½¿ç”¨å‘½ä»¤\n```zsh\narm-linux-gnueabihf-objcopy -O binary -S -g led.elf led.bin\n```\nä¸Šè¿°å‘½ä»¤ä¸­ï¼Œâ€œ-Oâ€é€‰é¡¹æŒ‡å®šä»¥ä»€ä¹ˆæ ¼å¼è¾“å‡ºï¼Œåé¢çš„â€œbinaryâ€è¡¨ç¤ºä»¥äºŒè¿›åˆ¶æ ¼å¼è¾“å‡ºï¼Œ\né€‰é¡¹â€œ-Sâ€è¡¨ç¤ºä¸è¦å¤åˆ¶æºæ–‡ä»¶ä¸­çš„é‡å®šä½ä¿¡æ¯å’Œç¬¦å·ä¿¡æ¯ï¼Œâ€œ-gâ€è¡¨ç¤ºä¸å¤åˆ¶æºæ–‡ä»¶ä¸­çš„è°ƒè¯•\nä¿¡æ¯ã€‚\nè‡³æ­¤æˆ‘ä»¬ç»ˆäºç­‰åˆ°äº†æƒ³è¦çš„ä¸œè¥¿â€”led.bin æ–‡ä»¶ã€‚\nä½†æ˜¯ I.MX6U ä¸èƒ½ç›´æ¥çƒ§å†™ç¼–è¯‘ç”Ÿæˆçš„.bin æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨.bin æ–‡ä»¶å‰é¢æ·»åŠ ä¸€äº›å¤´ä¿¡æ¯æ„æˆæ»¡è¶³ I.MX6U éœ€æ±‚çš„æœ€ç»ˆå¯çƒ§å†™æ–‡ä»¶ï¼ŒI.MX6U çš„æœ€ç»ˆå¯çƒ§å†™æ–‡ä»¶ç»„æˆå¦‚ä¸‹ï¼š\n1. Image vector tableï¼Œç®€ç§° IVTï¼ŒIVT é‡Œé¢åŒ…å«äº†ä¸€ç³»åˆ—çš„åœ°å€ä¿¡æ¯ï¼Œè¿™äº›åœ°å€ä¿¡æ¯åœ¨\nROM ä¸­æŒ‰ç…§å›ºå®šçš„åœ°å€å­˜æ”¾ç€ã€‚\n2. Boot dataï¼Œå¯åŠ¨æ•°æ®ï¼ŒåŒ…å«äº†é•œåƒè¦æ‹·è´åˆ°å“ªä¸ªåœ°å€ï¼Œæ‹·è´çš„å¤§å°æ˜¯å¤šå°‘ç­‰ç­‰ã€‚\n3. Device configuration dataï¼Œç®€ç§° DCDï¼Œè®¾å¤‡é…ç½®ä¿¡æ¯ï¼Œé‡ç‚¹æ˜¯ DDR3 çš„åˆå§‹åŒ–é…ç½®ã€‚\n4. ç”¨æˆ·ä»£ç å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¯”å¦‚ led.binã€‚\n## 5. ä½¿ç”¨å®˜æ–¹SDKåŒ…ç”Ÿæˆé•œåƒæ–‡ä»¶\n\n!!ä½ ä¸ä¼šä»¥ä¸ºæˆ‘è¦ç”¨æ­£ç‚¹åŸå­æˆ–è€…é‡ç«æä¾›çš„é•œåƒåˆ¶ä½œè½¯ä»¶å§å­©å­!!\n\næ­¤æ­¥æ‰€éœ€è½¯ä»¶ï¼š\n:::success\n- NXP SDK_2.2_MCIM6ULL\n:::\n\nç¬¬äºŒä¸ªå¯ä»NXPå®˜ç½‘è·å–ã€‚\n## 6. å®‰è£…SDKåŒ…\nä½¿ç”¨å…±äº«æ–‡ä»¶å¤¹å°†â€œSDK_2.2_MCIM6ULL_RFP_Linux.runâ€ æ‹·è´åˆ°Linuxä¸‹ï¼Œå­˜æ”¾ä½ç½®è‡ªå®šã€‚ç”¨chmodæ·»åŠ æƒé™ã€‚ç„¶åè¿è¡Œ.runæ–‡ä»¶ç”ŸæˆSDKï¼Œlinuxä¸‹çš„æºæ–‡ä»¶å‘½ä»¤å¦‚ä¸‹ï¼š\n```zsh\n./SDK_2.2_MCIM6ULL_RFP_Linux.run\n```\n\n### 6.1. ï¼ˆå¯é€‰ï¼‰æ£€æŸ¥å¯ç”¨æ€§\næ­¤æ­¥æ‰€éœ€è½¯ä»¶ï¼š\n:::success\n- gcc-arm-none-eabiäº¤å‰ç¼–è¯‘å¥—ä»¶\n- cmake\n:::\n\nåœ¨Linuxç¯å¢ƒä¸‹ï¼Œ\næ·»åŠ ä¸´æ—¶ç¯å¢ƒå˜é‡ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n```zsh\nexport ARMGCC_DIR=/usr\n```\n\nè¿›å…¥å·¥ç¨‹æ–‡ä»¶**SDK_2.2_MCIM6ULL/boards/evkmcimx6ull/demo_apps/hello_world/armgcc**Â ï¼Œè¿™æ˜¯å®˜æ–¹çš„demoï¼Œè¿è¡Œbuild_ddr_release.shè„šæœ¬\n```zsh\n./build_ddr_release.sh\n```\n\nè¿›å…¥åŒæ–‡ä»¶å¤¹çš„ `ddr_release` æ–‡ä»¶å¤¹ï¼Œä¼šå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªsdk20-app.imgï¼Œè¿™å®é™…ä¸Šæ˜¯æ·»åŠ äº†å¤´æ–‡ä»¶çš„å¯ç”¨imgæ–‡ä»¶ã€‚\n\nè·³è½¬åˆ°ç¬¬7èŠ‚çƒ§å½•åˆ°sdå¡å¹¶å¯åŠ¨ã€‚è¿æ¥åˆ°ä¸²å£åä¼šæ¿å­ä¼šå‘é€\"hello world\"ã€‚\n\n#### 2025-10-26è¡¥å……\n\n>é¦–å…ˆæ„Ÿè°¢æˆ‘å½“æ—¶å†™äº†è¿™ç¯‡æ–‡ç« ï¼Œï¼Œï¼Œï¼Œï¼ŒæŸ¥é˜…èµ·æ¥çœŸæ˜¯å¤ªæ–¹ä¾¿äº†\nå½“æˆ‘æŒ‡å®šç¼–è¯‘å™¨å¹¶è¿è¡Œè„šæœ¬æ—¶æç¤ºç¼ºå°‘newlibåº“ï¼Œè¿™é‡Œæ¨èä½¿ç”¨ARMå®˜æ–¹çš„ç¼–è¯‘å·¥å…·é“¾ï¼Œä»¥é¿å…ç¼ºå°‘åº“çš„é—®é¢˜ã€‚\né™„é“¾æ¥ï¼š[Arm GNU Toolchain Downloads â€“ Arm Developer](https://developer.arm.com/downloads/-/arm-gnu-toolchain-downloads)\n\n###  6.2. ç”Ÿæˆé•œåƒæ–‡ä»¶\nè¿›å…¥å·¥ç¨‹æ–‡ä»¶**SDK_2.2_MCIM6ULL/tools/imgutil/evkmcimx6ull**\næŸ¥çœ‹readme.txt æŸ¥çœ‹ä½¿ç”¨æ•™ç¨‹\nreadme.txtå†…å®¹å¦‚ä¸‹ï¼š\n```txt\n   IMGUTIL User Guide\n  \n   ======================================\n   \n   1. Build SDK2.0 application\n   2. Copy built binary (.bin file) to imgutil/<board> folder and rename to sdk20-app.bin\n   3. In imgutil/<board> folder, run mkimage.sh in mingw32 shell to get bootable image file sdk20-app.img\n       a. If the image is built with ram link file, use \"mkimage.sh ram\" to make the bootable image.\n       b. If the image is built with flash link file, use \"mkimage.sh flash\" to make the bootable XIP image.\n       c. If the image is built with ram link file and want to boot from MicroSD card, use \"mkimage.sh sd\" to make the bootable image.\n\n   ======================================\n```\n\nå¤§è‡´æ„æ€ï¼š\n1. build SDKï¼ˆå‰é¢å·²ç»åšäº†ï¼‰\n2. å¤åˆ¶ä½ è¦åˆ¶ä½œä¸ºé•œåƒçš„binæ–‡ä»¶åˆ°å¯¹åº”çš„è®¾å¤‡æ–‡ä»¶å¤¹å¹¶å°†å¤åˆ¶çš„binæ–‡ä»¶æ”¹åä¸º`sdk20-app.bin`\n> æˆ‘ä»¬çš„æ¿å­æ˜¯imx6ullï¼Œæ•…å¤åˆ¶åˆ°å½“å‰æ–‡ä»¶å¤¹\n3. ä½¿ç”¨ mkimage.sh+å‚æ•° æ¥åˆ¶ä½œé•œåƒ å‚æ•°æŒ‡å®šå¯åŠ¨æ–¹å¼ï¼Œæœ‰ï¼š\n\t-  ram\n\t- flash\n\t- sd\nå‚æ•°æˆ‘ä»¬ä½¿ç”¨sdã€‚\n\n```zsh\n./mkimage sd\n```\n\nè¿è¡Œåï¼Œç”Ÿæˆäº†`sdk20-app.img`æ–‡ä»¶\n\n## 7. çƒ§å½•åˆ°SDå¡\n\nç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯WSLç¯å¢ƒï¼ŒWSLè®¿é—®USBæ¯”è¾ƒä¸æ–¹ä¾¿æ‰€ä»¥æ”¹åœ¨winä¸‹çƒ§å½•ã€‚\n\næ­¤æ­¥æ‰€éœ€è½¯ä»¶ï¼š\n:::success\n- Win32DiskImager\n:::\n\næ­¤æ­¥éå¸¸ç®€å•ï¼Œå°†ç”Ÿæˆçš„imgæ–‡ä»¶ä¼ åˆ°winæ–‡ä»¶å¤¹ä¸‹ï¼Œä½¿ç”¨Win32DiskImagerè½¯ä»¶çƒ§å½•åˆ°è¿æ¥åˆ°winçš„SDå¡ã€‚\n\n\n## 8. è¾¾æˆæˆå°±ã€ç‚¹ç¯å¤§å¸ˆã€‘\n\nå°†SDå¡æ’å…¥imx6ullï¼Œè®¾ç½®å¯åŠ¨æ–¹å¼ä¸ºSDå¡ï¼Œå…·ä½“è®¾ç½®éœ€å‚è€ƒä½ æ¿å­çš„ç¡¬ä»¶åŸç†å›¾ï¼Œæ¯”å¦‚æˆ‘çš„ï¼š\n![](Snipaste_2025-06-30_00-49-08.png)\næˆåŠŸç‚¹äº®ï¼\n![](WIN_20250630_00_50_53_Pro.jpg)\n\n\n## 9. å‚è€ƒèµ„æ–™\n\n- ã€Šã€æ­£ç‚¹åŸå­ã€‘I.MX6UåµŒå…¥å¼Linuxé©±åŠ¨å¼€å‘æŒ‡å—V1.81ã€‹\n- [[é‡ç«]åµŒå…¥å¼Linuxé©±åŠ¨å¼€å‘å®æˆ˜æŒ‡å—â€”â€”åŸºäºi.MX6ULLç³»åˆ— â€” [é‡ç«]åµŒå…¥å¼Linuxé©±åŠ¨å¼€å‘å®æˆ˜æŒ‡å—â€”â€”åŸºäºi.MX6ULLç³»åˆ— æ–‡æ¡£](https://doc.embedfire.com/linux/imx6/driver/zh/latest/index.html)\n- ã€ŠIMX6ULLå‚è€ƒæ‰‹å†Œã€‹\n\n[^1]: Double Data Rate SDRAM åŒå€æ•°æ®é€Ÿç‡åŒæ­¥åŠ¨æ€éšæœºå­˜å‚¨å™¨","tags":["åµŒå…¥å¼","Linux"],"categories":["Linux","è®°å½•"]},{"title":"Shellè„šæœ¬æµç¨‹æ§åˆ¶ç®€æ˜æŒ‡å—","url":"/posts/21870/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n- [1. æ¡ä»¶åˆ¤æ–­è¯­å¥ if/else](#1-æ¡ä»¶åˆ¤æ–­è¯­å¥-ifelse)\n  - [1.1. åŸºæœ¬è¯­æ³•ï¼š](#11-åŸºæœ¬è¯­æ³•)\n  - [1.2. ç¤ºä¾‹ï¼š](#12-ç¤ºä¾‹)\n- [2. åˆ¤æ–­ç¬¦å·è¯´æ˜](#2-åˆ¤æ–­ç¬¦å·è¯´æ˜)\n- [3. case åˆ†æ”¯ç»“æ„](#3-case-åˆ†æ”¯ç»“æ„)\n  - [3.1. è¯­æ³•ï¼š](#31-è¯­æ³•)\n  - [3.2. ç¤ºä¾‹ï¼š](#32-ç¤ºä¾‹)\n- [4. for å¾ªç¯](#4-for-å¾ªç¯)\n  - [4.1. éå†åˆ—è¡¨ï¼š](#41-éå†åˆ—è¡¨)\n  - [4.2. ä½¿ç”¨ C é£æ ¼è¯­æ³•ï¼š](#42-ä½¿ç”¨-c-é£æ ¼è¯­æ³•)\n- [5. while å¾ªç¯](#5-while-å¾ªç¯)\n  - [5.1. åŸºæœ¬è¯­æ³•ï¼š](#51-åŸºæœ¬è¯­æ³•)\n  - [5.2. ç¤ºä¾‹ï¼š](#52-ç¤ºä¾‹)\n- [6. until å¾ªç¯](#6-until-å¾ªç¯)\n- [7. è·³å‡ºå¾ªç¯ï¼šbreak å’Œ continue](#7-è·³å‡ºå¾ªç¯break-å’Œ-continue)\n\n\nShell è„šæœ¬ä¸ä»…å¯ä»¥æ‰¹é‡å¤„ç†å‘½ä»¤ä»»åŠ¡ï¼Œè¿˜æ‹¥æœ‰å®Œæ•´çš„æµç¨‹æ§åˆ¶è¯­æ³•ç»“æ„ï¼ŒåŒ…æ‹¬æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ä¸åˆ†æ”¯ç­‰é€»è¾‘æ§åˆ¶ç»“æ„ã€‚æœ¬æ–‡å°†ç®€æ˜ä»‹ç» Shell çš„åŸºæœ¬æµç¨‹æ§åˆ¶è¯­æ³•ï¼Œé€‚ç”¨äº bash ç¯å¢ƒã€‚\n\n## 1. æ¡ä»¶åˆ¤æ–­è¯­å¥ if/else\n\n### 1.1. åŸºæœ¬è¯­æ³•ï¼š\n\n```shell\nif [ æ¡ä»¶ ]; then\n    å‘½ä»¤1\nelif [ æ¡ä»¶ ]; then\n    å‘½ä»¤2\nelse\n    å‘½ä»¤3\nfi\n```\nå†™æˆä¸€è¡Œï¼š\n```shell\nif [ ]; then ; fi\n```\n\n### 1.2. ç¤ºä¾‹ï¼š\n\n```shell\nread -p \"è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—: \" num\nif [ \"$num\" -gt 0 ]; then\n    echo \"æ­£æ•°\"\nelif [ \"$num\" -lt 0 ]; then\n    echo \"è´Ÿæ•°\"\nelse\n    echo \"é›¶\"\nfi\n```\n\n---\n\n## 2. åˆ¤æ–­ç¬¦å·è¯´æ˜\n\n|æ¡ä»¶è¡¨è¾¾å¼|å«ä¹‰|\n|---|---|\n|`-eq`|ç­‰äºï¼ˆæ•´æ•°ï¼‰|\n|`-ne`|ä¸ç­‰äº|\n|`-gt`|å¤§äº|\n|`-lt`|å°äº|\n|`-ge`|å¤§äºç­‰äº|\n|`-le`|å°äºç­‰äº|\n|`-z str`|å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º|\n|`-n str`|å­—ç¬¦ä¸²æ˜¯å¦éç©º|\n|`str1 = str2`|å­—ç¬¦ä¸²ç›¸ç­‰|\n|`-f file`|æ˜¯å¦ä¸ºæ™®é€šæ–‡ä»¶|\n|`-d dir`|æ˜¯å¦ä¸ºç›®å½•|\n\n> æ³¨æ„ï¼š`[` å’Œ `]` è¦æœ‰ç©ºæ ¼ï¼›å˜é‡æœ€å¥½åŠ å¼•å·é˜²æ­¢ç©ºå€¼ã€‚\n\n## 3. case åˆ†æ”¯ç»“æ„\n\nç”¨äºå¤šä¸ªæ¡ä»¶çš„åŒ¹é…å¤„ç†ã€‚\n\n### 3.1. è¯­æ³•ï¼š\n\n```shell\ncase $å˜é‡ in\n    æ¨¡å¼1)\n        å‘½ä»¤ ;;\n    æ¨¡å¼2)\n        å‘½ä»¤ ;;\n    *)\n        é»˜è®¤å‘½ä»¤ ;;\nesac\n```\n\n### 3.2. ç¤ºä¾‹ï¼š\n\n```shell\nread -p \"è¯·è¾“å…¥é€‰é¡¹[a/b/c]: \" choice\ncase $choice in\n    a) echo \"ä½ é€‰æ‹©äº†A\" ;;\n    b) echo \"ä½ é€‰æ‹©äº†B\" ;;\n    c) echo \"ä½ é€‰æ‹©äº†C\" ;;\n    *) echo \"æ— æ•ˆé€‰é¡¹\" ;;\nesac\n```\n\n## 4. for å¾ªç¯\n\n### 4.1. éå†åˆ—è¡¨ï¼š\n\n```shell\nfor var in å€¼1 å€¼2 å€¼3; do\n    å‘½ä»¤\ndone\n```\n\n```shell\nfor name in Alice Bob Charlie; do\n    echo \"Hello, $name\"\ndone\n```\n### 4.2. ä½¿ç”¨ C é£æ ¼è¯­æ³•ï¼š\n\n```bash\nfor ((i=1; i<=5; i++)); do\n    echo \"ç¬¬ $i æ¬¡\"\ndone\n```\n\n## 5. while å¾ªç¯\n\n### 5.1. åŸºæœ¬è¯­æ³•ï¼š\n\n```shell\nwhile [ æ¡ä»¶ ]; do\n    å‘½ä»¤\ndone\n```\n### 5.2. ç¤ºä¾‹ï¼š\n\n```shell\ni=1\nwhile [ $i -le 5 ]; do\n    echo \"å¾ªç¯ç¬¬ $i æ¬¡\"\n    ((i++))\ndone\n```\n\n## 6. until å¾ªç¯\n\nä¸ `while` ç›¸åï¼š**æ¡ä»¶ä¸ºå‡æ—¶æ‰§è¡Œ**\n\n```shell\ni=1\nuntil [ $i -gt 5 ]; do\n    echo \"ç¬¬ $i æ¬¡\"\n    ((i++))\ndone\n```\n\n## 7. è·³å‡ºå¾ªç¯ï¼šbreak å’Œ continue\n\n```shell\nfor ((i=1;i<=10;i++)); do\n    if [ $i -eq 5 ]; then\n        break   # æå‰ç»“æŸå¾ªç¯\n    fi\n    echo $i\ndone\n```\n\n```shell\nfor ((i=1;i<=5;i++)); do\n    if [ $i -eq 3 ]; then\n        continue   # è·³è¿‡å½“å‰å¾ªç¯\n    fi\n    echo $i\ndone\n```","tags":["Linux","shell"],"categories":["Linux","å…¥é—¨"]},{"title":"shellè„šæœ¬å…¥é—¨","url":"/posts/27290/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\nä½œä¸ºlinuxåµŒå…¥å¼å¼€å‘ï¼ŒæŒæ¡ä¸€äº›shellè„šæœ¬çš„åŸºç¡€æ˜¯å¿…è¦çš„ã€‚\n\n- [1. shellè„šæœ¬çš„å†™æ³•](#1-shellè„šæœ¬çš„å†™æ³•)\n- [2. shellè„šæœ¬çš„ä¸€äº›åŸºæœ¬ç”¨æ³•](#2-shellè„šæœ¬çš„ä¸€äº›åŸºæœ¬ç”¨æ³•)\n  - [2.1. è¾“å…¥å‚æ•°](#21-è¾“å…¥å‚æ•°)\n  - [2.2. æ•´å½¢è¿ç®—](#22-æ•´å½¢è¿ç®—)\n  - [2.3. testå‘½ä»¤](#23-testå‘½ä»¤)\n    - [2.3.1. æ–‡ä»¶æµ‹è¯•](#231-æ–‡ä»¶æµ‹è¯•)\n    - [2.3.2. å­—ç¬¦ä¸²æ¯”è¾ƒ](#232-å­—ç¬¦ä¸²æ¯”è¾ƒ)\n    - [2.3.3. æ•°å€¼æ¯”è¾ƒ](#233-æ•°å€¼æ¯”è¾ƒ)\n    - [2.3.4. é€»è¾‘æ“ä½œç¬¦](#234-é€»è¾‘æ“ä½œç¬¦)\n  - [2.4. æ¡ä»¶åˆ¤æ–­](#24-æ¡ä»¶åˆ¤æ–­)\n- [3. æ‹“å±•ï¼šshellè„šæœ¬ä¸­`$`çš„ä½œç”¨](#3-æ‹“å±•shellè„šæœ¬ä¸­çš„ä½œç”¨)\n  - [3.1. å˜é‡å¼•ç”¨](#31-å˜é‡å¼•ç”¨)\n  - [3.2. å‘½ä»¤æ›¿æ¢](#32-å‘½ä»¤æ›¿æ¢)\n  - [3.3. ä½ç½®å‚æ•°å’Œç‰¹æ®Šå˜é‡](#33-ä½ç½®å‚æ•°å’Œç‰¹æ®Šå˜é‡)\n  - [3.4. ç®—æœ¯æ‰©å±•](#34-ç®—æœ¯æ‰©å±•)\n  - [3.5. å­—ç¬¦ä¸²æ“ä½œå’Œé»˜è®¤å€¼å¤„ç†](#35-å­—ç¬¦ä¸²æ“ä½œå’Œé»˜è®¤å€¼å¤„ç†)\n\n\n\n\n## 1. shellè„šæœ¬çš„å†™æ³•\nshellæ˜¯ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå‘½ä»¤ä»ä¸Šè€Œä¸‹ï¼Œä¸€è¡Œä¸€è¡Œå¼€å§‹æ‰§è¡Œï¼Œshellè„šæœ¬çš„æ‰©å±•åä¸º.sh\nç¬¬ä¸€è¡Œï¼š\n```shell\n#ï¼/bin/bash\n```\nè¡¨ç¤ºä½¿ç”¨bash\n\n## 2. shellè„šæœ¬çš„ä¸€äº›åŸºæœ¬ç”¨æ³•\n\n### 2.1. è¾“å…¥å‚æ•°\n`read`å¸¸ç”¨é€‰é¡¹ï¼š\n- -a array å°†è¾“å…¥çš„å€¼ä½œä¸ºæ•°ç»„èµ‹å€¼\n- -d delim æŒ‡å®šè¾“å…¥ç»“æŸçš„æ ‡è¯†ç¬¦\n- -p prompt åœ¨è¾“å…¥å‰æ‰“å°æç¤ºä¿¡æ¯\n- -t timeout è®¾ç½®è¶…æ—¶æ—¶é—´\n- -e åœ¨è¾“å…¥çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡¥å…¨\n- -s silent å®‰é™æ¨¡å¼ï¼Œåœ¨è¾“å…¥å­—ç¬¦æ—¶ä¸å†å±å¹•ä¸Šæ˜¾ç¤ºï¼Œä¾‹å¦‚loginæ—¶è¾“å…¥å¯†ç ã€‚\n\n---\n\n### 2.2. æ•´å½¢è¿ç®—\n ä½¿ç”¨`$[]`è¿›è¡Œç®—æ•°æ‰©å±•\n```shell\nread -p \"two num: \" num1 num2\necho \"$num1 + $num2 = $[num1 + num2]\"\n```\n\n---\n\n### 2.3. testå‘½ä»¤\n\nç”¨äºæŸ¥çœ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€æƒé™ç­‰ä¿¡æ¯ã€‚å¯ä»¥å¯¹æ•°å€¼ã€å­—ç¬¦ã€æ–‡ä»¶ä¸‰æ–¹é¢æµ‹è¯•ï¼Œ**è¿”å›å¸ƒå°”å€¼**\næ ¼å¼ï¼š\n```shell\ntest EXPRESSION\n# æˆ–\n[ EXPRESSION ]  # æ³¨æ„æ–¹æ‹¬å·å†…å¿…é¡»æœ‰ç©ºæ ¼\n```\n\n#### 2.3.1. æ–‡ä»¶æµ‹è¯•\n\n| æ“ä½œç¬¦ | æè¿°      | ç¤ºä¾‹                     |\n| --- | ------- | ---------------------- |\n| -e  | æ–‡ä»¶æ˜¯å¦å­˜åœ¨  | `[ -e file.txt ]`      |\n| -f  | æ˜¯æ™®é€šæ–‡ä»¶   | `[ -f /path/to/file ]` |\n| -d  | æ˜¯ç›®å½•     | `[ -d /path/to/dir ]`  |\n| -r  | å¯è¯»      | `[ -r file.txt ]`      |\n| -w  | å¯å†™      | `[ -w file.txt ]`      |\n| -x  | å¯æ‰§è¡Œ     | `[ -x script.sh ]`     |\n| -s  | æ–‡ä»¶å¤§å° >0 | `[ -s logfile ]`       |\n| -L  | æ˜¯ç¬¦å·é“¾æ¥   | `[ -L symlink ]`       |\n\n#### 2.3.2. å­—ç¬¦ä¸²æ¯”è¾ƒ\n\n| æ“ä½œç¬¦                | æè¿°    | ç¤ºä¾‹                       |\n| ------------------ | ----- | ------------------------ |\n| -z STRING          | å­—ç¬¦ä¸²ä¸ºç©º | `[ -z \"$var\" ]`          |\n| -n STRING          | å­—ç¬¦ä¸²éç©º | `[ -n \"$var\" ]`          |\n| STRING1 = STRING2  | å­—ç¬¦ä¸²ç›¸ç­‰ | `[ \"$var1\" = \"$var2\" ]`  |\n| STRING1 != STRING2 | å­—ç¬¦ä¸²ä¸ç­‰ | `[ \"$var1\" != \"$var2\" ]` |\n\n#### 2.3.3. æ•°å€¼æ¯”è¾ƒ\n\n|æ“ä½œç¬¦|æè¿°|ç¤ºä¾‹|\n|---|---|---|\n|-eq|ç­‰äº|`[ \"$a\" -eq \"$b\" ]`|\n|-ne|ä¸ç­‰äº|`[ \"$a\" -ne \"$b\" ]`|\n|-gt|å¤§äº|`[ \"$a\" -gt \"$b\" ]`|\n|-ge|å¤§äºæˆ–ç­‰äº|`[ \"$a\" -ge \"$b\" ]`|\n|-lt|å°äº|`[ \"$a\" -lt \"$b\" ]`|\n|-le|å°äºæˆ–ç­‰äº|`[ \"$a\" -le \"$b\" ]`|\n\n#### 2.3.4. é€»è¾‘æ“ä½œç¬¦\n\n`test`Â æ”¯æŒé€»è¾‘ç»„åˆï¼š\n\n|æ“ä½œç¬¦|æè¿°|ç¤ºä¾‹|\n|---|---|---|\n|!|é€»è¾‘é|`[ ! -f \"$file\" ]`|\n|-a|é€»è¾‘ä¸|`[ \"$a\" -eq 1 -a \"$b\" -eq 2 ]`|\n|-o|é€»è¾‘æˆ–|`[ \"$a\" -eq 1 -o \"$b\" -eq 2 ]`|\n\n**ç°ä»£æ¨èå†™æ³•**ï¼šä½¿ç”¨Â `&&`Â å’ŒÂ `||`Â æ›¿ä»£Â `-a`Â å’ŒÂ `-o`ï¼Œæ›´ç¬¦åˆ POSIX æ ‡å‡†\n\n---\n\n### 2.4. æ¡ä»¶åˆ¤æ–­\n\n:::warning\nå’Œ Javaã€PHP ç­‰è¯­è¨€ä¸ä¸€æ ·ï¼Œsh çš„æµç¨‹æ§åˆ¶ä¸å¯ä¸ºç©º\n:::\n\n**è¿™ä¸ªæˆ‘å•ç‹¬å¼€ä¸€ç¯‡ç®—äº†....**\n\n## 3. æ‹“å±•ï¼šshellè„šæœ¬ä¸­`$`çš„ä½œç”¨\n\nåœ¨ Shell ä¸­ï¼Œ`$` æ˜¯ä¸€ä¸ªéå¸¸æ ¸å¿ƒçš„ç¬¦å·ï¼Œä¸»è¦ç”¨äº**å˜é‡å¼•ç”¨**ã€**å‘½ä»¤æ›¿æ¢**ã€**å‚æ•°è®¿é—®**ã€**å­—ç¬¦ä¸²æ“ä½œ**ç­‰ã€‚ä¸‹é¢æŒ‰ä¸åŒç”¨é€”åˆ†ç±»è¯´æ˜ï¼š\n### 3.1. å˜é‡å¼•ç”¨\n\n`$å˜é‡å` ç”¨äºè·å–å˜é‡çš„å€¼ï¼š\n\n```shell\nname=\"lemon\"\necho $name     # è¾“å‡º: lemon\n```\n\n```shell\necho ${name}world   # è¾“å‡º: lemonworld\n```\n\n### 3.2. å‘½ä»¤æ›¿æ¢\n\n`$(command)` ä¼šæ‰§è¡Œ `command` å‘½ä»¤ï¼Œå¹¶å°†å…¶æ ‡å‡†è¾“å‡ºç»“æœæ›¿æ¢ä¸ºå­—ç¬¦ä¸²ï¼š\n\n```shell\necho \"Today is $(date)\"\n# è¾“å‡º: Today is Wed Jun 18 17:00:00 CST 2025\n```\n\nç­‰ä»·äºæ—§å¼ï¼š`` `command` ``\n\n### 3.3. ä½ç½®å‚æ•°å’Œç‰¹æ®Šå˜é‡\n\nShell è„šæœ¬ä¸­ `$` ä¹Ÿç”¨äºè·å–ä¼ å…¥è„šæœ¬çš„å‚æ•°æˆ–ç‰¹æ®Šå«ä¹‰å˜é‡ï¼š\n\n|è¡¨è¾¾å¼|å«ä¹‰|\n|---|---|\n|`$0`|è„šæœ¬å|\n|`$1` ~ `$9`|è„šæœ¬å‚æ•°ï¼ˆç¬¬1~9ä¸ªï¼‰|\n|`$@`|æ‰€æœ‰å‚æ•°ï¼ˆç‹¬ç«‹ï¼‰|\n|`$*`|æ‰€æœ‰å‚æ•°ï¼ˆæ•´ä½“ï¼‰|\n|`$#`|å‚æ•°ä¸ªæ•°|\n|`$$`|å½“å‰è„šæœ¬/è¿›ç¨‹çš„ PID|\n|`$?`|ä¸Šä¸€ä¸ªå‘½ä»¤çš„è¿”å›å€¼|\n|`$!`|æœ€è¿‘ä¸€ä¸ªåå°è¿›ç¨‹çš„ PID|\n\nç¤ºä¾‹ï¼š\n```shell\n#!/bin/bash\n\necho \"ã€\\$0ã€‘ï¼šè„šæœ¬åç§°ï¼š$0\"\necho \"ã€\\$1ã€‘ï¼šç¬¬ä¸€ä¸ªå‚æ•°ï¼š$1\"\necho \"ã€\\$2ã€‘ï¼šç¬¬äºŒä¸ªå‚æ•°ï¼š$2\"\necho \"ã€\\$#ã€‘ï¼šå‚æ•°æ€»æ•°ï¼š$#\"\n\necho \"ã€\\$@ã€‘ï¼šæ‰€æœ‰å‚æ•°ï¼ˆé€ä¸ªæ˜¾ç¤ºï¼‰\"\nfor arg in \"$@\"; do\n    echo \"  - $arg\"\ndone\n#  æˆ–echo \"ã€\\$@ã€‘ï¼šæ‰€æœ‰å‚æ•°:\" \"$@\"\necho \"ã€\\$*ã€‘ï¼šæ‰€æœ‰å‚æ•°ï¼ˆæ•´ä½“æ˜¾ç¤ºï¼‰\"\nfor arg in \"$*\"; do\n    echo \"  - $arg\"\ndone\n\necho \"ã€\\$$ã€‘ï¼šå½“å‰è„šæœ¬çš„ PID æ˜¯ï¼š$$\"\n\n# æ¨¡æ‹Ÿä¸€ä¸ªå‘½ä»¤å¹¶æŸ¥çœ‹è¿”å›å€¼\necho \"æ‰§è¡Œ ls å‘½ä»¤ï¼š\"\nls > /dev/null\necho \"ã€\\$?ã€‘ï¼šä¸Šä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç ï¼š$?\"\n\n# æ¨¡æ‹Ÿåå°å‘½ä»¤å¹¶æŸ¥çœ‹å…¶ PID\nsleep 5 &\necho \"ã€\\$!ã€‘ï¼šæœ€è¿‘ä¸€ä¸ªåå°ä»»åŠ¡çš„ PID æ˜¯ï¼š$!\"\n\n```\n\n\nå¸¸è§é—®é¢˜ï¼š`${@}`ä¸ `${*}`çš„åŒºåˆ«\n\n| è¡¨è¾¾å¼      | è§£é‡Š                                |\n| -------- | --------------------------------- |\n| `\"${@}\"` | æŠŠæ¯ä¸ªå‚æ•°**ä½œä¸ºç‹¬ç«‹å­—ç¬¦ä¸²**å¤„ç†ï¼Œé€‚åˆ for å¾ªç¯      |\n| `\"${*}\"` | æŠŠæ‰€æœ‰å‚æ•°å½“ä½œ**ä¸€ä¸ªæ•´ä½“å­—ç¬¦ä¸²**å¤„ç†ï¼Œè‹¥å¸¦å¼•å·ä¼šåˆå¹¶æˆä¸€ä¸ªå‚æ•° |\n\n### 3.4. ç®—æœ¯æ‰©å±•\n\nç”¨ `$(())` æˆ– `$[]` è¿›è¡Œç®—æœ¯è¿ç®—ï¼š\n\n```bash\na=5\nb=3\necho $[a + b]  # è¾“å‡º: 8\n```\n\n### 3.5. å­—ç¬¦ä¸²æ“ä½œå’Œé»˜è®¤å€¼å¤„ç†\n\næ”¯æŒ `:-`, `:=`, `:+`, `:?` ç­‰æ“ä½œï¼š\n\n```shell\necho ${var:-default}   # varæœªå®šä¹‰åˆ™ä½¿ç”¨\"default\"\n```\n\n\n","tags":["Linux","shell"],"categories":["Linux","å…¥é—¨"]},{"title":"Ubuntuä¸‹è¿æ¥æ–‡ä»¶","url":"/posts/36626/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\nåœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦åœ¨ä¸åŒä½ç½®å¼•ç”¨åŒä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…å¸Œæœ›é€šè¿‡æŸç§æ–¹å¼ä¸ºæŸä¸ªæ–‡ä»¶è®¾ç½®åˆ«åã€‚è¿™æ—¶å€™ï¼Œæ–‡ä»¶â€œè¿æ¥ï¼ˆLinkï¼‰â€æœºåˆ¶å°±æ´¾ä¸Šç”¨åœºäº†ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç» Linux ä¸‹çš„ç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰ä¸ç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼Œåˆç§°è½¯é“¾æ¥ï¼‰çš„æ¦‚å¿µã€åŒºåˆ«ä»¥åŠå®é™…ç”¨æ³•ã€‚\n\n---\n\n## ğŸ“Œ ä¸€ã€ä»€ä¹ˆæ˜¯æ–‡ä»¶è¿æ¥ï¼Ÿ\n\nLinux ä¸­çš„â€œè¿æ¥â€æŒ‡çš„æ˜¯ä¸ºæŸä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªåˆ«åæˆ–æŒ‡é’ˆï¼Œä½¿ä½ å¯ä»¥é€šè¿‡å¤šä¸ªè·¯å¾„è®¿é—®åŒä¸€ä¸ªæ–‡ä»¶å†…å®¹ã€‚\n\nè¿æ¥åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š\n\n- **ç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰**\n- **ç¬¦å·é“¾æ¥ï¼ˆSymbolic Link æˆ– Soft Linkï¼‰**\n\n---\n\n## ğŸ”— äºŒã€ç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰\n\n### 1. æ¦‚å¿µ\n\nç¡¬é“¾æ¥æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ç§æœºåˆ¶ï¼Œå®ƒä¸º**åŒä¸€ä¸ª inodeï¼ˆç´¢å¼•èŠ‚ç‚¹ï¼‰** åˆ›å»ºå¤šä¸ªç›®å½•é¡¹ã€‚å¤šä¸ªç¡¬é“¾æ¥æœ¬è´¨ä¸Šæ˜¯â€œå¹³ç­‰çš„â€ï¼Œäº’ä¸ºé•œåƒã€‚\n\n### 2. ç‰¹ç‚¹\n\n- åŒä¸€ä¸ª inode å·ï¼Œè¡¨ç¤ºæŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶å†…å®¹ã€‚\n- åˆ é™¤å…¶ä¸­ä¸€ä¸ªé“¾æ¥ä¸ä¼šå½±å“å…¶ä»–é“¾æ¥ã€‚\n- ä¸æ”¯æŒå¯¹ç›®å½•åˆ›å»ºç¡¬é“¾æ¥ï¼ˆä¸ºé¿å…ç¯å½¢ç»“æ„ï¼‰ã€‚\n- åªèƒ½å¯¹åŒä¸€æ–‡ä»¶ç³»ç»Ÿå†…çš„æ–‡ä»¶åˆ›å»ºã€‚\n\n### 3. åˆ›å»ºå‘½ä»¤\n\n```bash\nln æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶\n```\n\n### 4.å®éªŒ\næŸ¥çœ‹é“¾æ¥æ•°\n```bash\nls -l\n```\n\nç¬¬äºŒåˆ—æ˜¾ç¤ºçš„æ•°å­—è¡¨ç¤ºé“¾æ¥æ•°ï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰ã€‚\n\n![](Snipaste_2025-06-14_21-30-04.png)\nå¯è§å…¶æ‰€å ç”¨çš„å­˜å‚¨ç©ºé—´æ˜¯ç›¸åŒçš„ï¼Œè¯´æ˜å®ƒä»¬æœ¬è´¨æ˜¯ç›¸åŒçš„ï¼ŒæŒ‡å‘åŒä¸€incodeï¼Œåˆ é™¤é“¾æ¥æºæ–‡ä»¶ï¼Œå…¶ä»–æ–‡ä»¶ä¾ç„¶å¯ä»¥è¿è¡Œã€‚\nä¾‹å¦‚ï¼š\n```bash\nrm hello\n./ hello2\n```\nä¾ç„¶æ­£å¸¸è¾“å‡º\n\n---\n\n## ä¸‰ã€ç¬¦å·é“¾æ¥ï¼ˆSymbolic Link / Soft Linkï¼‰\n\n### 1. æ¦‚å¿µ\n\nç¬¦å·é“¾æ¥ç±»ä¼¼ Windows çš„å¿«æ·æ–¹å¼ï¼Œå®ƒæ˜¯ä¸€ä¸ª**ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶**ï¼ŒåŒ…å«äº†å¦ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„ã€‚\n\n### 2. ç‰¹ç‚¹\n\n- æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œæœ‰è‡ªå·±çš„ inodeã€‚\n- é“¾æ¥è·¯å¾„ï¼Œè€Œéç›´æ¥æŒ‡å‘æ•°æ®å—ã€‚\n- åˆ é™¤æºæ–‡ä»¶ä¼šå¯¼è‡´ç¬¦å·é“¾æ¥å¤±æ•ˆï¼ˆå˜æˆâ€œæ‚¬æŒ‚é“¾æ¥â€æˆ–â€œæ­»é“¾æ¥â€ï¼‰ã€‚\n- å¯è·¨æ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿå¯æŒ‡å‘ç›®å½•ã€‚\n\n:::bug\n**è¯·ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå¦åˆ™æ‹·è´æ–‡ä»¶åˆ°å¦ä¸€ç›®å½•æ—¶ä¼šå¤±å»è½¯è¿æ¥**\n:::\n### 3. åˆ›å»ºå‘½ä»¤\n\n```bash\nln -s æºæ–‡ä»¶ ç›®æ ‡é“¾æ¥å\n```\n\n### 4. å®éªŒ\n\næ‹·è´æ–‡ä»¶ä¿ç•™è½¯é“¾æ¥\n```bash\ncp -d [æº] [ç›®çš„]\n```\n\nå½“ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ—¶ï¼š\n![](Snipaste_2025-06-14_21-42-53.png)\n![](Snipaste_2025-06-14_21-48-24.png)\nä½¿ç”¨ç»å¯¹è·¯å¾„ï¼š\n![](Snipaste_2025-06-14_21-54-29.png)\n\n---\n\n## ğŸ†š å››ã€ç¡¬é“¾æ¥ vs ç¬¦å·é“¾æ¥\n\n|ç‰¹æ€§|ç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰|ç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼‰|\n|---|---|---|\n|æ˜¯å¦æœ‰ç‹¬ç«‹ inode|å¦|æ˜¯|\n|æ˜¯å¦å¯è·¨æ–‡ä»¶ç³»ç»Ÿ|å¦|æ˜¯|\n|æ˜¯å¦å¯é“¾æ¥ç›®å½•|å¦|æ˜¯ï¼ˆéœ€ç®¡ç†å‘˜æƒé™ï¼‰|\n|åˆ é™¤åŸæ–‡ä»¶å|å†…å®¹ä»ä¿ç•™|é“¾æ¥å¤±æ•ˆï¼ˆæ‚¬æŒ‚é“¾æ¥ï¼‰|\n|ä½œç”¨|å¤šä¸ªæ–‡ä»¶åå…±äº«å†…å®¹|æ–‡ä»¶å¿«æ·æ–¹å¼|\n\n---\n\n## ğŸ§ª äº”ã€è¡¥å……\n\n### æŸ¥æ‰¾æ‰€æœ‰æŒ‡å‘åŒä¸€ inode çš„æ–‡ä»¶\n\n```bash\nfind . -inum <inodeå·>\n```\n\n### æŸ¥æ‰¾æ‰€æœ‰æ­»é“¾æ¥\n\n```bash\nfind . -xtype l\n```\n---\n\n## âœ… å…­ã€æ€»ç»“\n\n| å…³é”®ç‚¹  | ç¡¬é“¾æ¥       | ç¬¦å·é“¾æ¥       |\n| ---- | --------- | ---------- |\n| å®‰å…¨æ€§  | å†…å®¹å†—ä½™ï¼Œè¾ƒå®‰å…¨  | å®¹æ˜“äº§ç”Ÿæ­»é“¾æ¥    |\n| çµæ´»æ€§  | ä¸æ”¯æŒè·¨ç³»ç»Ÿå’Œç›®å½• | çµæ´»ï¼Œå¯æŒ‡å‘ä»»æ„è·¯å¾„ |\n| é€‚ç”¨åœºæ™¯ | æœ¬åœ°å¤‡ä»½ï¼Œæ ¸å¿ƒæ–‡ä»¶ | å¿«æ·æ–¹å¼ï¼Œå¿«æ·è®¿é—®  |\n","tags":["Linux","é“¾æ¥æ–‡ä»¶"],"categories":["Linux","å…¥é—¨"]},{"title":"è¸©å‘è®°å½•ï¼šWSLä¸‹å¯¹uç›˜æ ¼å¼åŒ–ä¿®æ”¹ååœ¨winä¸‹è¿æ¥uç›˜å‘ç°ç›˜å†…å†…å®¹æœªæ”¹å˜","url":"/posts/20676/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n## é—®é¢˜æè¿°\næˆ‘å°†USBè¯»å¡å™¨æ’å…¥microSDå¡ï¼ˆè¯¥SDå¡æ­¤å‰åˆ·å…¥è¿‡micropythonå›ºä»¶åŒ…ï¼‰ï¼Œå¹¶å°†å…¶è¿æ¥è‡³ç”µè„‘ï¼Œæ¥ç€æˆ‘åœ¨winç³»ç»Ÿä¸‹ï¼Œåœ¨SDå¡ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶wtf.txtï¼Œç„¶åæ‰“å¼€WSLï¼Œä½¿ç”¨usbipå°†è¯¥uç›˜å…±äº«ï¼Œåœ¨WSLä¸‹ï¼Œuç›˜èƒ½æ­£ç¡®è¯»å–ã€æŒ‚è½½ï¼Œæˆ‘åœ¨WSLé‡æ–°å¯¹è¿™ä¸ªuç›˜ä½¿ç”¨fdiské‡æ–°åˆ†åŒºï¼Œmkfsé‡æ–°æ ¼å¼åŒ–ä¸ºFAT32æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”åœ¨WSLä¸‹touchäº†ä¸€ä¸ªæ–°æ–‡ä»¶hi.txtï¼Œä½¿ç”¨syncåŒæ­¥ï¼Œç„¶åä½¿ç”¨usbipdçš„å‘½ä»¤æ–­å¼€è¿æ¥ï¼Œæ¥å…¥winç³»ç»Ÿåï¼Œwtf.txtå±…ç„¶è¿˜åœ¨ï¼Œå†æ¬¡å°†uç›˜æ¥å…¥WSLï¼Œå‘ç°hi.txtä¹Ÿåœ¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒæ ·çš„SDå¡ï¼Œä¸¤ä¸ªç³»ç»Ÿè¯»åˆ°çš„ä¸œè¥¿å´ä¸ä¸€æ ·ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ\næŒ‰ç…§ç½‘ä¸Šçš„ä¸»æµæ–¹æ³•ï¼Œå°è¯•è¿‡ç¼–è¯‘å†…æ ¸æ·»åŠ usbé©±åŠ¨æ”¯æŒï¼Œæ‰‹åŠ¨å®‰è£…usbipå·¥å…·éƒ½ä¸ç®¡ç”¨ã€‚\n## é—®é¢˜è§£å†³\nåœ¨ä½¿ç”¨fdiskåˆ†åŒºæ—¶ï¼Œæˆ‘å‘ç°å¦‚ä¸‹è­¦å‘Šï¼š\n```text\nThe device contains hybrid MBR -- writing GPT only.\n```\n\nåœ¨è¯¢é—®chatgptåï¼Œå¼„æ¸…äº†è¿™æ¡è­¦å‘Šçš„å«ä¹‰ï¼š\n1. **ç£ç›˜ä¸­æ£€æµ‹åˆ° Hybrid MBR**ï¼šå³ä½¿ä¹‹å‰æ ¼å¼åŒ–æˆ–é‡åˆ†åŒºè¿‡ï¼Œå®ƒä»å¯èƒ½ä¿ç•™æœ‰æ—§çš„æ··åˆç»“æ„ã€‚\n2. **å½“å‰æ­£å°è¯•ç”¨ GPT æ ¼å¼é‡å†™è¯¥ç£ç›˜**ï¼šå·¥å…·ä¼šå¿½ç•¥ MBR éƒ¨åˆ†ï¼Œåªå†™å…¥çº¯ GPTã€‚    \n\n**Hybrid MBRï¼ˆæ··åˆä¸»å¼•å¯¼è®°å½•ï¼‰** æ˜¯ä¸€ç§å…¼å®¹æœºåˆ¶ï¼Œå®ƒå…è®¸ä¸€ä¸ªç£ç›˜åŒæ—¶æ‹¥æœ‰ï¼š\n- ä¸€éƒ¨åˆ† **MBRï¼ˆä¼ ç»Ÿ BIOS å¯åŠ¨æ”¯æŒï¼‰**\n- ä¸€éƒ¨åˆ† **GPTï¼ˆç”¨äºç°ä»£ç³»ç»Ÿçš„åˆ†åŒºæ–¹æ¡ˆï¼‰**\n\nè¿™ç§ç»“æ„é€šå¸¸ç”¨äºè®© **ä½¿ç”¨ GPT åˆ†åŒºçš„ç£ç›˜**ä»ç„¶å¯ä»¥åœ¨ä¸€äº›åªè¯†åˆ« MBR çš„ç³»ç»Ÿä¸­å¯åŠ¨ï¼Œæ¯”å¦‚æ—§ç‰ˆ BIOS ç³»ç»Ÿã€‚\n\næˆ‘çªç„¶æƒ³èµ·æ¥è¿™ä¸ªSDå¡ä¸å°±æ˜¯ä¹‹å‰ç”¨äºå¼•å¯¼å¯åŠ¨micropythonå›ºä»¶çš„å—ï¼Œæ‰€ä»¥å­˜åœ¨æ··åˆç»“æ„ï¼Œè€Œæ­£æ˜¯è¿™æ ·çš„æ··åˆç»“æ„ï¼Œæ˜¯ä½¿å¾—åœ¨winä¸‹ï¼Œç³»ç»Ÿè¯»åˆ°çš„æ˜¯MBRåˆ†åŒºè¡¨ï¼ŒLinuxä¸‹è¯»åˆ°çš„æ˜¯GPTåˆ†åŒºè¡¨ï¼Œè¿™å°±åƒ SD å¡å‰é¢è´´ç€ä¸¤å¼ æ ‡ç­¾çº¸ï¼ˆMBR å’Œ GPTï¼‰ï¼š\n- Windows çœ‹æ ‡ç­¾ Aï¼Œå°±çœ‹åˆ°æ—§æ–‡ä»¶\n- Linux çœ‹æ ‡ç­¾ Bï¼Œå°±çœ‹åˆ°æ–°æ–‡ä»¶\n- å®ƒä»¬æ ¹æœ¬æ²¡åœ¨â€œåŒä¸€å¼ çº¸â€ä¸Šæ“ä½œ\n\näºæ˜¯æˆ‘æŒ‰ç…§GPTæä¾›çš„æ–¹æ³•ï¼Œä½¿ç”¨å‘½ä»¤å½»åº•æ¸…é™¤ç£ç›˜å‰éƒ¨ï¼ˆåŒ…æ‹¬ MBR & GPTï¼‰ï¼š\n```bash\nsudo dd if=/dev/zero of=/dev/sdd bs=1M count=10\nsync\n```\nå®Œå…¨æŠ¹é™¤äº†æ—§çš„ç»“æ„ä¿¡æ¯ï¼Œå†æ¬¡é‡å¤åˆ†åŒºã€æ ¼å¼åŒ–ã€æŒ‚è½½ã€åˆ›å»ºæ–‡ä»¶ç­‰æ“ä½œï¼Œè¿™ä¸‹ä¸¤ä¸ªç³»ç»Ÿè¯»å–åˆ°çš„æ–‡ä»¶å°±åŒæ­¥äº†ğŸ˜ï¼\n\n## ç‰¹åˆ«æ„Ÿè°¢\n\n- [ChatGPT](https://chatgpt.com/)!ï¼ŒAIæ”¹å˜ä¸–ç•Œå•Š~\n- æˆ‘è‡ªå·±ï¼\n","tags":["Linux","è¸©å‘è®°å½•"],"categories":["Linux","è®°å½•"]},{"title":"Ubuntuä¸‹æ–‡ä»¶æƒé™ç®¡ç†","url":"/posts/10180/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\nåœ¨å‘½ä»¤è¡Œç•Œé¢ä¸‹ï¼Œè¾“å…¥å‘½ä»¤\n```bash\ncd /dev\nls -l\n```\n\nå¾—åˆ°è¾“å‡ºå¦‚ä¸‹ï¼š\n\n![](Snipaste_2025-06-14_17-39-42.png)\n\næ¯åˆ—é‡Šä¹‰å¦‚ä¸‹ï¼š\n\n| åˆ—   | ç¤ºä¾‹å€¼            | å«ä¹‰è¯´æ˜                                 |\n| --- | -------------- | ------------------------------------ |\n| 1   | `crw-rw----`   | æ–‡ä»¶ç±»å‹ä¸æƒé™ï¼ˆc è¡¨ç¤ºå­—ç¬¦è®¾å¤‡ï¼›æ¥ä¸‹æ¥æ˜¯ç”¨æˆ·/ç»„/å…¶ä»–çš„è¯»å†™æ‰§è¡Œæƒé™ï¼‰ |\n| 2   | `1`            | ç¡¬é“¾æ¥æ•°é‡ï¼ˆå¯¹äºè®¾å¤‡æ–‡ä»¶é€šå¸¸æ˜¯1ï¼‰                    |\n| 3   | `root`         | æ–‡ä»¶ï¼ˆæˆ–è®¾å¤‡ï¼‰çš„æ‰€æœ‰è€…                          |\n| 4   | `root`         | æ‰€å±ç”¨æˆ·ç»„                                |\n| 5   | `188, 0`       | ä¸»è®¾å¤‡å·å’Œæ¬¡è®¾å¤‡å·ï¼ˆ**ä»…å¯¹è®¾å¤‡æ–‡ä»¶å­˜åœ¨**ï¼Œè¡¨ç¤ºå¯¹åº”é©±åŠ¨å’Œè®¾å¤‡ï¼‰    |\n| 6   | `Jun 14 16:45` | æœ€åä¿®æ”¹æ—¶é—´                               |\n| 7   | `ttyUSB0`      | æ–‡ä»¶åï¼ˆè¿™é‡Œæ˜¯è®¾å¤‡åï¼‰                          |\n\n## ä¸»æ¬¡è®¾å¤‡å·\nä¸»è®¾å¤‡å·ï¼ˆMajor Numberï¼‰\n- å†³å®šäº†è¿™ä¸ªæ–‡ä»¶å¯¹åº”å“ªä¸ª**é©±åŠ¨ç¨‹åº**ã€‚\n- æ¯”å¦‚æ‰€æœ‰çš„ `ttyUSBx` è®¾å¤‡å¯èƒ½éƒ½ç”±ä¸»è®¾å¤‡å· 188 å¯¹åº”çš„é©±åŠ¨å¤„ç†ã€‚\n\næ¬¡è®¾å¤‡å·ï¼ˆMinor Numberï¼‰\n- ç”±ä¸»è®¾å¤‡å·æŒ‡å®šçš„é©±åŠ¨ç¨‹åºä½¿ç”¨ï¼Œç”¨äºåŒºåˆ†åŒä¸€é©±åŠ¨ç®¡ç†ä¸‹çš„ä¸åŒè®¾å¤‡ã€‚\n- æ¯”å¦‚ `ttyUSB0` æ˜¯ç¬¬ä¸€ä¸ªè®¾å¤‡ï¼Œ`ttyUSB1` æ˜¯ç¬¬äºŒä¸ªï¼Œä»¥æ­¤ç±»æ¨ã€‚\n\n## æ–‡ä»¶æƒé™ä½è¯¦è§£\nç¬¬ä¸€åˆ—æ˜¯æ–‡ä»¶æƒé™ä½ï¼Œæ¯ä½é‡Šä¹‰å¦‚ä¸‹ï¼š\n\n| ä½æ¬¡   | å«ä¹‰           | ç¤ºä¾‹    | è¯´æ˜                                |\n| ---- | ------------ | ----- | --------------------------------- |\n| 1    | æ–‡ä»¶ç±»å‹         | `-`   | `-` æ™®é€šæ–‡ä»¶ã€`d` ç›®å½•ã€`l` è½¯é“¾æ¥ã€`c` å­—ç¬¦è®¾å¤‡ç­‰ |\n| 2-4  | æ‰€æœ‰è€…æƒé™ï¼ˆuserï¼‰  | `rwx` | è¯»ï¼ˆrï¼‰ã€å†™ï¼ˆwï¼‰ã€æ‰§è¡Œï¼ˆxï¼‰                   |\n| 5-7  | ç”¨æˆ·ç»„æƒé™ï¼ˆgroupï¼‰ | `r-x` |                                   |\n| 8-10 | å…¶ä»–äººæƒé™ï¼ˆotherï¼‰ | `r--` |                                   |\næƒé™å­—ç¬¦ï¼š\n\n| å­—ç¬¦  | å«ä¹‰                          |\n| --- | --------------------------- |\n| `r` | å¯è¯»ï¼ˆreadï¼‰ï¼šå¯ä»¥è¯»å–æ–‡ä»¶å†…å®¹æˆ–åˆ—å‡ºç›®å½•å†…å®¹    |\n| `w` | å¯å†™ï¼ˆwriteï¼‰ï¼šå¯ä»¥ä¿®æ”¹æ–‡ä»¶å†…å®¹æˆ–æ·»åŠ /åˆ é™¤ç›®å½•é¡¹ |\n| `x` | å¯æ‰§è¡Œï¼ˆexecuteï¼‰ï¼šå¯æ‰§è¡Œç¨‹åºæˆ–è¿›å…¥ç›®å½•     |\n| `-` | æ²¡æœ‰è¯¥æƒé™                       |\n\n## æ–‡ä»¶æƒé™ä¿®æ”¹\n\n### ä¸€ã€`chmod` å‘½ä»¤æ¦‚è¿°\n\nç”¨äºæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ï¼Œæ”¯æŒ **ç¬¦å·æ³•** å’Œ **æ•°å­—æ³•**ã€‚\n\n---\n\n### äºŒã€æƒé™åŸºç¡€\n\n|æƒé™å­—ç¬¦|æƒé™å«ä¹‰|å¯¹æ–‡ä»¶ä½œç”¨|å¯¹ç›®å½•ä½œç”¨|\n|---|---|---|---|\n|`r`|è¯»æƒé™|å¯è¯»å–å†…å®¹|å¯åˆ—å‡ºç›®å½•æ–‡ä»¶|\n|`w`|å†™æƒé™|å¯ä¿®æ”¹å†…å®¹|å¯åˆ›å»º/åˆ é™¤æ–‡ä»¶|\n|`x`|æ‰§è¡Œæƒé™|å¯æ‰§è¡Œ|å¯è¿›å…¥ç›®å½•|\n\n---\n\n### ä¸‰ã€ç¬¦å·æ³•ï¼ˆSymbolic Modeï¼‰\n\n#### è¯­æ³•\n\n```bash\nchmod [å¯¹è±¡][æ“ä½œ][æƒé™] æ–‡ä»¶å\n```\n#### å¯¹è±¡ï¼ˆæƒé™å½’å±ï¼‰\n\n|ç¬¦å·|å«ä¹‰|\n|---|---|\n|`u`|æ‰€æœ‰è€…|\n|`g`|æ‰€å±ç»„|\n|`o`|å…¶ä»–ç”¨æˆ·|\n|`a`|æ‰€æœ‰äººï¼ˆugoï¼‰|\n\n#### æ“ä½œç¬¦\n\n|ç¬¦å·|å«ä¹‰|\n|---|---|\n|`+`|æ·»åŠ æƒé™|\n|`-`|åˆ é™¤æƒé™|\n|`=`|èµ‹äºˆæƒé™ï¼ˆæ›¿æ¢ï¼‰|\n\n#### ç¤ºä¾‹\n\n```bash\nchmod u+x file.sh     # ç»™æ‰€æœ‰è€…æ·»åŠ æ‰§è¡Œæƒé™\nchmod g-w file.txt    # ç§»é™¤ç»„çš„å†™æƒé™\nchmod o=r file.txt    # å…¶ä»–äººåªè¯»\nchmod a+x run.sh      # æ‰€æœ‰äººæ·»åŠ æ‰§è¡Œæƒé™\n```\n\n---\n\n### å››ã€æ•°å­—æ³•ï¼ˆOctal Modeï¼‰\n\n#### æƒé™ä¸æ•°å­—æ˜ å°„\n\n|æƒé™|æ•°å€¼|å«ä¹‰|\n|---|---|---|\n|`---`|0|æ— æƒé™|\n|`--x`|1|æ‰§è¡Œ|\n|`-w-`|2|å†™|\n|`-wx`|3|å†™ + æ‰§è¡Œ|\n|`r--`|4|è¯»|\n|`r-x`|5|è¯» + æ‰§è¡Œ|\n|`rw-`|6|è¯» + å†™|\n|`rwx`|7|å…¨éƒ¨æƒé™|\n ç›¸å½“äºä»¥äºŒè¿›åˆ¶å¯¹åº”çš„åè¿›åˆ¶æ¥è¡¨ç¤ºï¼Œè¿™ç‚¹åº”è¯¥ä¸é™Œç”Ÿã€‚\n#### ç¤ºä¾‹\n\n```bash\nchmod 755 script.sh    # æ‰€æœ‰è€…å…¨éƒ¨æƒé™ï¼Œå…¶ä»–ç”¨æˆ·è¯»+æ‰§è¡Œ\nchmod 644 note.txt     # æ‰€æœ‰è€…è¯»å†™ï¼Œå…¶ä»–äººåªè¯»\nchmod 700 secret.txt   # åªæœ‰æ‰€æœ‰è€…æœ‰æƒé™\n```\n\n---\n\n### äº”ã€é€’å½’æƒé™ä¿®æ”¹\n\n```bash\nchmod -R 755 myfolder     # é€’å½’ä¿®æ”¹ç›®å½•åŠå…¶ä¸‹æ‰€æœ‰æ–‡ä»¶/å­ç›®å½•æƒé™\n```\n\n---\n\n### å…­ã€ä½¿ç”¨ find æ‰¹é‡è®¾ç½®æƒé™\n\n```bash\nfind . -type f -exec chmod 644 {} \\;   # è®¾ç½®æ‰€æœ‰æ–‡ä»¶æƒé™\nfind . -type d -exec chmod 755 {} \\;   # è®¾ç½®æ‰€æœ‰ç›®å½•æƒé™\n```\n\n---\n\n### ä¸ƒã€å¸¸è§ç›®å½•æƒé™æ¨è\n\n|ç›®å½•|æ¨èæƒé™|å«ä¹‰è¯´æ˜|\n|---|---|---|\n|`/home/ç”¨æˆ·å`|`700`|ä»…ç”¨æˆ·æœ¬äººè®¿é—®|\n|`/tmp`|`1777`|æ‰€æœ‰äººå¯å†™ï¼ŒSticky ä½ä¿æŠ¤|\n|ç½‘ç«™ç›®å½•|`755`|å…¶ä»–äººå¯è®¿é—®ä½†ä¸å¯ä¿®æ”¹|\n\n---\n\n### å…«ã€ç‰¹æ®Šæƒé™ç®€è¿°ï¼ˆå¯é€‰ï¼‰\n\n|æƒé™|ä½œç”¨|ç¤ºä¾‹|\n|---|---|---|\n|SUID|æ‰§è¡Œç¨‹åºæ—¶ä½¿ç”¨æ–‡ä»¶æ‰€æœ‰è€…æƒé™|`chmod u+s`|\n|SGID|åŒä¸Šï¼Œåº”ç”¨äºç»„|`chmod g+s`|\n|Sticky|åªèƒ½åˆ é™¤è‡ªå·±æ–‡ä»¶ï¼ˆå¤šç”¨äº/tmpï¼‰|`chmod +t`|\n\n---\n","tags":["Linux","Ubuntu","æ–‡ä»¶ç³»ç»Ÿ"],"categories":["Linux","å…¥é—¨"]},{"title":"Ubuntuä¸‹ç£ç›˜ç®¡ç†","url":"/posts/30265/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\nå‰é¢æˆ‘ä»¬æˆåŠŸè®©WSLè¯»å–åˆ°Winç³»ç»Ÿçš„USBè®¾å¤‡ï¼Œä¸‹é¢æ¥å­¦ä¹ WSLä¸‹ç£ç›˜çš„ç®¡ç†ã€‚\n\n## ç£ç›˜å’Œç›®å½•çš„å®¹é‡æŸ¥è¯¢å‘½ä»¤\n\n`df` ï¼šæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨é‡ï¼Œä¸»è¦æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿçš„ä½¿ç”¨é‡ã€‚\n`du` ï¼šè¯„ä¼°æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨é‡ï¼Œä¸»è¦æŸ¥çœ‹å•ä¸ªæ–‡ä»¶å¤§å°ã€‚\n`lsblk` ï¼š*List Block Devices* åˆ—å‡ºç³»ç»Ÿä¸­SSDã€Uç›˜ç­‰å­˜å‚¨è®¾å¤‡çš„ä¿¡æ¯\n## ç£ç›˜çš„æŒ‚è½½å¸è½½\n\nè¿˜è®°å¾—å‰é¢æåˆ°çš„[Ubuntuæ–‡ä»¶ç³»ç»Ÿç»“æ„](https://blog.godmao.top/posts/7417/)å—ï¼Ÿæƒ³è¦è¯»å–uç›˜é‡Œçš„æ–‡ä»¶ï¼Œéœ€è¦æŠŠuç›˜æŒ‚è½½åœ¨æŸä¸ªç›®å½•ä¸‹æ‰èƒ½è®¿é—®ã€‚\n\n### ä»€ä¹ˆæ˜¯æŒ‚è½½ï¼Ÿ\næŒ‚è½½å°±æ˜¯â€œ**æŠŠè®¾å¤‡ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿæ¥å…¥Linuxçš„ç›®å½•ç»“æ„ä¸­**â€ã€‚\n- Linux çš„ç›®å½•ç»“æ„æ˜¯ä¸€ä¸ª**ç»Ÿä¸€çš„æ ‘å½¢ç»“æ„**ï¼ˆæ ¹ç›®å½• `/` æ˜¯èµ·ç‚¹ï¼‰ã€‚\n- æ‰€æœ‰çš„æ–‡ä»¶ã€æ–‡ä»¶å¤¹ã€è®¾å¤‡è®¿é—®ï¼Œéƒ½è¦é€šè¿‡è¿™ä¸ªç»Ÿä¸€çš„ç›®å½•æ ‘ã€‚\n- å½“ä½ æ’å…¥ä¸€ä¸ªUç›˜æ—¶ï¼Œå®ƒæœ¬èº«æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚FAT32ï¼‰ï¼ŒLinuxä¸ä¼šè‡ªåŠ¨å°†å…¶è¿æ¥è¿›ç›®å½•æ ‘ï¼Œé™¤éä½ æ˜ç¡®åœ°**æŒ‚è½½**å®ƒã€‚\n\n### ä¸ºä»€ä¹ˆLinuxè¦æŒ‚è½½ï¼ŸWindowsä¸ºä»€ä¹ˆä¸éœ€è¦ï¼Ÿ\n**Linuxè®¾è®¡å“²å­¦ï¼š**\n- LinuxæºäºUnixï¼Œè¿½æ±‚â€œä¸€åˆ‡çš†æ–‡ä»¶â€ï¼Œç»Ÿä¸€çš„ç›®å½•ç»“æ„ã€‚\n- æ‰€æœ‰è®¾å¤‡éƒ½å¿…é¡»é€šè¿‡`/dev/xxx`è¡¨ç¤ºä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åæŒ‚è½½åˆ°æŸä¸ªç›®å½•ï¼ˆå¦‚`/mnt/usb`ï¼‰æ‰å¯ä»¥è®¿é—®ã€‚\n**Windowsçš„æ–¹å¼ï¼š**\n- Windowsæ˜¯â€œç›˜ç¬¦å¼â€çš„ï¼Œæ¯ä¸ªè®¾å¤‡æœ‰ç‹¬ç«‹çš„ç›˜ç¬¦ï¼ˆå¦‚`E:\\`, `F:\\`ï¼‰ï¼Œæ“ä½œç³»ç»Ÿä¼š**è‡ªåŠ¨è¯†åˆ«å¹¶æŒ‚è½½**ã€‚\n- æŒ‚è½½è¿‡ç¨‹å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ï¼Œä½†å…¶å®ç³»ç»Ÿå†…éƒ¨ä¹Ÿåœ¨å®ŒæˆæŒ‚è½½ï¼Œåªæ˜¯éšè—äº†ç»†èŠ‚ã€‚\næ‰€ä»¥ï¼š**Windowsç³»ç»Ÿä¹ŸæŒ‚è½½ï¼Œåªæ˜¯è‡ªåŠ¨åŒ–å¹¶ä¸”ç”¨ç›˜ç¬¦è¡¨ç¤ºï¼›Linuxåˆ™æ›´æ˜¾å¼ä¸”çµæ´»**ã€‚\n\n### Linuxä¸‹å¦‚ä½•æ‰‹åŠ¨æŒ‚è½½uç›˜ï¼Ÿ\n\nå¦‚æœæ˜¯Uç›˜å¯ä»¥æŒ‚è½½åœ¨`/dev/media/`ç›®å½•æˆ–`/dev/mnt/`ç›®å½•\n#### 1.æŸ¥çœ‹uç›˜è®¾å¤‡å\nåœ¨ä½¿ç”¨usbipdä½¿WSLè¯»å–åˆ°uç›˜åï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š\n```bash\nlsblk\n```\n\nä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š\n```\nsdb      8:16   1  29.8G  0 disk\nâ”œâ”€sdb1   8:17   1  10.0G  0 part\nâ”œâ”€sdb2   8:18   1   9.8G  0 part\nâ””â”€sdb3   8:19   1  10.0G  0 part\n```\nè¿™é‡Œ `sdb1` æ˜¯Uç›˜çš„åˆ†åŒºåã€‚ç£ç›˜å¯èƒ½æœ‰å¾ˆå¤šåˆ†åŒºå˜›ã€‚\n\n#### 2.ä¸ºæ¯ä¸ªåˆ†åŒºåˆ›å»ºæŒ‚è½½ç‚¹ç›®å½•\n```bash\nsudo mkdir -p /mnt/usb1 /mnt/usb2 /mnt/usb3\n```\n\n#### 3.é€ä¸ªæŒ‚è½½\n```bash\nsudo mount /dev/sdb1 /mnt/usb1\nsudo mount /dev/sdb2 /mnt/usb2\nsudo mount /dev/sdb3 /mnt/usb3\n```\nå¦‚æœæŸä¸ªåˆ†åŒºçš„æ–‡ä»¶ç³»ç»Ÿä¸æ˜¯è‡ªåŠ¨è¯†åˆ«çš„ï¼ˆæŠ¥é”™ï¼‰ï¼Œä½ å¯ä»¥æŒ‡å®šç±»å‹æŒ‚è½½ï¼Œä¾‹å¦‚ï¼š\n```bash\nsudo mount -t vfat /dev/sdb1 /mnt/usb1\nsudo mount -t ext4 /dev/sdb2 /mnt/usb2\nsudo mount -t ntfs /dev/sdb3 /mnt/usb3\n```\nå¦‚æœä¸æ¸…æ¥šç±»å‹è¿è¡Œå¦‚ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹ï¼š\n```bash\nsudo blkid /dev/sdb1 /dev/sdb2 /dev/sdb3\n```\n\n### å¸è½½\n```bash\nsudo umount /mnt/usb1\nsudo umount /mnt/usb2\nsudo umount /mnt/usb3\n```\n\n## ç£ç›˜åˆ†åŒº\n\n### fdiskå‘½ä»¤å¸¸ç”¨é€‰é¡¹\n| å‘½ä»¤ | å«ä¹‰                     | åŠŸèƒ½è¯´æ˜                                     |\n|------|--------------------------|----------------------------------------------|\n| `m`  | help                     | æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‘½ä»¤                             |\n| `p`  | print                    | æ˜¾ç¤ºå½“å‰åˆ†åŒºè¡¨                               |\n| `n`  | new                      | åˆ›å»ºä¸€ä¸ªæ–°åˆ†åŒºï¼ˆä¸»åˆ†åŒºæˆ–é€»è¾‘åˆ†åŒºï¼‰           |\n| `d`  | delete                   | åˆ é™¤ä¸€ä¸ªå·²æœ‰åˆ†åŒº                             |\n| `t`  | type                     | ä¿®æ”¹åˆ†åŒºçš„ç±»å‹ ID                            |\n| `l`  | list                     | åˆ—å‡ºæ‰€æœ‰åˆ†åŒºç±»å‹ ID                         |\n| `a`  | toggle bootable          | åˆ‡æ¢åˆ†åŒºçš„å¯åŠ¨æ ‡å¿—ï¼ˆè®¾ç½®/å–æ¶ˆå¯å¼•å¯¼åˆ†åŒºï¼‰   |\n| `w`  | write                    | å†™å…¥åˆ†åŒºè¡¨å¹¶é€€å‡º                             |\n| `q`  | quit                     | ä¸ä¿å­˜æ›´æ”¹ï¼Œç›´æ¥é€€å‡º                         |\n| `g`  | gpt                      | åˆ›å»ºæ–°çš„ GPT åˆ†åŒºè¡¨                          |\n| `o`  | dos                      | åˆ›å»ºæ–°çš„ç©ºç™½ DOS (MBR) åˆ†åŒºè¡¨                |\n| `v`  | verify                   | éªŒè¯åˆ†åŒºè¡¨çš„å®Œæ•´æ€§                           |\n| `x`  | expert                   | è¿›å…¥ä¸“å®¶æ¨¡å¼ï¼ˆç”¨äºé«˜çº§æ“ä½œï¼‰                 |\n### ç”¨fdiskæ‰“å¼€è¦åˆ†åŒºçš„ç£ç›˜\n```bash\nsudo fdisk /dev/sde\n```\n\n:::warning\nåƒä¸‡ä¸è¦è¯¯é€‰ï¼Œå¦åˆ™å¯èƒ½ç ´åä½ çš„æ•°æ®ã€‚\n:::\n\n### åˆ é™¤åˆ†åŒº\n```bash\nCommand (m for help): p        â† æŸ¥çœ‹å½“å‰åˆ†åŒºæƒ…å†µï¼ˆç¡®è®¤è¦åˆ å“ªä¸ªï¼‰\nCommand (m for help): d        â† åˆ é™¤åˆ†åŒº\nPartition number (1,2,...): 2  â† é€‰æ‹©ä½ è¦åˆ é™¤çš„åˆ†åŒºç¼–å·ï¼ˆæ¯”å¦‚ 2 è¡¨ç¤º /dev/sdb2ï¼‰\nCommand (m for help): w        â† ä¿å­˜æ›´æ”¹å¹¶é€€å‡º\n```\n\n### åˆ›å»ºåˆ†åŒº\n```bash\nCommand (m for help): n\n```\n\n![](Snipaste_2025-06-12_17-21-39.png)\n\n1ï¼šåˆ†åŒºç¼–å·ï¼Œç›´æ¥å›è½¦æ¥å—é»˜è®¤ç¼–å·ã€‚\n2ï¼šèµ·å§‹æ‰‡åŒºï¼Œé»˜è®¤å€¼é€šå¸¸åˆé€‚ï¼Œç›´æ¥å›è½¦å³å¯ã€‚\n3ï¼šç»“æŸæ‰‡åŒº or åˆ†åŒºå¤§å°ï¼Œå¯ä»¥è¾“å…¥ï¼šæ‰‡åŒºç¼–å·ï¼ˆç›´æ¥å›è½¦ä½¿ç”¨å‰©ä½™ç©ºé—´ï¼‰æˆ–è€…æ‰‹åŠ¨è¾“å…¥å¤§å°ï¼ˆä¾‹å¦‚ï¼š`+1G`ã€`+512M`ï¼‰\n\n### å†™å‡º\nä¿å­˜å¹¶é€€å‡ºã€‚\n```bash\nCommand (m for help): w\n```\n\n## æ ¼å¼åŒ–åˆ†åŒº\nå½“ç”¨ `fdisk` åˆ›å»ºå®Œä¸€ä¸ªåˆ†åŒºåï¼Œè¿™ä¸ªåˆ†åŒºåªæ˜¯â€œé€»è¾‘åˆ’åˆ†å¥½äº†â€ï¼Œä½†**è¿˜ä¸èƒ½ä½¿ç”¨**ï¼Œå¿…é¡»è¦**æ ¼å¼åŒ–ï¼ˆåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼‰**æ‰èƒ½çœŸæ­£è¯»å†™æ•°æ®ã€‚\n\n### ä¸ºä»€ä¹ˆè¦æ ¼å¼åŒ–ï¼Ÿ\næ ¼å¼åŒ–çš„æœ¬è´¨æ˜¯ï¼š\n\n> **åœ¨åˆ†åŒºä¸Šå†™å…¥ç‰¹å®šçš„æ–‡ä»¶ç³»ç»Ÿç»“æ„**ï¼ˆå¦‚ ext4ã€FAT32ã€NTFS ç­‰ï¼‰ã€‚\n\nåªæœ‰è¿™æ ·ï¼Œæ“ä½œç³»ç»Ÿæ‰çŸ¥é“å¦‚ä½•åœ¨è¿™å—åŒºåŸŸå†…ç»„ç»‡ã€å­˜å‚¨å’ŒæŸ¥æ‰¾æ–‡ä»¶ã€‚\n\n### 1.é€‰æ‹©æ ¼å¼åŒ–ç±»å‹\n| æ–‡ä»¶ç³»ç»Ÿ  | è¯´æ˜                               |\n| ----- | -------------------------------- |\n| ext4  | Linuxå¸¸ç”¨ï¼Œæ€§èƒ½ç¨³å®šï¼Œæ”¯æŒå¤§æ–‡ä»¶               |\n| vfat  | FAT32ï¼Œå…¼å®¹Windows/Mac/Linuxï¼Œä¸æ”¯æŒå¤§æ–‡ä»¶ |\n| ntfs  | Windowså¸¸ç”¨ï¼ŒLinuxå¯è¯»å†™ï¼ˆéœ€é©±åŠ¨ï¼‰          |\n| exfat | æ–°å‹é€šç”¨æ ¼å¼ï¼Œæ”¯æŒå¤§æ–‡ä»¶ï¼Œè·¨å¹³å°å…¼å®¹æ€§å¥½             |\n### 2.æ‰§è¡Œæ ¼å¼åŒ–å‘½ä»¤\n*make file system* -type\n```bash\nsudo mkfs.vfat -f 32 /dev/sde2\n```\næ²¡æœ‰mkfsçš„å…ˆå®‰è£…ï¼Œä¸ç„¶æŠ¥é”™ï¼š\n```\nfailed to execute mkfs.vfat: No such file or directory\n```\nå®‰è£…ï¼š\n```bash\nsudo apt update\nsudo apt install dosfstools\n```\n\n### æ£€æŸ¥\nå¯ä»¥è¾“å…¥å‘½ä»¤ï¼š\n```bash\nsudo blkid /dev/sde1 /dev/sde2\n```\næ£€æŸ¥type\nè¾“å‡ºï¼š\n```\nsde1: UUID=\"FBD5-E06C\" BLOCK_SIZE=\"512\" TYPE=\"vfat\" PARTUUID=\"3b15f93b-f163-491d-9f0f-94be96692beb\"\nsde2: UUID=\"FC22-7890\" BLOCK_SIZE=\"512\" TYPE=\"vfat\" PARTUUID=\"248a2fdb-2255-4a7a-802e-e5a11bb87c53\"\n```\n","tags":["Linux","Ubuntu","ç£ç›˜ç®¡ç†"],"categories":["Linux","å…¥é—¨"]},{"title":"WSLä¸‹è¿æ¥USBè®¾å¤‡","url":"/posts/13715/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\nâ­â­â­æœ¬æ–‡å‚è€ƒè‡ªå¾®è½¯å®˜æ–¹WSLæ–‡æ¡£â€”â€”[è¿æ¥ USB è®¾å¤‡ | Microsoft Learn](https://learn.microsoft.com/zh-cn/windows/wsl/connect-usb)\n\nç”±äºWSLä¸æä¾›æœ¬æœºè¿æ¥USBè®¾å¤‡çš„æ”¯æŒï¼Œå› æ­¤éœ€è¦å®‰è£…å¼€æºé¡¹ç›®usbipd-winæ¥æ”¯æŒUSBçš„å…±äº«è¿æ¥ã€‚\n\n## ä»€ä¹ˆæ˜¯usbpidï¼Ÿ\nusbipd æ˜¯ä¸€ä¸ª**ç”¨äºç®¡ç† USB/IPï¼ˆUSB over IPï¼‰æœåŠ¡çš„å‘½ä»¤è¡Œå·¥å…·**ï¼Œå¯ä»¥åœ¨ Windows ä¸‹ä½¿ç”¨ã€‚ USB/IP æ˜¯ä¸€ç§åè®®ï¼Œå…è®¸**é€šè¿‡ç½‘ç»œå…±äº«USB è®¾å¤‡**ã€‚ usbipdå·¥å…·å…è®¸ç”¨æˆ·åœ¨ Windows ä¸Šå…±äº« USB è®¾å¤‡ï¼Œä½¿å…¶ä»–è®¡ç®—æœºèƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®è¿™äº›è®¾å¤‡ã€‚\n\n## å®‰è£… USBIPD-WIN é¡¹ç›®\n1. è½¬åˆ°Â [usbipd-win é¡¹ç›®çš„æœ€æ–°å‘å¸ƒé¡µé¢](https://github.com/dorssel/usbipd-win/releases)ã€‚\n2. é€‰æ‹© .msi æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°†ä¸‹è½½å®‰è£…ç¨‹åºã€‚ ï¼ˆä½ å¯èƒ½ä¼šæ”¶åˆ°ä¸€æ¡è­¦å‘Šï¼Œè¦æ±‚ä½ ç¡®è®¤ä½ ä¿¡ä»»æ­¤ä¸‹è½½ï¼‰ã€‚\n3. è¿è¡Œä¸‹è½½ usbipd-win_x.msi å®‰è£…ç¨‹åºæ–‡ä»¶ã€‚\n\nè¿™å°†å®‰è£…ï¼š\n- åä¸ºÂ `usbipd`Â çš„æœåŠ¡ï¼Œï¼ˆæ˜¾ç¤ºåç§°ï¼šUSBIP è®¾å¤‡ä¸»æœºï¼‰ã€‚ å¯ä»¥ä½¿ç”¨ Windows ä¸­çš„æœåŠ¡åº”ç”¨æ£€æŸ¥æ­¤æœåŠ¡çš„çŠ¶æ€ã€‚\n- å‘½ä»¤è¡Œå·¥å…·Â `usbipd`ã€‚ æ­¤å·¥å…·çš„ä½ç½®å°†æ·»åŠ åˆ° PATH ç¯å¢ƒå˜é‡ã€‚\n- åä¸ºÂ `usbipd`Â çš„é˜²ç«å¢™è§„åˆ™ï¼Œç”¨äºå…è®¸æ‰€æœ‰æœ¬åœ°å­ç½‘è¿æ¥åˆ°æœåŠ¡ã€‚ å¯ä¿®æ”¹æ­¤é˜²ç«å¢™è§„åˆ™ä»¥å¾®è°ƒè®¿é—®æ§åˆ¶ã€‚\n\n4. è‹¥è¦é™„åŠ  USB è®¾å¤‡ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚ ï¼ˆä¸å†éœ€è¦ä½¿ç”¨æå‡çš„ç®¡ç†å‘˜æç¤ºã€‚ç¡®ä¿ WSL å‘½ä»¤æç¤ºç¬¦å¤„äºæ‰“å¼€çŠ¶æ€ï¼Œä»¥ä½¿ WSL 2 è½»å‹ VM ä¿æŒæ´»åŠ¨çŠ¶æ€ã€‚ **è¯·æ³¨æ„ï¼Œåªè¦ USB è®¾å¤‡è¿æ¥åˆ° WSLï¼ŒWindows å°†æ— æ³•ä½¿ç”¨å®ƒã€‚** ä¸€æ—¦è¿æ¥åˆ° WSLï¼Œä»»ä½•åœ¨ WSL 2 ä¸Šè¿è¡Œçš„å‘è¡Œç‰ˆéƒ½å¯ä»¥ä½¿ç”¨è¯¥ USB è®¾å¤‡ã€‚ è¯·ç¡®è®¤è®¾å¤‡æ˜¯å¦å·²è¿æ¥Â `usbipd list`ã€‚ åœ¨ WSL æç¤ºç¬¦ä¸‹ï¼Œè¿è¡ŒÂ `lsusb`Â ä»¥éªŒè¯ USB è®¾å¤‡æ˜¯å¦å·²åˆ—å‡ºï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ Linux å·¥å…·ä¸ä¹‹äº¤äº’ã€‚\n\n```powershell\nusbipd attach --wsl --busid <busid>\n```\n\n5. æ‰“å¼€ Ubuntuï¼ˆæˆ–é¦–é€‰ WSL å‘½ä»¤è¡Œï¼‰ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ—å‡ºé™„åŠ çš„ USB è®¾å¤‡ï¼š\n\n```bash\nlsusb\næˆ–è€…\nlsblk -f\n```\n\nè‹¥æ²¡æœ‰æ‰¾åˆ°å‘½ä»¤ï¼Œåˆ™å…ˆä¸‹è½½`usbutils`\n![](Snipaste_2025-06-12_00-11-23.png)\n```bash\nsudo apt install usbutils\n```\n\nå¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸè¯»å–åˆ°uç›˜ï¼Œå¹¶ä¸”èƒ½å¤Ÿä½¿ç”¨æ™®é€š Linux å·¥å…·ä¸ä¹‹äº¤äº’ã€‚ æ ¹æ®åº”ç”¨ç¨‹åºï¼Œå¯èƒ½éœ€è¦é…ç½® udev è§„åˆ™ï¼Œä»¥å…è®¸éæ ¹ç”¨æˆ·è®¿é—®è®¾å¤‡ã€‚\n![](Snipaste_2025-06-12_00-18-59.png)\n6. åœ¨ WSL ä¸­ä½¿ç”¨è®¾å¤‡åï¼Œå¯ä»¥ç‰©ç†æ–­å¼€ USB è®¾å¤‡çš„è¿æ¥ï¼Œæˆ–è€…ä» PowerShell è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n\n```powershell\nusbipd detach --busid <busid>\n```\n\n\n","tags":["Linux","WSL2","USB"],"categories":["Linux","WSL2"]},{"title":"Ubuntuæ–‡ä»¶ç³»ç»Ÿç»“æ„","url":"/posts/7417/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\nUbuntuæ–‡ä»¶ç³»ç»Ÿç»“æ„æ¸…å•ã€‚\n<!--more-->\n\n> ä¸‡ç‰©çš†æ–‡ä»¶\n\n**ä»…ä½œå­¦ä¹ è®°å½•ã€‚**\n\n| ç›®å½•          | è¯´æ˜                                                  |\n| ----------- | --------------------------------------------------- |\n| `/`         | æ ¹ç›®å½•ï¼Œæ˜¯æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„èµ·ç‚¹ã€‚                                    |\n| `/bin`[^1]  | å­˜æ”¾ç³»ç»Ÿå¯åŠ¨å’Œè¿è¡Œæ‰€éœ€çš„åŸºæœ¬å‘½ä»¤ï¼ˆå¦‚ `ls`, `cp`, `mv`ï¼‰ã€‚               |\n| `/boot`     | å¯åŠ¨ç›¸å…³æ–‡ä»¶ï¼Œå¦‚å†…æ ¸ (`vmlinuz`)ã€å¼•å¯¼åŠ è½½å™¨é…ç½®ç­‰ã€‚                    |\n| `/dev`      | åŒ…å«æ‰€æœ‰è®¾å¤‡ï¼ˆé©±åŠ¨ï¼‰æ–‡ä»¶ï¼ˆå¦‚ç¡¬ç›˜ã€ç»ˆç«¯ã€USB è®¾å¤‡ï¼‰ã€‚                        |\n| `/etc`      | ç³»ç»Ÿé…ç½®æ–‡ä»¶ç›®å½•ï¼ˆå¦‚ç½‘ç»œã€ç”¨æˆ·ã€æœåŠ¡é…ç½®ï¼‰ã€‚                              |\n| `/home`     | æ¯ä¸ªæ™®é€šç”¨æˆ·çš„ä¸»ç›®å½•ï¼ˆå¦‚ `/home/alice`ï¼‰ã€‚                        |\n| `/lib`      | å­˜æ”¾ç³»ç»Ÿç¨‹åºæ‰€éœ€çš„å…±äº«åº“æ–‡ä»¶ã€‚                                     |\n| `/lib64`    | å­˜æ”¾64ä½ç³»ç»Ÿçš„å…±äº«åº“ï¼ˆä¸ `/lib` ç±»ä¼¼ï¼‰ã€‚                           |\n| `/media`    | å¯ç§»åŠ¨è®¾å¤‡æŒ‚è½½ç‚¹ï¼ˆå¦‚Uç›˜ã€CD-ROMï¼‰ã€‚                               |\n| `/mnt`      | ä¸´æ—¶æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•ï¼Œä¾›ç®¡ç†å‘˜ä½¿ç”¨ã€‚                                 |\n| `/opt`      | ä¸ºç¬¬ä¸‰æ–¹è½¯ä»¶æä¾›å®‰è£…ä½ç½®ã€‚                                       |\n| `/proc`     | è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œå†…æ ¸å’Œè¿›ç¨‹ä¿¡æ¯ä»¥æ–‡ä»¶å½¢å¼å±•ç°ï¼ˆå¦‚ `/proc/cpuinfo`ï¼‰ã€‚å­˜æ”¾ç³»ç»Ÿè¿è¡Œçš„ä¿¡æ¯ï¼Ÿ |\n| `/root`     | `root` ç”¨æˆ·çš„ä¸»ç›®å½•ï¼ˆæ³¨æ„ï¼šä¸æ˜¯ `/`ï¼‰ã€‚                           |\n| `/run`      | å­˜æ”¾è¿è¡Œæ—¶æ•°æ®ï¼Œå¦‚ç³»ç»Ÿå¯åŠ¨åç”Ÿæˆçš„PIDæ–‡ä»¶æˆ–Socketæ–‡ä»¶ã€‚                    |\n| `/sbin`     | å­˜æ”¾ç³»ç»Ÿç®¡ç†ç±»å‘½ä»¤ï¼Œä»…ä¾› `root` ç”¨æˆ·ä½¿ç”¨ï¼ˆå¦‚ `reboot`, `fsck`ï¼‰ã€‚       |\n| `/srv`      | å­˜æ”¾æä¾›æœåŠ¡çš„æ•°æ®ï¼ˆå¦‚ç½‘ç«™ã€FTP æœåŠ¡å™¨æ•°æ®ï¼‰ã€‚                           |\n| `/sys`      | è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œè¡¨ç¤ºå†…æ ¸è®¾å¤‡ç»“æ„ï¼Œä¾› `udev` å’Œå…¶ä»–å·¥å…·ä½¿ç”¨ã€‚                   |\n| `/tmp`      | å­˜æ”¾ä¸´æ—¶æ–‡ä»¶ï¼ˆç³»ç»Ÿé‡å¯åæ¸…ç©ºï¼‰ã€‚                                    |\n| `/usr`      | å¤šæ•°ç”¨æˆ·ç©ºé—´ç¨‹åºå’Œåº“çš„å®‰è£…ç›®å½•ã€‚                                    |\n| `/usr/bin`  | éå¿…è¦åŸºæœ¬å‘½ä»¤ï¼ˆå¤§éƒ¨åˆ†ç”¨æˆ·ç¨‹åºï¼‰çš„ä½ç½®ã€‚                                |\n| `/usr/sbin` | ç³»ç»Ÿç®¡ç†å‘½ä»¤çš„ä½ç½®ï¼Œä¾›ç®¡ç†å‘˜ä½¿ç”¨ã€‚                                   |\n| `/usr/lib`  | `/usr/bin` å’Œ `/usr/sbin` ç¨‹åºæ‰€ç”¨åº“æ–‡ä»¶ã€‚                   |\n| `/var`      | å¯å˜æ•°æ®æ–‡ä»¶ï¼ˆå¦‚æ—¥å¿—ã€ç¼“å­˜ã€é‚®ä»¶ã€æ•°æ®åº“æ–‡ä»¶ç­‰ï¼‰ã€‚                           |\n\n[^1]:Faker VS Bin ä½ è¹²æˆ‘çš„æ„æ€å—\n","tags":["Linux","Ubuntu","æ–‡ä»¶ç³»ç»Ÿ"],"categories":["Linux","å…¥é—¨"]},{"title":"Linuxå¸¸ç”¨çš„å‘½ä»¤æ€»ç»“","url":"/posts/37616/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\nLinuxä¸‹å¸¸ç”¨çš„å‘½ä»¤æ¸…å•åŠè¡¥å……ã€‚\n<!--more-->\n\n**ä»…ä½œå­¦ä¹ è®°å½•ã€‚**\n\n| å‘½ä»¤         | è¯´æ˜                 | ä½¿ç”¨æ ¼å¼                   |\n| ---------- | ------------------ | ---------------------- |\n| `ls`       | åˆ—å‡ºç›®å½•å†…å®¹             | `ls [é€‰é¡¹] [ç›®å½•]`         |\n| `cd`       | æ”¹å˜å½“å‰ç›®å½•             | `cd [ç›®å½•]`              |\n| `pwd`      | æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•           | `pwd`                  |\n| `cp`       | å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•            | `cp [é€‰é¡¹] æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶`     |\n| `mv`       | ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•ï¼Œé‡å‘½åæ–‡ä»¶      | `mv [é€‰é¡¹] æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶`     |\n| `rm`       | åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•            | `rm [é€‰é¡¹] æ–‡ä»¶`           |\n| `touch`    | åˆ›å»ºç©ºæ–‡ä»¶              | `touch æ–‡ä»¶å`            |\n| `mkdir`    | åˆ›å»ºç›®å½•               | `mkdir [é€‰é¡¹] ç›®å½•å`       |\n| `rmdir`    | åˆ é™¤ç©ºç›®å½•              | `rmdir ç›®å½•å`            |\n| `chmod`    | æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•æƒé™          | `chmod [é€‰é¡¹] æƒé™ æ–‡ä»¶`     |\n| `chown`    | æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…        | `chown ç”¨æˆ·:ç»„ æ–‡ä»¶`        |\n| `chgrp`    | æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç»„        | `chgrp ç»„ æ–‡ä»¶`           |\n| `cat`      | æŸ¥çœ‹æ–‡ä»¶å†…å®¹             | `cat æ–‡ä»¶å`              |\n| `more`     | åˆ†é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹           | `more æ–‡ä»¶å`             |\n| `less`     | åˆ†é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼ˆæ”¯æŒä¸Šä¸‹ç¿»é¡µï¼‰   | `less æ–‡ä»¶å`             |\n| `head`     | æŸ¥çœ‹æ–‡ä»¶å¼€å¤´éƒ¨åˆ†           | `head [é€‰é¡¹] æ–‡ä»¶`         |\n| `tail`     | æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨éƒ¨åˆ†           | `tail [é€‰é¡¹] æ–‡ä»¶`         |\n| `find`     | æŸ¥æ‰¾æ–‡ä»¶æˆ–ç›®å½•            | `find [è·¯å¾„] [é€‰é¡¹] [è¡¨è¾¾å¼]` |\n| `grep`     | æ–‡æœ¬æœç´¢               | `grep [é€‰é¡¹] \"æ¨¡å¼\" æ–‡ä»¶`    |\n| `tar`      | å‹ç¼©æˆ–è§£å‹æ–‡ä»¶            | `tar [é€‰é¡¹] [æ–‡ä»¶]`        |\n| `gzip`     | å‹ç¼©æ–‡ä»¶               | `gzip æ–‡ä»¶å`             |\n| `gunzip`   | è§£å‹.gzæ–‡ä»¶            | `gunzip æ–‡ä»¶å.gz`        |\n| `zip`      | å‹ç¼©æ–‡ä»¶               | `zip [é€‰é¡¹] å‹ç¼©åŒ… æ–‡ä»¶`      |\n| `unzip`    | è§£å‹.zipæ–‡ä»¶           | `unzip å‹ç¼©åŒ…`            |\n| `df`       | æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µ     | `df [é€‰é¡¹]`              |\n| `du`       | æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶çš„ç£ç›˜ä½¿ç”¨æƒ…å†µ     | `du [é€‰é¡¹] æ–‡ä»¶/ç›®å½•`        |\n| `top`      | æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹çŠ¶æ€           | `top`                  |\n| `ps`       | æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€             | `ps [é€‰é¡¹]`              |\n| `kill`     | ç»ˆæ­¢è¿›ç¨‹               | `kill [é€‰é¡¹] è¿›ç¨‹å·`        |\n| `pstree`   | ä»¥æ ‘å½¢ç»“æ„æ˜¾ç¤ºè¿›ç¨‹          | `pstree`               |\n| `free`     | æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ           | `free [é€‰é¡¹]`            |\n| `uname`    | æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯             | `uname [é€‰é¡¹]`           |\n| `ifconfig` | é…ç½®ç½‘ç»œæ¥å£             | `ifconfig [ç½‘ç»œæ¥å£]`      |\n| `ip`       | æŸ¥çœ‹æˆ–é…ç½®ç½‘ç»œ            | `ip [é€‰é¡¹]`              |\n| `ping`     | æµ‹è¯•ç½‘ç»œè¿æ¥             | `ping [é€‰é¡¹] åœ°å€`         |\n| `scp`      | å®‰å…¨å¤åˆ¶æ–‡ä»¶             | `scp æºæ–‡ä»¶ ç”¨æˆ·@ä¸»æœº:ç›®æ ‡`     |\n| `rsync`    | åŒæ­¥æ–‡ä»¶å’Œç›®å½•            | `rsync [é€‰é¡¹] æº ç›®æ ‡`      |\n| `wget`     | ä»ç½‘ç»œä¸‹è½½æ–‡ä»¶            | `wget [é€‰é¡¹] URL`        |\n| `curl`     | ä¸ç½‘ç»œäº¤äº’ï¼ˆä¸‹è½½ã€ä¸Šä¼ æ–‡ä»¶ç­‰ï¼‰    | `curl [é€‰é¡¹] URL`        |\n| `alias`    | åˆ›å»ºå‘½ä»¤åˆ«å             | `alias åˆ«å='å‘½ä»¤'`        |\n| `history`  | æŸ¥çœ‹å‘½ä»¤å†å²             | `history`              |\n| `man`      | æŸ¥çœ‹å‘½ä»¤æ‰‹å†Œ             | `man å‘½ä»¤å`              |\n| `echo`     | è¾“å‡ºå­—ç¬¦ä¸²åˆ°ç»ˆç«¯           | `echo \"æ–‡æœ¬\"`            |\n| `tee`      | ä»æ ‡å‡†è¾“å…¥è¯»å–ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºåˆ°æ–‡ä»¶ | `å‘½ä»¤ \\| tee æ–‡ä»¶`         |\n| `cut`      | æŒ‰åˆ—åˆ‡å‰²æ–‡ä»¶å†…å®¹           | `cut -d åˆ†éš”ç¬¦ -f åˆ— æ–‡ä»¶`   |\n| `awk`      | å¼ºå¤§çš„æ–‡æœ¬å¤„ç†å·¥å…·          | `awk 'æ¡ä»¶ {åŠ¨ä½œ}' æ–‡ä»¶`     |\n| `sed`      | æµç¼–è¾‘å™¨ï¼Œå¤„ç†æ–‡æœ¬æ•°æ®        | `sed 's/æ¨¡å¼/æ›¿æ¢æ–‡æœ¬/' æ–‡ä»¶`  |\n| `tr`       | è½¬æ¢å­—ç¬¦               | `tr 'æ—§å­—ç¬¦' 'æ–°å­—ç¬¦' < æ–‡ä»¶`  |\n| `wc`       | ç»Ÿè®¡æ–‡ä»¶å­—æ•°ã€è¡Œæ•°ã€å­—èŠ‚æ•°ç­‰     | `wc [é€‰é¡¹] æ–‡ä»¶`           |\n| `whoami`   | æŸ¥çœ‹å½“å‰ç”¨æˆ·             | `whoami`               |\n| `sudo`     | ä»¥è¶…çº§ç”¨æˆ·èº«ä»½æ‰§è¡Œå‘½ä»¤        | `sudo å‘½ä»¤`              |\n| `exit`     | é€€å‡ºç»ˆç«¯æˆ–å½“å‰Shellä¼šè¯     | `exit`                 |\n| `file`     | æ–‡ä»¶ç±»å‹æŸ¥çœ‹å‘½ä»¤           |  `file æ–‡ä»¶è·¯å¾„`           |\n\n## ls\n-a åˆ—å‡ºå…¨éƒ¨\n-l ä»¥åˆ—å±•ç¤º\n\n## ranger\nä¸€ä¸ªç»ˆç«¯æ–‡ä»¶ç®¡ç†å™¨ï¼ˆVimé£æ ¼ï¼‰\n\n| æ“ä½œ        | å¿«æ·é”®                |\n| --------- | ------------------ |\n| å‘ä¸Š/å‘ä¸‹     | æ–¹å‘é”®                |\n| è¿›å…¥ç›®å½•æˆ–æ‰“å¼€æ–‡ä»¶ | `l / Enter`        |\n| è¿”å›ä¸Šä¸€çº§ç›®å½•   | æ–¹å‘é”®                |\n| åˆ›å»ºæ–°æ–‡ä»¶     | `:touch filename`  |\n| åˆ›å»ºæ–°ç›®å½•     | `:mkdir dirname`   |\n| åˆ é™¤æ–‡ä»¶/ç›®å½•   | `D` ç„¶åç¡®è®¤           |\n| é‡å‘½å       | `cw`               |\n| å¤åˆ¶        | `yy`ï¼ˆå¤åˆ¶ï¼‰+ `pp`ï¼ˆç²˜è´´ï¼‰ |\n| å‰ªåˆ‡        | `dd`ï¼ˆå‰ªåˆ‡ï¼‰+ `pp`ï¼ˆç²˜è´´ï¼‰ |\n| é¢„è§ˆæ–‡ä»¶å†…å®¹    | è‡ªåŠ¨æˆ–æŒ‰ `i`           |\n| æœç´¢æ–‡ä»¶å     | `/å…³é”®è¯`             |\n| é€€å‡º        | `q` æˆ– `:q`         |\n\n## grep\n\n`grep`Â æ˜¯ Linux ç³»ç»Ÿä¸­ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œç”¨äºåœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶æ‰“å°åŒ¹é…çš„è¡Œã€‚å®ƒçš„åå­—æ¥æºäº \"Global Regular Expression Print\"ã€‚\n### åŸºæœ¬è¯­æ³•\n\n`grep [é€‰é¡¹] \"æœç´¢å†…å®¹\" æ–‡ä»¶å`\n\n### å¸¸ç”¨é€‰é¡¹\n\n1. **`-i`**ï¼šå¿½ç•¥å¤§å°å†™ã€‚\n\n    `grep -i \"hello\" file.txt`\n    - åŒ¹é…Â `hello`ã€`HELLO`Â ç­‰ã€‚\n    \n2. **`-n`**ï¼šæ˜¾ç¤ºåŒ¹é…è¡Œçš„è¡Œå·ã€‚\n\n    `grep -n \"hello\" file.txt`\n    - è¾“å‡ºåŒ¹é…è¡ŒåŠå…¶è¡Œå·ã€‚\n    \n3. **`-v`**ï¼šåå‘åŒ¹é…ï¼Œæ˜¾ç¤ºä¸åŒ…å«æœç´¢å†…å®¹çš„è¡Œã€‚\n    \n    `grep -v \"hello\" file.txt`\n    \n4. **`-c`**ï¼šä»…æ˜¾ç¤ºåŒ¹é…çš„è¡Œæ•°ã€‚\n    \n    `grep -c \"hello\" file.txt`\n    \n5. **`-r`Â æˆ–Â `-R`**ï¼šé€’å½’æœç´¢ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚\n    \n    `grep -r \"hello\" /path/to/directory`\n    \n6. **`-l`**ï¼šä»…æ˜¾ç¤ºåŒ…å«åŒ¹é…å†…å®¹çš„æ–‡ä»¶åã€‚\n    \n    `grep -l \"hello\" *.txt`\n    \n7. **`-w`**ï¼šåŒ¹é…æ•´ä¸ªå•è¯ã€‚\n    \n    `grep -w \"hello\" file.txt`\n    \n8. **`-A`Â å’ŒÂ `-B`**ï¼šæ˜¾ç¤ºåŒ¹é…è¡Œçš„ä¸Šä¸‹æ–‡ã€‚\n    \n    - **`-A`**ï¼šæ˜¾ç¤ºåŒ¹é…è¡Œåé¢çš„è‹¥å¹²è¡Œã€‚\n        `grep -A 2 \"hello\" file.txt`\n        \n    - **`-B`**ï¼šæ˜¾ç¤ºåŒ¹é…è¡Œå‰é¢çš„è‹¥å¹²è¡Œã€‚\n        `grep -B 2 \"hello\" file.txt`\n        \n    - **`-C`**ï¼šåŒæ—¶æ˜¾ç¤ºåŒ¹é…è¡Œçš„å‰åè‹¥å¹²è¡Œã€‚\n        `grep -C 2 \"hello\" file.txt`\n        \n\n### æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒ\n\n`grep`Â æ”¯æŒåŸºæœ¬æ­£åˆ™è¡¨è¾¾å¼ï¼ˆBREï¼‰å’Œæ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼ˆEREï¼Œéœ€ä½¿ç”¨Â `egrep`Â æˆ–Â `grep -E`ï¼‰ã€‚\n\n- **åŒ¹é…ä»»æ„å­—ç¬¦**ï¼š`grep \"h.llo\" file.txt`Â åŒ¹é…Â `hello`ã€`hallo`Â ç­‰ã€‚\n- **åŒ¹é…å¼€å¤´**ï¼š`grep \"^hello\" file.txt`Â åŒ¹é…ä»¥Â `hello`Â å¼€å¤´çš„è¡Œã€‚\n- **åŒ¹é…ç»“å°¾**ï¼š`grep \"hello$\" file.txt`Â åŒ¹é…ä»¥Â `hello`Â ç»“å°¾çš„è¡Œã€‚\n- **åŒ¹é…å¤šä¸ªé€‰é¡¹**ï¼š`grep -E \"hello|world\" file.txt`Â åŒ¹é…Â `hello`Â æˆ–Â `world`ã€‚\n\n### å®ä¾‹\n\n1. æŸ¥æ‰¾æ–‡ä»¶ä¸­åŒ…å« \"error\" çš„è¡Œå¹¶æ˜¾ç¤ºè¡Œå·ï¼š\n\n    `grep -n \"error\" log.txt`\n    \n2. åœ¨å½“å‰ç›®å½•åŠå­ç›®å½•ä¸­æŸ¥æ‰¾åŒ…å« \"TODO\" çš„æ–‡ä»¶ï¼š\n\n    `grep -r \"TODO\" .`\n    \n3. æŸ¥æ‰¾ä»¥ \"INFO\" å¼€å¤´çš„æ—¥å¿—è¡Œï¼š\n\n    `grep \"^INFO\" log.txt`\n    \n4. æŸ¥æ‰¾ä¸åŒ…å« \"DEBUG\" çš„è¡Œï¼š\n\n    `grep -v \"DEBUG\" log.txt`\n\n## du\n-s åªæ˜¾ç¤ºæŒ‡å®šç›®å½•æ€»å¤§å° \n-h ä»¥å•ä½kã€mã€gæ˜¾ç¤º\n\n## tar\n\n`tarÂ [é€‰é¡¹] -f å½’æ¡£æ–‡ä»¶å [æ–‡ä»¶æˆ–ç›®å½•]`\n### é€‰é¡¹ï¼š\n- -cï¼šåˆ›å»ºæ–°çš„å½’æ¡£æ–‡ä»¶ã€‚\n- -xï¼šè§£å‹å½’æ¡£æ–‡ä»¶ã€‚\n- -tï¼šåˆ—å‡ºå½’æ¡£æ–‡ä»¶çš„å†…å®¹ã€‚\n- -vï¼šæ˜¾ç¤ºè¯¦ç»†æ“ä½œè¿‡ç¨‹ã€‚\n- -zï¼šä½¿ç”¨ gzip å‹ç¼©æˆ–è§£å‹ã€‚\n- -jï¼šä½¿ç”¨ bzip2 å‹ç¼©æˆ–è§£å‹ã€‚\n- -Jï¼šä½¿ç”¨ xz å‹ç¼©æˆ–è§£å‹ã€‚\n- --deleteï¼šä»å½’æ¡£æ–‡ä»¶ä¸­åˆ é™¤æŒ‡å®šæ–‡ä»¶ï¼ˆä»…é™ GNU tarï¼‰ã€‚\n\n### å¸¸è§æ“ä½œç¤ºä¾‹ï¼š\n\n1. **åˆ›å»ºå½’æ¡£æ–‡ä»¶**\n\n\tå°†æ–‡ä»¶Â _file1_Â å’ŒÂ _file2_Â ä»¥åŠç›®å½•Â _dir_Â æ‰“åŒ…æˆÂ _archive.tar_ï¼š\n\t`tarÂ -cvf archive.tarÂ file1 file2Â dir`\n\n2. **è§£å‹å½’æ¡£æ–‡ä»¶**\n\n\tè§£å‹Â _archive.tar_Â åˆ°å½“å‰ç›®å½•ï¼š\n\t`tarÂ -xvf archive.tar`\n\n3. **å‹ç¼©å½’æ¡£æ–‡ä»¶**\n\n\tå°†ç›®å½•Â _dir_Â æ‰“åŒ…å¹¶ä½¿ç”¨ gzip å‹ç¼©ä¸ºÂ _archive.tar.gz_ï¼š\n\t`tarÂ -czvf archive.tar.gzÂ dir`\n\n4. **è§£å‹å‹ç¼©å½’æ¡£æ–‡ä»¶**\n\n\tè§£å‹Â _archive.tar.gz_ï¼š\n\t`tarÂ -zxvf archive.tar.gz`\n\n5. **åˆ—å‡ºå½’æ¡£æ–‡ä»¶å†…å®¹**\n\n\tæŸ¥çœ‹Â _archive.tar_Â ä¸­çš„æ–‡ä»¶å’Œç›®å½•ï¼š\n\t`tarÂ -tvf archive.tar`\n\n6. **å‘å½’æ¡£æ–‡ä»¶è¿½åŠ æ–‡ä»¶**\n\n\tå°†Â _newfile_Â æ·»åŠ åˆ°å·²å­˜åœ¨çš„Â _archive.tar_Â ä¸­ï¼š\n\t`tarÂ -rvf archive.tarÂ newfile`\n\n7. **åˆ é™¤å½’æ¡£æ–‡ä»¶ä¸­çš„æ–‡ä»¶**\n\n\tä»Â _archive.tar_Â ä¸­åˆ é™¤Â _file1_ï¼š\n\t`tarÂ --delete -f archive.tarÂ file1`\n\n8. **è§£å‹åˆ°æŒ‡å®šç›®å½•**\n\n\tå°†Â _archive.tar.gz_Â è§£å‹åˆ°Â _/tmp/files_Â ç›®å½•ï¼š\n\t`tarÂ -zxvf archive.tar.gz -C /tmp/files`\n\n### **æ³¨æ„äº‹é¡¹**\n\n- ä½¿ç”¨Â _-v_Â å¯ä»¥æŸ¥çœ‹è¯¦ç»†çš„æ“ä½œè¿‡ç¨‹ã€‚ \n- è§£å‹æ—¶ï¼Œ_-C_Â é€‰é¡¹å¯ä»¥æŒ‡å®šç›®æ ‡ç›®å½•ã€‚\n- å‹ç¼©æ—¶ï¼Œå»ºè®®æ ¹æ®æ–‡ä»¶ç±»å‹é€‰æ‹©åˆé€‚çš„å‹ç¼©ç®—æ³•ï¼ˆå¦‚ gzipã€bzip2 æˆ– xzï¼‰ã€‚\n\n## dd\n\n### dd å‘½ä»¤ç®€ä»‹\n\n`dd` æ˜¯ Linux å’Œç±» UNIX ç³»ç»Ÿä¸­ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸»è¦ç”¨äºä½çº§åˆ«çš„æ•°æ®å¤åˆ¶å’Œè½¬æ¢æ“ä½œã€‚å®ƒå¯ä»¥å¤„ç†è®¾å¤‡æ–‡ä»¶ã€ç£ç›˜ã€åˆ†åŒºã€æ–‡ä»¶ç­‰ï¼Œå¸¸ç”¨äºå¤‡ä»½ã€æ¢å¤ã€åˆ›å»ºç£ç›˜é•œåƒç­‰ä»»åŠ¡ã€‚\n\n`dd if=<è¾“å…¥æ–‡ä»¶> of=<è¾“å‡ºæ–‡ä»¶> [å‚æ•°...]`\n\n- **if**ï¼šæŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼ˆinput fileï¼‰ï¼Œå¦‚ `/dev/zero`ã€ç£ç›˜è®¾å¤‡æˆ–æ™®é€šæ–‡ä»¶ã€‚\n- **of**ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼ˆoutput fileï¼‰ï¼Œå¦‚ç£ç›˜è®¾å¤‡æˆ–æ™®é€šæ–‡ä»¶ã€‚\n- **å‚æ•°**ï¼šç”¨äºæ§åˆ¶å—å¤§å°ã€æ•°æ®é‡ç­‰ã€‚\n### å¸¸ç”¨å‚æ•°\n\n- **bs=å¤§å°**ï¼šè®¾ç½®å—å¤§å°ï¼ˆå¦‚ `bs=1M` è¡¨ç¤ºæ¯æ¬¡è¯»å†™ 1MB æ•°æ®ï¼‰ã€‚\n- **count=æ•°é‡**ï¼šæŒ‡å®šå¤åˆ¶çš„å—æ•°ã€‚\n- **skip=æ•°é‡**ï¼šè·³è¿‡è¾“å…¥æ–‡ä»¶çš„å‰è‹¥å¹²å—ã€‚\n- **seek=æ•°é‡**ï¼šè·³è¿‡è¾“å‡ºæ–‡ä»¶çš„å‰è‹¥å¹²å—ã€‚\n- **status=progress**ï¼šæ˜¾ç¤ºè¿›åº¦ä¿¡æ¯ã€‚\n\n### å¸¸è§ç”¨æ³•\n\n1. **åˆ›å»ºç©ºæ–‡ä»¶**\n    \n    `dd if=/dev/zero of=empty_file bs=1M count=10`\n    \n    - åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 10MB çš„ç©ºæ–‡ä»¶ã€‚\n2. **åˆ¶ä½œç£ç›˜é•œåƒ**\n        \n    `dd if=/dev/sda of=/path/to/image.img bs=1M`\n    \n    - å°†æ•´ä¸ªç£ç›˜ `/dev/sda` åˆ¶ä½œæˆé•œåƒæ–‡ä»¶ã€‚\n3. **æ¢å¤ç£ç›˜é•œåƒ**\n    \n    `dd if=/path/to/image.img of=/dev/sda bs=1M`\n    \n    - å°†é•œåƒæ–‡ä»¶å†™å›ç£ç›˜ã€‚\n4. **æ¸…ç©ºç£ç›˜æ•°æ®**\n        \n    `dd if=/dev/zero of=/dev/sda bs=1M`\n    \n    - ç”¨é›¶å¡«å……æ•´ä¸ªç£ç›˜ `/dev/sda`ï¼Œæ¸…ç©ºæ•°æ®ã€‚\n5. **æµ‹è¯•ç£ç›˜è¯»å†™é€Ÿåº¦**\n    \n    `dd if=/dev/zero of=testfile bs=1G count=1 oflag=direct`\n    \n    - åˆ›å»ºä¸€ä¸ª 1GB çš„æ–‡ä»¶ï¼Œæµ‹è¯•å†™å…¥é€Ÿåº¦ã€‚\n\n### æ³¨æ„äº‹é¡¹\n\n- `dd` æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†æ“ä½œä¸å½“å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œå°¤å…¶æ˜¯æ¶‰åŠç£ç›˜è®¾å¤‡æ—¶ï¼Œè¯·åŠ¡å¿…ç¡®è®¤è¾“å…¥å’Œè¾“å‡ºè·¯å¾„ã€‚\n- ä½¿ç”¨ `status=progress` å‚æ•°å¯ä»¥å®æ—¶æŸ¥çœ‹æ“ä½œè¿›åº¦ã€‚\n\n## find\n\n`find` æ˜¯ Linux ä¸­éå¸¸å¼ºå¤§çš„å‘½ä»¤ï¼Œç”¨äºåœ¨æŒ‡å®šç›®å½•ä¸‹é€’å½’æŸ¥æ‰¾æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¹¶æ”¯æŒå¤šç§æ¡ä»¶è¿‡æ»¤å’Œæ“ä½œã€‚ä»¥ä¸‹æ˜¯å®ƒçš„åŸºæœ¬ç”¨æ³•å’Œå¸¸è§ç¤ºä¾‹ï¼š\n\n### åŸºæœ¬è¯­æ³•\n\n`find [è·¯å¾„] [é€‰é¡¹] [è¡¨è¾¾å¼]`\n\n- **è·¯å¾„**ï¼šæŒ‡å®šæŸ¥æ‰¾çš„ç›®å½•ï¼ˆå¦‚ `/`, `.` è¡¨ç¤ºå½“å‰ç›®å½•ï¼‰ã€‚\n- **é€‰é¡¹**ï¼šæ§åˆ¶æŸ¥æ‰¾è¡Œä¸ºï¼ˆå¦‚æŒ‰æ–‡ä»¶åã€å¤§å°ã€æ—¶é—´ç­‰ï¼‰ã€‚\n- **è¡¨è¾¾å¼**ï¼šå®šä¹‰åŒ¹é…æ¡ä»¶æˆ–æ“ä½œï¼ˆå¦‚æ‰§è¡Œå‘½ä»¤ï¼‰ã€‚\n\n### å¸¸ç”¨é€‰é¡¹\n\n1. **æŒ‰æ–‡ä»¶åæŸ¥æ‰¾**\n\n    `find /path -name \"filename\"`\n    - åŒºåˆ†å¤§å°å†™ï¼š`-name`\n    - ä¸åŒºåˆ†å¤§å°å†™ï¼š`-iname`\n\n2. **æŒ‰æ–‡ä»¶ç±»å‹æŸ¥æ‰¾**\n\n    `find /path -type [f|d|l]`\n\n    - `f`ï¼šæ™®é€šæ–‡ä»¶\n    - `d`ï¼šç›®å½•\n    - `l`ï¼šç¬¦å·é“¾æ¥\n\n3. **æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾**\n\n    `find /path -size [+|-]N[c|k|M|G]`\n    \n    - `+N`ï¼šå¤§äº N å•ä½\n    - `-N`ï¼šå°äº N å•ä½\n    - `N`ï¼šç­‰äº N å•ä½\n    - å•ä½ï¼š`c`ï¼ˆå­—èŠ‚ï¼‰ã€`k`ï¼ˆKBï¼‰ã€`M`ï¼ˆMBï¼‰ã€`G`ï¼ˆGBï¼‰\n\n4. **æŒ‰ä¿®æ”¹æ—¶é—´æŸ¥æ‰¾**\n\n    `find /path -mtime [+|-]N`\n    \n    - `+N`ï¼šN å¤©å‰ä¿®æ”¹\n    - `-N`ï¼šN å¤©å†…ä¿®æ”¹\n    - `N`ï¼šæ­£å¥½ N å¤©å‰ä¿®æ”¹\n    - è®¿é—®æ—¶é—´ï¼š`-atime`ï¼ŒçŠ¶æ€æ›´æ”¹æ—¶é—´ï¼š`-ctime`\n\n5. **æŒ‰æƒé™æŸ¥æ‰¾**\n\n    `find /path -perm [mode]`\n    \n    - ç²¾ç¡®åŒ¹é…ï¼š`-perm 644`\n    - è‡³å°‘åŒ…å«æƒé™ï¼š`-perm -644`\n\n6. **æŒ‰ç”¨æˆ·æˆ–ç»„æŸ¥æ‰¾**\n\n    `find /path -user username find /path -group groupname`\n\n### æ‰§è¡Œæ“ä½œ\n\n1. **åˆ é™¤åŒ¹é…çš„æ–‡ä»¶**\n    \n    `find /path -name \"*.log\" -delete`\n    \n    æˆ–\n\n    `find /path -name \"*.log\" -exec rm -f {} \\;`\n    \n2. **æŸ¥æ‰¾å¹¶æ‰§è¡Œå‘½ä»¤**\n    \n    `find /path -type f -name \"*.txt\" -exec cat {} \\;`\n    \n    - `{}`ï¼šè¡¨ç¤ºå½“å‰åŒ¹é…çš„æ–‡ä»¶\n    - `\\;`ï¼šè¡¨ç¤ºå‘½ä»¤ç»“æŸ\n\n3. **æŸ¥æ‰¾å¹¶ç§»åŠ¨æ–‡ä»¶**\n    \n    `find /path -name \"*.jpg\" -exec mv {} /new/path/ \\;`\n    \n\n### ç»¼åˆç¤ºä¾‹\n\n1. æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ `.txt` æ–‡ä»¶ï¼š\n\n    `find . -name \"*.txt\"`\n    \n2. æŸ¥æ‰¾ `/var/log` ç›®å½•ä¸‹æœ€è¿‘ 7 å¤©ä¿®æ”¹çš„æ–‡ä»¶ï¼š\n\n    `find /var/log -mtime -7`\n    \n3. æŸ¥æ‰¾ `/home` ç›®å½•ä¸‹å¤§äº 100MB çš„æ–‡ä»¶ï¼š\n    \n    `find /home -size +100M`\n    \n4. æŸ¥æ‰¾ `/tmp` ç›®å½•ä¸‹æƒé™ä¸º 777 çš„æ–‡ä»¶å¹¶åˆ é™¤ï¼š\n\n    `find /tmp -perm 777 -delete`\n    ","tags":["Linux","å‘½ä»¤"],"categories":["Linux","å…¥é—¨"]},{"title":"å¦‚ä½•ä¼˜é›…çš„åœ¨winä¸Šè¿è¡ŒLinux","url":"/posts/26155/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n åœ¨ Windows å’Œ Linux ä¹‹é—´åˆ‡æ¢å¼€å‘ç¯å¢ƒæ˜¯ä¸€ä»¶è®©äººå¤´ç–¼çš„äº‹ã€‚å¹¸è¿çš„æ˜¯ï¼ŒWSLï¼ˆWindows Subsystem for Linuxï¼‰ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼š**åœ¨ Windows ä¸ŠåŸç”Ÿè¿è¡Œ Linux**ï¼Œæ— éœ€è™šæ‹Ÿæœºæˆ–åŒç³»ç»Ÿã€‚æœ¬æ–‡å°†å¸¦ä½ ä¼˜é›…åœ°å…¥é—¨ WSLï¼Œä»å®‰è£…åˆ°ä½¿ç”¨ï¼Œè®©ä½ è½»æ¾æ‹¥æœ‰åŒç³»ç»Ÿçš„å¿«ä¹è€Œä¸ç‰ºç‰²æ•ˆç‡ã€‚\n\n## ä¸€ã€WSL æ˜¯ä»€ä¹ˆï¼Ÿ\n\nWSLï¼ˆWindows Subsystem for Linuxï¼‰æ˜¯å¾®è½¯æä¾›çš„ä¸€ç§å…¼å®¹å±‚ï¼Œä½¿ä½ å¯ä»¥ç›´æ¥åœ¨ Windows ä¸Šè¿è¡Œ Linux ç”¨æˆ·ç©ºé—´ç¯å¢ƒã€‚å½“å‰ä¸»æµç‰ˆæœ¬æ˜¯ **WSL 2**ï¼Œå®ƒä½¿ç”¨è½»é‡è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œæä¾›å®Œæ•´çš„ Linux å†…æ ¸å’Œæ›´å¥½çš„æ€§èƒ½ã€‚é‚£ä¹ˆå®ƒæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ\n- Linux ã€Windowsæ–‡ä»¶å…±äº«ã€‚ä½ å¯ä»¥åœ¨Windowsçš„æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸Šå¤„ç†Linuxå­ç³»ç»Ÿçš„æ–‡ä»¶\n- å‘½ä»¤æ··ç”¨ï¼Œåœ¨Windowsé‡Œå¯ä»¥è¿è¡ŒLiunxå‘½ä»¤ï¼Œåœ¨Linuxé‡Œå¯ä»¥è¿è¡ŒWindowsç¨‹åº\n- æ˜¾å¡ç›´é€šï¼Œåœ¨AIè®­ç»ƒæ–¹é¢éå¸¸æ–¹ä¾¿\nç­‰ç­‰....\n\n## äºŒã€å‡†å¤‡å·¥ä½œ\n\n:::success\n- Windows 10ï¼ˆç‰ˆæœ¬ 2004 åŠä»¥ä¸Šï¼Œæ¨è 21H2 æˆ–æ›´é«˜ï¼‰\n- æˆ– Windows 11ï¼ˆåŸç”Ÿæ”¯æŒ WSL 2ï¼‰\n:::\næœ¬æ–‡ä»¥win11ä¸ºä¾‹ã€‚\n### å¼€å¯å¿…è¦åŠŸèƒ½\nåœ¨æœç´¢æ æœç´¢ `å¯åŠ¨æˆ–å…³é—­windowåŠŸèƒ½`\n![](Snipaste_2025-06-07_23-29-33%201.png)\nå¼€å¯å¦‚ä¸‹ä¸¤é¡¹ï¼š\n- é€‚ç”¨äºLinuxçš„Windowså­ç³»ç»Ÿ\n- è™šæ‹Ÿæœºå¹³å°\n![](Snipaste_2025-06-07_23-32-13.png)\nç„¶å**é‡å¯ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆ**ã€‚\nå¦‚æœæ˜¯win11çš„è¯é‡å¯åå¯ä»¥çœ‹åˆ°æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æœ‰ä¸ªLinux\n![](Snipaste_2025-06-07_23-36-31.png)\n## å®‰è£…Linuxå­ç³»ç»Ÿ\n\n:::warning\nwin11åŸç”Ÿæ”¯æŒWSL2ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…WSLï¼Œå¯ä»¥ç‚¹å‡»è¿™ä¸ªé“¾æ¥å®‰è£…\n[Windows Subsystem for Linux - Microsoft Apps](https://apps.microsoft.com/detail/9p9tqf7mrm4r?ocid=pdpshare&hl=en-us&gl=US)\n:::\n\nè¿™é‡Œæä¾›ä¸¤ç§æ–¹æ³•å®‰è£…WSL2ï¼š\n\n### ç›´æ¥å®‰è£…å‘è¡Œç‰ˆ\n\næ‰“å¼€ä¸‹é¢çš„é“¾æ¥ï¼š\n[æ—§ç‰ˆ WSL çš„æ‰‹åŠ¨å®‰è£…æ­¥éª¤ | Microsoft Learn](https://learn.microsoft.com/zh-cn/windows/wsl/install-manual#step-1---enable-the-windows-subsystem-for-linux)\nç›´æ¥ä¸‹è½½æƒ³è¦çš„ç³»ç»Ÿçš„å‘è¡Œç‰ˆï¼š\n![](Snipaste_2025-06-08_00-08-42.png)\n\nä¸‹è½½ä¸‹æ¥åå°†æ–‡ä»¶åç¼€æ”¹ä¸º`.zip`,è§£å‹ç¼©\n![](Snipaste_2025-06-08_00-11-46.png)\n\nè§£å‹åï¼Œé€‰æ‹©x64ç‰ˆæœ¬ï¼ŒåŒæ ·çš„æ–¹æ³•ï¼Œç»§ç»­è§£å‹\n![](Snipaste_2025-06-08_00-14-29.png)\n\nè§£å‹åï¼Œå¤åˆ¶å¦‚ä¸‹ä¸¤ä¸ªæ–‡ä»¶åˆ°ä½ æƒ³è¦å®‰è£…çš„æŒ‡å®šç›®å½•\n![](Snipaste_2025-06-08_00-14-53.png)\n\nä¾‹å¦‚æˆ‘çš„æ˜¯`E:\\Linux\\Ubuntu-24.04LTS`\n\nåœ¨ç›®å½•ä¸‹åŒå‡»è¿è¡Œexeæ–‡ä»¶ï¼Œè‡ªæ­¤å®‰è£…å®Œæˆã€‚\n![](Snipaste_2025-06-08_00-18-01.png)\n### å‘½ä»¤è¡Œå®‰è£…ï¼ˆä¸æ¨èï¼‰\n\nä¸æ¨èåŸå› å¦‚ä¸‹ï¼š\n- æ­¤æ–¹æ³•ä¸‹å®‰è£…çš„Linuxå­ç³»ç»Ÿé»˜è®¤å®‰è£…åœ¨cç›˜ï¼Œæ— æ³•æ›´æ”¹å®‰è£…è·¯å¾„ï¼Œæƒ³è¦è¿ç§»æ¯”è¾ƒéº»çƒ¦ã€‚\n- ç”±äºæœåŠ¡å™¨åŸå› ï¼Œä¸‹è½½å¾ˆæ…¢ï¼Œéœ€è¦ä¸€äº›ä¸Šç½‘æŠ€å·§æ‰èƒ½æµç•…ä¸‹è½½ã€‚\n\næ‰“å¼€cmdå‘½ä»¤æç¤ºç¬¦çª—å£ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š\n```shell\nwsl --update\nwsl --install\n```\nç­‰å¾…å®‰è£…æˆåŠŸã€‚é»˜è®¤å®‰è£…Ubuntuç³»ç»Ÿã€‚\nä¹Ÿå¯ä»¥æŒ‡å®šç‰ˆæœ¬\nè¾“å…¥\n```shell\nwsl --list --online\n```\nå¯ä»¥æŸ¥çœ‹å½“å‰å¯å®‰è£…çš„å‘è¡Œç‰ˆã€‚\n![](Snipaste_2025-06-08_00-01-29%201.png)\næ¯”å¦‚å®‰è£…Debianï¼Œç›´æ¥è¾“å…¥\n```shell\nwsl --install Debian\n```\nç­‰å¾…å®‰è£…å®Œæˆå³å¯ã€‚\n\n**å®‰è£…å®Œæˆåæç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œæ³¨æ„å¯†ç è¾“å…¥æ˜¯ä¸æ˜¾ç¤ºçš„ã€‚**\n\n\n### å¼€å§‹ä½¿ç”¨\nğŸ’¡å¦‚æœä½ çš„ç”µè„‘åªæœ‰é‚£ç§ä¸‘ä¸‘çš„ç®€é™‹çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥åœ¨å¾®è½¯å•†åº—ä¸‹è½½ä¸€ä¸ª`Windows Terminal Preview`è·å¾—æ›´å¥½çš„ä½“éªŒ\n![](Snipaste_2025-06-08_00-21-38.png)\n\n### å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥\n| å‘½ä»¤                                     | åŠŸèƒ½                |\n| -------------------------------------- | ----------------- |\n| `wsl`                                  | å¯åŠ¨é»˜è®¤ Linux å‘è¡Œç‰ˆ    |\n| `wsl -l -v`                            | æŸ¥çœ‹å·²å®‰è£…çš„å‘è¡Œç‰ˆå’Œ WSL ç‰ˆæœ¬ |\n| `wsl --set-version <å‘è¡Œç‰ˆ> 2`            | å°†æŒ‡å®šå‘è¡Œç‰ˆå‡çº§åˆ° WSL 2   |\n| `wsl --set-default-version 2`          | è®¾ç½®é»˜è®¤å¯åŠ¨Linuxç‰ˆæœ¬     |\n| `wsl -d <å‘è¡Œç‰ˆ>`                         | å¯åŠ¨æŒ‡å®šå‘è¡Œç‰ˆ           |\n| `wsl --shutdown`                       | å…³é—­æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ WSL å®ä¾‹  |\n| `wsl --unregister <å‘è¡Œç‰ˆ>`               | å¸è½½å‘è¡Œç‰ˆ             |\n| `wsl --export Ubuntu ubuntu.tar`       | å¯¹å­ç³»ç»Ÿè¿›è¡Œå¤‡ä»½ä¸æ¢å¤ ã€å¯¼å‡ºã€‘  |\n| `wsl --import <è‡ªå®šä¹‰å> <ç›®æ ‡è·¯å¾„> <.taræºè·¯å¾„>` | å¯¹å­ç³»ç»Ÿè¿›è¡Œè¯»å–/æ¢å¤Â  ã€å¯¼å…¥ã€‘ |\n## å¯åŠ¨\nå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå¯åŠ¨ï¼ˆè§ä¸Šè¡¨ï¼‰ä¹Ÿå¯åœ¨`Windows Terminal Preview`ä¸‹ç›´æ¥ç‚¹å‡»\n![](Snipaste_2025-06-08_00-26-24.png)\nå³å¯æ‰“å¼€~\n\n## æ¢æº\nè¿™é‡Œä½¿ç”¨æ¸…åæº\n[ubuntu | é•œåƒç«™ä½¿ç”¨å¸®åŠ© | æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ | Tsinghua Open Source Mirror](https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/)\næœ‰è¯¦ç»†çš„ä½¿ç”¨ä»‹ç»ï¼Œæ ¹æ®è‡ªå·±çš„ç‰ˆæœ¬é€‰æ‹©æ–‡ä»¶è·¯å¾„ä»¥åŠæ ¼å¼å¤åˆ¶ç²˜è´´å³å¯ï¼Œä»¥Ubuntu24.04ä¸ºä¾‹ï¼š\nä½¿ç”¨å‘½ä»¤\n```shell\nsudo nano /etc/apt/sources.list.d/ubuntu.sources\n```\nè¿›å…¥ç¼–è¾‘é¡µé¢åï¼Œå…ˆæŠŠåŸæ¥çš„é…ç½®æºåˆ é™¤ï¼Œå†ç²˜è´´ã€‚\n![](Snipaste_2025-06-08_13-50-00.png)\nç„¶åæŒ‰`Ctrl+O` `Enter` `Ctrl+x`é€€å‡º ï¼ˆ\"^\"æŒ‡Ctrl \"M\"æŒ‡Altï¼‰\né€€å‡ºåä½¿ç”¨å‘½ä»¤ \n```shell\nsudo apt update\n```\næ›´æ–°è½¯ä»¶åŒ…æ•°æ®åº“ã€‚\næœ€åä½¿ç”¨\n```shell\nsudo apt upgrade\n```\nå‡çº§è½¯ä»¶åŒ…ã€‚\n\n## é€€å‡ºç³»ç»Ÿ\n`Windows Terminal Preview`ä¸‹ï¼Œç›´æ¥å‰æ‰Linuxå‘½ä»¤è¡Œçª—å£å³å¯é€€å‡º\næˆ–åœ¨Linuxå‘½ä»¤è¡Œçª—å£ç›´æ¥ä½¿ç”¨å‘½ä»¤\n```shell\nexit\n```\næ¨å‡ºåç­‰å¾…å‡ ç§’å¯ä»¥è¾“å…¥\n```shell\nwsl -l -v\n```\næŸ¥çœ‹LiunxçŠ¶æ€ï¼šæ˜¯åœæ­¢\n![](Snipaste_2025-06-08_14-16-16.png)\nè¿˜å¯ä»¥ä½¿ç”¨ \n```shell\nwsl --shutdown\n```\nä¸€æ¬¡æ€§å…³é—­æ‰€æœ‰è¿è¡Œçš„å®ä¾‹ã€‚\n## å¸è½½ç³»ç»Ÿ\nä½¿ç”¨å‘½ä»¤\n```shell\nwsl --unregister <å‘è¡Œç‰ˆå>\n```\nå³å¯å¸è½½\n\n## C/C++ ç¯å¢ƒæ­å»º\n\næ¯”è¾ƒç®€å•ï¼Œé»˜è®¤çš„ Ubuntu è½¯ä»¶æºåŒ…å«äº†ä¸€ä¸ªè½¯ä»¶åŒ…ç»„ï¼Œåç§°ä¸º \"build-essential\",å®ƒåŒ…å«äº† GNU ç¼–è¾‘å™¨é›†åˆï¼ŒGNU è°ƒè¯•å™¨ï¼Œå’Œå…¶ä»–ç¼–è¯‘è½¯ä»¶æ‰€å¿…éœ€çš„å¼€å‘åº“å’Œå·¥å…·ã€‚  \næƒ³è¦å®‰è£…å¼€å‘å·¥å…·è½¯ä»¶åŒ…ï¼Œç›´æ¥\n```shell\nsudo apt install build-essential\n```\néªŒè¯\n```shell\ngcc -v\ng++ -v\ngdb -v\n```\n æœ‰ä¸€ä¸ªæ²¡æœ‰çš„è¯ å•ç‹¬å®‰è£…ä¸€ä¸‹å³å¯\n```shell\n sudo apt install gdb\n```\n## æ¨èç©æ³•\n### VScodeæ’ä»¶\nä½¿ç”¨ WSL ä½œä¸ºå¼€å‘ç¯å¢ƒï¼Œç»“åˆ VS Code çš„ **Remote - WSL æ’ä»¶**ï¼Œåœ¨ Windows ä¸­ç¼–è¾‘ã€WSL ä¸­è¿è¡Œã€‚\nç›´æ¥ä¸‹è½½æ’ä»¶\n![](Snipaste_2025-06-08_14-28-45.png)\nåœ¨Linuxç»ˆç«¯æ‰“å¼€æŸä¸ªæ–‡ä»¶å¤¹ ç„¶åä½¿ç”¨å‘½ä»¤å³å¯åœ¨Linuxç¯å¢ƒä¸‹è¿è¡ŒVScode\n```shell\ncode .\n```\n\n![](Snipaste_2025-06-08_14-31-11.png)\nè¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨VScodeç»ˆç«¯è¾“å…¥Linuxå‘½ä»¤ã€‚\n![](Snipaste_2025-06-08_14-43-03.png)\n\n## æ¨èå®‰è£…\n\n`ranger`ï¼šæ–‡ä»¶ç®¡ç†å™¨\n`usbipd`ï¼šå…±äº«usb","tags":["Linux","WSL2"],"categories":["Linux","WSL2"]},{"title":"[è‡ªç”¨]16å±Šçƒ‚æ¡¥æ¯åµŒå…¥å¼èµ›é“æ¨¡å—ä»£ç æ•´ç†","url":"/posts/44982/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n##  æ—¶é—´ç‰‡è½®è¯¢è°ƒåº¦\n\n```c\n\nuint8_t TaskCount = 0;//ç”¨äºè®°å½•ä»»åŠ¡æ•°é‡\n\ntypedef enum {\n\trun,wait,stop\n}TaskStatus;//ä»»åŠ¡çŠ¶æ€\n\ntypedef struct {\n\tuint8_t TaskRunTime;\n\tuint8_t TaskTimer;\n\tTaskStatus Status;\n\tvoid (*FC)();\n}TaskStrust;//ä»»åŠ¡ä¿¡æ¯å—ï¼šæ³¨æ„ä¸¤ç‚¹1.æ³¨æ„Timerå’Œruntimeçš„æ•°æ®ç±»å‹ä¸ºucharï¼Œæœ€å¤§ä¸º255 2.æ—¶é—´ç‰‡ä¸º2ms\nTaskStrust TaskList[]={0};\n\nvoid OS_Init(TIM_HandleTypeDef* htim){\n\tHAL_TIM_Base_Start_IT(htim);\n\tTaskCount = sizeof(TaskList)/sizeof(TaskList[1]);\n\tif(TaskCount > MAX_TASK) while(1);\n}\n\nvoid OS_IT_Run(void){\n\tuint8_t i;\n\tfor(i = 0;i < TaskCount;i++){\n\t\tif(TaskList[i].Status == wait){\n\t\t\tif(++TaskList[i].TaskTimer >= TaskList[i].TaskRunTime){\n\t\t\t\tTaskList[i].TaskTimer = 0;\n\t\t\t\tTaskList[i].Status = run;\n\t\t\t}\t\t\n\t\t}\n\t}\n\n}\n//è‡ªå¸¦æ­»å¾ªç¯ï¼Œä¸»å‡½æ•°é‡Œè¿è¡Œ\nvoid OS_Run(void){\n\tuint8_t j = 0;\n\twhile(1){\n\t\tif(TaskList[j].Status == run){\n\t\t\tTaskList[j].FC();\n\t\t\tTaskList[j].Status = wait;\n\t\t}\n\t\tif(++j >= TaskCount) j = 0;\n\t}\n}\n```\n\n## é¢‘ç‡æµ‹é‡\n\næ ¸å¿ƒæ€è·¯ï¼š\n\n1/ï¼ˆï¼ˆè¿™ä¸€æ¬¡çš„è®¡æ•°å€¼-ä¸Šä¸€æ¬¡è®°å½•çš„è®¡æ•°å€¼ï¼‰x ï¼ˆ1/æ—¶é’Ÿé¢‘ç‡ï¼‰ï¼‰= æ—¶é’Ÿé¢‘ç‡/ï¼ˆè®°å½•å·®å€¼ï¼‰\n\n\n```c\ntypedef struct {\n    uint8_t i;//è®°å½•å½“å‰æ˜¯ç¬¬å‡ æ¬¡ã€‚\n    int former;//å‰ä¸€æ¬¡è®°å½•çš„è®¡æ•°å€¼\n    int now;//ç°åœ¨è®°å½•çš„è®¡æ•°å€¼\n    int result;//é¢‘ç‡ç»“æœ\n    uint8_t ElapsedTime;//å®šæ—¶å™¨æº¢å‡ºæ¬¡æ•°\n}FreqInfo;\n\nreqInfo F1 = {0};\nFreqInfo F2 = {0};\n\n//å¯åŠ¨é¢‘ç‡æµ‹é‡\nvoid Freq_Start(void){\n    HAL_TIM_Base_Start_IT(&htim3);//å¯¹åº”F1\n    HAL_TIM_IC_Start_IT(&htim3,TIM_CHANNEL_1);\n    HAL_TIM_Base_Start_IT(&htim8);//å¯¹åº”F2\n    HAL_TIM_IC_Start_IT(&htim8,TIM_CHANNEL_1);\n}\n\nstatic void Freq_Measure(FreqInfo* Fx,TIM_HandleTypeDef *htim){\n    if(Fx->i == 0){\n        Fx->result = 1000000/(Fx->now - Fx->former);\n        __HAL_TIM_ENABLE(htim);\n    }\n}\n\nvoid Freq_Fuc(void){\n    Freq_Measure(&F1,&htim3);\n\tFreq_Measure(&F2,&htim8);\n}\n\t\n//ä¸­æ–­\nvoid HAL_TIM_IC_CaptureCallback(TIM_HandleTypeDef *htim){\n\n    if(htim->Instance == TIM3){\n        switch(F1.i){\n            case 0: \n                F1.former = HAL_TIM_ReadCapturedValue(&htim3,TIM_CHANNEL_1) + 65535 * F1.ElapsedTime;\n                F1.i = 1;\n                break;\n            case 1:\n                F1.now = HAL_TIM_ReadCapturedValue(&htim3,TIM_CHANNEL_1) + 65535 * F1.ElapsedTime;\n                __HAL_TIM_DISABLE(&htim3);\n                F1.ElapsedTime = 0;\n                F1.i = 0;\n                break;\n            default:break;\n        }\n    }\n\n    else if(htim->Instance == TIM8){\n        switch(F2.i){\n            case 0:\n                F2.former = HAL_TIM_ReadCapturedValue(&htim8,TIM_CHANNEL_1) + 65535 * F2.ElapsedTime;\n                F2.i = 1;\n                break;\n            case 1:\n                F2.now = HAL_TIM_ReadCapturedValue(&htim8,TIM_CHANNEL_1) + 65535 * F2.ElapsedTime;\n                __HAL_TIM_DISABLE(&htim8);\n                F2.ElapsedTime = 0;\n                F2.i = 0;\n                break;\n            default:break;\n        }\n    }\n}\n\n//åœ¨æº¢å‡ºä¸­æ–­ä¸­è®°å½•æº¢å‡ºæ¬¡æ•°\n\n```\n\n## å…±äº«å˜é‡\n```c\n#include \"SharedData.h\"\n\n//åˆå§‹åŒ–\nstatic Data1 shareddata1 = {0,0};\n\n//è·å–Data1æŒ‡é’ˆçš„æ¥å£\nData1* get_shared_data(void) {\n    return &shareddata1;\n}\n\n```\n## æŒ‰é”®\n```c\nuint8_t KeyBit(void){\n    uint8_t keybit = 0x00;\n    //è¯»å–B1çš„ç”µå¹³çŠ¶æ€å¹¶æŠŠä»–å·¦ç§»åˆ°bit0ä½\n    keybit |= HAL_GPIO_ReadPin(B1_GPIO_Port,B1_Pin) << 0;\n    //åŒä¸Š\n    keybit |= HAL_GPIO_ReadPin(B2_GPIO_Port,B2_Pin) << 1;\n    keybit |= HAL_GPIO_ReadPin(B3_GPIO_Port,B3_Pin) << 2;\n    keybit |= HAL_GPIO_ReadPin(B4_GPIO_Port,B4_Pin) << 3;\n    return keybit;\n}\n\nvoid task_Key(void){\n\tstatic uint8_t Trg,Cont;\n    unsigned char ReadData = KeyBit() ^ 0x0f;   \t// å–åï¼šåœ¨æ²¡æœ‰æŒ‰é”®æŒ‰ä¸‹çš„æƒ…å†µä¸‹ï¼Œå…¶å§‹ç»ˆä¸º0x00\n    Trg = ReadData & (ReadData ^ Cont);             // 2\n    Cont = ReadData; \n    if(Trg && Cont){};\n    if(Trg && Cont == 0){};\n}\n```\n\n## LCD\nå¼•è„šåˆå§‹åŒ–ä¸ºå…¨ä½å°±è¡Œ\n\n## LED\nLDå£ ä¸º PD2 ä½ç”µå¹³ä¸å…è®¸å†™å…¥ï¼Œé«˜ç”µå¹³å…è®¸å†™å…¥ã€‚\n```c\n#include \"LED.h\"\n#include \"SharedData.h\"\n\nuint16_t LD_state = 0;  //è®°å½•LDå„ä½çŠ¶æ€\nuint16_t LD_state_before = 0; \n\nvoid LED_init(void){\n\tHAL_GPIO_WritePin(LD1_GPIO_Port,GPIO_PIN_All,GPIO_PIN_SET);\n\tHAL_GPIO_WritePin(LD_load_GPIO_Port,LD_load_Pin,GPIO_PIN_SET);\n\tHAL_GPIO_WritePin(LD_load_GPIO_Port,LD_load_Pin,GPIO_PIN_RESET);\n}\n\nvoid LED_lightLD(uint8_t LDnum){\n\t\t\n\tLD_state |= (LD1_Pin << LDnum); //å…¶ä»–ä½ä¸å˜ï¼Œéœ€è¦æ”¹å˜çš„ä½å˜ä¸º1\n\t\t\n\t\n}\n\nvoid LED_closeLD(uint8_t LDnum){ \n\n\tLD_state &= ~(LD1_Pin << LDnum); //å…¶ä»–ä½ä¸å˜ï¼Œéœ€æ”¹å˜çš„ä½å˜ä¸º0\n\t\n}\n\n\nvoid Call_ChangeLD(void(*fc)(uint8_t),uint8_t LDnum){\n\t\n\tLDnum -= 1;\n\tfc(LDnum);\n\tif(LD_state_before != LD_state){\n\t\tHAL_GPIO_WritePin(LD_load_GPIO_Port,LD_load_Pin,GPIO_PIN_SET);\n\t\tHAL_GPIO_WritePin(LD1_GPIO_Port,GPIO_PIN_All,GPIO_PIN_SET);\n\t\tHAL_GPIO_WritePin(LD1_GPIO_Port,LD_state,GPIO_PIN_RESET);\n\t\tHAL_GPIO_WritePin(LD_load_GPIO_Port,LD_load_Pin,GPIO_PIN_RESET);\n\t\tLD_state_before = LD_state;\n\t}\n\telse return;\n\t\n}\n\nvoid LED_Fuc(void){\n\n\tif(Read_Show_index(0)) {\n\t\tCall_ChangeLD(LED_closeLD,1);\n\t\tCall_ChangeLD(LED_lightLD,2);\n\t}\n\telse {\t\n\t\tCall_ChangeLD(LED_closeLD,2);\n\t\tCall_ChangeLD(LED_lightLD,1);\n\t}\n\tif(Read_Show_index(1)){\n\t\tCall_ChangeLD(LED_lightLD,8);\n\t}\n\telse Call_ChangeLD(LED_closeLD,8);\n\t\n}\n```\n\n## ä¸²å£é‡å®šå‘ä¸æ•°æ®å¤„ç†\n```c\n#define BUFFER_SIZE 50\n#define CMDNUM 6\n\n\nvoid TF1(void);\nvoid TF2(void);\nvoid PF1(void);\nvoid PF2(void);\nvoid returnF1(void);\nvoid returnF2(void);\n\n\nchar rx_DataBuffer[BUFFER_SIZE] = {0};\nchar tx_DataBuffer[BUFFER_SIZE] = {0};\nchar cmd[BUFFER_SIZE] = {0};\n\nuint16_t tx_len = 0;  // å½“å‰ç¼“å†²åŒºæ•°æ®é•¿åº¦\nuint8_t tx_busy = 0;  // å‘é€çŠ¶æ€æ ‡å¿—\n\nuint8_t rx_handle = 0; //å¤„ç†æ¥æ”¶æ•°æ®æ ‡å¿—\nuint8_t rx_len = 0;\n\ntypedef struct{\n    uint8_t* cmd_str;\n    void (*fc)();\n}cmdinfo;\n\n\ncmdinfo cmdlist[] = {\n    {\"TF1\",TF1},\n    {\"TF2\",TF2},\n    {\"PF1\",PF1},\n    {\"PF2\",PF2},\n    {\"F1\",returnF1},\n    {\"F2\",returnF2}\n};\n\nvoid TheUART_start(void){\n    HAL_UARTEx_ReceiveToIdle_DMA(&huart1,(uint8_t*)rx_DataBuffer,0x0f);\n}\n\nvoid TheUART_dma_transmit(void)\n{\n    // å¦‚æœ DMA è¿˜åœ¨å¿™ï¼Œåˆ™ä¸å¯åŠ¨æ–°çš„ä¼ è¾“\n    if (tx_busy) return;\n\n    tx_busy = 1;  // æ ‡è®°ä¸ºå‘é€ä¸­\n    HAL_UART_Transmit_DMA(&huart1,(uint8_t*)tx_DataBuffer,tx_len-1);//-1ä¸ºäº†é˜²æ­¢å‚»é€¼çƒ‚æ¡¥æ¯çš„éªŒè¯ç¨‹åºä¸é€šè¿‡\n}\n\n\nint fputc(int ch, FILE *f)\n{\n    // ç¡®ä¿ç¼“å†²åŒºä¸ä¼šæº¢å‡º\n    if (tx_len < BUFFER_SIZE - 1)\n    {\n        tx_DataBuffer[tx_len++] = (uint8_t)ch;\n    }\n\n    // å¦‚æœé‡åˆ°æ¢è¡Œç¬¦ï¼Œæˆ–è€…ç¼“å†²åŒºæ¥è¿‘æ»¡ï¼Œå°±å¯åŠ¨ DMA å‘é€\n    // æ³¨æ„å’¯ï¼Œå¦‚æœç¼“å†²åŒºæ²¡æ»¡çš„æƒ…å†µä¸‹ï¼Œåªæœ‰æ£€æµ‹åˆ°/næ‰ä¼šè§¦å‘DMAçš„å‘é€ã€‚æ‰€ä»¥åœ¨ç¼“\n    // å†²åŒºæ²¡æ»¡çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æƒ³è¦å‘é€å­—ç¬¦ä¸²\"abc\"ï¼Œprintf(\"abc\")æ˜¯æ²¡ç”¨çš„ï¼Œ\n    // printf(\"abc\\n\")æ‰æœ‰ç”¨å“¦ã€‚\n\n    \n    if (ch == '\\n' || tx_len >= BUFFER_SIZE - 1)\n    {\n        TheUART_dma_transmit();\n    }\n\n    return ch;\n}\n\n\nvoid TheUART_HandleRxdata(void){\n\n    if(rx_handle == 1){\n\n        uint8_t i = 0;\n        strcpy(cmd,rx_DataBuffer);\n        cmd[rx_len] = '\\0';\n        if(!Read_Show_index(1)){\n            other();\n            rx_len = 0;\n            rx_handle = 0;\n            TheUART_start();\n            return;\n        }\n        for(i = 0;i < CMDNUM;i++){\n            if(strcmp((const char*)cmd,(const char*)cmdlist[i].cmd_str) == 0){\n                cmdlist[i].fc();\n                rx_len = 0;\n                rx_handle = 0;\n                TheUART_start();\n                return;\n            }\n        }\n        other();\n        rx_len = 0;\n        rx_handle = 0;\n        TheUART_start();\n    }\n    else return;\n}\n\n//å‘½ä»¤å‡½æ•°\nvoid TF1(void){\n\n}\n\nvoid TF2(void){\n\n}\n\nvoid PF1(void){\n\n}\n\nvoid PF2(void){\n\n}\n\nvoid returnF1(void){\n\n}\n\nvoid returnF2(void){\n\n}\n\nvoid other(void){\n}\n\n//ä¸­æ–­\nvoid HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)\n{\n    if(huart->Instance == USART1)  // ç¡®ä¿æ˜¯ç›®æ ‡ä¸²å£\n    {\n        tx_len = 0;  // æ¸…ç©ºç¼“å†²åŒº\n        tx_busy = 0; // æ ‡è®°ä¸ºå¯ç”¨\n    }\n}\n\nvoid HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size){\n\n    if(huart->Instance == USART1){\n        rx_len = Size;\n        rx_handle = 1;\n    }\n\n}\n```\n\n## ADCï¼šä½¿ç”¨å®šæ—¶å™¨TRGOä¿¡å·è§¦å‘ADCè½¬æ¢\n```c\ndouble ADC_Data = .0;\n\nvoid ADCFuc_Init(ADC_HandleTypeDef *hadc){\n    HAL_ADCEx_Calibration_Start(hadc,ADC_SINGLE_ENDED);//æ ¡å‡†\n    HAL_ADC_Start_IT(hadc);\n}\n\n\nchar ADCFuc_ReturnResult(void){\n    double result = ADC_Data;\n    result = (result / 4095.0) * 3.3;\n}\n\n\n//ä¸­æ–­-------------------------------------------------------------//\nvoid HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef *hadc){\n\n    if(hadc->Instance == ADC2){\n        ADC_Data = HAL_ADC_GetValue(&hadc2);\n    }\n}\n```\n\n## at24c02\n```c\ninclude \"i2c_hal.h\"\n\n#define COMMAND_W   0xA0\n#define COMMAND_R   0xA1\n\nvoid at24c02_Init(void){\n    I2CInit();\n}\n\n/// @brief at24c02å†™æ•°æ®\n/// @param address è¦å†™å…¥çš„åœ°å€\n/// @param data è¦å†™å…¥çš„æ•°æ®\nvoid at24c02_Write(uint8_t address,uint8_t data){\n    \n    I2CStart();\n\n    I2CSendByte(COMMAND_W);\n    I2CWaitAck();\n\n    I2CSendByte(address);\n    I2CWaitAck();\n\n    I2CSendByte(data);\n    I2CWaitAck(); \n\n    I2CStop();\n}\n\n/// @brief at24c02è¯»æ•°æ®\n/// @param address è¦è¯»æ•°æ®çš„åœ°å€\n/// @return è¯»å‡ºçš„æ•°æ®\nuint8_t at24c02_Read(uint8_t address){\n    uint8_t data = 0;\n    I2CStart();\n\n    I2CSendByte(COMMAND_W);\n    I2CWaitAck();\n\n    I2CSendByte(address);\n    I2CWaitAck();\n\n    I2CStart();//ä¸é‡Šæ”¾æ€»çº¿çš„æƒ…å†µä¸‹é‡å¯é€šä¿¡ï¼Œå‘é€è¯»å‘½ä»¤ã€‚\n\n    I2CSendByte(COMMAND_R);\n    I2CWaitAck();\n\n    data = I2CReceiveByte();\n    I2CSendNotAck();//é€šçŸ¥ä»æœºä¸å†å‘é€æ•°æ®\n\n    I2CStop();\n\n    return data;\n}   \n\n```\n\n## éŸ©ä¿¡åœ¨å¹²å˜›ï¼ŸéŸ©ä¿¡åœ¨å·å¡”ï¼èƒ½åšåˆ°å—ï¼Ÿå“‡ä»–å‡ºäº†ä¸€ä¸ªååˆ€Â·å¸å‘½ï¼çŒ«é›·ï¼\næŒ‚ä¸€å¼ æ¢¦è€å¸ˆä¿ä½‘ï¼\n![](https://tiebapic.baidu.com/forum/w%3D580%3B/sign=770517cb7fdbb6fd255be52e391faa18/8326cffc1e178a829fdedc90b003738da977e824.jpg?tbpicau=2025-04-12-05_1fd40d1758be922db3d2562ec3e230c3)","tags":["è“æ¡¥æ¯"],"categories":["åµŒå…¥å¼","ç¨‹åºæ¶æ„"]},{"title":"hexoä¸»é¢˜Klise-enhancedä½¿ç”¨æ–‡æ¡£","url":"/posts/20333/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n## è¯´æ˜\n\næœ¬ä¸»é¢˜æ˜¯æ ¹æ®dewjonhçš„hexoä¸»é¢˜[Klise](https://github.com/dewjohn/hexo-theme-Klise)æ”¹çš„ï¼Œæˆ‘éå¸¸å–œæ¬¢è¿™æ¬¾ä¸»é¢˜ï¼Œä½†æ˜¯ç”±äºæ­¤ä¸»é¢˜åŸä½œè€…å¥½åƒä¸å†ç»´æŠ¤ï¼Œå¯¹hexoçš„ç°ç‰ˆæœ¬ï¼ˆ2024ï¼‰çš„é€‚é…ä¸å¤ªå¥½ï¼Œäºæ˜¯ä¾¿è‡ªå·±ä¿®ä¿®è¡¥è¡¥ç”¨ç€ğŸ™‚ä½†æ˜¯ç”±äºæˆ‘æ²¡æœ‰å¤ªå¤šçš„ç²¾åŠ›åˆ†é…åœ¨å‰ç«¯ä¸Šï¼Œæ‰€ä»¥æœ‰äº›ä»£ç å¯èƒ½æœ‰äº›ä¸ä¸“ä¸šï¼Œå¸Œæœ›å„ä½å¤§ä½¬è§è°…å¹¶æŒ‡æ­£ã€‚å½“ç„¶å¦‚æœæœ‰ä»»ä½•bugè¯·å°½ç®¡issueï¼Œæˆ‘ä¼šå°½åŠ›ä¿®å¤ï¼\n\n## ä¸»é¢˜æ¦‚è§ˆ\n\n![](Snipaste_2025-04-06_15-26-39.png)\n\n![](Snipaste_2025-04-06_15-27-19.png)\n\n![](Snipaste_2025-04-06_15-27-54.png)\n\nä½ å¯ä»¥æŸ¥çœ‹[demo](https://im.godmao.top/)æˆ–[æˆ‘çš„åšå®¢](https://im.godmao.top/)æ¥é˜…è§ˆä¸»é¢˜æ•ˆæœã€‚\n\n## ç›¸è¾ƒäºåŸç‰ˆæœ‰ä½•æ”¹åŠ¨\n\n- ğŸ˜¢æŠŠscsså…¨ç¼–è¯‘ä¸ºcssäº†ï¼Œåªæœ‰ä¸€ä¸ªmain.cssæ–‡ä»¶ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„æ¸²æŸ“æ ·å¼....ä¸è¿‡ä¸ç”¨æ‹…å¿ƒæˆ‘æ³¨é‡Šäº†å˜»å˜»ğŸ¤“\n- å°†åŸä¸»é¢˜çš„æ·±è‰²æ¨¡å¼è¿›ä¸€æ­¥é€‚é…ï¼Œå¹¶ä¿®æ”¹äº†ä¸€äº›å…ƒç´ çš„æ˜¾ç¤ºé£æ ¼ã€‚\n## ä½¿ç”¨æ–¹æ³•\n\n### é¦–å…ˆï¼Œ\nä½ éœ€è¦ä¸‹è½½ä¸€ä¸ªå­—æ•°ç»Ÿè®¡æ’ä»¶:\n```bash\nnpm install hexo-wordcount --save\n```\n\nå¦‚æœä¸æƒ³è¦ä¸‹è½½æˆ–æ— æ³•ä¸‹è½½æˆåŠŸï¼Œä½ ä¹Ÿå¯ä»¥æ”¾å¼ƒå­—æ•°ç»Ÿè®¡åŠŸèƒ½ã€‚å‰å¾€ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹çš„`layout\\post.ejs`åˆ é™¤\n```ejs\nå­—æ•°: <span class=\"post-count\"><%= wordcount(page.content) %></span>\n\né¢„è®¡é˜…è¯»æ—¶é—´: <span class=\"post-count\"><%= min2read(page.content) %>min</span>\n```\nä¸¤è¡Œã€‚\n\n### ç„¶åï¼Œ\nå®‰è£…ä¸»é¢˜æ–‡ä»¶\n```bash\ngit clone https://github.com/g0dmao/hexo-theme-Klise-enhanced.git\n```\n\nå°†ä¸»é¢˜æ ¹ç›®å½•çš„`_config.hexo-theme-Klise-enhanced.yml`ç§»åŠ¨åˆ°åšå®¢æ ¹ç›®å½•ã€‚ä½ å¯ä»¥æ‰“å¼€è¯¥æ–‡ä»¶è¿›è¡Œä¸»é¢˜çš„ä¸€äº›é…ç½®ã€‚\n\nåœ¨åšå®¢é…ç½®æ–‡ä»¶`_config.yml`ä¸­å¯ç”¨ä¸»é¢˜ã€‚\n\n### æœ€åï¼Œ\nenjoyï¼\n\n## ä¸ªæ€§åŒ–éƒ¨åˆ†\n\n### è‡ªå®šä¹‰èƒŒæ™¯\næ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹çš„`source\\css\\main.css`åœ¨å¤´éƒ¨ä¿®æ”¹ï¼Œå¯ä»¥è‡ªå®šä¹‰æ˜æš—æ¨¡å¼ä¸‹ä¸åŒçš„èƒŒæ™¯ï¼Œå·²åšå¥½æ³¨é‡Šã€‚\n\n### å½“ç½‘é¡µå¤±å»ç„¦ç‚¹æ—¶æ ‡ç­¾é¡µæ ‡é¢˜çš„æ˜¾ç¤ºæ–‡å­—\næ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹çš„`layout\\layout.ejs` ä¿®æ”¹document.titleå³å¯ã€‚\n```html\n<script defer>\n\nÂ  document.addEventListener('visibilitychange', function () {\n\nÂ  if (document.visibilityState == 'hidden') {\n\nÂ  Â  Â  normal_title = document.title;\n\nÂ  Â  Â  document.title = 'ç‚¹ä¸€ä¸‹';\n\nÂ  } else document.title = normal_title;\n\n});\n\n</script>\n```\n### å¯é€‰\nä½ å¯ä»¥å®‰è£…å¦‚ä¸‹æ’ä»¶è·å¾—æ›´å¥½çš„æµè§ˆä½“éªŒã€‚\n#### hexo-renderer-markdown-it-plus\nä¸ä½¿ç”¨è‡ªå¸¦çš„mdæ¸²æŸ“å™¨ã€‚ä½¿ç”¨markdown-itæ¸²æŸ“å™¨ï¼Œä¸°å¯Œçš„æ’ä»¶æä¾›æ›´å¥½çš„mdæµè§ˆä½“éªŒã€‚\n\n####  hexo-tips\nåœ¨æ–‡ç« ä¸­ç”Ÿæˆå„ç§æç¤ºå¡ç‰‡ï¼Œæ­¤ä¸»é¢˜å·²åšå¥½é€‚é…ã€‚\n\n#### hexo-blog-encrypt\næ–‡ç« åŠ å¯†æ’ä»¶ã€‚\n\n## å¯èƒ½çš„é—®é¢˜\n\n### tagsã€categoriesé¡µé¢æ˜¾ç¤ºä¸æ­£ç¡®\né¦–å…ˆæ£€æŸ¥é¡µé¢çš„è·¯å¾„è®¾ç½®æ˜¯å¦æ­£ç¡®ã€‚è‹¥æ­£ç¡®åˆ™è¯•ç€åœ¨ç›¸åº”é¡µé¢çš„`index.md` é‡Œæ·»åŠ typeå’Œlayoutæ ‡ç­¾ï¼š\n![](Snipaste_2025-04-06_16-18-33.png)\ntagsé¡µé¢ typeã€layout ä¸ºtagsã€‚\ncategoriesé¡µé¢ typeã€layout ä¸º categoriesã€‚","tags":["ç½‘é¡µ","hexoä¸»é¢˜"],"categories":["å…¶ä»–"]},{"title":"ä»cåº•å±‚åˆ°åµŒå…¥å¼é©±åŠ¨å¼€å‘çš„å­¦ä¹ å‚è€ƒè·¯çº¿","url":"/posts/25619/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\nä»¥ä¸‹æ˜¯ä¸“ä¸º **åµŒå…¥å¼Linuxé©±åŠ¨å¼€å‘å·¥ç¨‹å¸ˆ** è®¾è®¡çš„ **å­¦ä¹ è·¯çº¿**ï¼Œæ•´åˆäº†ç›®æ ‡ã€é‡ç‚¹ã€æ—¶é—´åˆ†é…ã€ä¹¦ç±æ¨èå’Œå®æˆ˜å»ºè®®ï¼ŒåŠ›æ±‚æ¸…æ™°é«˜æ•ˆã€‚ç”±`deepseekR1`ç”Ÿæˆã€‚\n\n---\n\n### **ä¸€ã€å­¦ä¹ è·¯çº¿æ€»å›¾**\n```mermaid\ngraph LR\n  A[Cè¯­è¨€+ç¡¬ä»¶] --> B[æ“ä½œç³»ç»Ÿ+é©±åŠ¨åŸºç¡€] --> C[é©±åŠ¨ä¸“é¡¹+å†…æ ¸æœºåˆ¶] --> D[å®æˆ˜æ·±åŒ–]\n```\n\n---\n\n### **äºŒã€åˆ†é˜¶æ®µè¯¦è§£**\n#### **é˜¶æ®µ1ï¼šCè¯­è¨€ä¸ç¡¬ä»¶äº¤äº’ï¼ˆ1-2ä¸ªæœˆï¼‰**\n**ç›®æ ‡**ï¼š  \n- æŒæ¡Cè¯­è¨€åº•å±‚æ“ä½œèƒ½åŠ›ï¼Œç†è§£ç¨‹åºå¦‚ä½•ç›´æ¥æ§åˆ¶ç¡¬ä»¶ã€‚  \n\n**æ ¸å¿ƒå†…å®¹**ï¼š\n\n| **çŸ¥è¯†ç‚¹**         | **å¿…è¦ç¨‹åº¦** | **æ·±å…¥ç¨‹åº¦**       | **æ¨èä¹¦ç±/èµ„æº**             |\n|--------------------|--------------|--------------------|------------------------------|\n| æŒ‡é’ˆä¸å†…å­˜ç®¡ç†     | â˜…â˜…â˜…â˜…â˜…        | ç†è§£å†…å­˜å¸ƒå±€       | ã€ŠCç¨‹åºè®¾è®¡è¯­è¨€ã€‹ï¼ˆK&Rï¼‰      |\n| ç»“æ„ä½“ä¸ä½æ“ä½œ     | â˜…â˜…â˜…â˜…â˜†        | èƒ½æ“ä½œå¯„å­˜å™¨       | ã€ŠåµŒå…¥å¼Cè¯­è¨€è‡ªæˆ‘ä¿®å…»ã€‹        |\n| æ±‡ç¼–åŸºç¡€           | â˜…â˜…â˜…â˜†â˜†        | é˜…è¯»ç®€å•æ±‡ç¼–       | ã€ŠARM Cortex-Mæƒå¨æŒ‡å—ã€‹       |\n| ç¼–è¯‘æµç¨‹ï¼ˆGCCï¼‰    | â˜…â˜…â˜…â˜…â˜†        | ç†Ÿæ‚‰é¢„å¤„ç†-é“¾æ¥    | CSAPPç¬¬3ç«                     |\n| ç¡¬ä»¶äº¤äº’ï¼ˆGPIOï¼‰   | â˜…â˜…â˜…â˜…â˜†        | è£¸æœºç¨‹åºå¼€å‘       | STM32å®˜æ–¹æ‰‹å†Œ                 |\n\n**å®è·µé¡¹ç›®**ï¼š  \n1. ç”¨STM32ç›´æ¥æ“ä½œå¯„å­˜å™¨ç‚¹äº®LEDï¼ˆæ— éœ€åº“å‡½æ•°ï¼‰ã€‚  \n2. ç”¨Cå®ç°å†…å­˜æ± åˆ†é…å™¨ï¼ˆæ¨¡æ‹Ÿ`malloc/free`ï¼‰ã€‚  \n\n**å·¥å…·**ï¼š  \n- **STM32CubeIDE**ï¼šè°ƒè¯•è£¸æœºç¨‹åºã€‚  \n- **objdump**ï¼šåæ±‡ç¼–æŸ¥çœ‹ä»£ç ç”Ÿæˆã€‚  \n\n**å¯¹Linuxçš„ç”¨å¤„**ï¼š  \n- ç†è§£é©±åŠ¨ä¸­ **å¯„å­˜å™¨æ˜ å°„**ï¼ˆå¦‚`ioremap`ï¼‰ã€‚  \n- è¯Šæ–­ **å†…å­˜è¶Šç•Œ** å’Œ **ç¡¬ä»¶è®¿é—®é”™è¯¯**ã€‚  \n\n---\n\n#### **é˜¶æ®µ2ï¼šæ“ä½œç³»ç»Ÿæ ¸å¿ƒ+é©±åŠ¨åŸºç¡€ï¼ˆ2-3ä¸ªæœˆï¼‰**\n**ç›®æ ‡**ï¼š  \n- ç†è§£æ“ä½œç³»ç»Ÿæ ¸å¿ƒæœºåˆ¶ï¼Œå…¥é—¨Linuxé©±åŠ¨å¼€å‘ã€‚  \n\n**æ ¸å¿ƒå†…å®¹**ï¼š  \n\n| **çŸ¥è¯†ç‚¹**         | **å¿…è¦ç¨‹åº¦** | **æ·±å…¥ç¨‹åº¦**       | **æ¨èä¹¦ç±/èµ„æº**             |\n|--------------------|--------------|--------------------|------------------------------|\n| è¿›ç¨‹ä¸çº¿ç¨‹         | â˜…â˜…â˜…â˜†â˜†        | ç†è§£ä¸Šä¸‹æ–‡åˆ‡æ¢     | ã€Šæ“ä½œç³»ç»Ÿå¯¼è®ºã€‹ï¼ˆOSTEPï¼‰     |\n| è™šæ‹Ÿå†…å­˜           | â˜…â˜…â˜…â˜…â˜†        | é¡µè¡¨å·¥ä½œåŸç†       | ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ç¬¬9ç«    |\n| ä¸­æ–­ä¸å¼‚å¸¸         | â˜…â˜…â˜…â˜…â˜†        | ä¸­æ–­å¤„ç†æµç¨‹       | ã€ŠLinuxè®¾å¤‡é©±åŠ¨ç¨‹åºã€‹ï¼ˆLDD3ï¼‰ |\n| å†…æ ¸æ¨¡å—å¼€å‘       | â˜…â˜…â˜…â˜…â˜…        | å­—ç¬¦è®¾å¤‡é©±åŠ¨       | LDD3ç¬¬3ç«                     |\n| è®¾å¤‡æ ‘ï¼ˆDTï¼‰       | â˜…â˜…â˜…â˜…â˜†        | è§£æç¡¬ä»¶é…ç½®       | å†…æ ¸æ–‡æ¡£ã€ŠDevice Tree Usageã€‹ |\n\n**å®è·µé¡¹ç›®**ï¼š  \n1. ç¼–å†™è™šæ‹Ÿå­—ç¬¦è®¾å¤‡é©±åŠ¨ï¼ˆå®ç°`read`/`write`ï¼‰ã€‚  \n2. ä¸ºLEDé©±åŠ¨æ·»åŠ è®¾å¤‡æ ‘æ”¯æŒï¼ˆ`.dts`æ–‡ä»¶é…ç½®ï¼‰ã€‚  \n\n**å·¥å…·**ï¼š  \n- **QEMU**ï¼šæ¨¡æ‹ŸARMè®¾å¤‡è¿è¡ŒLinuxã€‚  \n- **dmesg**ï¼šæŸ¥çœ‹å†…æ ¸æ—¥å¿—ã€‚  \n\n**å¯¹Linuxçš„ç”¨å¤„**ï¼š  \n- æŒæ¡é©±åŠ¨å¼€å‘æ¡†æ¶ï¼ˆ`file_operations`ï¼‰ã€‚  \n- ç†è§£ **è®¾å¤‡æ ‘** å¦‚ä½•è§£è€¦ç¡¬ä»¶é…ç½®ã€‚  \n\n---\n\n#### **é˜¶æ®µ3ï¼šé©±åŠ¨ä¸“é¡¹+å†…æ ¸æœºåˆ¶ï¼ˆ3-6ä¸ªæœˆï¼‰**\n**ç›®æ ‡**ï¼š  \n- ç²¾é€šä¸»æµé©±åŠ¨å¼€å‘æŠ€æœ¯ï¼Œæ·±å…¥å†…æ ¸æ ¸å¿ƒæœºåˆ¶ã€‚  \n\n**æ ¸å¿ƒå†…å®¹**ï¼š  \n\n| **çŸ¥è¯†ç‚¹**         | **å¿…è¦ç¨‹åº¦** | **æ·±å…¥ç¨‹åº¦**       | **æ¨èä¹¦ç±/èµ„æº**             |\n|--------------------|--------------|--------------------|------------------------------|\n| GPIO/I2C/SPIé©±åŠ¨   | â˜…â˜…â˜…â˜…â˜…        | å®Œæ•´é©±åŠ¨å¼€å‘       | ã€Šç²¾é€šLinuxè®¾å¤‡é©±åŠ¨ç¨‹åºå¼€å‘ã€‹ |\n| ä¸­æ–­å¤„ç†           | â˜…â˜…â˜…â˜…â˜…        | é¡¶åŠéƒ¨/åº•åŠéƒ¨      | å†…æ ¸æºç `drivers/irqchip`     |\n| å†…æ ¸åŒæ­¥æœºåˆ¶       | â˜…â˜…â˜…â˜…â˜†        | è‡ªæ—‹é”/RCU         | ã€ŠLinuxå†…æ ¸è®¾è®¡ä¸å®ç°ã€‹ç¬¬5ç«   |\n| DMAä¸å†…å­˜ç®¡ç†      | â˜…â˜…â˜…â˜†â˜†        | ç¼“å­˜ä¸€è‡´æ€§         | å†…æ ¸æ–‡æ¡£ã€ŠDMA-API-HOWTOã€‹     |\n| ç”µæºç®¡ç†           | â˜…â˜…â˜…â˜†â˜†        | suspend/resume     | å†…æ ¸æ–‡æ¡£ã€ŠPower Managementã€‹  |\n\n**å®è·µé¡¹ç›®**ï¼š  \n1. ä¸ºæ ‘è“æ´¾å¼€å‘I2Cä¼ æ„Ÿå™¨é©±åŠ¨ï¼ˆå¦‚BMP280ï¼‰ã€‚  \n2. å®ç°å¸¦ä¸­æ–­çš„æŒ‰é”®é©±åŠ¨ï¼ˆ`request_irq`ï¼‰ã€‚  \n\n**å·¥å…·**ï¼š  \n- **é€»è¾‘åˆ†æä»ª**ï¼šæŠ“å–SPI/I2Cæ—¶åºã€‚  \n- **perf**ï¼šåˆ†æé©±åŠ¨æ€§èƒ½ç“¶é¢ˆã€‚  \n\n**å¯¹Linuxçš„ç”¨å¤„**ï¼š  \n- æŒæ¡çœŸå®ç¡¬ä»¶é©±åŠ¨å¼€å‘æµç¨‹ã€‚  \n- ç†è§£å†…æ ¸ **å¹¶å‘æ§åˆ¶** å’Œ **ä¸­æ–­ä¼˜åŒ–**ã€‚  \n\n---\n\n#### **é˜¶æ®µ4ï¼šå®æˆ˜æ·±åŒ–ï¼ˆæŒç»­å­¦ä¹ ï¼‰**\n**ç›®æ ‡**ï¼š  \n- å‚ä¸çœŸå®é¡¹ç›®ï¼Œè§£å†³å¤æ‚é—®é¢˜ã€‚  \n\n**æ ¸å¿ƒå†…å®¹**ï¼š  \n\n| **çŸ¥è¯†ç‚¹**         | **å¿…è¦ç¨‹åº¦** | **æ·±å…¥ç¨‹åº¦**       | **æ¨èèµ„æº**                 |\n|--------------------|--------------|--------------------|------------------------------|\n| å†…æ ¸å­ç³»ç»Ÿ         | â˜…â˜…â˜…â˜…â˜†        | è¾“å…¥/IIOå­ç³»ç»Ÿ     | å†…æ ¸æºç `drivers/input`       |\n| è°ƒè¯•ä¸è°ƒä¼˜         | â˜…â˜…â˜…â˜…â˜†        | ftrace/kgdb        | å†…æ ¸æ–‡æ¡£ã€Šftraceä½¿ç”¨æŒ‡å—ã€‹    |\n| ç¤¾åŒºè´¡çŒ®           | â˜…â˜…â˜…â˜†â˜†        | æäº¤å†…æ ¸è¡¥ä¸       | LKMLï¼ˆLinuxå†…æ ¸é‚®ä»¶åˆ—è¡¨ï¼‰     |\n\n**å®è·µé¡¹ç›®**ï¼š  \n1. ä¸ºå¼€æºé©±åŠ¨ä¿®å¤Bugï¼ˆå¦‚å†…æ ¸Bugzillaä¸­çš„ç®€å•é—®é¢˜ï¼‰ã€‚  \n2. ä¼˜åŒ–é©±åŠ¨æ€§èƒ½ï¼ˆå‡å°‘ä¸­æ–­å»¶è¿Ÿæˆ–å†…å­˜å ç”¨ï¼‰ã€‚  \n\n**å·¥å…·**ï¼š  \n- **git**ï¼šç®¡ç†å†…æ ¸ä»£ç ä¿®æ”¹ã€‚  \n- **checkpatch.pl**ï¼šæ£€æŸ¥ä»£ç è§„èŒƒã€‚  \n\n**å¯¹Linuxçš„ç”¨å¤„**ï¼š  \n- ç§¯ç´¯çœŸå®é¡¹ç›®ç»éªŒï¼Œæå‡å·¥ç¨‹èƒ½åŠ›ã€‚  \n- ç†è§£Linuxå†…æ ¸ç¤¾åŒºçš„åä½œæ–¹å¼ã€‚  \n\n---\n\n### **ä¸‰ã€æ—¶é—´åˆ†é…å»ºè®®**\n| **é˜¶æ®µ**               | **å»ºè®®æ—¶é•¿** | **æ ¸å¿ƒç›®æ ‡**                     | **æ—¶é—´å æ¯”** |\n|------------------------|--------------|----------------------------------|--------------|\n| Cè¯­è¨€ä¸ç¡¬ä»¶äº¤äº’        | 1-2ä¸ªæœˆ      | è£¸æœºæ“ä½œå¯„å­˜å™¨                   | 15%          |\n| æ“ä½œç³»ç»Ÿ+é©±åŠ¨åŸºç¡€      | 2-3ä¸ªæœˆ      | å­—ç¬¦è®¾å¤‡é©±åŠ¨+è®¾å¤‡æ ‘              | 30%          |\n| é©±åŠ¨ä¸“é¡¹+å†…æ ¸æœºåˆ¶      | 3-6ä¸ªæœˆ      | GPIO/I2C/ä¸­æ–­é©±åŠ¨å¼€å‘            | 40%          |\n| å®æˆ˜æ·±åŒ–               | æŒç»­         | é¡¹ç›®ç»éªŒ+ç¤¾åŒºè´¡çŒ®                | 15%          |\n\n---\n\n### **å››ã€é©±åŠ¨å¼€å‘å·¥ç¨‹å¸ˆæ ¸å¿ƒèƒ½åŠ›**\n1. **ç¡¬ä»¶èƒ½åŠ›**ï¼š  \n   - é˜…è¯»èŠ¯ç‰‡æ‰‹å†Œï¼ˆå¦‚æ—¶é’Ÿé…ç½®ã€å¯„å­˜å™¨å®šä¹‰ï¼‰ã€‚  \n   - ä½¿ç”¨ç¤ºæ³¢å™¨è°ƒè¯•I2C/SPIé€šä¿¡é—®é¢˜ã€‚  \n\n2. **å†…æ ¸èƒ½åŠ›**ï¼š  \n   - ç¼–å†™ç¬¦åˆå†…æ ¸ç¼–ç è§„èŒƒï¼ˆ`checkpatch.pl`ï¼‰çš„ä»£ç ã€‚  \n   - ç†è§£è®¾å¤‡æ¨¡å‹ï¼ˆæ€»çº¿/è®¾å¤‡/é©±åŠ¨ï¼‰ã€‚  \n\n3. **è°ƒè¯•èƒ½åŠ›**ï¼š  \n   - åˆ†æå†…æ ¸Oopså’ŒPanicæ—¥å¿—ã€‚  \n   - ä½¿ç”¨`trace-cmd`è·Ÿè¸ªå‡½æ•°è°ƒç”¨é“¾ã€‚  \n\n---\n\n### **äº”ã€å­¦ä¹ å»ºè®®ä¸é¿å‘**\n1. **å¿…åš**ï¼š  \n   - æ¯å¤©é˜…è¯»å†…æ ¸é©±åŠ¨æºç ï¼ˆå¦‚`drivers/gpio`ï¼‰ã€‚  \n   - ç”¨çœŸå®ç¡¬ä»¶ï¼ˆæ ‘è“æ´¾/BeagleBoneï¼‰æ›¿ä»£ä»¿çœŸã€‚  \n\n2. **é¿å…**ï¼š  \n   - æ²‰è¿·è‡ªåˆ¶æ“ä½œç³»ç»Ÿå†…æ ¸ï¼ˆé™¤éç›®æ ‡ä¸ºå†…æ ¸ç ”å‘ï¼‰ã€‚  \n   - è¿‡æ—©ç ”ç©¶ç¼–è¯‘å™¨åç«¯ä¼˜åŒ–ï¼ˆå¦‚LLVM Passï¼‰ã€‚  \n\n3. **æ·å¾„**ï¼š  \n   - ç›´æ¥å‚è€ƒå†…æ ¸ä¸­ç±»ä¼¼é©±åŠ¨çš„å®ç°ï¼ˆå¦‚`drivers/i2c/busses/i2c-bcm2835.c`ï¼‰ã€‚  \n   - å‚ä¸å¼€æºç¤¾åŒºï¼ˆä»æ–‡æ¡£æ”¹è¿›å¼€å§‹ï¼‰ã€‚  \n\n---\n\n### **å…­ã€é©±åŠ¨å¼€å‘é¢è¯•å¸¸è§é—®é¢˜**\n- **åŸºç¡€é—®é¢˜**ï¼š  \n  - è§£é‡Š`platform_driver`å’Œ`platform_device`çš„ä½œç”¨ã€‚  \n  - è‡ªæ—‹é”ä¸ºä»€ä¹ˆä¸èƒ½åœ¨ç¡çœ åœºæ™¯ä½¿ç”¨ï¼Ÿ  \n\n- **å®æˆ˜é—®é¢˜**ï¼š  \n  - å¦‚ä½•ä¸ºä¸€ä¸ªæ–°ç¡¬ä»¶ç¼–å†™è®¾å¤‡æ ‘èŠ‚ç‚¹ï¼Ÿ  \n  - é©±åŠ¨ä¸­å‡ºç°`Unable to handle kernel paging request`å¦‚ä½•è°ƒè¯•ï¼Ÿ  \n\n---\n\næŒ‰æ­¤è·¯çº¿ï¼Œ**12-18ä¸ªæœˆ** å¯è¾¾åˆ°åµŒå…¥å¼Linuxé©±åŠ¨å·¥ç¨‹å¸ˆçš„å…¥èŒè¦æ±‚ã€‚**è®°ä½ï¼šé©±åŠ¨å¼€å‘çš„æœ¬è´¨æ˜¯â€œç”¨è½¯ä»¶ç²¾ç¡®æè¿°ç¡¬ä»¶è¡Œä¸ºâ€**ï¼Œä¿æŒå¯¹ç¡¬ä»¶çš„æ•æ„Ÿåº¦æ˜¯å…³é”®ï¼","tags":["åµŒå…¥å¼","å­¦ä¹ è·¯çº¿"],"categories":["åµŒå…¥å¼"]},{"title":"Kelly McGonigal, Ph.D.ã€Šè‡ªæ§åŠ›ã€‹ç¬¬å››ç« é˜…è¯»æ„Ÿæ‚Ÿ","url":"/posts/57146/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚æ‘˜å½•è‡ªå¾®ä¿¡è¯»ä¹¦ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n# 04 å®¹å¿ç½ªæ¶ï¼šä¸ºä½•å–„è¡Œä¹‹åä¼šæœ‰æ¶è¡Œï¼Ÿ\n\n## è­¦æƒ•â€œæ”¾çºµè®¸å¯â€\n\n>  ä¸æ˜¯æ¯ä¸€æ¬¡è‡ªæ§åŠ›å¤±æ•ˆéƒ½æ˜¯å› ä¸ºçœŸçš„å¤±å»äº†æ§åˆ¶ã€‚æœ‰æ—¶ï¼Œæˆ‘ä»¬æ˜¯æœ‰æ„è¯†åœ°é€‰æ‹©äº†åœ¨è¯±æƒ‘é¢å‰å±ˆæœã€‚\n\n>  æˆ‘ä»¬è¦æ€è€ƒä¸€ä¸‹ï¼Œè¿™æ•´ä¸ªè¿‡ç¨‹å¦‚ä½•å‰Šå¼±äº†æˆ‘ä»¬çš„åŠ¨åŠ›ï¼Œä¹è§‚ç²¾ç¥å¦‚ä½•å…è®¸æˆ‘ä»¬æ”¾çºµè‡ªå·±ï¼Œä¸ºä»€ä¹ˆè§‰å¾—è‡ªå·±å“å¾·é«˜å°šåè€Œæ˜¯é€šå¾€ç½ªæ¶çš„å¿«é€Ÿé€šé“ã€‚æ¯ä¸€æ¬¡æˆ‘ä»¬éƒ½ä¼šå‘ç°ï¼Œæ”¾å¼ƒæŠµæŠ—æ˜¯ä¸€ç§é€‰æ‹©ï¼Œè€Œä¸”å¹¶éä¸å¯é¿å…ã€‚äº†è§£æˆ‘ä»¬æ˜¯å¦‚ä½•ç»™è‡ªå·±è®¸å¯çš„ï¼Œèƒ½è®©æˆ‘ä»¬å­¦ä¼šå¦‚ä½•ä¸ç¦»æ­£è½¨ã€‚\n\n>  å½“è¯´åˆ°å­°æ˜¯å­°éæ—¶ï¼Œæˆ‘ä»¬éƒ½èƒ½æ¯«ä¸è´¹åŠ›åœ°ä½œå‡ºç¬¦åˆé“å¾·æ ‡å‡†çš„é€‰æ‹©ã€‚æˆ‘ä»¬åªæƒ³è®©è‡ªå·±æ„Ÿè§‰è‰¯å¥½ï¼Œè€Œè¿™å°±ä¸ºè‡ªå·±çš„èƒ¡ä½œéä¸ºå¼€äº†ç»¿ç¯ã€‚\n\n>  å½“ä½ åšå–„äº‹çš„æ—¶å€™ï¼Œä½ ä¼šæ„Ÿè§‰è‰¯å¥½ã€‚è¿™å°±æ„å‘³ç€ï¼Œä½ æ›´å¯èƒ½ç›¸ä¿¡è‡ªå·±çš„å†²åŠ¨ã€‚è€Œå†²åŠ¨å¸¸å¸¸ä¼šå…è®¸ä½ åšåäº‹ã€‚\n\n>  ä»–ä»¬åªæ˜¯è¢«è‡ªå·±ä¹‹å‰è‰¯å¥½çš„è¡Œä¸ºæ‰€è’™è”½ï¼Œæ²¡çœ‹åˆ°è¿™äº›å†³å®šä¼šå¸¦æ¥çš„ä¼¤å®³è€Œå·²ã€‚\n\n>  å¦‚æœä½ å»é”»ç‚¼äº†å°±è¯´è‡ªå·±å¾ˆâ€œå¥½â€ï¼Œæ²¡å»é”»ç‚¼å°±è¯´è‡ªå·±å¾ˆâ€œåâ€ï¼Œé‚£ä¹ˆä½ å¾ˆå¯èƒ½å› ä¸ºä»Šå¤©å»é”»ç‚¼äº†ï¼Œæ˜å¤©å°±ä¸å»äº†ã€‚\n\n>  ç®€å•è¯´æ¥ï¼Œåªè¦æˆ‘ä»¬çš„æ€æƒ³ä¸­å­˜åœ¨æ­£åä¸¤æ–¹ï¼Œå¥½çš„è¡Œä¸ºå°±æ€»æ˜¯å…è®¸æˆ‘ä»¬åšä¸€ç‚¹åäº‹ã€‚\n\n>  ä»–ä»¬è¿™æ ·ä¸ºè‡ªå·±è¾©è§£ï¼šâ€œæˆ‘å·²ç»è¿™ä¹ˆå¥½äº†ï¼Œåº”è¯¥å¾—åˆ°ä¸€ç‚¹å¥–åŠ±ã€‚â€è¿™ç§å¯¹è¡¥å¿çš„æ¸´æœ›å¸¸å¸¸ä½¿æˆ‘ä»¬å •è½ã€‚å› ä¸ºæˆ‘ä»¬å¾ˆå®¹æ˜“è®¤ä¸ºï¼Œçºµå®¹è‡ªå·±å°±æ˜¯å¯¹ç¾å¾·æœ€å¥½çš„å¥–åŠ±ã€‚æˆ‘ä»¬å¿˜è®°äº†è‡ªå·±çœŸæ­£çš„ç›®æ ‡ï¼Œå‘è¯±æƒ‘å±ˆæœäº†ã€‚\n\n>  å¦‚æœæŒ‰ç…§è¿™ä¸ªè’è°¬çš„é€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰çš„è‡ªæˆ‘æ”¾çºµéƒ½å˜æˆå¼•ä»¥ä¸ºå‚²çš„äº‹ã€‚ï¼ˆä¿¡ç”¨å¡è´¦å•ä¼šè®©ä½ äº§ç”Ÿè´Ÿç½ªæ„Ÿå—ï¼Ÿæ€ä¹ˆä¼šå‘¢ï¼Œèµ·ç ä½ æ²¡æœ‰å› ä¸ºè¦ä»˜è´¦å•è€Œå»æŠ¢é“¶è¡Œï¼ï¼‰\n\n>  æˆ‘ä»¬é€šå¸¸ç›¸ä¿¡æœ¬èƒ½ï¼Œåªæœ‰å½“éœ€è¦è§£é‡Šè‡ªå·±çš„åˆ¤æ–­æ—¶ï¼Œæˆ‘ä»¬æ‰å¯»æ±‚é€»è¾‘ã€‚\n\n>  å› ä¸ºè¿‡å»çš„å–„è¡Œè€Œæ„Ÿè§‰è‰¯å¥½ï¼Œè¿™è®©ä½ ä¸ºä»Šåçš„çºµå®¹æ‰¾åˆ°äº†å€Ÿå£ã€‚å½“ä½ è§‰å¾—è‡ªå·±åƒä¸ªåœ£äººçš„æ—¶å€™ï¼Œçºµå®¹è‡ªå·±çš„å¿µå¤´å¬èµ·æ¥æ²¡ä»€ä¹ˆé”™ã€‚å®ƒå¬èµ·æ¥å¾ˆæ­£ç¡®ï¼Œå°±åƒæ˜¯ä½ åº”å¾—çš„ä¸€æ ·ã€‚å¦‚æœä½ è‡ªæ§çš„å”¯ä¸€åŠ¨åŠ›å°±æ˜¯æˆä¸ºä¸€ä¸ªè¶³å¤Ÿå¥½çš„äººï¼Œé‚£ä¹ˆæ¯å½“ä½ è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½çš„æ—¶å€™ï¼Œä½ å°±ä¼šæ”¾å¼ƒè‡ªæ§ã€‚\n\n>  å®ƒè®©æˆ‘ä»¬ç›¸ä¿¡ï¼Œæ”¾å¼ƒèŠ‚é£Ÿã€æ‰“ç ´é¢„ç®—ã€å¤šæŠ½æ ¹çƒŸè¿™äº›ä¸è‰¯è¡Œä¸ºéƒ½æ˜¯å¯¹è‡ªå·±çš„â€œæ¬¾å¾…â€ã€‚è¿™å¾ˆç–¯ç‹‚ï¼Œä½†å¯¹å¤§è„‘æ¥è¯´ï¼Œå®ƒæœ‰å¯æ€•çš„è¯±æƒ‘åŠ›ï¼Œèƒ½è®©ä½ æŠŠâ€œæƒ³åšçš„äº‹â€å˜æˆâ€œå¿…é¡»åšçš„äº‹â€ã€‚\n\n>  æˆ‘ä»¬ç”¨å¤§åƒç”œé£Ÿã€ç†¬å¤œæ™šç¡ã€ä¿¡ç”¨å¡è´Ÿå€ºæ¥åˆ¤æ–­è‡ªå·±æ˜¯å–„è¿˜æ˜¯æ¶ã€‚ä½†æ˜¯ï¼Œè¿™äº›äº‹æ— æ³•çœŸæ­£ä½“ç°ä»€ä¹ˆæ˜¯ç½ªæ¶ï¼Œä»€ä¹ˆæ˜¯ç¾å¾·ã€‚å½“æˆ‘ä»¬ä»é“å¾·çš„è§’åº¦æ€è€ƒè‡ªå·±é¢å¯¹çš„æ„å¿—åŠ›æŒ‘æˆ˜æ—¶ï¼Œæˆ‘ä»¬å°±å¤±å»äº†è‡ªæˆ‘åˆ¤æ–­èƒ½åŠ›ï¼Œçœ‹ä¸åˆ°è¿™äº›æŒ‘æˆ˜æœ‰åŠ©äºæˆ‘ä»¬å¾—åˆ°è‡ªå·±æƒ³è¦çš„ä¸œè¥¿\n\n>  è¿›æ­¥å¯èƒ½è®©æˆ‘ä»¬æ”¾å¼ƒæ›¾ç»ä¸ºä¹‹å¥‹æ–—çš„ä¸œè¥¿ã€‚\n\n>  å½“ä½ å–å¾—è¿›æ­¥çš„æ—¶å€™ï¼Œä½ çš„å¤§è„‘å°±åœæ­¢äº†æ€ç»´è¿›ç¨‹ï¼Œè€Œè¿™ä¸ªè¿›ç¨‹æ­£æ˜¯æ¨åŠ¨ä½ è¿½æ±‚é•¿è¿œç›®æ ‡çš„å…³é”®ã€‚ç„¶åï¼Œé‚£ä¸ªæ”¾çºµè‡ªæˆ‘çš„å£°éŸ³å°±ä¼šå“èµ·æ¥ï¼Œä½ å°±ä¼šè½¬è€Œå…³æ³¨é‚£äº›è¿˜æ²¡æœ‰å¾—åˆ°æ»¡è¶³çš„ç›®æ ‡ã€‚å¿ƒç†å­¦å®¶ç§°ä¹‹ä¸ºâ€œç›®æ ‡é‡Šæ”¾â€ã€‚ä½ æ›¾åŠªåŠ›å…‹åˆ¶çš„ç›®æ ‡ä¼šå˜å¾—æ›´åŠ å¼ºå¤§ï¼Œè¯±æƒ‘ä¹Ÿä¼šå˜å¾—æ›´åŠ éš¾ä»¥æŠµæŒ¡ã€‚\n\n>  ä½†å…³æ³¨è¿›æ­¥ç¡®å®ä¼šè®©æˆ‘ä»¬ç¦»æˆåŠŸè¶Šæ¥è¶Šè¿œã€‚\n\n>  åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ€»åœ¨å¯»æ‰¾åœä¸‹æ¥çš„ç†ç”±ã€‚\n\n>  ä½ ä¸åº”è¯¥æƒ³ç€â€œæˆ‘åšåˆ°äº†ï¼Œå¥½äº†ï¼Œç°åœ¨æˆ‘å¯ä»¥åšç‚¹æˆ‘çœŸæ­£æƒ³åšçš„äº‹äº†ï¼â€åº”è¯¥æƒ³ç€â€œæˆ‘åšè¿™ä»¶äº‹æ˜¯å› ä¸ºæˆ‘æƒ³è¦â€¦â€¦â€\n\n>  è®°ä½æˆ‘ä»¬ä¸ºä»€ä¹ˆä¼šæ‹’ç»è¯±æƒ‘ï¼Œè¿™æ˜¯ä¸ªå¾ˆæœ‰æ•ˆçš„åŠæ³•ã€‚\n\n>  æ‰€è°“çš„å¥–åŠ±çœ‹èµ·æ¥æ›´åƒå¯¹ç›®æ ‡çš„å¨èƒï¼Œå±ˆæœäºè¯±æƒ‘çš„æ„Ÿè§‰å¹¶ä¸å¥½ã€‚è®°ä½ç†ç”±è¿˜æœ‰åŠ©äºä½ å‘ç°å¹¶æŠ“ä½æœºé‡ï¼Œä»¥ä¾¿å®Œæˆç›®æ ‡ã€‚\n\n>  ä¸‹ä¸€å›ï¼Œå½“ä½ å‘ç°è‡ªå·±åœ¨ç”¨æ›¾ç»çš„å–„è¡Œç»™ç°åœ¨çš„æ”¾çºµä½œè¾©æŠ¤æ—¶ï¼Œåœä¸‹æ¥æƒ³ä¸€æƒ³ï¼Œä½ å½“æ—¶ä¸ºä»€ä¹ˆèƒ½æ‹’ç»è¯±æƒ‘ã€‚\n\n## æ˜æ—¥å¤æ˜æ—¥ã€æ‹–å»¶\n\n>  è¿™å¾ˆå¥½åœ°è§£é‡Šäº†ï¼Œæˆ‘ä»¬æƒ³åˆ°æœªæ¥çš„é€‰æ‹©æ—¶ï¼Œå°±ä¼šå¾ˆå®¹æ˜“çŠ¯ä¸‹å¤§é”™ã€‚æˆ‘ä»¬ä¸æ–­æœŸæœ›æ˜å¤©èƒ½ä½œå‡ºå’Œä»Šå¤©ä¸åŒçš„é€‰æ‹©ï¼Œä½†è¿™ç§æœŸæœ›æ˜¯é”™è¯¯çš„\n\n>  è¿™ç§ä¹è§‚ç²¾ç¥è®©æˆ‘ä»¬èƒ½åœ¨ä»Šå¤©æ”¾çºµè‡ªå·±â€”â€”å°¤å…¶æ˜¯å½“ä½ ç¡®ä¿¡è‡ªå·±ä¸‹æ¬¡ä¸ä¼šä½œå‡ºåŒæ ·é€‰æ‹©çš„æ—¶å€™ã€‚\n\n>  å¦‚æœæˆ‘ä»¬ç°åœ¨è¡¨ç°ç³Ÿç³•ï¼Œå´ç”¨å¯¹æœªæ¥çš„ä¹è§‚æœŸå¾…æ¥æ©é¥°å®ƒï¼Œé‚£ä¹ˆè¿˜ä¸å¦‚ä¸€å¼€å§‹å°±ä¸è¦è®¾å®šè¿™ä¸ªç›®æ ‡ã€‚\n\n>  å¸®åŠ©äººä»¬å…‹æœè¿™ç§â€œæ˜æ—¥å¤æ˜æ—¥â€çš„æƒ³æ³•ã€‚å½“ä½ æƒ³æ”¹å˜æŸç§è¡Œä¸ºçš„æ—¶å€™ï¼Œè¯•ç€å‡å°‘è¡Œä¸ºçš„å˜åŒ–æ€§ï¼Œè€Œä¸æ˜¯å‡å°‘é‚£ç§è¡Œä¸ºã€‚\n\n>  æˆ‘ä»¬éƒ½å¸Œæœ›è¯´æœè‡ªå·±ï¼Œæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿å¹¶æ²¡æœ‰é‚£ä¹ˆåã€‚æ­£å¦‚ä½ å°†è¦çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬è¿«åˆ‡æƒ³ç»™è¯±æƒ‘æˆ‘ä»¬çš„å¯¹è±¡åŠ ä»¥é“å¾·æ ‡å‡†ï¼Œå¥½è®©æˆ‘ä»¬åœ¨æ”¾çºµè‡ªå·±çš„æ—¶å€™æ¯«æ— è´Ÿç½ªæ„Ÿã€‚\n\n## è­¦æƒ•â€œå…‰ç¯æ•ˆåº”â€\n\n>  å½“æˆ‘ä»¬æƒ³è·å¾—æ”¾çºµè®¸å¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå¯»æ‰¾ä»»ä½•ä¸€ä¸ªç¾å¾·çš„æš—ç¤ºï¼Œä¸ºè‡ªå·±æ”¾å¼ƒæŠµæŠ—ä½œè¾©æŠ¤ã€‚\n\n>  åªè¦ä½¿ä½ æ”¾çºµçš„ä¸œè¥¿å’Œä½¿ä½ è§‰å¾—å“å¾·é«˜å°šçš„ä¸œè¥¿åŒæ—¶å‡ºç°ï¼Œå°±ä¼šäº§ç”Ÿå…‰ç¯æ•ˆåº”ã€‚\n\n>  ä½ ä¼šä¸ä¼šå› ä¸ºå…³æ³¨ä¸€ä¸ªäº‹ç‰©æœ€æœ‰ç›Šçš„å“è´¨ï¼Œè€Œå…è®¸è‡ªå·±æ²‰æººäºå®ƒï¼Ÿ\n\n>  å½“â€œå…‰ç¯æ•ˆåº”â€å½±å“åˆ°ä½ çš„æ„å¿—åŠ›æŒ‘æˆ˜æ—¶ï¼Œä½ éœ€è¦æ‰¾åˆ°æœ€å…·ä½“çš„æµ‹é‡æ ‡å‡†ï¼ˆæ¯”å¦‚å¡è·¯é‡Œã€èŠ±è´¹ã€æ¶ˆè€—æˆ–æµªè´¹çš„æ—¶é—´ï¼‰ï¼Œä»¥æ­¤åˆ¤æ–­è¿™ä¸ªé€‰æ‹©æ˜¯å¦å’Œä½ çš„ç›®æ ‡ç›¸ç¬¦ã€‚\n\n>  åªè¦æŸäº›äº‹è®©æˆ‘ä»¬è§‰å¾—è‡ªå·±å°½åŠ›äº†ï¼Œä¸ç”¨å†æ‹…å¿ƒé‚£äº›é—®é¢˜äº†ï¼Œæˆ‘ä»¬å°±ä¼šèœ‚æ‹¥è€Œä¸Šã€‚è€Œä¸€æ—¦æˆ‘ä»¬çš„ç½ªæ¶æ„Ÿå’Œç„¦è™‘æ¶ˆå¤±äº†ï¼Œæˆ‘ä»¬å°±ä¼šè§‰å¾—å¯ä»¥é‡æ–°å¼€å§‹ä¸€è´¯æµªè´¹çš„ç”Ÿæ´»æ–¹å¼äº†ã€‚\n\n>  ä»æœ¬è´¨ä¸Šçœ‹ï¼Œé“å¾·è®¸å¯å°±æ˜¯ä¸€ç§èº«ä»½å±æœºã€‚æˆ‘ä»¬ä¹‹æ‰€ä»¥ä¼šå¥–åŠ±è‡ªå·±çš„è‰¯å¥½è¡Œä¸ºï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å†…å¿ƒæ·±å¤„è®¤ä¸ºï¼ŒçœŸæ­£çš„è‡ªå·±æƒ³åšåäº‹ã€‚ä»è¿™ç‚¹æ¥çœ‹ï¼Œæ¯æ¬¡è‡ªæ§éƒ½æ˜¯ä¸€ç§æƒ©ç½šï¼Œåªæœ‰æ”¾çºµè‡ªæˆ‘æ‰æ˜¯å¥–åŠ±ã€‚ä½†æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å®šè¦è¿™æ ·çœ‹å¾…è‡ªå·±å‘¢ï¼Ÿæƒ³è¦èµ°å‡ºâ€œé“å¾·è®¸å¯â€çš„é™·é˜±ï¼Œæˆ‘ä»¬å°±è¦çŸ¥é“ï¼Œé‚£ä¸ªæƒ³å˜å¥½çš„è‡ªå·±æ‰æ˜¯çœŸæ­£çš„è‡ªå·±ï¼Œæƒ³æŒ‰æ ¸å¿ƒä»·å€¼è§‚ç”Ÿæ´»çš„è‡ªå·±ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±ä¸ä¼šè®¤ä¸ºé‚£ä¸ªå†²åŠ¨ã€æ‡’æ•£ã€å®¹æ˜“å—è¯±æƒ‘çš„è‡ªå·±æ˜¯â€œçœŸæ­£â€çš„è‡ªå·±äº†ã€‚\n\n>  å¦‚æœåªæŒ‰ç…§â€œæ­£ç¡®â€å’Œâ€œé”™è¯¯â€æ¥åˆ¤æ–­åšè¿‡çš„äº‹ï¼Œè€Œä¸æ˜¯ç‰¢è®°æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„ä¸œè¥¿ï¼Œå°±ä¼šå¸¦æ¥ä¸ç›®æ ‡ç›¸æŠµè§¦çš„å†²åŠ¨ï¼Œå¹¶å…è®¸æˆ‘ä»¬åšå‡ºå¦¨ç¢è‡ªå·±çš„è¡Œä¸ºã€‚æƒ³è¦åšåˆ°å§‹ç»ˆå¦‚ä¸€ï¼Œæˆ‘ä»¬å°±éœ€è¦è®¤åŒç›®æ ‡æœ¬èº«ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬åšå–„äº‹æ—¶çš„å…‰ç¯ã€‚\n\n## æ€è€ƒ\n\nè¿™ä¸€ç« å¯¹æˆ‘æ¥è¯´å¸®åŠ©å¾ˆå¤§ï¼Œæˆ‘å°±ä¸€ç›´é™·å…¥äº†å®Œæˆç›®æ ‡->æ”¾çºµè¿™æ ·çš„æ€ªåœˆã€‚å®é™…ä¸Šï¼Œå¯¹æ‰€åšçš„äº‹åŠ ä»¥é“å¾·æ ‡å‡†ï¼Œä¹Ÿå°±æ˜¯ç”¨â€å¥½â€œä¸â€åâ€œè¡¡é‡ä¸€ä»¶äº‹å…¶å®æ˜¯ä¸€ä¸ªæ€ç»´é™·é˜±ã€‚å¦‚æœè¿™æ ·åšï¼Œä½ å°±ä¼šä¸ºè‡ªå·±çš„æ”¾çºµæ‰¾åˆ°ç†ç”±â€”â€”æˆ‘éƒ½åšäº†è¿™ä¹ˆå¤šâ€å¥½â€œäº‹äº†ï¼Œå¶å°”åšåšâ€åâ€œäº‹ä¹Ÿä¸è¦ç´§ã€‚æˆ‘ä»¬å¾ˆå®¹æ˜“è®¤ä¸ºï¼Œçºµå®¹è‡ªå·±å°±æ˜¯å¯¹ç¾å¾·æœ€å¥½çš„å¥–åŠ±ã€‚æˆ‘ä»¬å¿˜è®°äº†è‡ªå·±çœŸæ­£çš„ç›®æ ‡ï¼Œå‘è¯±æƒ‘å±ˆæœäº†ã€‚æœ¬ç« è¿˜æåˆ°äº†ä¸¤ä¸ªæœ‰æ„æ€çš„è§‚ç‚¹ï¼šâ€è¿›æ­¥å¯èƒ½è®©æˆ‘ä»¬æ”¾å¼ƒæ›¾ç»ä¸ºä¹‹å¥‹æ–—çš„ä¸œè¥¿â€œã€â€é“å¾·é«˜å°šä¹‹äººæ›´å¯èƒ½èµ°ä¸ŠçŠ¯ç½ªé“è·¯â€œï¼Œè¿™ä¸¤ä¸ªè§‚ç‚¹ä¹Ÿå¯ä»¥ç”¨â€é“å¾·è®¸å¯â€œåŠ ä»¥è§£é‡Šã€‚æ‰€ä»¥æˆ‘ä»¬ä¸åº”è¯¥ä¸ºè‡ªå·±åšè¿‡çš„â€å¥½â€œäº‹è€Œè’™è”½åŒçœ¼ï¼Œé‚£åªæ˜¯ä¸€ä»¶äº‹ï¼Œè€Œæ— ä»»ä½•å±æ€§!!åˆ«å¼•ç”³åˆ°åäº‹!!ã€‚\n\nè€Œâ€å…‰ç¯æ•ˆåº”â€œåˆ™æ˜¯å¯¹â€é“å¾·è®¸å¯â€œçš„å»¶ç”³ï¼Œå®ƒæŒ‡å‡ºå¦‚æœä½¿ä½ æ”¾çºµçš„ä¸œè¥¿å’Œä½¿ä½ è§‰å¾—å“å¾·é«˜å°šçš„ä¸œè¥¿åŒæ—¶å‡ºç°ï¼Œè¿™ä¼šæ›´è®©ä½ æ”¾çºµå¾—æ— è´Ÿç½ªæ„Ÿï¼Œä½ ä¼šä¸ä¼šå› ä¸ºå…³æ³¨ä¸€ä¸ªäº‹ç‰©æœ€æœ‰ç›Šçš„å“è´¨ï¼Œè€Œå…è®¸è‡ªå·±æ²‰æººäºå®ƒï¼Ÿæ¯”å¦‚ï¼Œä½ çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸‹åˆï¼Œè€Œä½ å´æ£é¼“äº†ä¸€å¤©ä½ çš„åšå®¢ï¼Œä½ ä¼šè¯´â€å¥½å§å…¶å®æ£é¼“åšå®¢ä¹Ÿå­¦ä¹ åˆ°äº†å¾ˆå¤šä¸œè¥¿â€œï¼Œè€Œä½ çœŸæ­£å¾—ç›®æ ‡å´è¢«å¿½è§†ã€‚\n\nå…³äºæ‹–å»¶é—®é¢˜ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¼šé«˜ä¼°æ˜å¤©çš„è‡ªå·±ã€‚è®¤ä¸ºæ˜å¤©çš„è‡ªå·±æ˜¯å®Œç¾çš„ï¼Œæˆ‘ä»¬æƒ³åˆ°æœªæ¥çš„é€‰æ‹©æ—¶ï¼Œå°±ä¼šå¾ˆå®¹æ˜“çŠ¯ä¸‹å¤§é”™ã€‚æˆ‘ä»¬ä¸æ–­æœŸæœ›æ˜å¤©èƒ½ä½œå‡ºå’Œä»Šå¤©ä¸åŒçš„é€‰æ‹©ï¼Œä½†è¿™ç§æœŸæœ›æ˜¯é”™è¯¯çš„ã€‚å¦‚æœä½ ä»Šå¤©è¡¨ç°â€ç³Ÿç³•â€œï¼Œé‚£ä¹ˆæ˜å¤©å¤§æ¦‚ç‡ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚å¦‚ä½•å…‹æœè¿™ç§é—®é¢˜å‘¢ï¼Ÿå½“ä½ æƒ³æ”¹å˜æŸç§è¡Œä¸ºçš„æ—¶å€™ï¼Œè¯•ç€å‡å°‘è¡Œä¸ºçš„å˜åŒ–æ€§ï¼Œè€Œä¸æ˜¯å‡å°‘é‚£ç§è¡Œä¸ºã€‚æ¯”å¦‚ä½ æŠ½çƒŸï¼Œä»Šå¤©æŠ½ä¸€åŒ…ï¼Œé‚£ä½ æ˜å¤©ä¹ŸæŠ½ä¸€åŒ…ï¼Œåå¤©ä¹ŸæŠ½ä¸€åŒ…ï¼Œè¿™æ ·æ¯æ”¯çƒŸå°±ä¸ä»…ä»…ä»£è¡¨ç€ä»Šå¤©çš„è¿™ä¸€æ”¯ï¼Œä½ è¿˜ä¼šè”æƒ³åˆ°ï¼šæˆ‘çš„å¤©å“ªï¼Œæˆ‘ä»Šå¤©æŠ½å®Œæ˜å¤©è¿˜è¦æŠ½è¿™ä¹ˆå¤šï¼Œè¿™å¤ªå¯æ€•äº†ã€‚ç„¶åä½ å°±æœ‰æ„è¯†çš„å‡å°‘å¸çƒŸé¢‘ç‡ã€‚ä½†æ˜¯æˆ‘æ„Ÿè§‰è¿™ç§æ–¹æ³•å¯¹æˆ‘æ¥è¯´æ²¡ä»€ä¹ˆç”¨ã€‚åªä½œè®°å½•\n\nå‡¯åˆ©åšå£«å‘Šè¯‰æˆ‘ä»¬å¦‚ä½•çœŸæ­£åœ°çœ‹å¾…é—®é¢˜ã€‚å¦‚æœåªæŒ‰ç…§â€œæ­£ç¡®â€å’Œâ€œé”™è¯¯â€æ¥åˆ¤æ–­åšè¿‡çš„äº‹ï¼Œè€Œä¸æ˜¯ç‰¢è®°æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„ä¸œè¥¿ï¼Œå°±ä¼šå¸¦æ¥ä¸ç›®æ ‡ç›¸æŠµè§¦çš„å†²åŠ¨ï¼Œå¹¶å…è®¸æˆ‘ä»¬åšå‡ºå¦¨ç¢è‡ªå·±çš„è¡Œä¸ºã€‚**æƒ³è¦åšåˆ°å§‹ç»ˆå¦‚ä¸€ï¼Œæˆ‘ä»¬å°±éœ€è¦è®¤åŒç›®æ ‡æœ¬èº«ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬åšå–„äº‹æ—¶çš„å…‰ç¯ã€‚**\n\n**æˆ‘ä»¬ä¹‹æ‰€ä»¥ä¼šå¥–åŠ±è‡ªå·±çš„è‰¯å¥½è¡Œä¸ºï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å†…å¿ƒæ·±å¤„è®¤ä¸ºï¼ŒçœŸæ­£çš„è‡ªå·±æƒ³åšåäº‹ã€‚ä»è¿™ç‚¹æ¥çœ‹ï¼Œæ¯æ¬¡è‡ªæ§éƒ½æ˜¯ä¸€ç§æƒ©ç½šï¼Œåªæœ‰æ”¾çºµè‡ªæˆ‘æ‰æ˜¯å¥–åŠ±ã€‚ä½†æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å®šè¦è¿™æ ·çœ‹å¾…è‡ªå·±å‘¢ï¼Ÿ** æƒ³è¦èµ°å‡ºâ€œé“å¾·è®¸å¯â€çš„é™·é˜±ï¼Œæˆ‘ä»¬å°±è¦çŸ¥é“ï¼Œé‚£ä¸ªæƒ³å˜å¥½çš„è‡ªå·±æ‰æ˜¯çœŸæ­£çš„è‡ªå·±ï¼Œæƒ³æŒ‰æ ¸å¿ƒä»·å€¼è§‚ç”Ÿæ´»çš„è‡ªå·±ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±ä¸ä¼šè®¤ä¸ºé‚£ä¸ªå†²åŠ¨ã€æ‡’æ•£ã€å®¹æ˜“å—è¯±æƒ‘çš„è‡ªå·±æ˜¯â€œçœŸæ­£â€çš„è‡ªå·±äº†ã€‚\n","tags":["é˜…è¯»æ„Ÿæ‚Ÿ","è‡ªæ§åŠ›"],"categories":["é˜…è¯»"]},{"title":"ä¸‰è¡Œä»£ç å®ç°æŒ‰é”®çš„é•¿çŸ­æŒ‰æ£€æµ‹","url":"/posts/862/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## è¯ä¸å¤šè¯´ç›´æ¥ä¸Šä»£ç \n\n```c\nuchar cont,trg;    //trigerè§¦å‘ continueè¿ç»­\nvoid KeyScan()\n{\n\tuchar ReadData =  PINB^0xff;\n\ttrg = ReadData & (ReadData^cont);\n\tcont = ReadData;\n}\n```\n\nå°±å®Œäº‹äº†ï¼Œç°å¸¸çš„amzingå•Šã€‚\n\n## å°è¯•ç†è§£\n\né¦–å…ˆæˆ‘ä»¬è¦ç†è§£`PINB`ï¼Œè¿™é‡Œçš„`PINB`æŒ‡çš„æ˜¯æˆ‘ä»¬çš„å•ç‰‡æœºGPIOBçš„æ‰€æœ‰Pinçš„ç«¯å£æ•°æ®ï¼Œè€Œæ¯ä¸ªç«¯å£çš„æ•°æ®ï¼ˆé«˜/ä½â€”â€”1/0ï¼‰å¯¹åº”1ä¸ªbitä½ã€‚ä¾‹å¦‚æŸå•ç‰‡æœºæœ‰å…«ä¸ªç«¯å£åªæœ‰ç«¯å£0ä¸ºé«˜ï¼Œå…¶ä½™çš†ä¸ºä½ï¼Œåˆ™PINB=0000 0001ã€‚åœ¨STM32Halåº“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š\n```c\nuint8_t KeyBit(void){\nÂ  Â  uint8_t keybit = 0x00;\nÂ  Â  //è¯»å–B1çš„ç”µå¹³çŠ¶æ€å¹¶æŠŠä»–å·¦ç§»åˆ°bit0ä½\nÂ  Â  keybit |= HAL_GPIO_ReadPin(B1_GPIO_Port,B1_Pin) << 0;\nÂ  Â  //åŒä¸Š\nÂ  Â  keybit |= HAL_GPIO_ReadPin(B2_GPIO_Port,B2_Pin) << 1;\nÂ  Â  keybit |= HAL_GPIO_ReadPin(B3_GPIO_Port,B3_Pin) << 2;\nÂ  Â  keybit |= HAL_GPIO_ReadPin(B4_GPIO_Port,B4_Pin) << 3;\nÂ  Â  return keybit; \n\n}\n```\n\n### å–å\n\nç¬¬ä¸€è¡Œä»£ç å°±ç›¸å½“äºæ˜¯å–åæ“ä½œï¼Œä½¿æ²¡æœ‰æŒ‰é”®æŒ‰ä¸‹æ—¶dataå§‹ç»ˆä¸º0x00ã€‚\n\næ³¨æ„ï¼Œä¸ä¸€å®šå°±æ˜¯å¼‚æˆ–0xffï¼ŒæŒ‰ç…§ä¸Šé¢çš„halåº“æ–¹æ³•ï¼Œä½ çš„PINBå˜é‡å®é™…ä¸Šåªæœ‰å››ä½æœ‰æ•ˆä½ï¼Œä¸ºäº†è®©æ²¡æœ‰æŒ‰é”®æŒ‰ä¸‹æ—¶dataä¸º0x00ï¼Œæˆ‘ä»¬å¼‚æˆ–0x0få³å¯ï¼Œæˆ–è€…å°†keybitåˆå§‹åŒ–ä¸º0xf0ç„¶åå¼‚æˆ–0xffï¼›è€Œæœ‰æ—¶GPIOè¾“å…¥æ¥äº†ä¸‹æ‹‰ï¼Œæ²¡æœ‰è¾“å…¥çš„æƒ…å†µæœ¬æ¥å°±æ˜¯0ï¼Œè¿™æ—¶å°±ä¸éœ€è¦å†å–åã€‚åæ­£å°±æ˜¯è¦è®©å®ƒæ²¡æœ‰æŒ‰é”®æŒ‰ä¸‹æ—¶ç­‰äº0x00ã€‚\n\n<details>\n\n<summary>ç‚¹å‡»å³çœ‹å¼‚æˆ–çœŸå€¼è¡¨</summary>\n\nä¸0å¼‚æˆ–ä¸å˜ï¼Œä¸1å¼‚æˆ–å–å\n\n| A   | B   | A âŠ• B |\n| --- | --- | ----- |\n| 0   | 0   | 0     |\n| 0   | 1   | 1     |\n| 1   | 0   | 1     |\n| 1   | 1   | 0     |\n\n</details>\n\n### å•å‡»æŒ‰ä¸‹\n\nç¬¬ä¸€æ¬¡PB0æŒ‰ä¸‹çš„æƒ…å†µ  \nç«¯å£æ•°æ®åŸæœ¬ä¸º0xfeï¼ŒReadDataè¯»ç«¯å£å¹¶ä¸”å–åï¼Œå˜ä¸ºÂ 0x01Â ï¼ˆç¬¬ä¸€è¡Œï¼‰ã€‚\nå› ä¸ºè¿™æ˜¯ç¬¬ä¸€æ¬¡æŒ‰ä¸‹ï¼Œæ‰€ä»¥Contæ˜¯ä¸Šæ¬¡çš„å€¼ï¼Œåº”ä¸ºä¸º0ã€‚ä¸0å¼‚æˆ–ä¸æ”¹å˜åŸæœ‰å€¼ï¼Œé‚£ä¹ˆç¬¬äºŒè¡Œæ‰§è¡Œçš„å®é™…æ˜¯ï¼š\n```\nTrg = 0x01 & (0x01^0x00) = 0x01  \n``` \n\nå°†contèµ‹å€¼\n\n```\nCont = ReadData = 0x01\n```\nç»“æœå°±æ˜¯ï¼š\n- ReadDataÂ ï¼Â 0x01\n- TrgÂ ï¼Â 0x01\n- ContÂ ï¼Â 0x01\n\n### æŒ‰ä¸‹åè¿˜æ²¡æœ‰å®Œå…¨æ¾å¼€ï¼ˆå¼•ç”³åˆ°é•¿æŒ‰ï¼‰\n\næ­¤æ—¶ç¨‹åºä¾ç„¶åœ¨æ‰§è¡Œã€‚\n- ç¬¬ä¸€è¡Œï¼šä¸å˜ï¼Œä¾ç„¶ä¸º0x01ã€‚\n- ç¬¬äºŒè¡Œï¼šæ“ä½œä¸ºâ€”â€”æŠŠæ£€æµ‹åˆ°çš„æŒ‰ä¸‹æŒ‰é’®å¯¹åº”çš„bitä¸ºç»™ç½®0äº†ï¼Œè®©Trgç­‰äº0äº†\n- ç¬¬ä¸‰è¡Œï¼šä¸å˜ï¼Œä¾ç„¶ä¸º0x01ã€‚\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°å”¯ä¸€å˜äº†çš„åœ°æ–¹å°±æ˜¯Trgè¢«ç½®0äº†ã€‚\n\n### å®Œå…¨æ¾å¼€\nå¾ˆå¥½ç†è§£ï¼Œè‚¯å®šå…¨ä¸º0x00äº†ã€‚\n\n### ç¬”è€…çš„æ€è€ƒ\n\nè¯¥ä»£ç çš„æ ¸å¿ƒæ€è·¯æˆ‘è®¤ä¸ºæ˜¯ç”¨ä¸‰ç§ä¸åŒçš„æ•°æ®å†…å®¹ä»£è¡¨ä¸åŒçš„ä¸‰ç§æƒ…å†µï¼ˆæœªæŒ‰ä¸‹ã€å•æŒ‰ã€é•¿æŒ‰ï¼‰æŒ‰ç…§è¿™ç§æ€è·¯ï¼Œæˆ‘ä»¬ç”šè‡³è¿˜å¯ä»¥æ‰©å±•ã€‚\n\n`ReadData`å­˜å‚¨åŸå§‹çš„ç«¯å£ç”µå¹³æ•°æ®ï¼Œä¸èƒ½æ”¹å˜ã€‚åç»­çš„ä¸¤ä¸ªæ•°æ®éƒ½ä¼šåŸºäºè¿™ä¸ªåŸå§‹æ•°æ®ã€‚\n`Trg` ç”¨äºæŒ‰é”®è§¦å‘ã€‚`ReadData`ä¸­æœ‰bitä½æœ‰ä¸Šå‡æ²¿æ—¶ï¼ŒTrgä¼šè®°å½•è¿™ä¸ªä¸Šå‡æ²¿ï¼šåªæœ‰bitä»0å˜ä¸º1ï¼ŒTrgæ‰ä¼šç½®1ã€‚æŒ‰ä¸‹åˆ¤æ–­çš„æ¡ä»¶æ˜¯ï¼š`Trg`ã€`Cont`å‡ä¸º1ã€‚\n`Cont` ç”¨äºé•¿æŒ‰ã€‚é•¿æŒ‰çš„åˆ¤æ–­æ¡ä»¶æ˜¯ï¼š`Trg`ä¸º0çš„æƒ…å†µä¸‹`Cont`ä¾ç„¶ä¸º1ã€‚\n\nè¿™æ ·çš„æ€è·¯è®©æˆ‘è”æƒ³åˆ°äº†3-8è¯‘ç å™¨çš„å·§å¦™è®¾è®¡ï¼Œé€šè¿‡3ä¸ªå€¼çš„è¾“å…¥ï¼Œå¯ä»¥å¾—åˆ°8ä¸ªå€¼çš„è¾“å‡ºï¼Œç”¨3ä¸ªå€¼å°±å¯ä»¥ä¸º8ä¸ªä¸åŒçš„æƒ…å†µè¿›è¡Œå¤„ç†ã€‚\n\n## åœ¨STM32ä¸­ä½¿ç”¨\n\né™„ä¸Šæˆ‘çš„ä½¿ç”¨æ–¹æ³•ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯[æ—¶é—´ç‰‡è½®è¯¢æ¶æ„](http://im.godmao.top/posts/39448/)ã€‚\n\n```c\n\n#define B1 0x01\n\n#define B2 0x02\n\n#define B3 0x04\n\n#define B4 0x08\n\nuint8_t KeyBit(void){\n\nÂ  Â  uint8_t keybit = 0x00;\n\nÂ  Â  //è¯»å–B1çš„ç”µå¹³çŠ¶æ€å¹¶æŠŠä»–å·¦ç§»åˆ°bit0ä½\nÂ  Â  keybit |= HAL_GPIO_ReadPin(B1_GPIO_Port,B1_Pin) << 0;\nÂ  Â  //åŒä¸Š\nÂ  Â  keybit |= HAL_GPIO_ReadPin(B2_GPIO_Port,B2_Pin) << 1;\nÂ  Â  keybit |= HAL_GPIO_ReadPin(B3_GPIO_Port,B3_Pin) << 2;\nÂ  Â  keybit |= HAL_GPIO_ReadPin(B4_GPIO_Port,B4_Pin) << 3;\n\nÂ  Â  return keybit;\n\n}\n\nvoid KeyFuc(void){//æŒ‰é”®é€»è¾‘\n\nÂ  Â  static uint8_t i = 0; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //é•¿æŒ‰æ—¶é—´è®¡æ•°å™¨\n\nÂ  Â  //æ ¸å¿ƒä»£ç ï¼šä¸‰è¡Œä»£ç å®ŒæˆæŒ‰é”®å•ã€é•¿æŒ‰æ£€æµ‹\n\nÂ  Â  unsigned char ReadData = KeyBit() ^ 0x0f; Â  Â  Â  // å–åï¼šåœ¨æ²¡æœ‰æŒ‰é”®æŒ‰ä¸‹çš„æƒ…å†µä¸‹ï¼Œå…¶å§‹ç»ˆä¸º0x00\n\nÂ  Â  Trg = ReadData & (ReadData ^ Cont); Â  Â  Â  Â  Â  Â  // 2\n\nÂ  Â  Cont = ReadData; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // 3 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â \n\nÂ  Â  if(Trg && Cont){//å•å‡»é€»è¾‘ Â  Â  Â \n\nÂ  Â  Â  Â  switch(Trg){ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â \n\nÂ  Â  Â  Â  Â  Â  case B4: Key4_Fuc();break;\n\nÂ  Â  Â  Â  Â  Â  case B3: Key3_Fuc();break; Â  Â  Â  Â  Â \n\nÂ  Â  Â  Â  Â  Â  case B2: Key2_Fuc();break; Â  Â  Â  Â  Â \n\nÂ  Â  Â  Â  Â  Â  case B1: Key1_Fuc();break; Â \n\nÂ  Â  Â  Â  Â  Â  default: break;\n\nÂ  Â  Â  Â  }\n\nÂ  Â  }\n\nÂ  Â  if(Cont && 0 == Trg) i++;//ä»¥ä¸‹ä¸ºé•¿æŒ‰é€»è¾‘\nÂ  Â  else i = 0;\nÂ  Â  \nÂ  Â  if(i >= 20){\nÂ  Â  Â  Â  i = 0;\n\nÂ  Â  Â  Â  switch(Cont)\nÂ  Â  Â  Â  {\n\nÂ  Â  Â  Â  Â  Â  case B3: Key3_Fuc_Preesed();break;\n\nÂ  Â  Â  Â  Â  Â  default: break;\n\nÂ  Â  Â  Â  }\n\nÂ  Â  }\n\n  \n\n}\n\n```\n\n## å…³äºæ¶ˆæŠ–é—®é¢˜\n\n~~ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼ŒæŒ‰ç†æ¥è¯´æ˜¯éœ€è¦æ¶ˆæŠ–çš„ï¼Œä½†æ˜¯å®é™…è·‘èµ·æ¥çš„æ—¶å€™æ²¡æœ‰æ¶ˆæŠ–ä¹Ÿéå¸¸ç¨³ï¼Œï¼Œï¼Œå¯èƒ½æ˜¯æˆ‘çš„æŒ‰é”®æ£€æµ‹ä»»åŠ¡æ‰§è¡Œé—´éš”æ¯”è¾ƒé•¿ï¼Ÿ~~\n\n--- \n\n2025.03.28 è¡¥å……ä¿®æ”¹ï¼šå¦‚æœä½¿ç”¨æ—¶é—´ç‰‡è½®è¯¢è°ƒåº¦ï¼Œç†è®ºä¸Šå¦‚æœæŒ‰é”®æ‰«æä»»åŠ¡æ‰§è¡Œé—´éš”æ—¶é—´è¾ƒé•¿ï¼Œæ˜¯ä¸ç”¨æ¶ˆæŠ–çš„ã€‚è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆæˆ‘çš„ç¨‹åºæ²¡æœ‰æ¶ˆæŠ–ä¹Ÿé‚£ä¹ˆç¨³ï¼ä¾‹å¦‚ï¼Œå‡è®¾ä½ è®¾ç½®çš„æ—¶é—´ç‰‡è°ƒåº¦é—´éš”æ˜¯ 100msï¼Œå¦‚æœæŒ‰é”®æ¯æ¬¡æ‰«ææ—¶æ˜¯ 100ms æ‰§è¡Œä¸€æ¬¡ï¼Œå‡è®¾æŒ‰é”®æŠ–åŠ¨çš„å‘¨æœŸæ˜¯ 10msï¼Œé‚£ä¹ˆæ¯æ¬¡æ‰«ææ—¶æŒ‰é”®å°±å·²ç»ç¨³å®šäº†ã€‚è¿™æ ·ï¼ŒæŒ‰é”®çš„ç‰©ç†çŠ¶æ€å˜åŒ–å°±ä¸å¤ªå¯èƒ½è¢«è¯¯åˆ¤ä¸ºå¤šä¸ªçŠ¶æ€å˜åŒ–ï¼Œå› ä¸ºæ—¶é—´é—´éš”æœ¬èº«å·²ç»è¶³å¤Ÿé•¿ã€‚å½“ç„¶ä»£ä»·æ˜¯ **ä¼šç‰ºç‰²æŒ‰é”®å“åº”é€Ÿåº¦ï¼Œä»¥åŠæ— æ³•åº”ç”¨å¿«é€Ÿè¿æŒ‰çš„æŒ‰é”®é€»è¾‘**\n\n--- \n\nå…³äºæ¶ˆæŠ–æˆ‘è¿˜æ²¡æœ‰å®é™…ä¸Šæœºè·‘è¿‡ï¼Œä½†æ˜¯ä¹Ÿå†™ä¸€ä¸‹ï¼ŒDeepseekå†™çš„ï¼š\n\n```c\n#define DEBOUNCE_TIME 1 //æ¶ˆæŠ–æ—¶é—´å‚æ•°ï¼Œæ ¹æ®æ—¶é—´ç‰‡çš„æ—¶é—´æ¥è®¾å®š\n\ntypedef enum {\n    KEY_STATE_IDLE,//ç©ºé—²\n    KEY_STATE_PRESSED,//æŒ‰ä¸‹\n    KEY_STATE_RELEASED//æ¾å¼€\n} KeyState;\n\nKeyState key_state = KEY_STATE_IDLE;\n\nuint16_t debounce_timer = 0;\n\nvoid KeyScan() {\n    uchar ReadData = PINB ^ 0xff;\n    uchar new_trg = ReadData & (ReadData ^ cont);\n\n    switch (key_state) {\n        case KEY_STATE_IDLE:\n            if (new_trg != 0) { // æ£€æµ‹åˆ°æŒ‰é”®å˜åŒ–\n                key_state = KEY_STATE_PRESSED;\n                debounce_timer = DEBOUNCE_TIME;\n            }\n            break;\n\n        case KEY_STATE_PRESSED:\n            if (debounce_timer > 0) {\n                debounce_timer --;\n            } else {\n                if (ReadData == (PINB ^ 0xff)) { // ç¡®è®¤æŒ‰é”®çŠ¶æ€\n                    trg = new_trg;\n                    cont = ReadData;\n\t\t    if(trg && cont){\n\t\t\t/*å†™å•å‡»é€»è¾‘*/\n\t\t    }\n                    key_state = KEY_STATE_RELEASED;\n                } else {\n                    key_state = KEY_STATE_IDLE;\n                }\n            }\n            break;\n\n        case KEY_STATE_RELEASED:\n            if (new_trg == 0) { // ç­‰å¾…æŒ‰é”®é‡Šæ”¾\n                key_state = KEY_STATE_IDLE;\n            }\n            break;\n    }\n}\n```\n\n","tags":["ç¨‹åºæ¶æ„","æŒ‰é”®æ£€æµ‹"],"categories":["åµŒå…¥å¼","ç¨‹åºæ¶æ„"]},{"title":"åµŒå…¥å¼æ¨¡å—åŒ–è®¾è®¡ä¸­çš„æ•°æ®å…±äº«ä¼˜åŒ–æ–¹æ¡ˆ","url":"/posts/58440/","content":"\n<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## é—®é¢˜çš„æå‡º\n\nåœ¨åµŒå…¥å¼é¡¹ç›®ä¸­ï¼Œæ¨¡å—åŒ–æ¯ä¸ªåŠŸèƒ½æœ‰åˆ©äºç®¡ç†å’Œç†æ¸…å¼€å‘æ€è·¯ï¼Œä½†æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦å°†æ¨¡å—è”åŠ¨èµ·æ¥çš„æ—¶å€™ï¼Œéœ€è¦ä¸€äº›å¿…è¦çš„å˜é‡ä»¥å®ç°ä¸¤ä¸ªæ¨¡å—ä¹‹é—´çš„äº’ç›¸é…åˆï¼Œæœ€å¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨å…¨å±€å˜é‡ï¼Œä½†è¿™æ ·åšä½¿æ¨¡å—é—´è€¦åˆæ€§[^1]å¤§å¤§æé«˜äº†ã€‚\n\n## æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹æ¡ˆå—\n\næœ‰çš„å…„å¼Ÿæœ‰çš„ã€‚åªä¸è¿‡è¦ç‰ºç‰²ä¸€äº›æ•ˆç‡ï¼ˆéœ€è¦é€šè¿‡æ¥å£è®¿é—®ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºå…±äº«å˜é‡å»ºç«‹ä¸€ä¸ªä¸“é—¨çš„.c/.hæ–‡ä»¶ï¼Œä¾‹å¦‚`SharedData.c/.h`ã€‚\nè¿™ä¸ªæ–‡ä»¶é›†ä¸­ç®¡ç†æ¨¡å—é—´çš„å…±äº«å˜é‡ã€‚è¿™æ ·åšç»“æ„æ¸…æ™°ï¼Œæ¯ä¸ªæ¨¡å—**åªä¾èµ– `SharedData.h`ï¼Œè€Œä¸æ˜¯å½¼æ­¤ä¾èµ–**\\ \nåŒæ—¶æˆ‘ä»¬é€šè¿‡ä¸¤ç§æ–¹æ³•ä½¿éœ€è¦è®¿é—®å˜é‡çš„æ¨¡å—æˆåŠŸè¯»å–æˆ–ä¿®æ”¹å˜é‡ï¼š\n- ç»“æ„ä½“å°è£…+æŒ‡é’ˆä¼ é€’\n- é€šè¿‡å‡½æ•°æä¾›è¯»å–å’Œä¿®æ”¹çš„æ¥å£\n\n## ç»“æ„ä½“å°è£…+æŒ‡é’ˆä¼ é€’\n\n:::recommend\n\n- å…±äº«å˜é‡è¾ƒå¤šæ—¶éå¸¸å¥½ç”¨ã€‚\n- **éšè—å…¨å±€å˜é‡**ï¼Œå¤–éƒ¨æ¨¡å—æ— æ³•ç›´æ¥è®¿é—®å…±äº«æ•°æ®è€Œæ˜¯é€šè¿‡æŒ‡é’ˆï¼Œå®‰å…¨æ€§é«˜ã€‚\n- æ›´å¥½æ‰©å±•ã€‚\n- æ–¹ä¾¿ï¼Œæ— éœ€ä¸ºæ¯ä¸ªå˜é‡éƒ½å†™å‡½æ•°æ¥å£ä»¥æä¾›ä¿®æ”¹ä¸è¯»å–ã€‚\n- **è®¿é—®é€Ÿåº¦å¿«**ã€‚\n\n:::\n\n### .hæ–‡ä»¶\n```c\n#ifndef SHARED_DATA_H\n#define SHARED_DATA_H\n\ntypedef struct {\n    int sensor_value;\n    int motor_speed;\n} SharedData;\n\n// åªæä¾›è·å–æŒ‡é’ˆçš„æ¥å£ï¼Œè€Œä¸æ˜¯ç›´æ¥æš´éœ²å˜é‡\nSharedData* get_shared_data(void);\n\n#endif\n```\n\n### .cæ–‡ä»¶\n\n```c\n#include \"shared_data.h\"\n\nstatic SharedData system_data = {0, 0}; // åªåœ¨æœ¬æ–‡ä»¶å¯è§\n\nSharedData* get_shared_data() {\n    return &system_data;\n}\n```\n\n### åœ¨å…¶ä»–æ¨¡å—ä¸­ä½¿ç”¨\n\n```c\n#include \"shared_data.h\"\n\nvoid moduleA_update() {\n    SharedData *data = get_shared_data();\n    data->sensor_value += 10;\n}\n```\n\n:::warning\n\nä¸æ¨èå°†**æ¥æ”¶å…±äº«å˜é‡çš„æŒ‡é’ˆçš„å˜é‡**å®šä¹‰ä¸ºå…¨å±€å˜é‡ã€‚å°½ç®¡è¿™æ ·ä¼šæ–¹ä¾¿ä¸€äº›ã€‚**æŒ‡é’ˆå¯èƒ½è¢«å¤šä¸ªæ¨¡å—ä¿®æ”¹**ï¼Œå¯¼è‡´æŒ‡å‘æ— æ•ˆåœ°å€ï¼ˆå¢åŠ  bug é£é™©ï¼‰ã€‚æ¨èåœ¨æ¯ä¸ªå‡½æ•°å†…éƒ¨é€šè¿‡æ¥å£è®¿é—®å˜é‡ã€‚å¦‚æœä¸€å®šè¦è¿™æ ·åšï¼Œè¯·ä¸€å®šé¿å…ç©ºæŒ‡é’ˆï¼ˆè®°ä½åˆå§‹åŒ–æŒ‡é’ˆï¼‰\n\n:::\n\nä½¿ç”¨å…¨å±€æŒ‡é’ˆç¤ºä¾‹ï¼š\n```c\nstatic SharedData *data;  // ä»…é™å½“å‰æ–‡ä»¶è®¿é—®\n\nvoid moduleA_init() {\n    data = get_shared_data();//é¿å…ç©ºæŒ‡é’ˆ\n}\n```\n\n## é€šè¿‡å‡½æ•°æä¾›è¯»å–å’Œä¿®æ”¹çš„æ¥å£\n\n:::recommend\n\n- **çµæ´»è®¿é—®å˜é‡ã€‚ä½ å¯ä»¥ä¸¥æ ¼æ§åˆ¶å¯¹æ•°æ®çš„è®¿é—®ï¼Œå¦‚åªè¯»ã€é¿å…éæ³•å€¼å†™å…¥ç­‰ï¼›åŒæ—¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰è®¿é—®æ–¹æ³•ï¼Œå¦‚æŒ‰ä½è¯»å–ã€‚éå¸¸çš„å¥½ç”¨ã€‚**\n- å¯æ‰©å±•æ€§å¼ºã€‚\n\n:::\n\n:::error\n\n- ä»£ç å†—é•¿ï¼Œè°ƒç”¨èŠ±é”€ç¨å¤§ã€‚\n- å˜é‡å¤ªå¤šæ—¶éœ€è¦ä¸ºæ¯ä¸ªå˜é‡éƒ½å†™æ¥å£ï¼Œå¤ªéº»çƒ¦ã€‚æ‰€ä»¥æ‰è¦å’Œä¸Šé¢çš„æ–¹æ³•è”åˆèµ·æ¥ä½¿ç”¨ï¼Œåªä¸ºå¿…è¦çš„å˜é‡ç¼–å†™æ¥å£ï¼Œå…¶ä½™é€šè¿‡ç¬¬ä¸€ç§æ–¹æ³•è®¿é—®ã€‚\n\n:::\n\n### .hæ–‡ä»¶\n\n```c\n#ifndef SHARED_DATA_H\n#define SHARED_DATA_H\n\nvoid setSensorValue(int value);\nint getSensorValue();\n\nvoid setMotorSpeed(int speed);\nint getMotorSpeed();\n\n#endif\n\n```\n\n### .cæ–‡ä»¶\n\n```c\n#include \"shared_data.h\"\n\nstatic int sensor_value = 0;\nstatic int motor_speed = 0;\n\nvoid setSensorValue(int value) {\n    if (value >= 0) {  // é™åˆ¶éæ³•å€¼\n        sensor_value = value;\n    }\n}\n\nint getSensorValue() {\n    return sensor_value;\n}\n\nvoid setMotorSpeed(int speed) {\n    if (speed >= 0) {\n        motor_speed = speed;\n    }\n}\n\nint getMotorSpeed() {\n    return motor_speed;\n}\n\n```\n\n### åœ¨å…¶ä»–æ¨¡å—ä¸­ä½¿ç”¨\n\n```c\n#include \"shared_data.h\"\n\nvoid moduleA_update() {\n    setSensorValue(getSensorValue() + 10);\n}\n```\n\n## è”åˆèµ·æ¥\n\nå°†ä¸¤ç§æ–¹å¼è”åˆèµ·æ¥ä½¿ç”¨â€”â€”å¤§éƒ¨åˆ†å˜é‡ï¼Œæˆ‘ä»¬ä½¿ç”¨æŒ‡é’ˆæ¥å£è®¿é—®å³å¯ï¼›å¦‚æœæœ‰äº›å˜é‡éœ€è¦ä¸€äº›ä¸ªæ€§åŒ–è¦æ±‚ï¼Œæˆ‘ä»¬ä¸ºè¿™äº›å˜é‡ç¼–å†™å®šåˆ¶çš„æ¥å£å°±å¥½ã€‚\n\n## æŒ–å‘\n\né™ä½è€¦åˆæ€§çš„æ–¹æ³•è¿˜æœ‰ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œä»¥åŠRTOSä¸­çš„æ¶ˆæ¯/äº‹ä»¶æœºåˆ¶ã€‚åç»­ç ”ç©¶ã€‚\n\n[^1]: ä»£ç è€¦åˆæ€§ï¼ˆCouplingï¼‰æ˜¯æŒ‡æ¨¡å—æˆ–ç»„ä»¶ä¹‹é—´çš„ä¾èµ–ç¨‹åº¦ã€‚å¦‚æœä»£ç è€¦åˆæ€§å¾ˆé«˜ï¼Œæ¨¡å—ä¹‹é—´ä¼šç´§å¯†ä¾èµ–ï¼Œå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤ã€æ‰©å±•å’Œæµ‹è¯•ã€‚\n\n","tags":["åµŒå…¥å¼","ç¨‹åºæ¶æ„","é™ä½è€¦åˆ"],"categories":["åµŒå…¥å¼","ç¨‹åºæ¶æ„"]},{"title":"ä¸²å£é‡å®šå‘çš„éé˜»å¡æ–¹æ³•","url":"/posts/18285/","content":"\n<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## å¸¸ç”¨æ–¹å¼\n\næœ‰æ—¶æˆ‘ä»¬éœ€è¦ä¸²å£æ‰“å°ä¿¡æ¯åˆ°ä¸Šä½æœºï¼Œæœ€ä¾¿æ·çš„æ–¹æ³•æ˜¯é‡å®šå‘ `printf()`ï¼Œç½‘ä¸Šçš„å¸¸ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š\n\n```c\n\nint fputc(int ch, FILE *f){    \n\tHAL_UART_Transmit(&huart1, (uint8_t *)&ch, 1, 0xffff);\n    \n\treturn ch;   \n}\n\nint fgetc(FILE *f){\n    \n\tuint8_t ch = 0;\n\t    \n\tHAL_UART_Receive(&huart1, &ch, 1, 0xffff);\n\t    \n\treturn ch;   \n}\n\n```\n\n### è¿™æ ·åšçš„ç¼ºç‚¹\n\n- è¿™æ˜¯ **é˜»å¡æ¨¡å¼**ï¼Œæ¯æ¬¡ `printf()` éƒ½è¦ç­‰å¾…æ•°æ®å‘é€å®Œæ¯•ï¼Œå½±å“ CPU æ‰§è¡Œæ•ˆç‡ã€‚\n- å¦‚æœæ•°æ®è¾ƒå¤šï¼Œä¼šé™ä½å®æ—¶æ€§ï¼Œé˜»å¡ä¸»å¾ªç¯ã€‚\n\n## ä½¿ç”¨éé˜»å¡çš„æ–¹å¼ï¼šçµæ´»è¿ç”¨DMA\n\næˆ‘ä»¬ä½¿ç”¨DMAéé˜»å¡å‘é€ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š\n\n### 1. å®šä¹‰ç¼“å†²åŒºã€‚\n\næ ¹æ®fputc()çš„ç‰¹æ€§ï¼ˆè¿™é‡Œå…ˆæŒ‰ä¸‹ä¸è¡¨ï¼‰ï¼Œä½¿ç”¨ DMA å‘é€æ—¶ï¼Œ`printf()` éœ€è¦å…ˆæŠŠæ•°æ®å­˜åˆ° **ä¸€ä¸ªç¼“å†²åŒº**ï¼Œç„¶åä¸€æ¬¡æ€§ä½¿ç”¨ DMA å‘é€å‡ºå»ã€‚\n\n```c\n\n#define TX_BUFFER_SIZE 256  // å‘é€ç¼“å†²åŒºå¤§å°\nuint8_t uart_tx_buffer[TX_BUFFER_SIZE];  // ä¸²å£å‘é€ç¼“å†²åŒº\nvolatile uint16_t tx_len = 0;  // å½“å‰ç¼“å†²åŒºæ•°æ®é•¿åº¦\nvolatile uint8_t tx_busy = 0;  // å‘é€çŠ¶æ€æ ‡å¿—\n\n```\n\n### 2. é‡å®šå‘ `fputc()`ï¼Œä½¿ç”¨ç¼“å†²åŒº\n\n```c\n\nint fputc(int ch, FILE *f)\n{\n    // ç¡®ä¿ç¼“å†²åŒºä¸ä¼šæº¢å‡º\n    if (tx_len < TX_BUFFER_SIZE - 1)\n    {\n        uart_tx_buffer[tx_len++] = (uint8_t)ch;\n    }\n\n    // å¦‚æœé‡åˆ°æ¢è¡Œç¬¦ï¼Œæˆ–è€…ç¼“å†²åŒºæ¥è¿‘æ»¡ï¼Œå°±å¯åŠ¨ DMA å‘é€\n    // æ³¨æ„å’¯ï¼Œå¦‚æœç¼“å†²åŒºæ²¡æ»¡çš„æƒ…å†µä¸‹ï¼Œåªæœ‰æ£€æµ‹åˆ°/næ‰ä¼šè§¦å‘DMAçš„å‘é€ã€‚æ‰€ä»¥åœ¨ç¼“\n    // å†²åŒºæ²¡æ»¡çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æƒ³è¦å‘é€å­—ç¬¦ä¸²\"abc\"ï¼Œprintf(\"abc\")æ˜¯æ²¡ç”¨çš„ï¼Œ\n    // printf(\"abc\\n\")æ‰æœ‰ç”¨å“¦ã€‚\n    if (ch == '\\n' || tx_len >= TX_BUFFER_SIZE - 1)\n    {\n        uart_dma_transmit();\n    }\n\n    return ch;\n}\n\n\n```\n\n### 3. å®šä¹‰DMA å‘é€å‡½æ•°\n\n```c\n\nvoid uart_dma_transmit(void)\n{\n    // å¦‚æœ DMA è¿˜åœ¨å¿™ï¼Œåˆ™ä¸å¯åŠ¨æ–°çš„ä¼ è¾“\n    if (tx_busy) return;\n\n    tx_busy = 1;  // æ ‡è®°ä¸ºå‘é€ä¸­\n    HAL_UART_Transmit_DMA(&huart1, uart_tx_buffer, tx_len);\n}\n\n```\n\n### 4. DMA ä¼ è¾“å®Œæˆå›è°ƒ\n\n```c\n\nvoid HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)\n{\n    if (huart->Instance == USART1)  // ç¡®ä¿æ˜¯ç›®æ ‡ä¸²å£\n    {\n        tx_len = 0;  // æ¸…ç©ºç¼“å†²åŒº\n        tx_busy = 0; // æ ‡è®°ä¸ºå¯ç”¨\n    }\n}\n\n```\n\n\n## ä¸€äº›ç–‘æƒ‘çš„è§£ç­”\n\nQ: èŒ‚ç¥èŒ‚ç¥ï¼Œä½ çš„è¯´çš„éé˜»å¡æ–¹å¼çš„ç¡®å¾ˆä¸é”™ï¼Œä½†æ˜¯è¿˜æ˜¯å¤ªåƒæ“ä½œäº†ï¼Œæˆ‘å°±ä¸èƒ½ç›´æ¥åœ¨ `fputc()`é‡Œå†™ `HAL_UART_Transmit_DMA`å—ï¼Ÿ\\\n\\\nA: å¯ä»¥çš„å…„å¼Ÿå¯ä»¥çš„ã€‚`fputc()` æ˜¯å‘é€ä¸€ä¸ªå­—ç¬¦å¯¹å§ï¼Œç†è®ºä¸Šæˆ‘ä»¬åªéœ€è¦æŠŠDMAä¼ è¾“çš„å­—èŠ‚æ•°æ”¹ä¸º1å°±è¡Œäº†å¯¹å§ï¼Ÿnononoï¼Œé¦–å…ˆDMAæ˜¯éé˜»å¡çš„å¯¹å§ï¼Œä¹Ÿå°±æ˜¯æ¿€æ´»äº†å®ƒï¼Œä»–å°±åªç®¡å‘ï¼Œä¸ç®¡ä½ å®Œæ²¡å®Œæˆï¼Œä½ éƒ½å¯ä»¥å†æ¬¡æ¿€æ´»å®ƒï¼Œå¦‚æœåƒä½ è¿™æ ·åšï¼Œå½“å‘é€å­—ç¬¦æµæ—¶å¤§æ¦‚ç‡æ˜¯è¿™ç§æƒ…å†µï¼š\n> `fputc()`æ‰“ç”µè¯ç»™DMAçš„ç§˜ä¹¦è¯´æˆ‘è¦å‘è¿™ä¸ªå­—ç¬¦ï¼Œç„¶åä»–å°±è®¤ä¸ºæˆ‘å·²ç»ç»™DMAè¯´äº†å«å®ƒå‘é€è¿™ä¸ªå­—ç¬¦å•¦ï¼Œæ‰€ä»¥è¿™ä¸ªå­—ç¬¦å°±å‘å‡ºå»å•¦ï¼Œå‰©ä¸‹å°±ä¸å…³æˆ‘çš„äº‹å•¦ã€‚ç»“æœDMAç§˜ä¹¦çœ‹åˆ°DMAæ­¤æ—¶è¿˜åœ¨å¿™äºä¸Šæ¬¡å‘é€ï¼Œäºæ˜¯åˆ¤æ–­DMAä¸º`HAL_BUSY`æ²¡æœ‰åŠæ³•æŠŠå­—ç¬¦äº¤ç»™DMAã€‚è¿™ä¸ªå­—ç¬¦ä¿¡æ¯å°±ä¸¢å¤±äº†ã€‚ã€‚ã€‚ã€‚","tags":["STM32","åµŒå…¥å¼","ç¨‹åºæ¶æ„","ä¸²å£"],"categories":["åµŒå…¥å¼","ç¨‹åºæ¶æ„"]},{"title":"CubeMXé…ç½®åŠŸèƒ½ç³»åˆ—ï¼šiic","url":"/posts/58129/","content":"\n<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## è¯´æ˜\nç”±äºå‰é¢å·²ç»è¯¦ç»†ä»‹ç»äº†iicé€šä¿¡åè®®ï¼ˆè¯¦è§[é€šä¿¡åè®®ï¼šiic [ g0dMa0's Blog ]](https://im.godmao.top/posts/55329/)ï¼‰ï¼Œè¿™é‡Œä¸»è¦å°±ç¡¬ä»¶iicåœ¨cubemxä¸­çš„é…ç½®ä½œä»‹ç»ã€‚\n\n## é€šé“è®¾ç½®\n![](Snipaste_2025-03-12_14-59-01.png)\nå“ˆå“ˆæ²¡æƒ³åˆ°å§ï¼Œiicé€šé“ä¸æ­¢æ”¯æŒiicåè®®ï¼Œå­©å­ã€‚\\\nSMBus-ç³»ç»Ÿç®¡ç†æ€»çº¿ï¼Œæ˜¯iicçš„æ‰©å±•ã€‚åˆ©ç”¨ç³»ç»Ÿç®¡ç†æ€»çº¿ï¼Œè®¾å¤‡å¯æä¾›åˆ¶é€ å•†ä¿¡æ¯ï¼Œå‘Šè¯‰ç³»ç»Ÿå®ƒçš„å‹å·/éƒ¨ä»¶å·ï¼Œä¿å­˜æš‚åœäº‹ä»¶çš„çŠ¶æ€ï¼ŒæŠ¥å‘Šä¸åŒç±»å‹çš„é”™è¯¯ï¼Œæ¥æ”¶æ§åˆ¶å‚æ•°ï¼Œå’Œè¿”å›å®ƒçš„çŠ¶æ€ã€‚SMBusä¸ºç³»ç»Ÿå’Œç”µæºç®¡ç†ç›¸å…³çš„ä»»åŠ¡æä¾›æ§åˆ¶æ€»çº¿ã€‚\\\nSMBus ä¸ºç³»ç»Ÿå’Œç”µæºç®¡ç†è¿™æ ·çš„ä»»åŠ¡æä¾›äº†ä¸€æ¡æ§åˆ¶æ€»çº¿ï¼Œä½¿ç”¨ SMBus çš„ç³»ç»Ÿï¼Œè®¾å¤‡ä¹‹é—´å‘é€å’Œæ¥æ”¶æ¶ˆæ¯éƒ½æ˜¯é€šè¿‡ SMBusï¼Œè€Œä¸æ˜¯ä½¿ç”¨å•ç‹¬çš„æ§åˆ¶çº¿ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœè®¾å¤‡çš„ç®¡è„šæ•°ã€‚\\  \næ‰€ä»¥å®ƒä¸iicçš„åŒºåˆ«å¾ˆæ˜æ˜¾äº†ï¼Œä¸€ä¸ªæ˜¯è¯¥æ€»çº¿ä¸Šè¿æ¥è®¾å¤‡è‡ªèº«å¯ä»¥æ§åˆ¶æ€»çº¿(I2Cï¼Œé€Ÿç‡è¾ƒé«˜)ï¼Œæƒ³å¹²å˜›å°±å¹²å˜›ï¼›å¦ä¸€ä¸ªæ˜¯è®¾å¤‡ä¹‹é—´å¯ä»¥é€šè¿‡å®ƒæ¥ä¼ é€ä¿¡æ¯ï¼Œä½†æ˜¯é€Ÿç‡æ¯”è¾ƒæ…¢ï¼Œæ¯”å¦‚ç”¨åœ¨æ£€æµ‹å„å…ƒä»¶çŠ¶æ€å¹¶æ›´æ–°ç¡¬ä»¶è®¾ç½®å¼•è„šç­‰ï¼ŒåŒæ—¶å»‰ä»·æ˜¯å®ƒçš„ä¼˜ç‚¹ã€‚\\\n\\\n**SMBus-Alert**æ˜¯ä¸€ä¸ªå¸¦ä¸­æ–­çº¿çš„å¯é€‰ä¿¡å·ï¼Œç”¨äºé‚£äº›å¸Œæœ›æ‰©å±•ä»–ä»¬çš„æ§åˆ¶èƒ½åŠ›è€Œç‰ºç‰²ä¸€ä¸ªå¼•è„šçš„è®¾å¤‡ã€‚SMBALERTå’ŒSCLå’ŒSDAä¿¡å·ä¸€æ ·ï¼Œæ˜¯ä¸€ç§çº¿ä¸ä¿¡å·ã€‚SMBALERTé€šå¸¸å’ŒSMBuså¹¿æ’­å‘¼å«åœ°å€ä¸€èµ·ä½¿ç”¨ã€‚ä¸SMBusæœ‰å…³çš„æ¶ˆæ¯ä¸º2å­—èŠ‚ã€‚**å•ä¸€çš„ä»è®¾å¤‡å¯ä»¥é€šè¿‡SMBALERTå‘ä¿¡å·ç»™ä¸»æœºè¡¨ç¤ºå®ƒå¸Œæœ›è¿›è¡Œé€šä¿¡**ï¼Œè¿™å¯é€šè¿‡è®¾ç½®I2C_CR1å¯„å­˜å™¨ä¸Šçš„ALERTä½å®ç°ã€‚ä¸»æœºå¤„ç†è¯¥ä¸­æ–­å¹¶é€šè¿‡æé†’å“åº”åœ°å€ARA(Alert ResponseÂ Addressï¼Œåœ°å€å€¼ä¸º0001100x)è®¿é—®æ‰€æœ‰SMBALERTè®¾å¤‡ã€‚åªæœ‰é‚£äº›å°†SMBALERTæ‹‰ä½çš„è®¾å¤‡èƒ½åº”ç­”ARAã€‚æ­¤çŠ¶æ€æ˜¯ç”± I2C_SR1å¯„å­˜å™¨ä¸­çš„SMBALERTçŠ¶æ€æ ‡è®°æ¥æ ‡è¯†çš„ã€‚ä¸»æœºæ‰§è¡Œä¸€ä¸ªä¿®æ”¹è¿‡çš„æ¥æ”¶å­—èŠ‚æ“ä½œã€‚ç”±ä»å‘é€è®¾å¤‡æä¾›çš„7ä½è®¾å¤‡åœ°å€è¢«æ”¾åœ¨å­—èŠ‚çš„7ä¸ªæœ€é«˜ä½ä¸Šï¼Œç¬¬å…«ä¸ªä½å¯ä»¥æ˜¯0æˆ–1ã€‚å¦‚æœå¤šä¸ªè®¾å¤‡æŠŠSMBALERTæ‹‰ä½ï¼Œæœ€é«˜ä¼˜å…ˆçº§è®¾å¤‡(æœ€å°çš„åœ°å€)å°†åœ¨åœ°å€ä¼ è¾“æœŸé—´é€šè¿‡æ ‡å‡†ä»²è£èµ¢å¾—é€šä¿¡æƒã€‚åœ¨ç¡®è®¤ä»åœ°å€åï¼Œæ­¤è®¾å¤‡ä¸å¾—å†æ‹‰ä½å®ƒçš„SMBALERTï¼Œå¦‚æœå½“ä¿¡æ¯ä¼ è¾“å®Œæˆåï¼Œä¸»æœºä»çœ‹åˆ°SMBALERTä½ï¼Œå°±çŸ¥é“éœ€è¦å†æ¬¡è¯»ARAã€‚æ²¡æœ‰æ‰§è¡ŒSMBALERTä¿¡å·çš„ä¸»æœºå¯ä»¥å®šæœŸè®¿é—®ARAã€‚æœ‰å…³SMBusæé†’æ¨¡å¼çš„æ›´å¤šè¯¦ç»†èµ„æ–™ï¼Œè¯·å‚è€ƒ2.0ç‰ˆçš„SMBusè§„èŒƒã€‚**è¯´ç™½äº†è¿˜æ˜¯é€šä¿¡ï¼Œåªä¸è¿‡æ˜¯ä»æœºä¸ä»æœºçš„é€šä¿¡** \\\næˆ‘å…ˆå¿½ç•¥ç³»ç»Ÿç®¡ç†æ€»çº¿åè®®ã€‚ä¸“æ³¨äºiicã€‚\n## ä¸»æ¨¡å¼è®¾ç½®\n![](Snipaste_2025-03-12_17-56-13.png)\n\n### Custom Timing\nè¿™ä¸ªç‰›é€¼äº†ï¼ŒiiCé€šä¿¡ä¾èµ–äºç‰¹å®šçš„æ—¶åºå‚æ•°ï¼Œå¦‚æ—¶é’Ÿé¢‘ç‡ã€é«˜ä½ç”µå¹³æ—¶é—´ç­‰ã€‚STM32CubeMXé€šå¸¸æä¾›é¢„å®šä¹‰çš„æ—¶åºé…ç½®ï¼Œé€‚ç”¨äºå¸¸è§åœºæ™¯ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé¢„å®šä¹‰é…ç½®å¯èƒ½æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œè¿™æ—¶å°±éœ€è¦æ‰‹åŠ¨è°ƒæ•´æ—¶åºå‚æ•°ã€‚\n\né€šè¿‡â€œCustom Timingâ€ï¼Œä½ å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚è°ƒæ•´ä»¥ä¸‹å‚æ•°ï¼š\n\n1. **SCLæ—¶é’Ÿé¢‘ç‡**ï¼šè®¾ç½®SCLæ—¶é’Ÿçš„é¢‘ç‡ã€‚    \n2. **SCLé«˜ä½ç”µå¹³æ—¶é—´**ï¼šåˆ†åˆ«è®¾ç½®SCLé«˜ç”µå¹³å’Œä½ç”µå¹³çš„æŒç»­æ—¶é—´ã€‚   \n3. **æ•°æ®å»ºç«‹å’Œä¿æŒæ—¶é—´**ï¼šè®¾ç½®æ•°æ®åœ¨æ—¶é’Ÿè¾¹æ²¿å‰åçš„ç¨³å®šæ—¶é—´ã€‚\n4. **èµ·å§‹å’Œåœæ­¢æ¡ä»¶æ—¶é—´**ï¼šè®¾ç½®èµ·å§‹å’Œåœæ­¢æ¡ä»¶çš„æŒç»­æ—¶é—´ã€‚\n#### ä½¿ç”¨åœºæ™¯\n- **éæ ‡å‡†I2Cè®¾å¤‡**ï¼šæŸäº›è®¾å¤‡å¯èƒ½éœ€è¦ç‰¹å®šçš„æ—¶åºã€‚\n- **ä¼˜åŒ–æ€§èƒ½**ï¼šåœ¨é«˜å™ªå£°ç¯å¢ƒä¸­ï¼Œè°ƒæ•´æ—¶åºå¯ä»¥æé«˜é€šä¿¡ç¨³å®šæ€§ã€‚  \n- **è°ƒè¯•**ï¼šåœ¨è°ƒè¯•æ—¶ï¼Œæ‰‹åŠ¨è°ƒæ•´æ—¶åºæœ‰åŠ©äºæ’æŸ¥é—®é¢˜ã€‚\n#### é…ç½®æ­¥éª¤\n1. åœ¨CubeMXä¸­å¯ç”¨I2Cå¤–è®¾ã€‚\n2. é€‰æ‹©â€œCustom Timingâ€é€‰é¡¹ã€‚\n3. æ‰‹åŠ¨è¾“å…¥æ‰€éœ€çš„æ—¶åºå‚æ•°ã€‚\n4. ç”Ÿæˆä»£ç å¹¶éªŒè¯é…ç½®ã€‚\n#### æ³¨æ„äº‹é¡¹\n- ç¡®ä¿æ—¶åºå‚æ•°ç¬¦åˆI2Cè§„èŒƒå’Œè®¾å¤‡è¦æ±‚ã€‚\n- é”™è¯¯çš„é…ç½®å¯èƒ½å¯¼è‡´é€šä¿¡å¤±è´¥æˆ–æŸåè®¾å¤‡ã€‚\né€šè¿‡â€œCustom Timingâ€ï¼Œä½ å¯ä»¥æ›´çµæ´»åœ°é…ç½®I2Cé€šä¿¡ï¼Œæ»¡è¶³ç‰¹å®šéœ€æ±‚ã€‚\n#### çœ‹å®Œä»¥åå‘ç°æˆ‘è¿˜æ˜¯ä¸ä¼šç”¨å•Šï¼Œï¼Œï¼Œï¼Œï¼Œ\n\n### Timing \nè¿™ä¸ªæ˜¯å’Œä¸Šé¢é‚£ä¸ªä¸€èµ·ç”¨çš„ï¼Œæˆ‘çŒœæ˜¯æŠŠTimingè¿™ä¸ªè®¾å®šå€¼å†™å…¥æŸä¸ªå¯„å­˜å™¨é‡Œï¼Œç„¶åè¿™ä¸ªå¯„å­˜å™¨çš„ä¸åŒä½æ§åˆ¶ç€ä¸åŒçš„æ—¶åºå‚æ•°ï¼Œå¦‚é«˜ä½ç”µå¹³æ—¶é—´ä»€ä¹ˆçš„ã€‚æ²¡æœ‰æ·±ç©¶ã€‚å› ä¸ºä¼°è®¡ä¹Ÿä¸ä¼šç”¨è‡ªå®šä¹‰æ—¶åºã€‚\n![](Snipaste_2025-03-12_18-39-27.png)\nè‡ªå®šä¹‰æ—¶åºenable åçš„ç•Œé¢å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚\n\n### RiseTime/FallTime/Coefficient of Digital Filter\næ§åˆ¶iicä¸Šå‡æ²¿/ä¸‹é™æ²¿çš„æ—¶é—´ï¼Œiicå¯¹äºä¸Šä¸‹é™æ²¿çš„æ—¶é—´æ˜¯æœ‰è¦æ±‚çš„ã€‚\\\næ•°å­—æ»¤æ³¢å™¨ç³»æ•°ã€‚ä¸å¯ç”¨è®¾ç½®ä¸º0ï¼Œå¯ç”¨åˆ™å¯è®¾ç½®ä¸º1-15ï¼Œè¡¨ç¤º1-15ä¸ªiicå¤–è®¾æ—¶é’Ÿã€‚\\\nè¿™ä¸‰ä¸ªå‚æ•°è¦éµå¾ªä¸€å¥—éå¸¸å¤æ‚çš„æ—¶åºè®¡ç®—æ–¹æ³•çš„ï¼Œä¹Ÿå’Œå¯¹åº”çš„å¤–è®¾æœ‰å…³ç³»ï¼Œåœ¨è®¾ç½®å‰ä¹Ÿè¦é˜…è¯»ç›¸å…³çš„å¤–è®¾èµ„æ–™ã€‚æ­¤å¤„æš‚ä¸”ä¸å±•å¼€ã€‚\n\n### Analog Filter\næ¨¡æ‹Ÿæ»¤æ³¢å™¨ã€‚\n\n## ä»æ¨¡å¼è®¾ç½®\n### Clockâ€‚Noâ€‚Stretchâ€‚Mode\n**IICæ—¶é’Ÿæ‹‰ä¼¸(Clock stretching)**ï¼š\\\næœ‰æ—¶å€™ä½é€Ÿä»æœºå¯èƒ½ç”±äºä¸Šä¸€ä¸ªè¯·æ±‚è¿˜æ²¡å¤„ç†å®Œï¼Œæ— æ³•ç»§ç»­æ¥æ”¶ä¸»æœºçš„åç»­è¯·æ±‚ï¼Œ**å³ä¸»æœºçš„æ•°æ®ä¼ è¾“é€Ÿç‡è¶…è¿‡äº†ä»æœºçš„å¤„ç†èƒ½åŠ›**ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä»æœºå¯ä»¥è¿›è¡Œæ—¶é’Ÿæ‹‰ä¼¸æ¥è¦æ±‚ä¸»æœºæš‚åœä¼ è¾“æ•°æ® ã€‚é€šå¸¸æ—¶é’Ÿéƒ½æ˜¯ç”±ä¸»æœºæä¾›çš„ï¼Œä»æœºåªæ˜¯åœ¨SDAä¸Šè¯»æ•°æ®æˆ–è€…å‘æ•°æ®ã€‚\næ—¶é’Ÿæ‹‰ä¼¸åˆ™æ˜¯ä»æœºåœ¨ä¸»æœºé‡Šæ”¾SCLåï¼Œå°†SCLä¸»åŠ¨æ‹‰ä½å¹¶ä¿æŒï¼Œæ­¤æ—¶è¦æ±‚ä¸»æœºåœæ­¢åœ¨SCLä¸Šäº§ç”Ÿè„‰å†²ä»¥åŠåœ¨SDAä¸Šå‘é€æ•°æ®ï¼Œç›´åˆ°ä»æœºé‡Šæ”¾SCLï¼ˆSCLä¸ºé«˜ç”µå¹³ï¼‰ã€‚ä¹‹åä¸»æœºä¾¿å¯ä»¥ç»§ç»­æ­£å¸¸çš„æ•°æ®ä¼ è¾“äº†ã€‚å¯è§æ—¶é’Ÿæ‹‰ä¼¸å®é™…ä¸Šæ˜¯åˆ©ç”¨äº†æ—¶é’ŸåŒæ­¥çš„æœºåˆ¶ï¼Œåªæ˜¯æ—¶é’Ÿç”±ä»æœºäº§ç”Ÿã€‚ å¦‚æœç³»ç»Ÿä¸­å­˜åœ¨è¿™ç§ä½é€Ÿä»æœºå¹¶ä¸”ä»æœºå®ç°äº†æ—¶é’Ÿæ‹‰ä¼¸ï¼Œä¸»æœºå¿…é¡»èƒ½å¤Ÿå¤„ç†è¿™ç§æƒ…å†µï¼Œ**å®é™…ä¸Šå¤§éƒ¨åˆ†ä»æœºè®¾å¤‡ä¸­ä¸åŒ…å«SCLé©±åŠ¨å™¨çš„ï¼Œå› æ­¤æ— æ³•æ‹‰ä¼¸æ—¶é’Ÿã€‚**\n\n### Primaryâ€‚Addressâ€‚Lengthâ€‚selection\nä»è®¾å¤‡åœ°å€é•¿åº¦ ç½®ä»è®¾å¤‡çš„åœ°å€æ˜¯7bitè¿˜æ˜¯10bitã€‚å¤§éƒ¨åˆ†ä¸º7bitã€‚\n\n### General call address\n**é€šç”¨å¹¿æ’­åœ°å€æ˜¯ä¸ºäº†å¯»å€æ€»çº¿ä¸Šæ‰€æœ‰è®¾å¤‡ã€‚** å¦‚æœä¸€ä¸ªè®¾å¤‡ä¸éœ€è¦ä½¿ç”¨å¹¿æ’­åŠŸèƒ½ï¼Œå¯ä»¥ä¸å“åº”å¹¿æ’­ã€‚å¦‚æœè®¾å¤‡éœ€è¦ä½¿ç”¨å¹¿æ’­åŠŸèƒ½ï¼Œåˆ™å®ƒåœ¨æ£€æµ‹åˆ°å¹¿æ’­åœ°å€åå‘é€å“åº”ï¼Œå¹¶ä½œä¸ºä»æœºæ¥æ”¶è¯»å–æ€»çº¿ä¸Šå‘é€çš„æ•°æ®ã€‚ä¸»æœºä¸çŸ¥é“æ€»çº¿ä¸Šæœ‰å¤šå°‘ä»æœºå‘é€å“åº”ã€‚**æ€»çº¿ä¸Šæ‰€æœ‰å¯ä»¥å“åº”å¹¿æ’­çš„ä»æœºè¯»å–å¹¿æ’­åœ°å€åçš„ç¬¬äºŒä¸ªåŠåé¢çš„å­—èŠ‚ã€‚** ä¸èƒ½å¤„ç†è¿™äº›å¹¿æ’­æ•°æ®çš„ä»æœºé€šè¿‡ä¸å‘é€å“åº”çš„æ–¹å¼å¿½ç•¥å®ƒã€‚åŒæ ·åœ°ï¼Œ**å¦‚æœæœ‰ä¸€ä¸ªæˆ–ä¸€ä¸ªä»¥ä¸Šçš„ä»æœºå‘é€å“åº”ï¼Œåˆ™ä¸»æœºå°±æ£€æµ‹ä¸åˆ°æ€»çº¿ä¸Šå…¶å®ƒæ²¡æœ‰å“åº”çš„è®¾å¤‡ã€‚** å¹¿æ’­æ¶ˆæ¯çš„å«ä¹‰æ€»æ˜¯å®šä¹‰åœ¨ç¬¬äºŒä¸ªå­—èŠ‚ã€‚\n![](65d333b522f92fae6584d6d5cccc4de9.jpeg)\n<details>\n\n<summary>ä»¥ä¸‹å†…å®¹éœ€è¦çš„æ—¶å€™å†çœ‹</summary>\n\næœ‰ä¸¤ç§å¯èƒ½æƒ…å†µï¼š\n\n- æœ€ä½ä½â€œBâ€ä¸º0\n- æœ€ä½ä½â€œBâ€ä¸º1\n\n- â€œBâ€ä¸º0ï¼Œç¬¬äºŒä¸ªå­—èŠ‚åŒ…æ‹¬ä»¥ä¸‹å®šä¹‰ï¼š\n0000 0110ï¼ˆ06hï¼‰ï¼šå¤ä½å¹¶é€šè¿‡ç¡¬ä»¶å†™å†…å®¹åˆ°ä»æœºçš„å¯ç¼–ç¨‹éƒ¨åˆ†ã€‚æ‰€æœ‰å¯ä»¥å“åº”æ­¤ç±»å¹¿æ’­çš„ä»æœºï¼Œæ”¶åˆ°æ­¤ä¸¤å­—èŠ‚åï¼Œè¿›è¡Œå¤ä½å¹¶è¿›å…¥å®ƒä»¬åœ°å€çš„å¯ç¼–ç¨‹éƒ¨åˆ†ã€‚æ³¨æ„ç¡®ä¿è®¾å¤‡åœ¨åŠ ç”µåä¸ä¼šå°†SDAæˆ–SCLæ‹‰ä½ï¼Œå› ä¸ºè¿™äº›ä½ç”µå¹³ä¼šé˜»å¡æ€»çº¿ï¼›\n0000 0100ï¼ˆ04hï¼‰ï¼šé€šè¿‡ç¡¬ä»¶å†™å†…å®¹åˆ°ä»æœºçš„å¯ç¼–ç¨‹éƒ¨åˆ†ï¼Œä½œç”¨ç±»ä¼¼ï¼ˆ06hï¼‰ï¼Œä½†è®¾å¤‡ä¸ä¼šå¤ä½ï¼›\n0000 0000ï¼ˆ00hï¼‰ï¼šè¿™ä¸ªä¸åº”è¯¥ä½œä¸ºç¬¬äºŒä¸ªå­—èŠ‚ç”¨ã€‚\nç¼–ç¨‹æ—¶åºå‚è€ƒç›¸åº”è®¾å¤‡çš„DATASHEETã€‚\\\n\n- â€œBâ€ä¸º1ï¼Œä¸¤å­—èŠ‚å¹¿æ’­å®šä¹‰ä¸ºâ€œç¡¬ä»¶å¹¿æ’­â€ã€‚ä¸»æœºåœ¨ç¼–ç¨‹åï¼Œå¯ä»¥å‘é€æ—¢å®šçš„ä»æœºåœ°å€åˆ°æ€»çº¿ä¸Šï¼Œæ„æˆä¸¤å­—èŠ‚åºåˆ—çš„â€œç¡¬ä»¶å¹¿æ’­â€ã€‚ä¸»æœºå¯èƒ½å¹¶ä¸çŸ¥é“æ€»çº¿ä¸Šä»æœºçš„åœ°å€ï¼Œå®ƒåªèƒ½é€šè¿‡ç¡¬ä»¶å¹¿æ’­çš„æ–¹å¼ï¼Œå°†è‡ªèº«åœ°å€é€šçŸ¥ç»™ç³»ç»Ÿã€‚\nç¡¬ä»¶å¹¿æ’­çš„ç¬¬äºŒä¸ªå­—èŠ‚çš„å‰ä¸ƒä½åŒ…æ‹¬ä¸»æœºçš„åœ°å€ã€‚æ€»çº¿ä¸Šçš„æ™ºèƒ½è®¾å¤‡å¦‚å¾®æ§åˆ¶å™¨ï¼Œè¯»å–æ­¤åœ°å€å¹¶æ¥æ”¶ä¸»æœºå‘é€çš„å…¶å®ƒä¿¡æ¯ã€‚å¦‚æœä¸»æœºä¹Ÿå¯ä»¥ä½œä¸ºä»æœºä½¿ç”¨ï¼Œåˆ™ä»¥ä¸Šè¯»å–çš„ä¸»æœºåœ°å€å®é™…ä¸Šä¹Ÿå°±æ˜¯ï¼ˆåˆ‡æ¢ä¸»ä»æ¨¡å¼åçš„ï¼‰ä»æœºåœ°å€ã€‚åœ¨ç³»ç»Ÿä¸­ï¼Œä¸€ç§å¯èƒ½æ˜¯ç³»ç»Ÿå¤ä½åè®¾å¤‡ç”±ä¸»æœºå‘é€æ¨¡å¼åˆ‡æ¢åˆ°ä»æœºæ¥æ”¶æ¨¡å¼ï¼Œè¿™æ—¶ç”±ç³»ç»Ÿä¸»æœºå…ˆå‘Šè¯‰ç¡¬ä»¶ä¸»æœºæ•°æ®åº”é€å¾€çš„ä»æœºåœ°å€ï¼Œè¿™æ ·å½“ç¡¬ä»¶ä¸»æœºå‘é€æ•°æ®æ—¶å°±å¯ä»¥ç›´æ¥å‘æŒ‡å®šä»æœºï¼ˆåœ°å€ï¼‰å‘é€æ•°æ®äº†ã€‚\nå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n</details>\n\n![](e76a7cecc118d861220014786be3e39b.jpeg)\n\n### Dualâ€‚Addressâ€‚Acknowledged\nåŒåœ°å€ç¡®è®¤ã€‚å…è®¸ä»æœºå“åº”ä¸¤ä¸ªä¸åŒçš„åœ°å€ã€‚æœ‰å•¥ç”¨ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ\n\n### Primaryâ€‚slaveâ€‚address\nä»è®¾å¤‡åˆå§‹åœ°å€ã€‚ä¸ç”¨å¡«ã€‚\n\n\n## å‚è€ƒèµ„æ–™\n- â­â­â­[I2Cè¯¦è§£ï¼ˆäºŒï¼‰_i2c general call-CSDNåšå®¢](https://blog.csdn.net/sternlycore/article/details/85759475)éµå¾ªÂ [CC 4.0 BY-SA](http://creativecommons.org/licenses/by-sa/4.0/)Â ç‰ˆæƒåè®®\n- [IICè®¾å¤‡é©±åŠ¨ç¨‹åºï¼ˆå…­ï¼‰â€”â€”â€”â€”SMBusåè®®-CSDNåšå®¢](https://blog.csdn.net/yangguoyu8023/article/details/71440688)\n- [ã€STM32F030å¼€å‘æ—¥å¿—/è¯„æµ‹/ç¬”è®°ã€‘+ï¼ˆ1ï¼‰STM32F0å¤„ç†å™¨I2Cæ—¶é—´é…... - STM32å›¢é˜Ÿ STæ„æ³•åŠå¯¼ä½“ä¸­æ–‡è®ºå›](https://shequ.stmicroelectronics.cn/thread-571931-1-1.html)\n- â­â­â­[ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹åäºŒ---IIC(è¯»å–AT24C02 )_hal iic-CSDNåšå®¢](https://blog.csdn.net/as480133937/article/details/105259075)\n","tags":["STM32","CubeMX","åµŒå…¥å¼","iic"],"categories":["åµŒå…¥å¼","CubeMXé…ç½®åŠŸèƒ½"]},{"title":"é€šä¿¡åè®®ï¼šiic","url":"/posts/55329/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## è¯´æ˜\n\niicä½œä¸ºå½“ä»ŠåµŒå…¥å¼åº”ç”¨ä¸­æœ€å¸¸è§çš„ä¸²è¡Œé€šä¿¡åè®®ä¹‹ä¸€!!æˆ‘æ„¿å°†å…¶ä¸UARTå’ŒSPIå¹¶ç§°ä¸‰å¹»ç¥!!ï¼Œæ˜¯å¯¹äºåµŒå…¥å¼å¼€å‘è€…æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ï¼Œå› ä¸ºè€æ˜¯ä¼šå¿˜è®°iicåè®®çš„ä¸€äº›ç»†èŠ‚ï¼Œæ•…ä½œè®°å½•ã€‚\n\n## iicç®€ä»‹\n\n**IIC(Interï¼Integrated Circuit)æ€»çº¿**æ˜¯ä¸€ç§ç”±NXPï¼ˆåŸPHILIPSï¼‰å…¬å¸å¼€å‘çš„ä¸¤çº¿å¼ä¸²è¡Œæ€»çº¿ï¼Œç”¨äºè¿æ¥å¾®æ§åˆ¶å™¨åŠå…¶å¤–å›´è®¾å¤‡ã€‚**æ˜¯ä¸€ç§åŠåŒå·¥åŒæ­¥çš„ä½é€Ÿé€šä¿¡åè®®**ã€‚å¤šç”¨äºä¸»æ§åˆ¶å™¨å’Œä»å™¨ä»¶é—´çš„ä¸»ä»é€šä¿¡ï¼Œåœ¨å°æ•°æ®é‡åœºåˆä½¿ç”¨ï¼Œä¼ è¾“è·ç¦»çŸ­ï¼Œä»»æ„æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªä¸»æœºç­‰ç‰¹æ€§ã€‚\\\n\\\nICä½¿ç”¨ä¸¤æ ¹ä¿¡å·çº¿è¿›è¡Œé€šä¿¡ï¼šä¸€æ ¹æ—¶é’Ÿçº¿SCLï¼Œä¸€æ ¹æ•°æ®çº¿SDAã€‚IICå°†SCLå¤„äºé«˜æ—¶SDAæ‹‰ä½çš„åŠ¨ä½œä½œä¸ºå¼€å§‹ä¿¡å·ï¼ŒSCLå¤„äºé«˜æ—¶SDAæ‹‰é«˜çš„åŠ¨ä½œä½œä¸ºç»“æŸä¿¡å·ï¼›ä¼ è¾“æ•°æ®æ—¶ï¼ŒSDAåœ¨SCLä½ç”µå¹³æ—¶æ”¹å˜æ•°æ®ï¼Œåœ¨SCLé«˜ç”µå¹³æ—¶ä¿æŒæ•°æ®ï¼Œæ¯ä¸ªSCLè„‰å†²çš„é«˜ç”µå¹³ä¼ é€’1ä½æ•°æ®ã€‚\n\n## ä¸»è¦ç‰¹æ€§\n\n- ICç”¨2æ ¹ä¿¡å·çº¿é€šä¿¡ï¼šä¸²è¡Œæ•°æ®çº¿ SDAã€ä¸²è¡Œæ—¶é’Ÿçº¿ SCLï¼›\n- IICæ€»çº¿ä¸Šæ‰€æœ‰å™¨ä»¶çš„SDAã€SCLå¼•è„šè¾“å‡ºé©±åŠ¨éƒ½ä¸º**å¼€æ¼(OD) ç»“æ„**ï¼Œé€šè¿‡å¤–æ¥ä¸Šæ‹‰ç”µé˜»å®ç°æ€»çº¿ä¸Šæ‰€æœ‰èŠ‚ç‚¹SDAã€SCLä¿¡å·çš„çº¿ä¸é€»è¾‘å…³ç³»ï¼›\n- æ€»çº¿ä¸Šçš„æ‰€æœ‰è®¾å¤‡é€šè¿‡è½¯ä»¶å¯»å€ä¸”å…·æœ‰å”¯ä¸€çš„åœ°å€ï¼ˆ7ä½æˆ–10ä½ï¼‰ã€‚7ä½â€œä»æœºä¸“ç”¨åœ°å€ç â€ï¼Œå…¶é«˜4ä½ä¸ºç”±ç”Ÿäº§å‚å®¶åˆ¶å®šçš„è®¾å¤‡ç±»å‹åœ°å€ï¼Œä½3ä½ä¸ºå™¨ä»¶å¼•è„šå®šä¹‰åœ°å€ï¼ˆç”±ä½¿ç”¨è€…å®šä¹‰ï¼‰ï¼›10ä½åœ°å€ä¸å¸¸è§ï¼›\n- ä»»ä½•æ—¶åˆ»éƒ½åªå­˜åœ¨ç®€å•çš„ä¸»ä»å…³ç³»ï¼ŒæŒ‰æ•°æ®ä¼ è¾“çš„æ–¹å‘ï¼Œä¸»æœºå¯ä»¥æ˜¯ä¸»å‘é€å™¨æˆ–ä¸»æ¥æ”¶å™¨ï¼›\n- æ”¯æŒå¤šä¸»æœºã€‚åœ¨æ€»çº¿ä¸Šå­˜åœ¨å¤šä¸ªä¸»æœºæ—¶ï¼Œé€šè¿‡å†²çªæ£€æµ‹å’Œä»²è£æœºåˆ¶é˜²æ­¢å¤šä¸ªä¸»æœºåŒæ—¶å‘èµ·æ•°æ®ä¼ è¾“æ—¶å­˜åœ¨çš„å†²çªï¼›\n- IICæ€»çº¿ä¸Šæ‰€æœ‰å™¨ä»¶éƒ½å…·æœ‰â€œè‡ªåŠ¨åº”ç­”â€åŠŸèƒ½ï¼Œä¿è¯æ•°æ®ä¼ è¾“çš„æ­£ç¡®æ€§ï¼› **ä¸»æœºå’Œä»æœºçš„åŒºåˆ«åœ¨äºå¯¹SCLçš„å‘é€æƒï¼Œåªæœ‰ä¸»æœºæ‰èƒ½å‘é€SCL**ï¼›\n- IICæ€»çº¿å…è®¸æŒ‚è½½æœ€å¤šçš„è®¾å¤‡æ•°é‡å–å†³äºæ€»çº¿ä¸Šæœ€å¤§ç”µå®¹å€¼ï¼Œä¸€èˆ¬ä¸º400pfï¼ˆHsæ¨¡å¼100pfï¼‰\n\næ”¯æŒçš„ä¼ è¾“é€Ÿç‡ï¼š\n\n| æ¨¡å¼                     | é€Ÿåº¦      |\n| ---------------------- | ------- |\n| æ ‡å‡†æ¨¡å¼ï¼ˆStandard Modeï¼‰    | 100kb/s |\n| å¿«é€Ÿæ¨¡å¼ï¼ˆFast Modeï¼‰        | 400kb/s |\n| å¢å¼ºå¿«é€Ÿæ¨¡å¼ï¼ˆFast Mode Plusï¼‰ | 1Mb/s   |\n| é«˜é€Ÿæ¨¡å¼ï¼ˆHigh Speed Modeï¼‰  | 3.4Mb/s |\n| æé€Ÿæ¨¡å¼ï¼ˆUltra-FastModeï¼‰   | 5Mb/s   |\n\n## ç¡¬ä»¶ç»“æ„\n\n### æ€»çº¿ç»“æ„\nIICä½¿ç”¨ä¸¤æ ¹ä¿¡å·çº¿è¿›è¡Œé€šä¿¡ï¼Œè¦æ±‚ä¸¤æ ¹çº¿éƒ½ä½¿ç”¨ **å¼€æ¼è¾“å‡ºæ¥ä¸Šæ‹‰ç”µé˜»** çš„é…ç½®ï¼Œä»¥æ­¤å®ç°æ€»çº¿ä¸Šæ‰€æœ‰èŠ‚ç‚¹SDAã€SCLä¿¡å·çš„**çº¿ä¸**é€»è¾‘å…³ç³»ã€‚\nRpç”µé˜»çš„å–å€¼æœ‰ä¸€å®šçš„è¦æ±‚ï¼Œå¤ªå°ä¼šå¯¼è‡´çŒå…¥ç”µæµè¿‡å¤§ï¼Œä½¿â€™ä½â€™æ•°æ®ä¸ç¨³å®šï¼Œç”šè‡³æŸåç«¯å£ï¼›å¤ªå¤§ä¼šå¯¼è‡´ä¿¡å·ä¸Šå‡ç¼“æ…¢ï¼Œä½¿å¾—æ•°æ®ä¼ è¾“å‡ºé”™ã€‚åœ¨ä¸åŒåº”ç”¨åœºæ™¯åŠä¾›ç”µç”µå‹ä¸‹æœ‰ä¸åŒçš„å–å€¼è¦æ±‚ã€‚ \n![](79b9189018381624841758e3ade6e477.png)\n\n### ä»²è£æœºåˆ¶\n\n#### å¼€æ¼è¾“å‡º\nå¼€æ¼è¾“å‡ºå›é¡¾ï¼šå½“è¾“å…¥ä¸ºé«˜ç”µå¹³æ—¶ï¼Œä¸‰çº§ç®¡å¯¼é€šï¼Œè¾“å‡ºä¸ºä½ç”µå¹³ã€‚è¾“å…¥ä¸ºä½ç”µå¹³ï¼Œè¾“å‡ºä¸ç¡®å®šï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä½¿ç”¨å¼ºä¸Šæ‹‰ï¼Œåˆ™å¯ä»¥è¾“å‡ºé«˜ç”µå¹³ã€‚å¼€æ¼è¾“å‡ºæ˜¯å®ç°â€çº¿ä¸â€œçš„ä¸€ç§æ–¹æ¡ˆã€‚\n#### çº¿ä¸\nå¤šä¸ªå¼€æ¼è¾“å‡ºè¿æ¥åœ¨ä¸€èµ·æ—¶ï¼Œåªè¦æœ‰ä¸€ä¸ªè¾“å…¥ä¸ºä½ç”µå¹³ï¼Œé‚£ä¹ˆæ€»ä½“è¡¨ç°ä¸ºä½ç”µå¹³ï¼ˆå¤„äºä½ç”µå¹³çš„é‚£ä¸ªioå£æŠŠvddæµå‘Voutçš„ç”µæµå¼•èµ°äº†ï¼‰ã€‚\n![](Snipaste_2025-03-11_20-01-18.png)\n\nâ€œçº¿ä¸â€œä½¿å¾—æ€»çº¿ä¸Šä¸ä¼šå‡ºç°æ•°æ®å†²çªï¼Œå®ç°äº†æ€»çº¿çš„ä»²è£æ§åˆ¶ã€‚æ€»çº¿çš„æ§åˆ¶æƒä¼šäº¤ç»™æœ€åä¸€ä¸ªè¾“å‡ºä½ç”µå¹³çš„è®¾å¤‡ï¼Œå…¶å®ƒè®¾å¤‡ï¼ˆè¾“å‡ºé«˜ï¼‰é€šè¿‡æ£€æµ‹æ€»çº¿ä¸Šçš„ç”µå¹³çŠ¶æ€ï¼ˆçŠ¶æ€ä½ï¼‰ï¼Œå¯¹æ¯”ä¸è‡ªå·±è¾“å‡ºçŠ¶æ€ä¸ä¸€è‡´ï¼Œåˆ™è‡ªåŠ¨é€€å‡ºå¯¹æ€»çº¿çš„æ§åˆ¶è¯·æ±‚ï¼Œä»è€Œé˜²æ­¢äº†æ€»çº¿ä¸Šçš„æ•°æ®å†²çªã€‚\n\n## ğŸŒŸæ—¶åºé€»è¾‘\n### æ•°æ®æœ‰æ•ˆæ€§\nsclä¸ºé«˜ç”µå¹³æœŸé—´ï¼Œä¸ºæ•°æ®é‡‡é›†æœŸï¼Œæ‰€ä»¥sdaä¸Šçš„æ•°æ®æ­¤æ—¶ä¸€å®šè¦ä¿æŒç¨³å®šå“¦~\n![](6c89c55012485f151df1a9fb48843d3f.jpeg)\n\n### å¼€å§‹ä¸ç»“æŸä¿¡å·\næœ‰è®¾å¤‡æƒ³è¦sdaæ€»çº¿æ§åˆ¶æƒæ—¶ï¼Œä¼šä¸»åŠ¨æŠŠsdaæ‹‰ä½ã€‚å¹³æ—¶sdaä¸ºé«˜ã€‚\n- **å¼€å§‹ä¿¡å·ï¼ˆSTART/Sï¼‰ï¼š**Â **SCLä¸ºé«˜æ—¶**ï¼ŒSDAä»é«˜åˆ°ä½çš„è·³å˜äº§ç”Ÿå¼€å§‹ä¿¡å· ã€‚\n- **ç»“æŸä¿¡å·ï¼ˆSTOP/Pï¼‰Â Â ï¼š**Â **SCLä¸ºé«˜æ—¶**ï¼ŒSDAä»ä½åˆ°é«˜çš„è·³å˜äº§ç”Ÿç»“æŸä¿¡å·ã€‚\n- **é‡å¤å¼€å§‹ä¿¡å·ï¼ˆReSTART/Srï¼‰ï¼š**Â åœ¨ç»“æŸæ—¶ä¸ç»™å‡ºSTOPä¿¡å·ï¼Œè€Œä»¥ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å†æ¬¡ç»™å‡ºå¼€å§‹ä¿¡å·ä½œä¸ºæ›¿ä»£ã€‚\n![](f749a6ab4f928522a99db173fd504647.png)\n\n### ä¼ è¾“æ ¼å¼ï¼ˆå­—èŠ‚æ ¼å¼ï¼‰\nSDAæ•°æ®çº¿ä¸Šçš„æ¯ä¸ªå­—èŠ‚**å¿…é¡»æ˜¯8ä½**ï¼Œå¯¹äºæ¯æ¬¡ä¼ è¾“çš„**å­—èŠ‚æ•°æ²¡æœ‰é™åˆ¶**ã€‚æ¯ä¸ªå­—èŠ‚ï¼ˆ8ä½ï¼‰æ•°æ®ä¼ é€å®Œåç´§è·Ÿç€åº”ç­”ä¿¡å·ï¼ˆACKï¼Œç¬¬9ä½ï¼‰ã€‚æ•°æ®çš„å…ˆåé¡ºåºä¸ºï¼š**é«˜ä½åœ¨å‰**Â ã€‚\n![](d3bbca378362c28829cee243a8497ef7.png)\n\n### ACKä¿¡å·\n\nåè®®è§„å®šæ•°æ®ä¼ è¾“è¿‡ç¨‹å¿…é¡»åŒ…å«åº”ç­”ï¼ˆACKï¼‰ã€‚æ¥æ”¶å™¨é€šè¿‡åº”ç­”å‘ŠçŸ¥å‘é€çš„å­—èŠ‚å·²è¢«æˆåŠŸæ¥æ”¶ï¼Œä¹‹åå‘é€å™¨å¯ä»¥è¿›è¡Œä¸‹ä¸€ä¸ªå­—èŠ‚çš„ä¼ è¾“ã€‚æ‰€ä»¥ä¸»æœºäº§ç”Ÿæ•°æ®ä¼ è¾“è¿‡ç¨‹ç”¨äº†9ä¸ªæ—¶é’Ÿã€‚å‘é€å™¨åœ¨åº”ç­”æ—¶é’Ÿå‘¨æœŸå†…é‡Šæ”¾å¯¹SDAæ€»çº¿çš„æ§åˆ¶ï¼Œè¿™æ · **æ¥æ”¶å™¨** å¯ä»¥é€šè¿‡å°†SDAçº¿æ‹‰ä½å‘ŠçŸ¥å‘é€å™¨ï¼šæ•°æ®å·²è¢«æˆåŠŸæ¥æ”¶ã€‚(è°æ¥æ”¶ï¼Œè°å‘é€åº”ç­”ä¿¡å·)!!å‘é€ç«¯å¯¹æ¥æ”¶ç«¯è¯´ï¼šæˆ‘ä»–å¦ˆè¦ç»™ä½ å‘æ•°æ®äº†ï¼Œæ”¶åˆ°è´§ä»–å¦ˆå›å¤ä¸€ä¸‹0!!\nåº”ç­”ä¿¡å·åˆ†ä¸ºä¸¤ç§ï¼š  \n1. å½“ç¬¬9ä½(åº”ç­”ä½)ä¸ºÂ **ä½ç”µå¹³**Â æ—¶ï¼Œä¸ºÂ **ACK**â€‚â€‰ï¼ˆAcknowledgeï¼‰â€ƒâ€‚â€‰ä¿¡å·  \n2. å½“ç¬¬9ä½(åº”ç­”ä½)ä¸ºÂ **é«˜ç”µå¹³**Â æ—¶ï¼Œä¸ºÂ **NACK**ï¼ˆNot Acknowledgeï¼‰ä¿¡å·\n\nä¸»æœºå‘é€æ•°æ®ï¼Œä»æœºæ¥æ”¶æ—¶ï¼ŒACKä¿¡å·ç”±ä»æœºå‘å‡ºã€‚å½“åœ¨SCLç¬¬9ä½æ—¶é’Ÿé«˜ç”µå¹³ä¿¡å·æœŸé—´ï¼Œå¦‚æœSDAä»ç„¶ä¿æŒé«˜ç”µå¹³ï¼Œåˆ™ä¸»æœºå¯ä»¥ç›´æ¥äº§ç”ŸSTOPæ¡ä»¶ç»ˆæ­¢ä»¥åçš„ä¼ è¾“æˆ–è€…ç»§ç»­ReSTARTå¼€å§‹ä¸€ä¸ªæ–°çš„ä¼ è¾“ !!æ­¤æ—¶ä¸»æœºå‘ç°äº‹æƒ…ä¸å¯¹ï¼Œæˆ‘ä»–å¦ˆè¾›è¾›è‹¦è‹¦ç»™ä½ å‘çš„è´§ä½ è¿å¥å›åº”éƒ½æ²¡æœ‰ï¼Œä¸»æœºå¯ä»¥é€‰æ‹©ä¸å‘äº†ï¼Œæˆ–è€…ç»§ç»­ç”¨çˆ±å‘ç”µå‘å‘å‘ å¤§å£°å‘ï¼æ¥è´¢ï¼Œæ¥~æˆ‘æ˜¯æ†‹ä½¬ä»”!!\\\n\\\nä»æœºå‘é€æ•°æ®ï¼Œä¸»æœºè¯»å–æ•°æ®æ—¶ï¼ŒACKä¿¡å·ç”±ä¸»æœºç»™å‡ºã€‚ä¸»æœºå“åº”ACKè¡¨ç¤ºè¿˜éœ€è¦å†æ¥æ”¶æ•°æ®ï¼Œè€Œå½“ä¸»æœºæ¥æ”¶å®Œæƒ³è¦çš„æ•°æ®åï¼Œé€šè¿‡å‘é€NACKå‘Šè¯‰ä»æœºè¯»å–æ•°æ®ç»“æŸã€é‡Šæ”¾æ€»çº¿ã€‚éšåä¸»æœºå‘é€STOPå‘½ä»¤ï¼Œå°†æ€»çº¿é‡Šæ”¾ï¼Œç»“æŸè¯»æ“ä½œã€‚!!ä»æœºè¿™ä¸ªfwï¼Œçº¯æ·»ç‹—çº§åˆ«çš„ã€éº¦å½“åŠ³çº§åˆ«çš„ã€ATMçº§åˆ«çš„ã€‚ä¸»æœºå«ä¸€ç›´å«ä»æœºçˆ†é‡‘å¸ï¼Œä»æœºçœŸå°±ä¸€ç›´çˆ†ï¼Œæ¦¨å¹²ä»æœºäº†å°±ç›´æ¥æŠŠä»–ç”©äº†ä»–å¦ˆçš„!!\n\n### 7bitå®Œæ•´ä¼ è¾“ç¤ºæ„å›¾\n![](f313f22e0c7bc962ff6e9e5afc2bbc95.png)\n\næ²¡é”™å‰7ä½æ˜¯åœ°å€ï¼Œå‘å®Œåœ°å€å‘é€è¯»/å†™å‘½ä»¤ï¼Œç„¶åå‘é€ç«¯äº¤å‡ºsdaæ§åˆ¶æƒï¼Œç­‰å¾…æ¥æ”¶ç«¯çš„åº”ç­”ä¿¡å·ã€‚å¦‚æœä»æœºæ²¡æœ‰ç»™å‡ºACKåº”ç­”ï¼Œåˆ™è¯´æ˜æ¥æ”¶è®¾å¤‡å¯èƒ½æ²¡æœ‰æ”¶åˆ°æ•°æ®ï¼ˆå¦‚å¯»å€çš„è®¾å¤‡ä¸å­˜åœ¨æˆ–æ˜¯è®¾å¤‡æ­£åœ¨å¿™ç¢Œï¼‰æˆ–æ— æ³•è§£ææ”¶åˆ°çš„æ•°æ®ï¼Œå¦‚æœæ˜¯è¿™æ ·ï¼Œåˆ™ç”±masteræ¥å†³å®šå¦‚ä½•å¤„ç†ï¼ˆSTOPæˆ–ReSTARTï¼‰ã€‚\n\n### ä»æœºå‘ï¼Œä¸»æœºæ”¶çš„æƒ…å†µ\nä¸»æœºå¯¹å‘ä»æœºè¯»å–æ•°æ®æ—¶ï¼Œæ–¹å¼åŒå‘é€æ•°æ®æœ‰æ‰€ä¸åŒï¼Œè¦å¤šä¸€æ¬¡é€šä¿¡è¿‡ç¨‹ã€‚\nä¸»æœºéœ€è¦å…ˆå‘ä»æœºå‘é€ä¸€æ¬¡ä¿¡å·ï¼Œå‘Šè¯‰ä»æœºâ€æˆ‘è¦è¯»å–æ•°æ®â€œï¼Œç„¶å**é‡å¼€ä¸€æ¬¡é€šä¿¡**[^1]ï¼Œç­‰å¾…ä»æœºä¸»åŠ¨è¿”å›æ•°æ®ã€‚\n![](Snipaste_2025-03-11_20-50-32.png)\n\n### 10bitä¼ è¾“\néšç€IICè®¾å¤‡æ—¥ç›Šå¢å¤šï¼Œ7ä½çš„ä»æœºåœ°å€é€æ¸ä¸èƒ½æ»¡è¶³ä½¿ç”¨ï¼Œäºæ˜¯ä»æœºåœ°å€ä»7ä½æ‰©å……åˆ°äº†10ä½ã€‚7ä½å’Œ10ä½åœ°å€çš„è®¾å¤‡å¯ä»¥å…±å­˜äºåŒä¸€ä¸ªI2Cæ€»çº¿ç³»ç»Ÿäº’ä¸å†²çªï¼Œå±•ç°äº†è‰¯å¥½çš„å…¼å®¹æ€§ã€‚\\\n10-bit åœ°å€çš„IICè®¾å¤‡éœ€è¦ 2-Byte æ¥ä¼ è¾“ä»è®¾å¤‡åœ°å€ä¿¡æ¯ï¼Œæ‰€ä»¥é‡‡ç”¨äº†è¿™æ ·çš„è®¾è®¡ï¼šç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º 11110 + åœ°å€é«˜ä¸¤ä½(ç¬¬10ã€9bit) + è¯»å†™æ§åˆ¶ä½ï¼Œç¬¬äºŒä¸ªå­—èŠ‚ä¸ºä»è®¾å¤‡åœ°å€ä½8ä½ï¼Œé™¤æ­¤ä¹‹å¤–ä¸7-bitè®¾å¤‡ç›¸åŒã€‚ï¼ˆå› ä¸º â€œ1111 0xxâ€ ä¸º IIC ä¸­ç‰¹åœ°ä¿ç•™çš„16ä¸ªç‰¹æ®ŠæŒ‡ä»¤åœ°å€ä¸­çš„ä¸€ä¸ªï¼Œæ‰€ä»¥7-bitè®¾å¤‡ä¸ä¼šå“åº”è¯¥é¦–å­—èŠ‚çš„å‘¼å«ï¼Œåªæœ‰10-bitè®¾å¤‡ä¼šå“åº”ï¼Œä»è€Œå®ç°è‰¯å¥½å…¼å®¹ã€‚!!å¥½æ ·çš„ï¼ŒiicğŸ‘ğŸ‘ğŸ‘ä¸ºä½ éª„å‚²!!ï¼‰\nç›´æ¥è´´å›¾äº†\nå†™\n![](5569e1d0e47921103fe2d9d5b8ce83f9.jpeg)\nè¯»\n![](dee04bba6b887b740ab122eac9bc37bf.jpeg)\næ³¨æ„ç¬¬ä¸€å¸§éƒ½æ˜¯writeå“¦ã€‚\n\n## å‚è€ƒæ–‡ç«  \n- â­â­â­[åŸºç¡€é€šä¿¡åè®®ä¹‹ IIC (I2C) è¯¦ç»†è®²è§£_i2cé€šä¿¡çš„è¯¦ç»†è®²è§£-CSDNåšå®¢](https://blog.csdn.net/qq_39829913/article/details/104718185)éµå¾ªÂ [CC 4.0 BY-SA](http://creativecommons.org/licenses/by-sa/4.0/)Â ç‰ˆæƒåè®®\n- [äºŒåã€I2Cæ€»çº¿ä»²è£æœºåˆ¶ - è½»è½»çš„å» - åšå®¢å›­](https://www.cnblogs.com/yuanqiangfei/p/15781416.html)\n- [GPIOæ¨æŒ½ä¸å¼€æ¼è¾“å‡ºçš„â€œçº¿ä¸â€œç‰¹æ€§ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/638360051)\n\n[^1]: é‡å¤å¯åŠ¨ä¿¡å·ï¼ˆRepeated Startï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ“ä½œï¼Œ**å®ƒå…è®¸åœ¨ä¸é‡Šæ”¾æ€»çº¿çš„æƒ…å†µä¸‹ä»å†™æ¨¡å¼åˆ‡æ¢åˆ°è¯»æ¨¡å¼**ã€‚è¿™ç§æ–¹å¼å¯ä»¥é¿å…æ€»çº¿è¢«å…¶ä»–è®¾å¤‡å ç”¨ï¼Œæˆ–è€…é˜²æ­¢ä¸»è®¾å¤‡å‘é€ STOP ä¿¡å·åï¼Œå…¶ä»–è®¾å¤‡è¯•å›¾æ¥ç®¡æ€»çº¿ã€‚","tags":["åµŒå…¥å¼","iic","é€šä¿¡åè®®"],"categories":["åµŒå…¥å¼","é€šä¿¡åè®®"]},{"title":"CubeMXé…ç½®åŠŸèƒ½ç³»åˆ—ï¼šADCï¼ˆä¸‹ï¼‰","url":"/posts/55933/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## ç›®å½•\n- [ç›®å½•](#ç›®å½•)\n- [1. è¾“å…¥æ¨¡å¼](#1-è¾“å…¥æ¨¡å¼)\n  - [1.1. å•ç«¯è¾“å…¥](#11-å•ç«¯è¾“å…¥)\n  - [1.2. å·®åˆ†è¾“å…¥](#12-å·®åˆ†è¾“å…¥)\n- [2. ç»§ç»­çœ‹configéƒ¨åˆ†](#2-ç»§ç»­çœ‹configéƒ¨åˆ†)\n  - [2.1. é€šç”¨è®¾ç½®éƒ¨åˆ†ï¼š](#21-é€šç”¨è®¾ç½®éƒ¨åˆ†)\n  - [2.2. ADC è®¾ç½®éƒ¨åˆ†ï¼š](#22-adc-è®¾ç½®éƒ¨åˆ†)\n    - [2.2.1. ClockPre...](#221-clockpre)\n    - [2.2.2. Resolusion](#222-resolusion)\n    - [2.2.3. Data Ali...](#223-data-ali)\n    - [2.2.4. Gain Com...](#224-gain-com)\n    - [2.2.5. Scan Conversion Mode](#225-scan-conversion-mode)\n    - [2.2.6. End Of Conversion Selection](#226-end-of-conversion-selection)\n    - [2.2.7. Low PowerÂ AutoÂ Wait](#227-low-powerautowait)\n    - [2.2.8. Continuous Conversion Mode](#228-continuous-conversion-mode)\n    - [2.2.9. Discontinuous Conversion Mode](#229-discontinuous-conversion-mode)\n    - [2.2.10. DMA Continuous Requests](#2210-dma-continuous-requests)\n    - [2.2.11. Overrun behaviour](#2211-overrun-behaviour)\n    - [2.2.12. Conversion Data Managerment Modeï¼ˆH7ï¼‰](#2212-conversion-data-managerment-modeh7)\n  - [2.3. è§„åˆ™è½¬æ¢æ¨¡å¼](#23-è§„åˆ™è½¬æ¢æ¨¡å¼)\n    - [2.3.1. Enable Regular Conversions](#231-enable-regular-conversions)\n    - [2.3.2. Enable Regular Oversampingï¼ˆä¸å¸¸ç”¨ï¼‰](#232-enable-regular-oversampingä¸å¸¸ç”¨)\n    - [2.3.3. Oversamping Right Shiftï¼ˆä¸å¸¸ç”¨ï¼‰](#233-oversamping-right-shiftä¸å¸¸ç”¨)\n    - [2.3.4. Number Of Conversion](#234-number-of-conversion)\n    - [2.3.5. External Trigger Conversion Soureï¼ˆè§¦å‘è½¬æ¢çš„å¤–éƒ¨æ¥æºï¼‰](#235-external-trigger-conversion-soureè§¦å‘è½¬æ¢çš„å¤–éƒ¨æ¥æº)\n    - [2.3.6. External Trigger Conversion Edgeï¼ˆè§¦å‘è½¬æ¢çš„å¤–éƒ¨æ²¿ï¼‰](#236-external-trigger-conversion-edgeè§¦å‘è½¬æ¢çš„å¤–éƒ¨æ²¿)\n    - [2.3.7. Rank](#237-rank)\n    - [2.3.8. Offset Number](#238-offset-number)\n  - [2.4. ç„¶åæ˜¯æ³¨å…¥è½¬æ¢æ¨¡å¼](#24-ç„¶åæ˜¯æ³¨å…¥è½¬æ¢æ¨¡å¼)\n    - [2.4.1. è§„åˆ™é€šé“ï¼š](#241-è§„åˆ™é€šé“)\n    - [2.4.2. æ³¨å…¥é€šé“ï¼š](#242-æ³¨å…¥é€šé“)\n  - [2.5. æœ€åæ˜¯å¯çˆ±çš„çœ‹é—¨å°ç‹—ğŸ¥°~](#25-æœ€åæ˜¯å¯çˆ±çš„çœ‹é—¨å°ç‹—)\n- [3. å‚è€ƒå‡½æ•°](#3-å‚è€ƒå‡½æ•°)\n- [4. å‚è€ƒåšå®¢](#4-å‚è€ƒåšå®¢)\n\n\n## 1. è¾“å…¥æ¨¡å¼\næˆ‘ä»¬æ‰“å¼€cubemxçš„é…ç½®ï¼Œé…ç½®é€šé“æ—¶æœ‰å¦‚ä¸‹é€‰æ‹©ï¼šåˆ†åˆ«æ˜¯å·®åˆ†è¾“å…¥å’Œå•ç«¯è¾“å…¥ã€‚\n![](Snipaste_2025-03-09_19-30-43.png)\n\n### 1.1. å•ç«¯è¾“å…¥\n\nå•ç«¯è¾“å…¥æ–¹å¼ä¼˜ç‚¹å°±æ˜¯ç®€å•ï¼Œç¼ºç‚¹æ˜¯å¦‚æœVINå—åˆ°å¹²æ‰°ï¼Œç”±äºGNDç”µä½å§‹ç»ˆæ˜¯0Vï¼Œæ‰€ä»¥æœ€ç»ˆé‡‡æ ·å€¼ä¹Ÿä¼šéšç€å¹²æ‰°è€Œå˜åŒ–ã€‚é‡‡æ ·å€¼=VINï¼ˆå åŠ å¹²æ‰°å€¼ ï¼‰- 0V\n\nå¦‚å›¾æ‰€ç¤ºï¼Œå•ç«¯è¾“å…¥åªæœ‰ä¸€ä¸ªè¾“å…¥å¼•è„šADCINï¼Œä½¿ç”¨å…¬å…±åœ°GNDä½œä¸ºç”µè·¯çš„è¿”å›ç«¯ï¼ŒADCçš„é‡‡æ ·å€¼=ADCINç”µå‹-GNDçš„ç”µå‹(0V)ã€‚è¿™ç§è¾“å…¥æ–¹å¼ä¼˜ç‚¹å°±æ˜¯ç®€å•ï¼Œç¼ºç‚¹æ˜¯å¦‚æœvinå—åˆ°å¹²æ‰°ï¼Œç”±äºGNDç”µä½å§‹ç»ˆæ˜¯0Vï¼Œæ‰€ä»¥æœ€ç»ˆADCçš„é‡‡æ ·å€¼ä¹Ÿä¼šéšç€å¹²æ‰°è€Œå˜åŒ–ã€‚\n![](8c60645887a08582fd0cd8f9cba6b8da.png)\n\n### 1.2. å·®åˆ†è¾“å…¥\n\nå·®åˆ†å—åˆ°çš„å¹²æ‰°æ˜¯å·®ä¸å¤šçš„ï¼Œè¾“å…¥çš„å…±æ¨¡å¹²æ‰°ï¼Œåœ¨è¾“å…¥æ—¶ä¼šè¢«å‡æ‰ï¼Œä»è€Œé™ä½äº†å¹²æ‰°ï¼Œç¼ºç‚¹å°±æ˜¯æ¥çº¿å¤æ‚ä¸€äº›ã€‚\n\nå·®åˆ†ä¿¡å·Â ä¼˜ç‚¹ï¼šæ˜“åˆ†è¾¨å°ä¿¡å·ã€æŠ—å¹²æ‰°EMSå¼ºï¼›ç¼ºç‚¹:åŒçº¿\n\nè€Œå·®åˆ†è¾“å…¥æ¯”å•ç«¯è¾“å…¥å¤šäº†ä¸€æ ¹çº¿ï¼Œæœ€ç»ˆçš„ADCé‡‡æ ·å€¼=(ADCINç”µå‹)-(ADCIN-ç”µå‹)ï¼Œç”±äºé€šå¸¸è¿™ä¸¤æ ¹å·®åˆ†çº¿ä¼šå¸ƒåœ¨ä¸€èµ·ï¼Œæ‰€ä»¥ä»–ä»¬å—åˆ°çš„å¹²æ‰°æ˜¯å·®ä¸å¤šçš„ï¼Œè¾“å…¥å…±æ¨¡å¹²æ‰°ï¼Œåœ¨è¾“å…¥ADCæ—¶ä¼šè¢«å‡æ‰ï¼Œä»è€Œé™ä½äº†å¹²æ‰°ï¼Œç¼ºç‚¹å°±æ˜¯æ¥çº¿å¤æ‚ä¸€äº›ã€‚è€Œä¸”éœ€è¦VIN+å’ŒVIN-ä¸¤è·¯åç›¸çš„è¾“å…¥ä¿¡å·ã€‚\n\nå·®åˆ†è¾“å…¥çš„æ˜¯å°†ä¸¤ä¸ªè¾“å…¥ç«¯çš„å·®å€¼ä½œä¸ºä¿¡å·ï¼Œè¿™æ ·å¯ä»¥å…å»ä¸€äº›è¯¯å·®ï¼Œæ¯”å¦‚ä½ è¾“å…¥ä¸€ä¸ª1Vçš„ä¿¡å·å¯ç”µæºæœ‰åå·®å®é™…è¾“å…¥è¦å¤§0.1.å°±å¯ä»¥ç”¨å·®åˆ†è¾“å…¥1Vå’Œ2Vä¸€å‡å°±æŠŠä¸¤ç«¯å…±æœ‰çš„é‚£0.1è¯¯å·®å‰ªæ‰äº†ã€‚å•ç«¯è¾“å…¥æ— æ³•å»é™¤è¿™ç±»è¯¯å·®ã€‚\n\n![](Snipaste_2025-03-09_19-43-28.png)\n\n## 2. ç»§ç»­çœ‹configéƒ¨åˆ†\n\n![](Snipaste_2025-03-09_19-45-21.png)\n![](Snipaste_2025-03-09_19-45-32.png)\n\n### 2.1. é€šç”¨è®¾ç½®éƒ¨åˆ†ï¼š\n- å½“åªå¯ç”¨1ä¸ªADCæ—¶ï¼Œåªèƒ½é€‰æ‹©**ç‹¬ç«‹æ¨¡å¼**ï¼Œå¦‚æœä½¿ç”¨åŒADCå¹¶è¦æ±‚åŒæ­¥çš„è¯ï¼Œåˆ™ä¼šæœ‰æ›´å¤šé€‰æ‹©ã€‚åŒé‡ADCåŒæ­¥æ¨¡å¼ï¼Œä¸¤ä¸ªADCåŒæ—¶é‡‡é›†ä¸€ä¸ªæˆ–å¤šä¸ªé€šé“ï¼Œå¯ä»¥æé«˜é‡‡æ ·ç‡ã€‚è¿™ä¸ªåŒADCåŒæ­¥æ¨¡å¼çš„é€‰æ‹©å…ˆä¸ä½œè®°å½•äº†ï¼\n### 2.2. ADC è®¾ç½®éƒ¨åˆ†ï¼š\n#### 2.2.1. ClockPre...\næ—¶é’Ÿé¢„åˆ†é¢‘ï¼ŒåŒæ—¶é’ŸåŸŸæ¶æ„ã€‚ç›®çš„æ˜¯è®©ADCè¾¾åˆ°ç¨³å®šçš„å·¥ä½œé¢‘ç‡[^1]ï¼ˆå¼‚æ­¥æ—¶é’Ÿæ¨¡å¼ï¼ˆAsynchronous clock modeï¼ŒåŸºäºPLL2Pæ—¶é’Ÿï¼‰åŒæ­¥æ—¶é’Ÿæ¨¡å¼ï¼ˆSynchronous clock modeï¼ŒåŸºäºAHBæ—¶é’Ÿï¼‰æœ‰äº›å‹å·çš„å•ç‰‡æœºåˆ™æ˜¯ç›´æ¥ä»æ—¶é’Ÿæ ‘ä¸“é—¨åˆ†å‡ºäº†ä¸€ä¸ªADCæ—¶é’Ÿé¢‘ç‡é…ç½®ã€‚\n![](Snipaste_2025-03-09_20-30-53.png)\n\n#### 2.2.2. Resolusion\nåˆ†è¾¨ç‡ã€‚ä¸å†èµ˜è¯‰ã€‚è¯·è§ä¸Šç¯‡\n\n#### 2.2.3. Data Ali...\næ•°æ®å¯¹é½ã€‚ä¸å†èµ˜è¯‰ã€‚è¯·è§ä¸Šç¯‡\n\n#### 2.2.4. Gain Com... \nå¢ç›Šè¡¥å¿ï¼šå¯¹æ‰€æœ‰è½¬æ¢åçš„æ•°æ®è¿›è¡Œå¢ç›Šè¡¥å¿ã€‚æ¯æ¬¡è½¬æ¢åï¼Œæ•°æ®æ ¹æ®å¢ç›Šè¡¥å¿å¯¹é‡‡æ ·åçš„æ•°æ®è¿›è¡Œå˜æ¢ã€‚\n\n#### 2.2.5. Scan Conversion Mode\næ‰«ææ¨¡å¼ã€‚ä¸å†èµ˜è¯‰ã€‚è¯·è§ä¸Šç¯‡\n\n#### 2.2.6. End Of Conversion Selection\nè½¬æ¢ç»“æŸæ ‡å¿—é€‰æ‹©ï¼šæŒ‡å®šè½¬æ¢ç»“æŸåæ˜¯å¦äº§ç”ŸEOSä¸­æ–­æˆ–å•æ¬¡è½¬æ¢ç»“æŸäº‹ä»¶æ ‡å¿—ï¼ˆEOCï¼‰ã€‚æœ‰End of single conversionï¼ˆEOCï¼‰ ä¸ End of sequence of conversionï¼ˆEOSï¼‰ä¸¤ç§é€‰æ‹©ã€‚è¿™ä¸¤ä¸ªäº‹ä»¶ä¼šè§¦å‘ä¸­æ–­ä¸DMAã€‚\\\n\\\nåœ¨å¤šé€šé“è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé€‰æ‹©äº†End of sequence of conversionï¼Œä¼šåœ¨ä¸€ç»„æ•°æ®è½¬æ¢å®Œæˆåå‘å‡ºEOSæ ‡å¿—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¦‚æœä¸é€‰ï¼Œåˆ™ä¸ä¼šç½®ä½è¯¥æ ‡å¿—ã€‚\n![](Snipaste_2025-03-09_20-42-09.png)\né€‰æ‹©EOSç›®çš„æ˜¯ç­‰æ‰€æœ‰é€šé“è½¬æ¢å®Œæ¯•åï¼Œäº§ç”Ÿä¸­æ–­åå°†å…¨éƒ¨æ•°æ®å–å‡ºæ¥ï¼Œæˆ–è€…ä½¿ç”¨DMAå°†å…¨éƒ¨æ•°æ®å–å‡ºæ¥ã€‚\n\n#### 2.2.7. Low PowerÂ AutoÂ Wait\nä½åŠŸè€—è‡ªåŠ¨å»¶è¿Ÿç­‰å¾…æ¨¡å¼ï¼Œå¯é€‰å‚æ•°ä¸º ENABLE å’Œ DISABLEï¼Œå½“ä½¿èƒ½æ—¶ï¼Œä»…å½“ä¸€ç»„å†…æ‰€æœ‰ä¹‹å‰çš„æ•°æ®å·²å¤„ç†å®Œæ¯•æ—¶ï¼Œæ‰å¼€å§‹æ–°çš„è½¬æ¢ï¼Œé€‚ç”¨äºä½é¢‘åº”ç”¨ã€‚**è¯¥æ¨¡å¼ä»…ç”¨äº ADC çš„è½®è¯¢æ¨¡å¼ï¼Œä¸å¯ç”¨äº DMA ä»¥åŠä¸­æ–­ã€‚**\n\n#### 2.2.8. Continuous Conversion Mode\næ˜¯å¦å¯ç”¨è¿ç»­è½¬æ¢ã€‚ä¸å†èµ˜è¯‰ã€‚è¯·è§ä¸Šç¯‡ **è‹¥æƒ³ä½¿ç”¨ADC+DMAçš„è¯ï¼Œå¿…é¡»å…ˆä½¿èƒ½è¿ç»­è½¬æ¢æ¨¡å¼**ã€‚\n\n#### 2.2.9. Discontinuous Conversion Mode\né—´æ–­æ¨¡å¼ï¼Œå†èµ˜è¯‰ä¸€ä¸‹ã€‚è¿™é‡Œçš„ä¸è¿ç»­å«ä¹‰æ˜¯æŒ‡æ¯æ¬¡è§¦å‘è¿›è¡Œä¸€ä¸ªå­ç»„çš„è½¬æ¢ï¼Œè·ŸContinuous Conversion Modeçš„è¿ç»­å«ä¹‰ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ä½¿èƒ½äº†è¯¥é…ç½®ï¼Œè¯¥å‚æ•°çš„ä¸‹æ–¹å°±ç«‹é©¬å‡ºç°Number Of Discontinuous Conversionsï¼Œå¦‚æœå®ƒè®¾ä¸º2ï¼Œä¸”ADC1ä½¿èƒ½äº†é€šé“1ï¼Œ2ï¼Œ5ï¼Œ7ï¼Œ10ï¼Œ11çš„è¯ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡è§¦å‘ADC1é‡‡æ ·æ—¶ï¼Œå°±ä¼šé‡‡æ ·é€šé“1ä¸é€šé“2çš„å€¼ï¼Œå†ä¸€æ¬¡è§¦å‘ADC1é‡‡æ ·çš„è¯ï¼Œå°±ä¼šé‡‡æ ·é€šé“5ä¸é€šé“7å€¼ï¼Œå¦‚æ­¤ç±»æ¨ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒContinuous Conversion Modeä¸Discontinuous Conversion Modeä¸èƒ½åŒæ—¶ä½¿èƒ½ï¼Œä¸¤è€…ä¸èƒ½å…±å­˜ã€‚\n\n#### 2.2.10. DMA Continuous Requests\nDMAè¿ç»­è¯·æ±‚ï¼šæŒ‡å®š DMA è¯·æ±‚æ˜¯å¦ä»¥ä¸€æ¬¡æ€§æ¨¡å¼æ‰§è¡Œ(å½“è¾¾åˆ°è½¬æ¢æ¬¡æ•°æ—¶ï¼ŒDMA ä¼ è¾“åœæ­¢)æˆ–åœ¨è¿ç»­æ¨¡å¼ä¸‹(DMA ä¼ è¾“æ— é™åˆ¶ï¼Œæ— è®ºè½¬æ¢çš„æ•°é‡)ã€‚[^2]\n- ä¸ä½¿èƒ½ï¼šåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¯æ¬¡æœ‰æ–°çš„è½¬æ¢æ•°æ®å¯ç”¨æ—¶ï¼ŒADCéƒ½ä¼šç”Ÿæˆä¸€ä¸ªDMAä¼ è¾“è¯·æ±‚ï¼Œä¸€æ—¦DMAåˆ°è¾¾æœ€åä¸€ä¸ªDMAä¼ è¾“ï¼Œå³ä½¿è½¬æ¢å·²ç»å†æ¬¡å¼€å§‹ï¼ŒADCä¹Ÿä¼šåœæ­¢ç”ŸæˆDMAè¯·æ±‚ï¼Œé€‚åˆè½¬æ¢å›ºå®šæ•°é‡æ•°æ®çš„æƒ…å†µã€‚\n- ä½¿èƒ½ï¼šåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¯å½“æ•°æ®å¯„å­˜å™¨ä¸­æœ‰æ–°çš„è½¬æ¢æ•°æ®å¯ç”¨æ—¶ï¼Œå³ä½¿DMAå·²ç»åˆ°è¾¾æœ€åä¸€æ¬¡DMAä¼ è¾“ï¼ŒADCä¹Ÿä¼šç”ŸæˆDMAä¼ è¾“è¯·æ±‚ã€‚è¿™å…è®¸åœ¨å¾ªç¯æ¨¡å¼ä¸‹é…ç½®DMAæ¥å¤„ç†è¿ç»­çš„æ¨¡æ‹Ÿè¾“å…¥æ•°æ®æµã€‚\n\n#### 2.2.11. Overrun behaviour\næº¢å‡ºå¤„ç†ï¼šç”¨äºé…ç½®ADCè½¬æ¢æ•°æ®æœªåŠæ—¶è¯»å–ï¼Œé€ æˆæº¢å‡ºæ—¶çš„å¤„ç†ã€‚\n- Overrun data preserved:ä¿ç•™æ—§æ•°æ®ï¼Œä¸¢å¼ƒå’Œä¸¢å¤±æ–°çš„è½¬æ¢ã€‚\n- Overrun data overwritten:æ•°æ®å¯„å­˜å™¨è¢«æœ€åä¸€æ¬¡è½¬æ¢çš„ç»“æœè¦†ç›–ï¼Œä¹‹å‰æœªè¯»çš„æ•°æ®ä¸¢å¤±\n![](Snipaste_2025-03-09_21-17-16.png)\n\n#### 2.2.12. Conversion Data Managerment Modeï¼ˆH7ï¼‰\nè½¬æ¢æ•°æ®ç®¡ç†æ¨¡å¼ã€‚ä¸ä½¿ç”¨DMAçš„è¯ï¼Œä¸ä½¿ç”¨DFSDMæ•°å­—æ»¤æ³¢å™¨åšåæœŸå¤„ç†çš„è¯ï¼Œé€‰æ‹©Regular Conversion data stored in DR register onlyå³å¯ã€‚å…¶å®å°±æ˜¯é€‰æ‹©å­˜æ”¾è½¬æ¢å®Œæˆçš„æ¨¡æ‹Ÿé‡æ•°æ®çš„åœ°æ–¹è€Œå·²ã€‚\n\n### 2.3. è§„åˆ™è½¬æ¢æ¨¡å¼\n\n#### 2.3.1. Enable Regular Conversions\nä½¿èƒ½è§„åˆ™è½¬æ¢ã€‚ä½¿èƒ½å®ƒæ‰èƒ½é‡‡é›†å„ä¸ªé€šé“ä¸Šçš„æ¨¡æ‹Ÿé‡ã€‚\n\n#### 2.3.2. Enable Regular Oversampingï¼ˆä¸å¸¸ç”¨ï¼‰\nä½¿èƒ½è§„åˆ™è¿‡é‡‡æ ·ã€‚\n![](Snipaste_2025-03-10_14-20-12.png)\n\n#### 2.3.3. Oversamping Right Shiftï¼ˆä¸å¸¸ç”¨ï¼‰\nè¿‡é‡‡æ ·å³ç§»ã€‚**è¿‡é‡‡æ ·å™¨èƒ½å°†ç´¯åŠ çš„é‡‡æ ·å€¼è¿›è¡Œå³ç§»**ã€‚æœ‰ä»€ä¹ˆç”¨ï¼Ÿæ¯”å¦‚è¿‡é‡‡æ ·è®¾ç½®15ï¼Œé‚£ä¹ˆå°†é‡‡é›†16ä¸ªå€¼è¿›è¡Œç´¯åŠ ã€‚æ¥ç€é…ç½®å³ç§»åŠ¨4ä½çš„è¯ï¼Œç›¸å½“äºå°†åˆšæ‰çš„ç´¯åŠ å€¼é™¤ä»¥16ï¼Œå¾—åˆ°å¹³å‡å€¼ã€‚ä¸éœ€è¦åœ¨ç¨‹åºé‡Œæ±‚å¹³å‡äº†ã€‚å½“ç„¶ï¼Œå¦‚æœå¤§å®¶å–œæ¬¢åœ¨ç¨‹åºé‡Œæ±‚å¹³å‡å€¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\n\n#### 2.3.4. Number Of Conversion\nè½¬æ¢é€šé“æ•°ã€‚æ ¹æ®ADCé…ç½®çš„é€šé“æ•°æ¥é€‰æ‹©ã€‚æœ‰å¤šå°‘è½¬æ¢é€šé“å°±è®¾ç½®å‡ ã€‚\n\n#### 2.3.5. External Trigger Conversion Soureï¼ˆè§¦å‘è½¬æ¢çš„å¤–éƒ¨æ¥æºï¼‰\né€‰æ‹©è§¦å‘è½¬æ¢çš„æ¥æºï¼š\n- Regular Conversion launched by software ï¼ˆè½¯ä»¶è§¦å‘ï¼‰\n- Timer 1 Capture Compare 1 event ï¼ˆå®šæ—¶å™¨1æ•è·æ¯”è¾ƒäº‹ä»¶1ï¼‰\n- â€¦ ï¼ˆå„ç§å®šæ—¶å™¨è§¦å‘æ¥æºï¼‰\nä¸€èˆ¬ä½¿ç”¨è½¯ä»¶è§¦å‘å°±è¡Œã€‚\n\n#### 2.3.6. External Trigger Conversion Edgeï¼ˆè§¦å‘è½¬æ¢çš„å¤–éƒ¨æ²¿ï¼‰\né€‰æ‹©å®šæ—¶å™¨è§¦å‘æ—¶ï¼Œéœ€è¦è¿›ä¸€æ­¥é€‰æ‹©è§¦å‘çš„æ²¿ã€‚é€‰æ‹©è½¯ä»¶è§¦å‘æ—¶ï¼Œè¯¥é¡¹ä¸ºNoneã€‚\nTrigger detection on the rising edgeï¼ˆä¸Šå‡æ²¿ï¼‰\nTrigger detection on the falling edgeï¼ˆä¸‹é™æ²¿ï¼‰\nTrigger detection on the rising and falling edgeï¼ˆä¸Šå‡ä¸ä¸‹é™æ²¿ï¼‰\n\n#### 2.3.7. Rank\n![](Snipaste_2025-03-10_14-29-51.png)\n\n- Channelï¼šé€‰æ‹©é‡‡æ ·çš„é€šé“ã€‚\n-  Sampling Timeï¼šé‡‡æ ·æ—¶é—´ã€‚é…ç½®å¤šå°‘ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œå»ºè®®é‡‡æ ·æ—¶é—´å°½é‡é•¿ä¸€ç‚¹ï¼Œä»¥è·å¾—è¾ƒé«˜çš„å‡†ç¡®åº¦ã€‚æ€»çš„è½¬æ¢æ—¶é—´=é‡‡æ ·æ—¶é—´+é€æ¬¡é€¼è¿‘æ—¶é—´ï¼ˆTSARï¼‰ã€‚[^3]\né€æ¬¡é€¼è¿‘å‚è€ƒæ—¶é—´ï¼šè¯·æŸ¥é˜…ç›¸å…³æ•°æ®æ‰‹å†Œã€‚\nè¿™æ˜¯ä¸€ä¸ªå‚è€ƒï¼š\n![](Snipaste_2025-03-10_14-31-52.png)\n\n#### 2.3.8. Offset Number\nåç§»åºå·ï¼Ÿï¼Ÿä¸æ‡‚ã€‚\n\n### 2.4. ç„¶åæ˜¯æ³¨å…¥è½¬æ¢æ¨¡å¼\næˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨é€‰æ‹©äº†ADCçš„ç›¸å…³é€šé“å¼•è„šä¹‹åï¼Œåœ¨æ¨¡æ‹Ÿè‡³æ•°å­—è½¬æ¢å™¨ä¸­æœ‰ä¸¤ä¸ªé€šé“ï¼šæ³¨å…¥é€šé“ä¸è§„åˆ™é€šé“ã€‚è§„åˆ™é€šé“è‡³å¤š16ä¸ªï¼Œæ³¨å…¥é€šé“è‡³å¤š4ä¸ªã€‚\n\n#### 2.4.1. è§„åˆ™é€šé“ï¼š\nè§„åˆ™é€šé“ç›¸å½“äºä½ æ­£å¸¸è¿è¡Œçš„ç¨‹åºï¼Œçœ‹å®ƒçš„åå­—å°±å¯ä»¥çŸ¥é“ï¼Œå¾ˆè§„çŸ©ï¼Œå°±æ˜¯æ­£å¸¸æ‰§è¡Œç¨‹åºã€‚\n#### 2.4.2. æ³¨å…¥é€šé“ï¼š\næ³¨å…¥é€šé“å¯ä»¥æ‰“æ–­è§„åˆ™é€šé“ï¼Œå¬å®ƒçš„åå­—å°±çŸ¥é“ä¸å®‰åˆ†ï¼Œå¦‚æœåœ¨è§„åˆ™é€šé“è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œæœ‰æ³¨å…¥é€šé“è¿›è¡Œè½¬æ¢ï¼Œé‚£ä¹ˆå°±è¦å…ˆè½¬æ¢å®Œæ³¨å…¥é€šé“ï¼Œç­‰æ³¨å…¥é€šé“è½¬æ¢å®Œæˆåï¼Œå†å›åˆ°è§„åˆ™é€šé“çš„è½¬æ¢æµç¨‹ã€‚ç±»ä¼¼äºä¸­æ–­ã€‚\n![](Snipaste_2025-03-10_14-43-22.png)\n\n### 2.5. æœ€åæ˜¯å¯çˆ±çš„çœ‹é—¨å°ç‹—ğŸ¥°~\nå½“è¢«ADCè½¬æ¢çš„æ¨¡æ‹Ÿç”µå‹å€¼ä½äºä½é˜ˆå€¼æˆ–é«˜äºé«˜é˜ˆå€¼æ—¶ï¼Œä¾¿ä¼šäº§ç”Ÿä¸­æ–­ã€‚é˜ˆå€¼çš„é«˜ä½å€¼ç”±ADC_LTRå’ŒADC_HTRé…ç½®ã€‚\nå¯ä»¥é˜²æ­¢è¯»å–åˆ°çš„ç”µå‹å€¼è¶…é‡ç¨‹æˆ–è€…ä½äºé‡ç¨‹ï¼Œä¹Ÿå¯ä»¥ç›‘æ§CPUæ¸©åº¦ï¼Œé˜²æ­¢æ¸©åº¦è¿‡é«˜ï¼Œåæ­£æ˜¯ç”¨å¤„å¤šå¤šã€‚\n\n## 3. å‚è€ƒå‡½æ•°\n```c\n//å¼€å¯ADC 3ç§æ¨¡å¼ ( è½®è¯¢æ¨¡å¼ ä¸­æ–­æ¨¡å¼ DMAæ¨¡å¼ )\nHAL_ADC_Start(&hadcx); â€ƒ â€ƒ â€ƒ //è½®è¯¢æ¨¡å¼å¼€å¯ADC\nHAL_ADC_Start_IT(&hadcx); â€ƒ â€ƒ â€ƒ //ä¸­æ–­è½®è¯¢æ¨¡å¼å¼€å¯ADC\nHAL_ADC_Start_DMA(&hadcx); â€ƒ â€ƒ â€ƒ //DMAæ¨¡å¼å¼€å¯ADC\n\n//å…³é—­ADC 3ç§æ¨¡å¼ ( è½®è¯¢æ¨¡å¼ ä¸­æ–­æ¨¡å¼ DMAæ¨¡å¼ )\nHAL_ADC_Stop();\nHAL_ADC_Stop_IT();\nHAL_ADC_Stop_DMA();\n\n//ADCæ ¡å‡†å‡½æ•° ï¼šF4ç³»åˆ—ä¸æ”¯æŒ\nHAL_ADCEx_Calibration_Start(&hadcx); â€ƒ â€ƒ â€ƒ\n\n//è¯»å–ADCè½¬æ¢å€¼\nHAL_ADC_GetValue();\n\n//ç­‰å¾…è½¬æ¢ç»“æŸå‡½æ•°.ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå“ªä¸ªADC,ç¬¬äºŒä¸ªå‚æ•°ä¸ºæœ€å¤§ç­‰å¾…æ—¶é—´\nHAL_ADC_PollForConversion(&hadc1, 50);\n\n//ADCä¸­æ–­å›è°ƒå‡½æ•°\nHAL_ADC_ConvCpltCallback();\n\n//è½¬æ¢å®Œæˆåå›è°ƒï¼ŒDMAæ¨¡å¼ä¸‹DMAä¼ è¾“å®Œæˆåè°ƒç”¨\n\n//è§„åˆ™é€šé“åŠçœ‹é—¨ç‹—é…ç½®\nHAL_ADC_ConfigChannel(); //é…ç½®è§„åˆ™ç»„é€šé“\nHAL_ADC_AnalogWDGConfig();\n```\n\n\n\n## 4. å‚è€ƒåšå®¢\næœ‰æ˜Ÿæ˜Ÿçš„æ˜¯æˆ‘è§‰å¾—å†™çš„å¾ˆå¥½çš„åšå®¢ã€‚\n- â­â­â­[STM32H743-æ¢³ç†ADCæ¨¡æ•°è½¬æ¢å™¨åœ¨CubeMXä¸Šçš„é…ç½®_overrun behaviour-CSDNåšå®¢](https://blog.csdn.net/wallace89/article/details/117048846)éµå¾ªÂ [CC 4.0 BY-SA](http://creativecommons.org/licenses/by-sa/4.0/)Â ç‰ˆæƒåè®®\n- â­â­â­[STM32CubeIde ADCé…ç½®è¯¦è§£_end of conversion selection-CSDNåšå®¢](https://blog.csdn.net/demonneverhunts/article/details/135155881)éµå¾ªÂ [CC 4.0 BY-SA](http://creativecommons.org/licenses/by-sa/4.0/)Â ç‰ˆæƒåè®®\n- â­â­â­[ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹ä¹---ADC_cubemx adc-CSDNåšå®¢](https://blog.csdn.net/as480133937/article/details/99627062)\n- [ADCçš„å•ç«¯è¾“å…¥ã€ä¼ªå·®åˆ†è¾“å…¥ã€å·®åˆ†è¾“å…¥åŒºåˆ«ï¼Ÿ_å·®åˆ†adc-CSDNåšå®¢](https://blog.csdn.net/chenhuanqiangnihao/article/details/122086308)\n\n\n[^1]:ADCçš„å·¥ä½œé¢‘ç‡éœ€è¦æŸ¥é˜…ç›¸å…³æ•°æ®æ‰‹å†Œ,å·¥ä½œé¢‘ç‡å¤ªé«˜ä¼šå¯¼è‡´è½¬æ¢æ— æ³•å®Œæˆã€‚\n[^2]: åœ¨è¿ç»­æ¨¡å¼ä¸‹ï¼ŒDMA å¿…é¡»é…ç½®ä¸ºå¾ªç¯æ¨¡å¼ã€‚å¦åˆ™ï¼Œå½“è¾¾åˆ° DMA ç¼“å†²åŒºæœ€å¤§æŒ‡é’ˆæ—¶å°†è§¦å‘æº¢å‡ºã€‚\n[^3]: æ—¶é—´å¯ä»¥ç”¨ADCæ—¶é’Ÿå‘¨æœŸæ¥è¡¡é‡ã€‚ä¾‹å¦‚12bitADCçš„é€æ¬¡é€¼è¿‘æ—¶é—´ä¸º12.5ä¸ªADCæ—¶é’Ÿå‘¨æœŸ\n","tags":["STM32","CubeMX","ADC","åµŒå…¥å¼"],"categories":["åµŒå…¥å¼","CubeMXé…ç½®åŠŸèƒ½"]},{"title":"Hello World","url":"/posts/16107/","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n"},{"title":"CubeMXé…ç½®åŠŸèƒ½ç³»åˆ—ï¼šADCï¼ˆä¸Šï¼‰","url":"/posts/9852/","content":"\n<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## ç›®å½•\n- [ç›®å½•](#ç›®å½•)\n- [1. è¯´æ˜](#1-è¯´æ˜)\n- [2. Analog-to-Digital Converterç®€ä»‹](#2-analog-to-digital-converterç®€ä»‹)\n- [3. STM32é‡Œçš„ADCæ˜¯å¦‚ä½•è¿›è¡Œè½¬æ¢çš„ï¼Ÿ](#3-stm32é‡Œçš„adcæ˜¯å¦‚ä½•è¿›è¡Œè½¬æ¢çš„)\n  - [3.1. æ•°æ®å¯¹é½](#31-æ•°æ®å¯¹é½)\n  - [3.2. å…·ä½“è¯´æ˜ï¼š](#32-å…·ä½“è¯´æ˜)\n- [4. ADCçš„è½¬æ¢æ¨¡å¼](#4-adcçš„è½¬æ¢æ¨¡å¼)\n  - [4.1. å…³äºæ˜¯å¦è¦æŒç»­è½¬æ¢](#41-å…³äºæ˜¯å¦è¦æŒç»­è½¬æ¢)\n  - [4.2. å¦‚æœæœ‰å¤šä¸ªé€šé“](#42-å¦‚æœæœ‰å¤šä¸ªé€šé“)\n- [5. å‚è€ƒåšå®¢](#5-å‚è€ƒåšå®¢)\n\n## 1. è¯´æ˜\n\nADCä½œä¸ºå¯¹æˆ‘æ¥è¯´ä¸æ€ä¹ˆç”¨çš„åŠŸèƒ½ï¼Œè®°å½•ä¸€ä¸‹å¾ˆæœ‰å¿…è¦ã€‚æœ¬æ–‡ä»¥*STM32G4*ç³»åˆ—ä¸ºä¾‹ã€‚ä¾›è‡ªå·±å­¦ä¹ ä¸è®°å½•ä¸”åªåšç®€å•ä»‹ç»ã€‚æœ‰ä¸€å®šåŸºç¡€çš„æœ‹å‹å¯å‚è€ƒã€‚\n\n## 2. Analog-to-Digital Converterç®€ä»‹\n\næ¨¡æ‹Ÿåˆ°æ•°å­—è½¬æ¢å™¨ï¼Œç®€ç§°ADCã€‚å°†è¿ç»­çš„æ¨¡æ‹Ÿä¿¡å·è½¬æ¢ä¸ºæ•°å­—ä¿¡å·ã€‚\n\n## 3. STM32é‡Œçš„ADCæ˜¯å¦‚ä½•è¿›è¡Œè½¬æ¢çš„ï¼Ÿ\n\né‡‡ç”¨çš„æ˜¯SARï¼ˆé€æ¬¡é€¼è¿‘ï¼‰çš„æ–¹æ³•ã€‚é€šè¿‡äºŒåˆ†æ¯”è¾ƒä½¿æ•°å­—é‡é€¼è¿‘çœŸå®çš„æ¨¡æ‹Ÿä¿¡å·é‡ã€‚\\\n\\\nä¸€èˆ¬stm32ä¸­çš„ADCå‚¨å­˜è½¬æ¢ç»“æœçš„å¯„å­˜å™¨æœ‰æ•ˆä½ä¸º12ä½ï¼Œä¹Ÿå¯ä»¥è¯´è¯¥ADCçš„åˆ†è¾¨ç‡ä¸º12ä½ã€‚æ¨¡æ‹Ÿé‡ç»è¿‡è½¬æ¢åä¸æ•°å­—é‡æ˜¯çº¿æ€§å…³ç³»[^1]ï¼Œ0x000ä»£è¡¨æµ‹é‡æœ€å°å€¼ã€‚0xfffä»£è¡¨æµ‹é‡æœ€å¤§å€¼ï¼ˆå³å‚è€ƒç”µå‹å€¼ï¼‰ã€‚\n\n### 3.1. æ•°æ®å¯¹é½\n\nå°½ç®¡åˆ†è¾¨ç‡ä¸º12ä½ï¼Œä¹Ÿæ˜¯æ”¾åœ¨16ä½å¯„å­˜å™¨é‡Œçš„ï¼Œé‚£ä¹ˆå°±æ¶‰åŠæ•°æ®å¯¹é½çš„é—®é¢˜ã€‚\n- è‹¥12ä½æ•°æ®æ˜¯å³å¯¹é½çš„ï¼Œå³ç»“æœä¸º0x0???ï¼Œè¿™æ ·å¾—åˆ°çš„ç»“æœç›´æ¥å°±æ˜¯è½¬æ¢ç»“æœã€‚\n- è‹¥é€‰æ‹©å·¦å¯¹é½ï¼Œå³ç»“æœä¸º0x???0ï¼Œç›¸å½“äº`0x0???<<4`!!ä¸ä¼šæœ‰äººè§‰å¾—æ˜¯å·¦ç§»1ä½å§!! æˆ‘ä»¬éƒ½çŸ¥é“å³ç§»å››ä½ç›¸å½“äºä¹˜ä»¥2^4^ï¼Œæ¯”å®é™…æ•°æ®å¢å¤§äº†16å€ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜éœ€è¦å·¦å¯¹é½å‘¢ï¼Ÿæœ‰æ—¶æˆ‘ä»¬å¯¹åˆ†è¾¨ç‡è¦æ±‚ä¸é«˜ï¼Œåªéœ€å¤§æ¦‚åˆ¤æ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å·¦å¯¹é½å–å‡ºå¯„å­˜å™¨çš„é«˜8ä½ï¼Œç›¸å½“äºèˆå¼ƒ4ä½è½¬æ¢ç²¾åº¦ï¼Œé™ä¸º8ä½åˆ†è¾¨ç‡ã€‚\n### 3.2. å…·ä½“è¯´æ˜ï¼š\n\nä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦æµ‹é‡æ¨¡æ‹Ÿé‡ä¸º0.9V è¿‡ç¨‹å¦‚ä¸‹[^2]ï¼š\n\n1. é€šè¿‡GPIOå£é‡‡æ ·å¾…æµ‹ç”µå‹åˆ°ç”µå®¹ä¸Šã€‚\n2. åˆ‡æ–­ä¸å¾…æµ‹ä¿¡å·çš„è¿æ¥ï¼Œå°†å¾…æµ‹ç”µå‹ä¿æŒåœ¨ç”µå®¹ä¸Šã€‚\n3. æˆ‘ä»¬ä»æœ€é«˜ä½å¼€å§‹ ?000-0000-0000 ï¼Œæˆ‘ä»¬çŸ¥é“ 1000-0000-0000 åˆšå¥½å¯¹åº”åè¿›åˆ¶2048ï¼Œæ ¹æ®çº¿æ€§å…³ç³»2048åˆšå¥½å¯¹åº”å‚è€ƒç”µå‹çš„ä¸€åŠã€‚æ‰€ä»¥è¿™é‡Œç›¸å½“äºå°†å‚è€ƒç”µå‹å€¼çš„ä¸€åŠ1.65vä¸å¾…æµ‹ç”µå‹æ¯”è¾ƒã€‚å¦‚æœå¾…æµ‹ç”µå‹æ²¡æœ‰1.65vé«˜ï¼Œå°±å°†æœ€é«˜ä½ç½®0ã€‚æˆ‘ä»¬å°±çŸ¥é“å¾…æµ‹ç”µå‹å¯¹åº”åœ¨0~2048ä¹‹é—´ã€‚æ­¤æ—¶æˆ‘ä»¬å°±è¦å’Œ1024æ¯”è¾ƒï¼Œ1024äºŒè¿›åˆ¶è¡¨ç¤ºä¸º 0100-0000-0000ï¼Œåˆšå¥½æ˜¯æ¬¡é«˜ä½ç½®1çš„æƒ…å†µã€‚ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°12ä½å…¨éƒ¨æ¯”è¾ƒå®Œï¼Œå°±èƒ½ç¡®å®šå“ªäº›ä½æ˜¯1å“ªäº›ä½æ˜¯0ã€‚\n\n\n\n## 4. ADCçš„è½¬æ¢æ¨¡å¼\n### 4.1. å…³äºæ˜¯å¦è¦æŒç»­è½¬æ¢\n1. å•æ¬¡è½¬æ¢æ¨¡å¼ï¼šADCåªæ‰§è¡Œä¸€æ¬¡è½¬æ¢ï¼›\n2. è¿ç»­è½¬æ¢æ¨¡å¼ï¼šè½¬æ¢ç»“æŸä¹‹åé©¬ä¸Šå¼€å§‹æ–°çš„è½¬æ¢ï¼›\n### 4.2. å¦‚æœæœ‰å¤šä¸ªé€šé“\n1. æ‰«ææ¨¡å¼ï¼šADCæ‰«æè¢«è§„åˆ™é€šé“å’Œæ³¨å…¥é€šé“é€‰ä¸­çš„æ‰€æœ‰é€šé“ï¼Œåœ¨æ¯ä¸ªç»„çš„æ¯ä¸ªé€šé“ä¸Šæ‰§è¡Œå•æ¬¡è½¬æ¢ã€‚åœ¨æ¯ä¸ªè½¬æ¢ç»“æŸæ—¶ï¼Œè¿™ä¸€ç»„çš„ä¸‹ä¸€ä¸ªé€šé“è¢«è‡ªåŠ¨è½¬æ¢ã€‚å¦‚æœè®¾ç½®äº†CONTä½ï¼ˆå¼€å¯äº†è¿ç»­è½¬æ¢æ¨¡å¼ï¼‰ï¼Œè½¬æ¢ä¸ä¼šåœ¨é€‰æ‹©ç»„çš„æœ€åä¸€ä¸ªé€šé“ä¸Šåœæ­¢ï¼Œè€Œæ˜¯å†æ¬¡ä»é€‰æ‹©ç»„çš„ç¬¬ä¸€ä¸ªé€šé“ç»§ç»­è½¬æ¢ã€‚\n2. é—´æ–­æ¨¡å¼ï¼šè§¦å‘ä¸€æ¬¡ï¼Œè½¬æ¢ä¸€ä¸ªé€šé“ï¼Œå†è§¦å‘ï¼Œå†è½¬æ¢ã€‚åœ¨æ‰€é€‰è½¬æ¢é€šé“å¾ªç¯ï¼Œç”±è§¦å‘ä¿¡å·å¯åŠ¨æ–°ä¸€è½®çš„è½¬æ¢ï¼Œç›´åˆ°è½¬æ¢å®Œæˆä¸ºæ­¢ã€‚\n\n## 5. å‚è€ƒåšå®¢\nç»™æ˜Ÿæ˜Ÿçš„æ˜¯æˆ‘è§‰å¾—å†™å¾—å¾ˆå¥½çš„åšå®¢ã€‚\n- â­â­â­[ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹ä¹---ADC_cubemx adc-CSDNåšå®¢](https://blog.csdn.net/as480133937/article/details/99627062)\n\n[^1]: ä»¥12ä½åˆ†è¾¨ç‡ADCä¸ºä¾‹ï¼Œå‚è€ƒç”µå‹3.3vï¼šç”µå‹å€¼y=è½¬æ¢ç»“æœxÂ·3.3/4096.\n[^2]:  å‚è€ƒç”µå‹3.3vï¼Œ12ä½ç²¾åº¦","tags":["STM32","CubeMX","ADC","åµŒå…¥å¼"],"categories":["åµŒå…¥å¼","CubeMXé…ç½®åŠŸèƒ½"]},{"title":"å•ç‰‡æœºï¼ˆä¼ªï¼‰å¤šä»»åŠ¡å¤„ç†ï¼šæ—¶é—´ç‰‡è½®è¯¢æ³•","url":"/posts/39448/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## å¼•å…¥\n\nåœ¨æ–°æ‰‹åˆšåˆšå…¥é—¨æ—¶ï¼Œé€šå¸¸ä½¿ç”¨çš„ç¨‹åºæ¶æ„ä¸ºè£¸æœºã€é¡ºåºæ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´æŠŠæ‰€æœ‰çš„åŠŸèƒ½æ”¾åœ¨ä¸€ä¸ª`while(1)`æ­»å¾ªç¯ä¸­ç„¶åå•ç‰‡æœºä¸æ–­å¾ªç¯æ‰§è¡Œã€‚æœ‰å¿…è¦çš„è¯ä¼šåŠ ä¸Šä¸€äº›ä¸­æ–­ç”¨æ¥å¤„ç†ä¸€äº›ç´§æ€¥äº‹ä»¶æˆ–è€…å¤–éƒ¨çš„ä¿¡å·ï¼Œæ„æˆç»å…¸çš„å‰åå°ç³»ç»Ÿã€‚ä½†æ˜¯è¿™æ ·åšæœ‰ä»€ä¹ˆå¼Šç«¯å‘¢ï¼Ÿè¿™æ˜¯æˆ‘åœ¨æˆ‘è¸©è¿‡å‘åæ„è¯†åˆ°çš„ï¼š\n\n1. æœ‰äº›ç¨‹åºå®Œå…¨ä¸éœ€è¦é¢‘ç¹æ‰§è¡Œï¼Œæ¯”å¦‚LEDçš„åˆ·æ–°ï¼ŒæŒ‰é”®çš„æ£€æµ‹ç­‰ã€‚æ”¾åœ¨æ­»å¾ªç¯ä¸­æ‰§è¡Œå¯¹CPUæ¯”è¾ƒæµªè´¹ã€‚\n2. éšç€åŠŸèƒ½çš„å¢å¤šæˆ–è€…ä»£ç å˜å¾—å¤æ‚ä½ ä¼šæ„Ÿè§‰åˆ°ç¨‹åºè¶Šå†™è¶Šå›°éš¾ï¼Œå¾ªç¯ä¸­çš„åŠŸèƒ½æ¨¡å—æœ‰æ—¶éœ€è¦å’Œä¸­æ–­è”åŠ¨ï¼Œå„ä¸ªæ¨¡å—ä¹‹é—´ä¹Ÿæœ‰å¯èƒ½éœ€è¦è”åŠ¨èµ·æ¥ã€‚å³ä½¿ä½¿ç”¨çŠ¶æ€æœºä¹ŸåŠ›ä¸ä»å¿ƒ...\n3. å‹‰å‹‰å¼ºå¼ºå®Œæˆäº†ä»»åŠ¡ï¼ŒåæœŸçš„ç»´æŠ¤ä¹Ÿå˜å¾—ç›¸å½“çš„éº»çƒ¦ã€‚\n\nè¸©è¿‡å‘åçš„æˆ‘ç—›å®šæ€ç—›ï¼šå‡†å¤‡ä»¥åå†™ç¨‹åºéƒ½è¯·å‡ºRTOSè¿™ä¸ªå¤§æ‰‹å­ã€‚ä½†æ˜¯åæ¥æˆ‘åˆå‘ç° æœ‰æ—¶ä½ æƒ³è¦å®ç°çš„åŠŸèƒ½åˆšå¥½ä»‹äºå¤æ‚ä¸ä¸å¤æ‚ä¹‹é—´...å’‹ç†è§£å‘¢ï¼Œå°±æ˜¯è¯´ç”¨é¡ºåºæ‰§è¡Œï¼Œå¤æ‚äº†ç‚¹ï¼Œç”¨RTOSå§å¥½åƒä¹Ÿæ²¡å¿…è¦...æ¯•ç«Ÿç§»æ¤è¿˜æ˜¯æŒºéº»çƒ¦çš„ã€‚å½“ç„¶è¿˜æœ‰å°±æ˜¯RTOSä½“é‡è¿‡å¤§ï¼Œæœ‰äº›å•ç‰‡æœºåƒä¸ä¸‹ï¼Œæˆ–è€…åƒä¸‹äº†ä½†æ˜¯ä¹Ÿæ’‘çš„åƒä¸ä¸‹è‡ªå·±å†™çš„ä»£ç äº†!!å±äºæ˜¯å°é¸Ÿèƒƒè¿™ä¸€å—ï¼Œä¸è¿‡ç›®å‰æˆ‘è¿˜æ²¡é‡åˆ°è¿‡ï¼Œæˆ‘ç”¨çš„å•ç‰‡æœºåŸºæœ¬ä¸Šå±äºå¤§å«æˆ´è¿™ä¸€å—!!\n\n## æ—¶é—´ç‰‡è½®è¯¢æ³•\n\nä¸ºäº†ä¼˜åŒ–ä¸Šé¢è¿™äº›é—®é¢˜ï¼Œå¤§ä½¬ä»¬äºæ˜¯æå‡ºäº†ä¸€ç§åŸºäºæ—¶é—´ç‰‡çš„è£¸æœºå¼€å‘æ¶æ„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€ä¸ªå®šæ—¶å™¨æä¾›å¿ƒè·³ï¼Œä¸æ–­çš„è¿›è¡Œè®¡æ•°ã€‚ç„¶åå½“å®šæ—¶æ—¶é—´ä¸€åˆ°ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¼€å§‹æ‰§è¡Œç›¸åº”çš„ä»»åŠ¡äº†ã€‚\n\n### Talk is cheapï¼ŒShow me the code.\n\né¦–å…ˆæ˜¯.hå¤´æ–‡ä»¶\n```c\n#ifndef __OS_H__\n#define __OS_H__\n\n//ä»»åŠ¡çŠ¶æ€\ntypedef enum TaskStatus\n{\nÂ  Â  wait,run,stop\n\n}TaskStatus;//ç­‰å¾…è¿è¡Œã€æ­£åœ¨è¿è¡Œã€åœæ­¢è¿è¡Œ\n\n\n//ä»»åŠ¡ä¿¡æ¯å—\ntypedef struct\n{\n\nÂ  Â  uint16_t Â  Â TaskTimer; Â  Â //ç”¨äºè®¡æ—¶\n\nÂ  Â  uint16_t Â  Â TaskRunTime; Â //æ¯éš”å¤šå°‘æ—¶é—´è¿è¡Œä¸€æ¬¡\n\nÂ  Â  TaskStatus Â Status; Â  Â  Â  //ä»»åŠ¡çŠ¶æ€\n\nÂ  Â  void (*FC)();             //ä»»åŠ¡å‡½æ•°æŒ‡é’ˆ\n\n}TaskStruct;\n\n  \nvoid OSInit(TIM_HandleTypeDef htim);//åˆå§‹åŒ–è®¾ç½®ï¼Œè¿™é‡Œæ˜¯ç”¨çš„STM32halåº“\n\nvoid OS_IT_RUN(void);//æ”¾åœ¨æä¾›å¿ƒè·³çš„å®šæ—¶å™¨ä¸­æ–­é‡Œè¿è¡Œ\n\nvoid OS_Run(void);//ä¸»å‡½æ•°é‡Œè¿è¡Œçš„\n \n#endif\n```\n\nç„¶åæ˜¯.c\n```c\n/**\n\nÂ  ******************************************************************************\n\nÂ  * @file Â  Â  Â  Â  Â  : OS.c\n\nÂ  * @brief Â  Â  Â  Â  Â : ä»»åŠ¡å‡½æ•°ã€OSå†…æ ¸\n\nÂ  ******************************************************************************\n\nÂ  */\n\n#include \"OS.h\"\n\n/* ä»»åŠ¡å£°æ˜------------------------------------------------------------------*/\n\nvoid A(void);\nvoid B(void);\nvoid C(void);\n\n/* -------------------------------------------------------------------------*/\n\n/* ä»»åŠ¡æ¸…å•é…ç½®---------------------------------------------------------------*/\n\nuint8_t TaskCount = 0;//è®°å½•ä»»åŠ¡æ•°é‡ Â \n\nTaskStruct TaskList[] = {\n\nÂ  Â  {0,5,run,A},\n\nÂ  Â  {0,10,wait,B},\n\nÂ  Â  {0,3,wait,C},\n\n};//ä»»åŠ¡æ¸…å•\n\n/* -------------------------------------------------------------------------*/\n\n  \n  \n\n/* ä»»åŠ¡åŒæ­¥æ‰€éœ€å…¬å…±å˜é‡--------------------------------------------------------*/\n\n/* -------------------------------------------------------------------------*/\n\n  \n  \n\n/* OS ä¸»åŠŸèƒ½ä»£ç --------------------------------------------------------------*/\n\nvoid OSInit(TIM_HandleTypeDef htim){//å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é‡æ–°å†™\n\nÂ  Â  HAL_TIM_Base_Start_IT(&htim); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //æ‰“å¼€å®šæ—¶å™¨\n\nÂ  Â  TaskCount = sizeof(TaskList)/sizeof(TaskList[0]); Â  //åˆ©ç”¨sizeofè®¡ç®—æ•°ç»„é•¿åº¦çš„æ–¹æ³•å¯å¾—åˆ°ä»»åŠ¡æ•°é‡\n\n}\n\n  \n//æ”¾åœ¨ä¸­æ–­ä¸­æ‰§è¡Œ\nvoid OS_IT_RUN(void){\n\nÂ  Â  uint8_t i;\n\nÂ  Â  for(i=0;i<TaskCount;i++){ Â  Â  Â  Â  Â  Â  Â //éå†æ‰€æœ‰å¾ªç¯\n\nÂ  Â  Â  Â  if(TaskList[i].Status == wait){ Â  Â //å½“ä»»åŠ¡waitçŠ¶æ€ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤\n\nÂ  Â  Â  Â  Â  Â  if(++TaskList[i].TaskTimer >= TaskList[i].TaskRunTime){\nÂ  Â  Â  Â  Â  Â  //è®¡æ—¶ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦åˆ°è¾¾å®šæ—¶æ—¶é—´ Â  Â  Â  Â  Â   Â Â  Â  \nÂ  Â  Â  Â  Â  Â  //å¦‚æœåˆ°äº†å®šæ—¶æ—¶é—´ï¼Œåˆ™å°†ä»»åŠ¡æŒ‚èµ·ï¼Œå¹¶å¤ä½è®¡æ—¶ï¼ˆä¹Ÿå¯ä»¥æ‰§è¡Œå®Œåå¤ä½ï¼Œæ•ˆæœä¸€æ ·ï¼‰\nÂ  Â  Â  Â  Â  Â  Â  Â  TaskList[i].TaskTimer = 0;\n\nÂ  Â  Â  Â  Â  Â  Â  Â  TaskList[i].Status = run;\nÂ  Â  Â  Â  Â  Â  }\n\nÂ  Â  Â  Â  }\n\nÂ  Â  }\n\n}\n\n  \n\n//æ”¾åœ¨mainå‡½æ•°ä¸­æ‰§è¡Œï¼Œè‡ªå¸¦æ­»å¾ªç¯ï¼Œç”¨äºæ‰§è¡Œä»»åŠ¡\nvoid OS_Run(void){\n\nÂ  Â  uint8_t j=0;\n\nÂ  Â  while(1){\n\nÂ  Â  Â  Â  if(TaskList[j].Status == run){ Â  Â  Â  Â  Â  Â  Â  Â  Â //åˆ¤æ–­ä¸€ä¸ªä»»åŠ¡æ˜¯å¦ä¸ºrunçŠ¶æ€\n\nÂ  Â  Â  Â  Â  Â  TaskList[j].FC(); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  //æ‰§è¡Œè¯¥ä»»åŠ¡å‡½æ•°\n\nÂ  Â  Â  Â  Â  Â  TaskList[j].Status = wait ; Â  Â  Â  Â  Â  Â  Â  Â  //å–æ¶ˆä»»åŠ¡çš„runçŠ¶æ€\n\nÂ  Â  Â  Â  }\n\nÂ  Â  Â  Â  if(++j>=TaskCount)j=0; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â //ä¸æ–­å¾ªç¯éå†æ‰€æœ‰ä»»åŠ¡\n\nÂ  Â  Â  Â  /* è¿™é‡Œå¯ä»¥å®šä¹‰ç©ºé—²ä»»åŠ¡ */\n\nÂ  Â  }\n\n}\n\n  \n\n/* -------------------------------------------------------------------------*/\n```\n\n**æŒ‰ç…§åˆ†è€Œæ²»ä¹‹çš„æ€æƒ³ï¼Œå®Œå…¨å¯ä»¥æŠŠä»»åŠ¡å‡½æ•°é‡æ–°å†™åœ¨ä¸€ä¸ªtask.cæ–‡ä»¶ä¸­ï¼Œè¿™æ ·æ›´åŠ ç®€æ´ç¾è§‚**ã€‚\né‡‡ç”¨ä¸Šé¢çš„ä»£ç ï¼Œä¸ªäººè®¤ä¸ºæ¯”ä¸ºæ¯ä¸ªåŠŸèƒ½å‡½æ•°æä¾›ä¸€ä¸ªflagï¼Œæ—¶é—´åˆ°è¾¾åå°†ä»»åŠ¡æ ‡å¿—ä¸ºç½®ä½ã€‚ç„¶ååœ¨mainå‡½æ•°çš„å¾ªç¯ä¸­æ£€æŸ¥æ ‡å¿—ä½çŠ¶æ€ï¼ˆç±»ä¼¼çŠ¶æ€æœºï¼‰é‚£ç§æ–¹æ³•è¦æ–¹ä¾¿ã€‚é¿å…äº†ä¸€äº›é‡å¤çš„å·¥ä½œã€‚\n\n### ä»€ä¹ˆæ„æ€\n\næ¯”å¦‚æˆ‘æœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼š\n- Aï¼š5msæ‰§è¡Œä¸€æ¬¡ \n- Bï¼š10msæ‰§è¡Œä¸€æ¬¡\n- Cï¼š3msæ‰§è¡Œä¸€æ¬¡\n\næˆ‘ä»¬éšæœºææ‹”ä¸€ä¸ªå®šæ—¶å™¨ä½œä¸ºå¿ƒè·³æ—¶é’Ÿï¼Œè¯´ç™½äº†å°±æ˜¯æè¡¨çš„å˜›ã€‚è¿™ä¸ªå®šæ—¶å™¨ä¸€èˆ¬ä½¿ç”¨åŸºæœ¬å®šæ—¶å™¨æ€§ä»·æ¯”é«˜ä¸€ç‚¹ã€‚è¿™ä¸ªå®šæ—¶å™¨æ¯éš”1mså°±å«ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šABCåœ¨ä¸Šç”µæ—¶å€™æ—¶æ˜¯å¦æ‰§è¡Œï¼Œæˆ–è€…ä¸Šç”µåå»¶è¿Ÿä¸€ä¸ªè‡ªå·±çš„ä»»åŠ¡å‘¨æœŸå†æ‰§è¡Œã€‚æ¯”å¦‚æˆ‘ä»¬è®¾å®šä¸Šç”µæ—¶ï¼šä»…Aæ‰§è¡Œã€‚å¦‚æœæˆ‘ä»¬å¿½ç•¥ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œé‚£ä¹ˆç¨‹åºå°±æ˜¯è¿™ä¹ˆè¿è¡Œçš„ï¼š\n\n`A-1ms-1ms-1ms(C)-1ms-1ms(A)-1ms(C)-1ms-1ms-1ms(C)-1ms(Aã€B)--------`\n\nå¦‚æœä¸Šä¸€ä¸ªåŠŸèƒ½æ¨¡å—å·²ç»æ‰§è¡Œå®Œäº†ï¼Œä½†ä¸‹ä¸€ä¸ªåŠŸèƒ½æ¨¡å—çš„å®šæ—¶æ—¶é—´è¿˜æ²¡åˆ°ï¼Œä¾¿ä¼šäº§ç”Ÿç©ºé—²æ—¶é—´ï¼Œè¿™é‚£äº›1msåæ²¡æœ‰æ‹¬å·çš„å°±æ˜¯CPUçš„ç©ºé—²æ®µã€‚åŒæ ·å¯ä»¥åƒRTOSé‚£æ ·æŠŠç©ºé—²æ—¶é—´ç»™ç©ºé—²ä»»åŠ¡ã€‚\næ³¨æ„å½“å‰å»¶æ—¶äº†å¤šå°‘æ—¶é—´æ˜¯ä¸€ä¸ªå‡½æ•°æ‰§è¡Œå®Œå°±ç›´æ¥å¼€å§‹è®¡ç®—çš„ï¼Œæˆ‘ä¹‹å‰å°±ç†è§£ä¸ºäº†ä¸€ä¸ªæ—¶é—´ç‰‡åªæœ‰ä¸€ä¸ªå‡½æ•°æ‰§è¡Œã€‚å®é™…ä¸Šä¸æ˜¯çš„ã€‚\n\n## è¿™æ ·çš„æ–¹æ³•æœ‰ä»€ä¹ˆä¸è¶³ï¼Ÿ\n\n1. é¦–å…ˆï¼Œåƒè¿™æ ·çš„ä¸ç‰ˆRTOSï¼Œå®æ—¶æ€§å¹¶æ²¡æœ‰çœŸæ­£çš„RTOSé«˜ï¼Œä¸æ˜¯è¯´æ‰§è¡Œå°±æ‰§è¡Œï¼Œä¼šæœ‰ä¸€äº›å»¶è¿Ÿã€‚\n2. **å¦‚æœæŸä¸ªä»»åŠ¡è¿è¡Œæ—¶é—´è¶…è¿‡ä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œå®ƒå¯èƒ½ä¼šä¸€ç›´å ç”¨CPUï¼Œå¯¼è‡´åé¢çš„ä»»åŠ¡æ— æ³•åŠæ—¶æ‰§è¡Œï¼Œä»è€Œå½±å“ç³»ç»Ÿçš„å“åº”æ—¶é—´ã€‚ç„¶åä¸€æ•´ä¸ªå°±ä¹±äº†ã€‚** ~~ä½†æ˜¯ä¸ªäººæ„Ÿè§‰å¦‚æœå®æ—¶æ€§è¦æ±‚ä¸é«˜ï¼Œä¹Ÿæ— ä¼¤å¤§é›…ğŸ¤”~~\n\næ¯”å¦‚æ—¶é—´ç‰‡ä¸º1msã€‚Aè¿è¡Œæ—¶é—´ä¸º2msï¼Œæ¯éš”4msæ‰§è¡Œä¸€æ¬¡ã€‚Bè¿è¡Œæ—¶é—´ä¸è®¡ï¼Œæ¯éš”3msè¿è¡Œä¸€æ¬¡ã€‚\n\nï¼ˆA1ms-1msï¼‰-1ms(B)-1ms(A1ms-1ms)(B)-1ms-1ms(A1ms([^1])-1ms)(B[^2])-----\n\n[^1]: è¿™é‡Œè¯¥æ‰§è¡ŒBäº†ï¼Œä½†ç”±äºAæŠ¢å CPUï¼Œæ— æ³•æ‰§è¡Œã€‚\n[^2]: è¿™æ¬¡Bå®é™…ä¸Šéš”äº†4msæ‰æ‰§è¡Œ\n\n## å‚è€ƒæ–‡ç« \n\n- [åµŒå…¥å¼è£¸æœºè®¾è®¡æ€æƒ³â€”â€”æ—¶é—´ç‰‡è½®è£¸æœºå¼€å‘æ¶æ„+çŠ¶æ€æœº+å®šæ—¶å™¨è°ƒåº¦æœºåˆ¶_åŸºäºçŠ¶æ€æœºåˆ¶ å®šæ—¶å™¨-CSDNåšå®¢](https://blog.csdn.net/qq_63922192/article/details/132746564)éµå¾ªÂ [CC 4.0 BY-SA](http://creativecommons.org/licenses/by-sa/4.0/)Â ç‰ˆæƒåè®®\n- [STM32è£¸æœº-æ—¶é—´ç‰‡ä»»åŠ¡è½®è¯¢_æ—¶é—´ç‰‡è½®è¯¢-CSDNåšå®¢](https://blog.csdn.net/weixin_44843021/article/details/117490107)éµå¾ªÂ [CC 4.0 BY-SA](http://creativecommons.org/licenses/by-sa/4.0/)Â ç‰ˆæƒåè®®\n","tags":["åµŒå…¥å¼","ç¨‹åºæ¶æ„","å•ç‰‡æœº","å¤šä»»åŠ¡"],"categories":["åµŒå…¥å¼","ç¨‹åºæ¶æ„"]},{"title":"å±äºè‡ªå·±çš„å¼•å¯¼é¡µ","url":"/posts/38456/","content":"## ç½‘ç«™æˆªå›¾\n\n![](Snipaste_2025-03-01_13-57-17.png)\n\n## æ„Ÿè°¢\n\nç½‘ç«™æ•´ä½“çš„ä»£ç æ¶æ„å’Œè®¾è®¡æ€è·¯éƒ½åŸºäº[Zyyo](https://zyyo.net/)çš„ä¸ªäººä¸»é¡µï¼Œè¿™æ˜¯GitHubé¡¹ç›®åœ°å€ï¼š[ZYYO666/homepage: æˆ‘çš„ä¸ªäººä¸»é¡µï¼Œhomepage,ä¸ªäººå¼•å¯¼é¡µ,ç®€çº¦ä¸»é¡µ,ä¸ªäººå¯¼èˆª](https://github.com/ZYYO666/homepage)\n\nå¾ˆå¤šcssåŠ¨ç”»æ¥è‡ªcodepené‡Œçš„å¤§ä½¬ï¼Œæˆ‘è‡ªå·±ç¨åŠ ä¿®æ”¹ï¼ä»¥ä¸‹ä¸ºéƒ¨åˆ†ç½‘é¡µä½¿ç”¨çš„ï¼š\n- [æ—¶é’Ÿ](https://codepen.io/graphilla/details/zEZKpN)\n- [åˆ—è¡¨æ”¶èµ·ä¸å±•å¼€](https://codepen.io/dannymoerkerke/details/wBwYzRe)\n- [hello worldåŠ¨ç”»](https://codepen.io/yoannhel/details/DMzjog)\n\n## åè®°\n\næ”¾å¯’å‡ï¼Œåœ¨å®¶å®åœ¨æ— èŠï¼Œçœ‹åˆ°å„è·¯å¤§ä½¬éƒ½æœ‰ä¸€ä¸ªå±äºè‡ªå·±blogï¼Œä¾¿æœ‰äº†å»ºä¸€ä¸ªè‡ªå·±çš„blogçš„æƒ³æ³•ã€‚äºæ˜¯äº†è§£åˆ°äº†hexo ï¼Œç„¶åå„ç§æŠ„èƒ½åŠ›ğŸ¤“ä¹Ÿç®—æ˜¯æ­å¥½äº†è‡ªå·±çš„ä¸€ä¸ªåšå®¢å¹¶æ‰˜ç®¡åœ¨äº†GitHubï¼Œç»“æœæ²¡æƒ³åˆ°è¿˜ä¸å¤Ÿè¿‡ç˜¾ï¼Œæƒ³çŸ¥é“å®Œå…¨ä»0å¼€å§‹æ­ä¸€ä¸ªé™æ€ç½‘é¡µæ˜¯ä»€ä¹ˆä½“éªŒï¼Œäºæ˜¯åˆåœ¨è¾¹æè¾¹å­¦çš„æƒ…å†µä¸‹æ•´äº†ä¸ªè¿™ä¸ªå¼•å¯¼é¡µï¼Œå­¦ä¹ åˆ°äº†htmlå’Œcssï¼ˆæ²¡æœ‰jsï¼Œjså…¨æ˜¯æŠ„çš„...ğŸ¥¹~~å¥½å§å…¶å®éƒ¨åˆ†æºç æ¶æ„ä¹Ÿæ˜¯æŠ„çš„ï¼Œæ¯•ç«Ÿä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹å¤§ä½¬å†™ä»£ç çš„ç»“æ„~~ï¼‰\n\n## TO DO\n\n- [ ]  é€‚é…é»‘å¤œæ¨¡å¼\n- [ ]  é€‚é…ç§»åŠ¨ç«¯","tags":["ç½‘é¡µ","web"],"categories":["å…¶ä»–"]},{"title":"CubeMXé…ç½®åŠŸèƒ½ç³»åˆ—ï¼šTimerï¼ˆä¸‹ï¼‰","url":"/posts/48581/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## 1. ç›®å½•\n- [1. ç›®å½•](#1-ç›®å½•)\n- [2. è¯´æ˜](#2-è¯´æ˜)\n- [3. TIM å„ç§æ¨¡å¼è¯¦è§£](#3-tim-å„ç§æ¨¡å¼è¯¦è§£)\n\t- [3.1. ä»æ¨¡å¼](#31-ä»æ¨¡å¼)\n\t\t- [3.1.1. ç®€ä»‹](#311-ç®€ä»‹)\n\t\t- [3.1.2. å¤ä½æ¨¡å¼ï¼ˆRMï¼‰](#312-å¤ä½æ¨¡å¼rm)\n\t\t- [3.1.3. é—¨æ§æ¨¡å¼ï¼ˆGMï¼‰](#313-é—¨æ§æ¨¡å¼gm)\n\t\t- [3.1.4. è§¦å‘æ¨¡å¼ï¼ˆTMï¼‰](#314-è§¦å‘æ¨¡å¼tm)\n\t\t- [3.1.5. å¤–éƒ¨æ—¶é’Ÿæ¨¡å¼1](#315-å¤–éƒ¨æ—¶é’Ÿæ¨¡å¼1)\n\t\t- [3.1.6. ä¸€ä¸ªç¤ºä¾‹](#316-ä¸€ä¸ªç¤ºä¾‹)\n\t\t- [3.1.7. å‚è€ƒ](#317-å‚è€ƒ)\n\t- [3.2. ç¼–ç å™¨æ¨¡å¼](#32-ç¼–ç å™¨æ¨¡å¼)\n\t- [3.3. è§¦å‘æº](#33-è§¦å‘æº)\n\t- [3.4. æ—¶é’Ÿæº](#34-æ—¶é’Ÿæº)\n\t- [3.5. ä¸»æ¨¡å¼](#35-ä¸»æ¨¡å¼)\n\t\t- [3.5.1. æ¯”è¾ƒä¸æ•è·](#351-æ¯”è¾ƒä¸æ•è·)\n\t- [3.6. ä¸€äº›ç–‘æƒ‘çš„åœ°æ–¹](#36-ä¸€äº›ç–‘æƒ‘çš„åœ°æ–¹)\n\t\t- [3.6.1. Qï¼š`output compare no output`æ˜¯ä»€ä¹ˆæ¨¡å¼ï¼Ÿå¥½çŸ›ç›¾çš„åå­—ã€‚ã€‚ã€‚](#361-qoutput-compare-no-outputæ˜¯ä»€ä¹ˆæ¨¡å¼å¥½çŸ›ç›¾çš„åå­—)\n\t\t- [3.6.2. Qï¼šè¾“å‡ºæ¯”è¾ƒå’ŒPWMç”Ÿæˆæ¨¡å¼æœ‰ä½•åŒºåˆ«ä¸è”ç³»ï¼Ÿ](#362-qè¾“å‡ºæ¯”è¾ƒå’Œpwmç”Ÿæˆæ¨¡å¼æœ‰ä½•åŒºåˆ«ä¸è”ç³»)\n\t\t- [3.6.3. Qï¼šä½•ä¸ºå¼ºåˆ¶è¾“å‡ºï¼Ÿæœ‰å•¥ç”¨ï¼Ÿ](#363-qä½•ä¸ºå¼ºåˆ¶è¾“å‡ºæœ‰å•¥ç”¨)\n\t\t\t- [3.6.3.1. å¼ºåˆ¶è¾“å‡ºæ¨¡å¼çš„å·¥ä½œåŸç†ï¼š](#3631-å¼ºåˆ¶è¾“å‡ºæ¨¡å¼çš„å·¥ä½œåŸç†)\n\t\t\t- [3.6.3.2. ä¸»è¦åŠŸèƒ½ï¼š](#3632-ä¸»è¦åŠŸèƒ½)\n\t\t\t- [3.6.3.3. å·¥ä½œæ¨¡å¼ï¼š](#3633-å·¥ä½œæ¨¡å¼)\n\t\t\t- [3.6.3.4. ä¾‹å­ï¼š](#3634-ä¾‹å­)\n\t\t\t- [3.6.3.5. æ€»ç»“ï¼š](#3635-æ€»ç»“)\n\t\t- [3.6.4. Qï¼šè¾“å…¥æ•è·çš„é—´æ¥æ¨¡å¼ï¼Ÿ](#364-qè¾“å…¥æ•è·çš„é—´æ¥æ¨¡å¼)\n\t\t\t- [3.6.4.1. ç‰¹ç‚¹ï¼š](#3641-ç‰¹ç‚¹)\n\t\t\t- [3.6.4.2. ä»¥ä¸‹æ˜¯ç›´æ¥ä¸éç›´æ¥æ¨¡å¼çš„æ¯”è¾ƒ](#3642-ä»¥ä¸‹æ˜¯ç›´æ¥ä¸éç›´æ¥æ¨¡å¼çš„æ¯”è¾ƒ)\n\t\t- [3.6.5. å‚è€ƒ](#365-å‚è€ƒ)\n\n\n## 2. è¯´æ˜\n\næœ¬æ–‡ä»¥STM32G4ç³»åˆ—ä¸ºä¾‹ã€‚ä¾›è‡ªå·±å­¦ä¹ ä¸è®°å½•ä¸”åªåšç®€å•ä»‹ç»ã€‚æœ‰ä¸€å®šåŸºç¡€çš„æœ‹å‹å¯å‚è€ƒã€‚\n\n--- \n\n## 3. TIM å„ç§æ¨¡å¼è¯¦è§£\n\nå¦‚ä¸‹ä¸ºä¸€ä¸ªé«˜çº§å®šæ—¶å™¨çš„é…ç½®é¡µé¢\n![](CubeMXé…ç½®åŠŸèƒ½ç³»åˆ—ï¼šTimerï¼ˆä¸Šï¼‰/Snipaste_2025-02-22_14-10-44.png)\n\n### 3.1. ä»æ¨¡å¼\n\nå¯é…ç½®åŠŸèƒ½\n![](CubeMXé…ç½®åŠŸèƒ½ç³»åˆ—ï¼šTimerï¼ˆä¸Šï¼‰/Snipaste_2025-02-22_14-14-22.png)\n\n#### 3.1.1. ç®€ä»‹\n\nå®šæ—¶å™¨çš„ä»æ¨¡å¼æ§åˆ¶å™¨å¯ä»¥å¯¹è®¡æ•°å™¨å®ç°å“ªäº›æ§åˆ¶æˆ–å½±å“å‘¢ï¼Ÿä»æ¨¡å¼æ§åˆ¶å™¨æ£€æµ‹åˆ°è§¦å‘è¾“å…¥ä¿¡å·æ—¶ï¼Œå¯ä»¥å¯¹å®šæ—¶å™¨è¿›è¡Œå¦‚ä¸‹æ“ä½œè€Œæ§åˆ¶æˆ–å½±å“è®¡æ•°å™¨çš„å·¥ä½œï¼š\n\n1. å¯¹è®¡æ•°å™¨å¤ä½\n2. å¯åŠ¨æˆ–åœæ­¢è®¡æ•°å™¨çš„è®¡æ•°åŠ¨ä½œ\n3. ä½¿èƒ½è®¡æ•°å™¨æ¨¡å—çš„å·¥ä½œ\n4. é€šè¿‡è§¦å‘ä¿¡å·ä¸ºè®¡æ•°å™¨æä¾›æ—¶é’Ÿæº\n\n#### 3.1.2. å¤ä½æ¨¡å¼ï¼ˆRMï¼‰\n\nä¸»å®šæ—¶å™¨å‡ºç°ä¿¡å·åï¼šä»å®šæ—¶å™¨è®¡æ•°å™¨å¤ä½å¹¶äº§ç”Ÿä¸€ä¸ªä¸­æ–­ã€‚\n\nä¸å¦¨ä»¥è®¡æ•°å™¨å‘ä¸Šè®¡æ•°ä¸ºä¾‹ï¼Œå°†å®ƒé…ç½®åœ¨å¤ä½ä»æ¨¡å¼ã€‚æ¯”æ–¹è¯´å½“è®¡æ•°å™¨è®¡æ•°åˆ°æŸä¸ªæ•°æ®çš„æ—¶å€™ï¼Œæ¥äº†ä¸ªè§¦å‘ä¿¡å·ï¼Œè®¡æ•°å™¨ä¸å†ç»§ç»­å¾€ä¸Šè®¡æ•°ï¼Œè€Œæ˜¯é‡æ–°å½’0åå¼€å§‹è®¡æ•°ã€‚å½“ç„¶ï¼Œè®¡æ•°å™¨çš„å®é™…å¤ä½æ“ä½œä¸è§¦å‘æ²¿ä¹‹é—´å¾€å¾€ä¼šæœ‰ä¸ªå°çš„å»¶æ—¶ï¼Œè¿™æ˜¯ç”±äºè§¦å‘ä¿¡å·ä½œä¸ºæœ‰æ•ˆè§¦å‘è„‰å†²çš„è¯ï¼Œè¿˜éœ€è¦ç»è¿‡å®šæ—¶å™¨å†…çš„åŒæ­¥ç”µè·¯ç¡®è®¤ã€‚\n\nå…³äºå¤„äºå¤ä½æ¨¡å¼ä¸‹çš„å®šæ—¶å™¨ï¼Œæœ‰ä¸¤ç‚¹æé†’ï¼š\n\n1. åªè¦æœ‰å¤ä½è§¦å‘è„‰å†²å‡ºç°ï¼Œè®¡æ•°å™¨å°±ä¼šè¢«å¤ä½é‡ç½®ã€‚å¤ä½æ¬¡æ•°å–å†³äºè§¦å‘è„‰å†²æ¬¡æ•°ã€‚\n2. å·¥ä½œåœ¨å¤ä½æ¨¡å¼ä¸‹çš„å®šæ—¶å™¨ï¼Œå…¶ä½¿èƒ½éœ€é è½¯ä»¶ä»£ç å®ç°ï¼Œå³ä½¿èƒ½å®šæ—¶å™¨çš„CEN@TIMx_CR1ä½ã€‚\n\n#### 3.1.3. é—¨æ§æ¨¡å¼ï¼ˆGMï¼‰\n\nä¸»å®šæ—¶å™¨å‡ºç°ä¿¡å·åï¼šä»å®šæ—¶å™¨è®¡æ•°å™¨å¼€å§‹å·¥ä½œ\n\nä¸»å®šæ—¶å™¨ä¿¡å·ç»“æŸåï¼šä»å®šæ—¶å™¨è®¡æ•°å™¨åœæ­¢å·¥ä½œå¹¶äº§ç”Ÿä¸­æ–­\n\n#### 3.1.4. è§¦å‘æ¨¡å¼ï¼ˆTMï¼‰\n\nä¸»å®šæ—¶å™¨å‡ºç°ä¿¡å·åï¼šä»å®šæ—¶å™¨è®¡æ•°å™¨å¼€å§‹å·¥ä½œï¼Œå¹¶ä¸”ä¸ä¼šåœæ­¢ã€‚\n\nè§¦å‘æ¨¡å¼ä¸»å®šæ—¶å™¨åªæ˜¯æä¾›äº†ä¸€ä¸ªå¯åŠ¨ä»å®šæ—¶å™¨å¼€å§‹æ—¶é—´çš„æ§åˆ¶ï¼Œå¹¶ä¸ä¼šæœ‰å…¶ä»–æ•ˆæœï¼Œè§¦å‘ä»æ¨¡å¼ä¸‹ï¼Œè§¦å‘ä¿¡å·å…·æœ‰ç›¸å½“äºè½¯ä»¶ä½¿èƒ½è®¡æ•°å™¨çš„ä½œç”¨ï¼Œå³ç½®ä½CEN@TIMx_CR1ï¼Œè¿™ä¹Ÿæ˜¯å®ƒæœ€å¤§æœ€æ˜æ˜¾çš„ç‰¹å¾ã€‚\n\n#### 3.1.5. å¤–éƒ¨æ—¶é’Ÿæ¨¡å¼1\n\nå¤–éƒ¨æ—¶é’Ÿæ¨¡å¼1ä»æ¨¡å¼æ¯”è¾ƒç‰¹åˆ«ï¼Œå½“è®¡æ•°å™¨çš„æ—¶é’Ÿæºæ¥è‡ªè§¦å‘ä¿¡å·æ—¶ï¼Œæ­¤æ—¶å®šæ—¶å™¨å°±å·¥ä½œåœ¨å¤–éƒ¨æ—¶é’Ÿ1ä»æ¨¡å¼ï¼Œæ­¤æ—¶è§¦å‘ä¿¡å·æ‰®æ¼”ç€åŒè§’è‰²ï¼Œå³**è§¦å‘ä¿¡å·**ä¸**æ—¶é’Ÿä¿¡å·**ã€‚\n\næ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥è‡ªETRè„šçš„æ»¤æ³¢ä¿¡å·ETRFä½œä¸ºè§¦å‘ä¿¡å·å¹¶æ‹…å½“è®¡æ•°å™¨çš„æ—¶é’Ÿæºã€‚\n\n#### 3.1.6. ä¸€ä¸ªç¤ºä¾‹\n\nQï¼šå¼€å¯ä¸¤ä¸ªå®šæ—¶å™¨ï¼Œå®šæ—¶å™¨2ä¸å®šæ—¶å™¨3ï¼Œå‡ä½œpwmè¾“å‡ºï¼Œå®šæ—¶å™¨3çš„pwmè¾“å‡ºè·Ÿéšå®šæ—¶å™¨2çš„pwmè¾“å‡ºã€‚\nå¦‚ä½•åšæ‰èƒ½åˆå‡†åˆç¨³å®šè¿˜ä¸å ç”¨cpuèµ„æºï¼Ÿ\n\nå¤§è‡´æ€è·¯ï¼šå®šæ—¶å™¨2çš„ch2è¾“å‡ºï¼Œå¹¶å°†ch2çš„OC2REFä½œä¸ºä»å®šæ—¶å™¨3çš„TRGOï¼Œå¹¶é€šè¿‡ä¸»ä»å¯¹åº”è¡¨ï¼Œæ‰¾åˆ°ç›¸åº”çš„ITRxï¼Œå½“å‡ºç°ä¸Šå‡æ²¿æˆ–ä¸‹é™æ²¿æ—¶ï¼Œä¼šè§¦å‘ä»å®šæ—¶å™¨çš„å¼€å¯ã€‚åº”å°†å®šæ—¶å™¨3é…ç½®ä¸ºè§¦å‘æ¨¡å¼ï¼ˆTrigger Modeï¼‰\n\n#### 3.1.7. å‚è€ƒ\n\n- ğŸ‘ğŸ‘ğŸ‘[ã€è¯è¯´å®šæ—¶å™¨ç³»åˆ—ã€‘ä¹‹ä¸‰ï¼šSTM32å®šæ—¶å™¨çš„ä¿¡å·è§¦å‘ä¸ä¸»ä»æ¨¡å¼-ç”µå­å·¥ç¨‹ä¸–ç•Œ](https://news.eeworld.com.cn/mcu/ic634774.html)\n- [stm32å®šæ—¶å™¨ä»æ¨¡å¼è§£æ_stm32å®šæ—¶å™¨ä¸»ä»æ¨¡å¼-CSDNåšå®¢](https://blog.csdn.net/weixin_44748127/article/details/123726458)\n\n### 3.2. ç¼–ç å™¨æ¨¡å¼\n\nå¯¹äºç¼–ç å™¨æ¨¡å¼ï¼Œå®ƒæ˜¯é’ˆå¯¹ç¼–ç å™¨åº”ç”¨çš„ä¸€ä¸ªç‰¹å®šä»æ¨¡å¼ï¼Œåº”ç”¨æ—¶æ³¨æ„ä½¿ç”¨å®šæ—¶å™¨çš„é€šé“1ã€é€šé“2å¼•è¿›ç¼–ç å™¨è„‰å†²ï¼Œè¿™é‡Œä¸èµ˜è¿°ã€‚\n\n\n### 3.3. è§¦å‘æº\n\n![](Snipaste_2025-02-22_14-34-20.png)\n\nç»“åˆåŸç†å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å®šæ—¶å™¨å¯ç”±è§¦å‘æºè§¦å‘å¯åŠ¨ã€‚\n\n\n### 3.4. æ—¶é’Ÿæº\n\nåˆ†ä¸ºå†…éƒ¨æ—¶é’Ÿå’Œå¤–éƒ¨è§¦å‘ï¼ˆå¤–ç•Œå…¶ä»–ä¿¡å·æºï¼‰ï¼Œä¸å†èµ˜è¯‰ã€‚\n\n\n### 3.5. ä¸»æ¨¡å¼\n\nè¿™æ˜¯é€šé“1çš„å¯é…ç½®åŠŸèƒ½ï¼š\n![](Snipaste_2025-02-22_15-02-04.png)\n![](Snipaste_2025-02-22_15-02-14.png)\n\nç»†è®²ä¸€ä¸‹\n#### 3.5.1. æ¯”è¾ƒä¸æ•è·\n\næ•è·\n\nä»€ä¹ˆæ˜¯æ•è·ï¼Ÿ\n\næ‰€è°“æ•è·å°±æ˜¯é€šè¿‡æ£€æµ‹æ•è·é€šé“ä¸Šçš„è¾¹æ²¿ä¿¡å·ã€‚åœ¨è¾¹æ²¿ä¿¡å·å‘ç”Ÿè·³å˜ï¼ˆæ¯”å¦‚ä¸Šå‡æ²¿/ä¸‹é™æ²¿ï¼‰çš„æ—¶å€™ï¼Œå°†å½“å‰å®šæ—¶å™¨çš„å€¼(TIMx_CNT)å­˜æ”¾åˆ°å¯¹åº”çš„é€šé“çš„æ•è·/æ¯”è¾ƒå¯„å­˜å™¨(TIMx_CCR)é‡Œé¢ï¼Œå®Œæˆä¸€æ¬¡æ•è·ã€‚\n\nSTM32æ”¯æŒä¸€ä¸‹æ•è·æ¨¡å¼ï¼š\n\n1. è¾“å…¥æ•è·æ¨¡å¼\n2. PWMè¾“å…¥æ¨¡å¼\n\nè¾“å…¥æ•è·æ¨¡å¼å¯ä»¥ç”¨æ¥æµ‹é‡è„‰å†²å®½åº¦æˆ–è€…æµ‹é‡é¢‘ç‡ã€‚ä¸‹å›¾æ˜¯è¾“å…¥æ•è·æµ‹é‡é«˜ç”µå¹³è„‰å®½çš„åŸç†ï¼Œå‡å®šå®šæ—¶å™¨å·¥ä½œåœ¨å‘ä¸Šè®¡æ•°æ¨¡å¼ï¼Œå›¾ä¸­ t1~t2 æ—¶é—´ï¼Œå°±æ˜¯éœ€è¦æµ‹é‡çš„é«˜ç”µå¹³æ—¶é—´ã€‚\n![](20220309022442146.png)\næµ‹é‡æ–¹æ³•å¦‚ä¸‹ï¼šé¦–å…ˆè®¾ç½®å®šæ—¶å™¨é€šé“xä¸ºä¸Šå‡æ²¿æ•è·ï¼Œè¿™æ ·ï¼Œt1 æ—¶åˆ»ï¼Œå°±ä¼šæ•è·åˆ°å½“å‰çš„ CNT å€¼ï¼Œç„¶åç«‹å³æ¸…é›¶ CNTï¼Œå¹¶è®¾ç½®é€šé“xä¸‹é™æ²¿æ•è·ï¼Œè¿™æ ·åˆ° t2 æ—¶åˆ»ï¼Œåˆä¼šå‘ç”Ÿæ•è·äº‹ä»¶ï¼Œå¾—åˆ°æ­¤æ—¶çš„ CNT å€¼ï¼Œè®°ä¸ºCCRx2ã€‚è¿™æ ·ï¼Œæ ¹æ®å®šæ—¶å™¨çš„è®¡æ•°é¢‘ç‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç®—å‡º t1~t2 çš„æ—¶é—´ï¼Œä»è€Œå¾—åˆ°é«˜ç”µå¹³è„‰å®½ã€‚\n\næ¯”è¾ƒ\n\nä»€ä¹ˆæ˜¯æ¯”è¾ƒï¼Ÿ\n\næ‰€è°“æ¯”è¾ƒå°±æ˜¯è®¡æ•°å™¨çš„å€¼å’Œä¸è£…è½½çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œ**å’Œå¤–éƒ¨çš„ä¿¡å·æ²¡å…³ç³»**ã€‚\n\nSTM32æ”¯æŒä¸€ä¸‹æ¯”è¾ƒæ¨¡å¼ï¼š\n\n1. å¼ºåˆ¶è¾“å‡ºæ¨¡å¼\n2. è¾“å‡ºæ¯”è¾ƒæ¨¡å¼\n3. **PWMæ¨¡å¼**\n4. å•è„‰å†²æ¨¡å¼\n\n### 3.6. ä¸€äº›ç–‘æƒ‘çš„åœ°æ–¹\n\n#### 3.6.1. Qï¼š`output compare no output`æ˜¯ä»€ä¹ˆæ¨¡å¼ï¼Ÿå¥½çŸ›ç›¾çš„åå­—ã€‚ã€‚ã€‚\n\nAï¼š`Output Compare No Output`æ„å‘³ç€è¯¥å®šæ—¶å™¨çš„è¾“å‡ºæ¯”è¾ƒï¼ˆOutput Compareï¼‰åŠŸèƒ½å·²ç»å¯ç”¨ï¼Œä½†å®ƒä¸ä¼šå®é™…è¾“å‡ºåˆ°å¼•è„šä¸Šã€‚å…·ä½“æ¥è¯´ï¼Œå®šæ—¶å™¨çš„è¾“å‡ºæ¯”è¾ƒåŠŸèƒ½é€šå¸¸æ˜¯ç”¨æ¥ç”Ÿæˆå®šæ—¶ä¿¡å·ï¼ˆæ¯”å¦‚ PWM æˆ–æ•è·ä¿¡å·ï¼‰ã€‚å¦‚æœä½ é€‰æ‹©`Output Compare No Output`ï¼Œè¿™è¡¨ç¤ºï¼š\n\n1. **è¾“å‡ºæ¯”è¾ƒåŠŸèƒ½å¯ç”¨**ï¼šå®šæ—¶å™¨ä»ç„¶ä¼šæ ¹æ®è®¾ç½®çš„æ¯”è¾ƒå€¼ï¼ˆæ¯”å¦‚å®šæ—¶å™¨è®¡æ•°å™¨å’Œæ¯”è¾ƒå¯„å­˜å™¨çš„åŒ¹é…ï¼‰äº§ç”Ÿä¸€ä¸ªäº‹ä»¶ã€‚\n2. **ä¸è¾“å‡ºåˆ°å¼•è„š**ï¼šè™½ç„¶æ¯”è¾ƒåŠŸèƒ½å¯ä»¥è§¦å‘ä¸­æ–­æˆ–è®¾ç½®çŠ¶æ€ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰é…ç½®å®šæ—¶å™¨çš„è¾“å‡ºå¼•è„šï¼ˆæ¯”å¦‚ä¸€ä¸ª PWM ä¿¡å·ï¼‰å»å“åº”è¿™äº›äº‹ä»¶ã€‚è¿™ç§é…ç½®é€‚ç”¨äºåªéœ€è¦å®šæ—¶å™¨åŠŸèƒ½ï¼ˆæ¯”å¦‚è§¦å‘ä¸­æ–­ï¼‰è€Œä¸éœ€è¦å…·ä½“çš„ç¡¬ä»¶è¾“å‡ºã€‚\n\n`Output Compare No Output`å°±æ˜¯é…ç½®å®šæ—¶å™¨çš„è¾“å‡ºæ¯”è¾ƒåŠŸèƒ½ï¼Œä¸å»ç”Ÿæˆå®é™…çš„å¼•è„šä¿¡å·ï¼Œå¯èƒ½åªæ˜¯ç”¨æ¥**è§¦å‘äº‹ä»¶**æˆ–**æ§åˆ¶ä¸­æ–­**ã€‚\n\n#### 3.6.2. Qï¼šè¾“å‡ºæ¯”è¾ƒå’ŒPWMç”Ÿæˆæ¨¡å¼æœ‰ä½•åŒºåˆ«ä¸è”ç³»ï¼Ÿ\n\nAï¼šè¾“å‡ºæ¯”è¾ƒï¼ˆOutput Compareï¼‰å’Œ PWM ç”Ÿæˆæ¨¡å¼ï¼ˆPWM Generation Modeï¼‰è™½ç„¶éƒ½ä¾èµ–äºå®šæ—¶å™¨çš„è¾“å‡ºæ¯”è¾ƒåŠŸèƒ½ï¼Œä½†å®ƒä»¬çš„åº”ç”¨åœºæ™¯å’Œå·¥ä½œæ–¹å¼æœ‰æ‰€ä¸åŒã€‚ä¸‹é¢æ˜¯å®ƒä»¬ä¹‹é—´çš„ä¸»è¦åŒºåˆ«ä¸è”ç³»ï¼š\n\n| **æ¨¡å¼**    | **è¾“å‡ºæ¯”è¾ƒï¼ˆOutput Compareï¼‰**     | **PWM ç”Ÿæˆæ¨¡å¼ï¼ˆPWM Generation Modeï¼‰**                 |\n| --------- | ---------------------------- | ------------------------------------------------- |\n| **åŸºæœ¬æ¦‚å¿µ**  | è®¡æ•°å™¨çš„å€¼ä¸é¢„è®¾æ¯”è¾ƒå€¼æ¯”è¾ƒï¼ŒåŒ¹é…æ—¶äº§ç”Ÿäº‹ä»¶ã€‚       | åŸºäºè¾“å‡ºæ¯”è¾ƒåŠŸèƒ½ï¼Œå‘¨æœŸæ€§åœ°ç”Ÿæˆè„‰å®½è°ƒåˆ¶ï¼ˆPWMï¼‰ä¿¡å·ã€‚è®¡æ•°å™¨ä¸æ¯”è¾ƒå€¼çš„å…³ç³»å†³å®šå¼•è„šçŠ¶æ€ï¼ˆé«˜æˆ–ä½ï¼‰ã€‚ |\n| **ä½œç”¨**    | è®¾ç½®å¼•è„šçŠ¶æ€æˆ–è§¦å‘ä¸­æ–­                  | æ ¹æ®è®¡æ•°å™¨å€¼ä¸æ¯”è¾ƒå€¼çš„å…³ç³»å‘¨æœŸæ€§æ”¹å˜å¼•è„šçŠ¶æ€ã€‚                           |\n| **ç”¨é€”**    | è§¦å‘å®šæ—¶å™¨äº‹ä»¶ï¼Œæ§åˆ¶å¤–éƒ¨ç¡¬ä»¶ä¿¡å·ï¼ˆå¦‚è®¾ç½®å¼•è„šä¸ºé«˜æˆ–ä½ï¼‰ã€‚ | æ§åˆ¶ç”µæœºã€LEDäº®åº¦è°ƒèŠ‚ã€ç”µæºç®¡ç†ç­‰åº”ç”¨ï¼Œéœ€è¦è°ƒèŠ‚å ç©ºæ¯”ã€‚                     |\n| **å…¸å‹åº”ç”¨**  | å®šæ—¶è„‰å†²ã€äº‹ä»¶è§¦å‘ã€ç²¾ç¡®çš„å®šæ—¶æ§åˆ¶            | ç”µæœºæ§åˆ¶ã€LEDäº®åº¦è°ƒèŠ‚ã€ä¿¡å·è°ƒåˆ¶                                 |\n| **å‘¨æœŸæ€§è¾“å‡º** | å¦ï¼Œè¾“å‡ºæ¯”è¾ƒé€šå¸¸äº§ç”Ÿå•æ¬¡ä¿¡å·æˆ–äº‹ä»¶ï¼Œä¸æ˜¯å‘¨æœŸæ€§çš„ã€‚    | æ˜¯ï¼Œç”Ÿæˆå‘¨æœŸæ€§çš„æ³¢å½¢ã€‚                                       |\n| **å€¾å‘ç›®æ ‡**  | ç”Ÿæˆäº‹ä»¶ï¼ˆå¦‚ä¸­æ–­ï¼‰ã€‚                   | ç”Ÿæˆå‘¨æœŸæ€§çš„æ³¢å½¢ä¿¡å·ã€‚                                       |\n\nç®€è€Œè¨€ä¹‹ï¼Œè¾“å‡ºæ¯”è¾ƒæ›´æ³¨é‡äº‹ä»¶çš„è§¦å‘ï¼Œè€ŒPWMç”Ÿæˆæ¨¡å¼åˆ™ä¸“æ³¨äºäº§ç”ŸæŒç»­çš„å‘¨æœŸæ€§æ³¢å½¢ã€‚\n\n#### 3.6.3. Qï¼šä½•ä¸ºå¼ºåˆ¶è¾“å‡ºï¼Ÿæœ‰å•¥ç”¨ï¼Ÿ\n\nAï¼šå¼ºåˆ¶è¾“å‡ºæ¨¡å¼ï¼ˆForced Output Modeï¼‰æ˜¯å®šæ—¶å™¨çš„ä¸€ç§ç‰¹æ®Šè¾“å‡ºæ§åˆ¶æ¨¡å¼ï¼Œä¸»è¦ç”¨äºåœ¨å®šæ—¶å™¨çš„æŸäº›æ¡ä»¶ä¸‹å¼ºåˆ¶æ”¹å˜è¾“å‡ºå¼•è„šçš„çŠ¶æ€ï¼ˆä¾‹å¦‚è®¾ç½®ä¸ºé«˜æˆ–ä½ï¼‰ã€‚è¿™ç§æ¨¡å¼å¯ä»¥åœ¨å®šæ—¶å™¨äº§ç”Ÿçš„è¾“å‡ºä¿¡å·ä¹‹å¤–ï¼Œå¼ºåˆ¶æ§åˆ¶å¼•è„šçš„çŠ¶æ€ã€‚\n\n##### 3.6.3.1. å¼ºåˆ¶è¾“å‡ºæ¨¡å¼çš„å·¥ä½œåŸç†ï¼š\n\nåœ¨å¼ºåˆ¶è¾“å‡ºæ¨¡å¼ä¸‹ï¼Œå®šæ—¶å™¨çš„è¾“å‡ºä¿¡å·ä¸å†å®Œå…¨ä¾èµ–äºå®šæ—¶å™¨è®¡æ•°å™¨å’Œæ¯”è¾ƒå¯„å­˜å™¨çš„å¸¸è§„æ“ä½œï¼ˆæ¯”å¦‚åœ¨ PWM æˆ–è¾“å‡ºæ¯”è¾ƒæ¨¡å¼ä¸‹çš„ä¿¡å·æ³¢å½¢ï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡æŸäº›ç‰¹å®šçš„æ¡ä»¶æˆ–å‘½ä»¤ç›´æ¥æ§åˆ¶è¾“å‡ºå¼•è„šçš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œå®šæ—¶å™¨å¯ä»¥åœ¨ç‰¹å®šæ—¶åˆ»å°†å¼•è„šå¼ºåˆ¶è®¾ç½®ä¸ºé«˜æˆ–ä½çŠ¶æ€ã€‚\n\t\n##### 3.6.3.2. ä¸»è¦åŠŸèƒ½ï¼š\n\n- **å¼ºåˆ¶è®¾ç½®è¾“å‡ºå¼•è„šçš„çŠ¶æ€**ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¼ºåˆ¶è¾“å‡ºæ¨¡å¼å¯ä»¥è¢«ç”¨æ¥ç›´æ¥æ§åˆ¶è¾“å‡ºå¼•è„šçš„çŠ¶æ€ï¼Œè€Œæ— éœ€ä¾èµ–äºå®šæ—¶å™¨çš„æ­£å¸¸è®¡æ•°å’Œæ¯”è¾ƒè¿‡ç¨‹ã€‚\n- **å®‰å…¨æ§åˆ¶å’Œå¤ä½åŠŸèƒ½**ï¼šå¼ºåˆ¶è¾“å‡ºæ¨¡å¼æœ‰æ—¶ç”¨äºä¸€äº›å®‰å…¨æˆ–å¤ä½æ“ä½œï¼Œæ¯”å¦‚åœ¨ç¡¬ä»¶æ•…éšœæ—¶é€šè¿‡å¼ºåˆ¶è¾“å‡ºä¿¡å·æ¥é‡ç½®ç³»ç»Ÿï¼Œæˆ–åœ¨ç‰¹å®šæ¡ä»¶ä¸‹ç¡®ä¿å¼•è„šå¤„äºæŸä¸€çŠ¶æ€ã€‚\n- **ç‰¹å®šåœºæ™¯ä¸‹çš„ä¿¡å·ç”Ÿæˆ**ï¼šæœ‰æ—¶ï¼Œå¼ºåˆ¶è¾“å‡ºæ¨¡å¼è¢«ç”¨æ¥ç”ŸæˆçŸ­æš‚çš„è„‰å†²æˆ–ç‰¹æ®Šçš„çŠ¶æ€ï¼Œé€šå¸¸ç”¨äºå¤–éƒ¨ç¡¬ä»¶çš„æ§åˆ¶ã€‚\n\n##### 3.6.3.3. å·¥ä½œæ¨¡å¼ï¼š\n\n- **å®šæ—¶å™¨å¼ºåˆ¶è¾“å‡ºé«˜æˆ–ä½**ï¼šå½“å®šæ—¶å™¨å¤„äºå¼ºåˆ¶è¾“å‡ºæ¨¡å¼æ—¶ï¼Œå¯ä»¥é€šè¿‡å¼ºåˆ¶å‘½ä»¤ç›´æ¥æ§åˆ¶è¾“å‡ºå¼•è„šçŠ¶æ€ï¼Œä¾‹å¦‚å¼ºåˆ¶è¾“å‡ºå¼•è„šä¿æŒé«˜ç”µå¹³æˆ–ä½ç”µå¹³ã€‚\n- **å¸¸ç”¨çš„åº”ç”¨**ï¼šè¿™ç§æ¨¡å¼å¸¸ç”¨äºä¸€äº›ç‰¹æ®Šçš„ä¿¡å·è¦æ±‚ï¼Œå¦‚åœ¨ç³»ç»Ÿå‘ç”Ÿå¼‚å¸¸æ—¶é€šè¿‡å®šæ—¶å™¨å¼•è„šæ¥è¾“å‡ºä¸€ä¸ªç‰¹å®šä¿¡å·ï¼Œä»¥è§¦å‘å¤–éƒ¨ç¡¬ä»¶æˆ–è¿›è¡Œæ•…éšœè¯Šæ–­ã€‚\n\n##### 3.6.3.4. ä¾‹å­ï¼š\n\nåœ¨æŸäº›å¾®æ§åˆ¶å™¨ä¸­ï¼Œå®šæ—¶å™¨çš„å¼ºåˆ¶è¾“å‡ºæ¨¡å¼å¯ä»¥ä¸â€œè¾“å‡ºæ¯”è¾ƒæ¨¡å¼â€ç»“åˆä½¿ç”¨ï¼Œå½“å®šæ—¶å™¨è¿›å…¥å¼ºåˆ¶è¾“å‡ºæ¨¡å¼æ—¶ï¼Œå®ƒä¼šç›´æ¥è®¾ç½®è¾“å‡ºå¼•è„šä¸ºé«˜æˆ–ä½ï¼Œè€Œä¸å†å—å®šæ—¶å™¨çš„å¸¸è§„è®¡æ•°å’Œæ¯”è¾ƒå€¼çš„æ§åˆ¶ã€‚å¯ä»¥é€šè¿‡ç‰¹å®šçš„è§¦å‘æ¡ä»¶æˆ–å¤–éƒ¨ä¿¡å·æ¥æ¿€æ´»å¼ºåˆ¶è¾“å‡ºæ¨¡å¼ï¼Œè¿™é€šå¸¸ç”¨äºæ§åˆ¶éœ€è¦åœ¨ç³»ç»Ÿä¸­ç«‹å³åšå‡ºå“åº”çš„åº”ç”¨åœºæ™¯ã€‚**ï¼ˆé€šè¿‡è½¯ä»¶åˆ‡æ¢ï¼‰**\n\n##### 3.6.3.5. æ€»ç»“ï¼š\n\nå¼ºåˆ¶è¾“å‡ºæ¨¡å¼å°±æ˜¯åœ¨ç‰¹å®šæƒ…å†µä¸‹ï¼Œå¼ºåˆ¶å®šæ—¶å™¨çš„è¾“å‡ºå¼•è„šä¸ºé«˜æˆ–ä½ç”µå¹³ï¼Œå¿½ç•¥å®šæ—¶å™¨çš„å¸¸è§„è¾“å‡ºä¿¡å·ï¼Œå¸¸ç”¨äºç‰¹æ®Šçš„åº”ç”¨éœ€æ±‚ï¼Œå¦‚ç³»ç»Ÿæ•…éšœå¤„ç†ã€ç¡¬ä»¶å¤ä½ã€ç‰¹æ®Šä¿¡å·ç”Ÿæˆç­‰ã€‚\n\n#### 3.6.4. Qï¼šè¾“å…¥æ•è·çš„é—´æ¥æ¨¡å¼ï¼Ÿ\n\nAï¼šé—´æ¥æ¨¡å¼è¾ƒä¸ºå¤æ‚ï¼Œæ•è·äº‹ä»¶å¹¶ä¸ç›´æ¥ä¸è®¡æ•°å™¨æŒ‚é’©ï¼Œè€Œæ˜¯é€šè¿‡æŸäº›æ¡ä»¶æˆ–å¤–éƒ¨äº‹ä»¶æ¥è§¦ï¼Œå…·ä½“æ¥è¯´ï¼Œè¿™ç§æ¨¡å¼å¯èƒ½æ¶‰åŠå®šæ—¶å™¨çš„æŸäº›é™„åŠ åŠŸèƒ½ï¼ˆä¾‹å¦‚å¤–éƒ¨è§¦å‘äº‹ä»¶æˆ–ç‰¹å®šçš„è¾“å…¥æ»¤æ³¢å™¨ï¼‰ï¼Œè¿™äº›åŠŸèƒ½å¯èƒ½ä¼šå»¶è¿Ÿæ•è·äº‹ä»¶çš„å®é™…è®°å½•ã€‚\n\n##### 3.6.4.1. ç‰¹ç‚¹ï¼š\n\n- **é—´æ¥æ•è·**ï¼šè¾“å…¥ä¿¡å·çš„å˜åŒ–å¹¶ä¸æ˜¯ç›´æ¥å½±å“è®¡æ•°å™¨ï¼Œè€Œæ˜¯éœ€è¦æŸäº›é™„åŠ çš„æ¡ä»¶æˆ–è§¦å‘äº‹ä»¶æ¥ä¿å­˜æ•è·å€¼ã€‚\n- **è¾ƒå¤æ‚çš„æ§åˆ¶é€»è¾‘**ï¼šéç›´æ¥æ¨¡å¼**å¯ä»¥ç»“åˆæ›´å¤šå¤–éƒ¨äº‹ä»¶å’Œè§¦å‘æ¡ä»¶æ¥å†³å®šä½•æ—¶æ•è·ä¿¡å·**ï¼Œå› æ­¤é€‚ç”¨äºæ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ã€‚\n- **æ»¤æ³¢å’Œå»æŠ–åŠ¨**ï¼šéç›´æ¥æ¨¡å¼å¯ä»¥é…åˆå¤–éƒ¨è§¦å‘ä¿¡å·æˆ–æ»¤æ³¢åŠŸèƒ½ï¼Œé€‚ç”¨äºå™ªå£°è¾ƒå¤§çš„ç¯å¢ƒã€‚\n\n##### 3.6.4.2. ä»¥ä¸‹æ˜¯ç›´æ¥ä¸éç›´æ¥æ¨¡å¼çš„æ¯”è¾ƒ\n\n| ç‰¹æ€§        | ç›´æ¥æ¨¡å¼ï¼ˆDirect Modeï¼‰          | éç›´æ¥æ¨¡å¼ï¼ˆIndirect Modeï¼‰    |\n| --------- | -------------------------- | ----------------------- |\n| **æ•è·æ–¹å¼**  | ä¿¡å·å˜åŒ–ç›´æ¥è§¦å‘æ•è·ï¼Œæ•è·å€¼ç«‹å³å­˜å‚¨         | ä¿¡å·å˜åŒ–é€šè¿‡è§¦å‘äº‹ä»¶æˆ–é™„åŠ æ¡ä»¶è§¦å‘æ•è·     |\n| **è§¦å‘æ¡ä»¶**  | å¤–éƒ¨è¾“å…¥ä¿¡å·ï¼ˆä¸Šå‡æ²¿/ä¸‹é™æ²¿ï¼‰ç›´æ¥è§¦å‘æ•è·      | å¤–éƒ¨äº‹ä»¶ã€è§¦å‘å™¨æˆ–æ»¤æ³¢å™¨æ§åˆ¶æ•è·äº‹ä»¶çš„è§¦å‘   |\n| **å“åº”é€Ÿåº¦**  | å¿«é€Ÿï¼ˆé€šå¸¸å®æ—¶æ•è·ï¼‰                 | ç›¸å¯¹è¾ƒæ…¢ï¼Œå¯èƒ½éœ€è¦é¢å¤–æ¡ä»¶æ¥è§¦å‘æ•è·      |\n| **åº”ç”¨åœºæ™¯**  | é€‚ç”¨äºé«˜é¢‘ä¿¡å·çš„å®æ—¶æ•è·ï¼ˆå¦‚é¢‘ç‡æµ‹é‡ã€è„‰å†²å®½åº¦æµ‹é‡ï¼‰ | é€‚ç”¨äºéœ€è¦å¤–éƒ¨äº‹ä»¶è§¦å‘çš„åœºæ™¯ï¼Œå¦‚å¤–éƒ¨ä¿¡å·åŒæ­¥ç­‰ |\n| **å®ç°å¤æ‚åº¦** | ç®€å•ï¼Œé€šå¸¸æ˜¯ç¡¬ä»¶å±‚é¢ç›´æ¥å®ç°             | éœ€è¦é¢å¤–çš„ç¡¬ä»¶é…ç½®å’Œæ§åˆ¶ï¼ˆå¦‚è§¦å‘ã€æ»¤æ³¢ï¼‰    |\n\n#### 3.6.5. å‚è€ƒ\n\n- ğŸ‘ğŸ‘ğŸ‘ChatGPT\n- ğŸ‘ğŸ‘ğŸ‘[STM32-ä¸€æ–‡ææ‡‚é€šç”¨å®šæ—¶å™¨æ•è·/æ¯”è¾ƒé€šé“-ç”µå­å·¥ç¨‹ä¸–ç•Œ](https://news.eeworld.com.cn/mcu/ic565151.html)\n","tags":["STM32","CubeMX","åµŒå…¥å¼","Timer"],"categories":["åµŒå…¥å¼","CubeMXé…ç½®åŠŸèƒ½"]},{"title":"CubeMXé…ç½®åŠŸèƒ½ç³»åˆ—ï¼šTimerï¼ˆä¸Šï¼‰","url":"/posts/16836/","content":"<details>\n\n<summary>ç‰ˆæƒä¿¡æ¯</summary>\n\n:::warning\n\næœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª [CC 4.0 BY-SA](https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans) ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n\n:::\n\n</details>\n\n---\n\n## ç›®å½•\n- [ç›®å½•](#ç›®å½•)\n- [1. è¯´æ˜](#1-è¯´æ˜)\n- [2. ç•Œé¢æ€»è§ˆ](#2-ç•Œé¢æ€»è§ˆ)\n- [3. LPTIMï¼šæ²¡ç”¨è¿‡ï¼Œç”¨è¿‡åè¡¥å……](#3-lptimæ²¡ç”¨è¿‡ç”¨è¿‡åè¡¥å……)\n  - [3.1. ä»‹ç»](#31-ä»‹ç»)\n  - [3.2. æ”¯æŒçš„æ¨¡å¼](#32-æ”¯æŒçš„æ¨¡å¼)\n  - [3.3. å‚è€ƒ](#33-å‚è€ƒ)\n- [4. RTCï¼šä¹Ÿä¸å’‹ç”¨ï¼Œç”¨æ—¶è¡¥å……](#4-rtcä¹Ÿä¸å’‹ç”¨ç”¨æ—¶è¡¥å……)\n  - [4.1. ä»€ä¹ˆæ˜¯RTC](#41-ä»€ä¹ˆæ˜¯rtc)\n  - [4.2. åŠŸèƒ½ç®€ä»‹](#42-åŠŸèƒ½ç®€ä»‹)\n  - [4.3. å‚è€ƒ](#43-å‚è€ƒ)\n\n\n## 1. è¯´æ˜\n\næœ¬æ–‡ä»¥STM32G4ç³»åˆ—ä¸ºä¾‹ã€‚ä¾›è‡ªå·±å­¦ä¹ ä¸è®°å½•ä¸”åªåšç®€å•ä»‹ç»ã€‚æœ‰ä¸€å®šåŸºç¡€çš„æœ‹å‹å¯å‚è€ƒã€‚\n\n--- \n\n## 2. ç•Œé¢æ€»è§ˆ\n\næ‰“å¼€Timerçš„é…ç½®ç•Œé¢å¦‚å›¾ï¼š\n![](Snipaste_2025-02-06_18-21-03.png)\n\n## 3. LPTIMï¼šæ²¡ç”¨è¿‡ï¼Œç”¨è¿‡åè¡¥å……\n\n### 3.1. ä»‹ç»\n\nLPTIM æ˜¯ä¸€ä¸ª 16 ä½å®šæ—¶å™¨ï¼Œé¡¾åæ€ä¹‰ä»–å°±æ˜¯å¯ä»¥å®ç°ä½åŠŸè€—åº”ç”¨çš„ä¸€ä¸ªç‰¹æ®Šå®šæ—¶å™¨ã€‚ç”±äºæ—¶é’Ÿæºçš„å¤šæ ·æ€§ï¼ŒLPTIM èƒ½å¤Ÿåœ¨é™¤å¾…æœºæ¨¡å¼ä»¥å¤–çš„æ‰€æœ‰ç”µæºæ¨¡å¼ä¸‹ä¿æŒè¿è¡Œã€‚ å³ä½¿æ²¡æœ‰å†…éƒ¨æ—¶é’Ÿæºï¼Œ LPTIM ä¹Ÿèƒ½è¿è¡Œï¼Œé‰´äºè¿™ä¸€ç‚¹ï¼Œå¯å°†å…¶ç”¨ä½œâ€œè„‰å†²è®¡æ•°å™¨â€ï¼Œè¿™ç§è„‰å†²è®¡æ•°å™¨åœ¨æŸäº›åº”ç”¨ä¸­ååˆ†æœ‰ç”¨ã€‚æ­¤å¤–ï¼Œ LPTIMè¿˜èƒ½å°†ç³»ç»Ÿä»ä½åŠŸè€—æ¨¡å¼å”¤é†’ï¼Œå› æ­¤éå¸¸é€‚åˆå®ç°â€œè¶…æ—¶åŠŸèƒ½â€ï¼Œè€Œä¸”åŠŸè€—æä½ã€‚\n\nLPTIM å¼•å…¥äº†ä¸€ä¸ªçµæ´»çš„æ—¶é’Ÿæ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆèƒ½å¤Ÿæä¾›æ‰€éœ€çš„åŠŸèƒ½å’Œæ€§èƒ½ï¼ŒåŒæ—¶è¿˜èƒ½æœ€å¤§ç¨‹åº¦åœ°é™ä½åŠŸè€—ã€‚\n\nLPTIMæ—¶åŸºå•å…ƒåŒ…å«ä¸€ä¸ª16ä½è‡ªåŠ¨é‡è½½è®¡æ•°å™¨ARRï¼Œä¸€ä¸ª16ä½çš„é€’å¢è®¡æ•°å™¨CNTï¼Œä¸€ä¸ª3ä½å¯ç¼–ç¨‹é¢„åˆ†é¢‘å™¨å¯ä»¥é‡‡ç”¨8ç§åˆ†é¢‘ç³»æ•°ï¼ˆ1ã€2ã€4ã€8ã€16ã€32ã€64ã€128ï¼‰ï¼Œ é¢„åˆ†é¢‘å™¨æ—¶é’Ÿæºæœ‰å¤šç§å¯é€‰ï¼Œæœ‰å†…éƒ¨æ—¶é’Ÿæºï¼š LSEã€ LSIã€ HSI æˆ– APB æ—¶é’Ÿã€å¤–éƒ¨æ—¶é’ŸULPTIMè¾“å…¥çš„å¤–éƒ¨æ—¶é’Ÿæºï¼ˆåœ¨æ²¡æœ‰ LP æŒ¯è¡å™¨è¿è¡Œçš„æƒ…å†µä¸‹å·¥ä½œï¼Œç”±è„‰å†²è®¡æ•°å™¨åº”ç”¨ä½¿ç”¨ï¼‰ã€‚\n\n### 3.2. æ”¯æŒçš„æ¨¡å¼\n\n![](Snipaste_2025-02-06_18-22-29.png)\n![](Snipaste_2025-02-06_18-23-44.png)\n\n- è®¡æ•°å™¨æ¨¡å¼ï¼šè®¡æ•°å™¨å¯ç”¨äºè®¡ç®—æ¥è‡ª Input1 çš„å¤–éƒ¨äº‹ä»¶æˆ–ç”¨äºè®¡ç®—å†…éƒ¨æ—¶é’Ÿå‘¨æœŸ\n- å•æ¬¡æ¨¡å¼ï¼šåœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œå½“æ»¡è¶³åŒ¹é…æ¡ä»¶æ—¶ï¼Œè¾“å‡ºå¯ä»¥åˆ‡æ¢é«˜ä½ç”µå¹³ï¼ˆå¦‚æœè¾“å‡ºææ€§é…ç½®ä¸ºé«˜ï¼Œåˆ™ä¸ºä½ç”µå¹³è‡³é«˜ç”µå¹³å˜åŒ–ï¼Œåä¹‹äº¦ç„¶ï¼‰\n-  ç¼–ç å™¨æ¨¡å¼\næ­¤å¤–è¿˜æœ‰\n- å•è„‰å†²æ¨¡å¼\n- PWM æ¨¡å¼ \n-  è¶…æ—¶æ¨¡å¼ï¼šæœ‰æ•ˆçš„è¾¹æ²¿è§¦å‘è¾“å…¥å¯å¤ä½å®šæ—¶å™¨ã€‚ç¬¬ä¸€ä¸ªè§¦å‘äº‹ä»¶å°†å¯åŠ¨è®¡æ—¶å™¨ï¼Œä»»ä½•è¿ç»­è§¦å‘äº‹ä»¶å°†é‡ç½®è®¡æ•°å™¨å¹¶é‡æ–°å¼€å§‹ã€‚\n\n### 3.3. å‚è€ƒ\n[ã€ç©è½¬STM32ã€‘ï¼šä½åŠŸè€—å®šæ—¶å™¨LPTIMåº”ç”¨_stm32 lptim-CSDNåšå®¢](https://blog.csdn.net/qq_42965739/article/details/113532039)\n[32. LPTIMâ€”ä½åŠŸè€—å®šæ—¶å™¨ â€” [é‡ç«]STM32 HALåº“å¼€å‘å®æˆ˜æŒ‡å—â€”â€”åŸºäºH743_Pro_V æ–‡æ¡£](https://doc.embedfire.com/mcu/stm32/h743prov/hal/zh/latest/book/LPTIM.html)\n\n\n## 4. RTCï¼šä¹Ÿä¸å’‹ç”¨ï¼Œç”¨æ—¶è¡¥å……\n\n### 4.1. ä»€ä¹ˆæ˜¯RTC\n\n**RTC (Real Time Clock)**ï¼šå®æ—¶æ—¶é’Ÿ\n\n**RTCæ˜¯ä¸ªç‹¬ç«‹çš„å®šæ—¶å™¨**ã€‚RTCæ¨¡å—æ‹¥æœ‰ä¸€ä¸ªè¿ç»­è®¡æ•°çš„è®¡æ•°å™¨ï¼Œåœ¨ç›¸åº”çš„è½¯ä»¶é…ç½®ä¸‹ï¼Œå¯ä»¥æä¾›æ—¶é’Ÿæ—¥å†çš„åŠŸèƒ½ã€‚ä¿®æ”¹è®¡æ•°å™¨çš„å€¼å¯ä»¥é‡æ–°è®¾ç½®å½“å‰æ—¶é—´å’Œæ—¥æœŸ RTCè¿˜åŒ…å«ç”¨äºç®¡ç†ä½åŠŸè€—æ¨¡å¼çš„è‡ªåŠ¨å”¤é†’å•å…ƒã€‚\n\nåœ¨æ–­ç”µæƒ…å†µä¸‹ RTCä»å¯ä»¥ç‹¬ç«‹è¿è¡Œ åªè¦èŠ¯ç‰‡çš„å¤‡ç”¨ç”µæºä¸€ç›´ä¾›ç”µ,RTCä¸Šçš„æ—¶é—´ä¼šä¸€ç›´èµ°ã€‚\n\nRTCå®è´¨æ˜¯ä¸€ä¸ªæ‰ç”µåè¿˜ç»§ç»­è¿è¡Œçš„å®šæ—¶å™¨,ä»å®šæ—¶å™¨çš„è§’åº¦æ¥çœ‹,ç›¸å¯¹äºé€šç”¨å®šæ—¶å™¨TIMå¤–è®¾,å®ƒçš„åŠŸèƒ½ååˆ†ç®€å•,åªæœ‰è®¡æ—¶åŠŸèƒ½(ä¹Ÿå¯ä»¥è§¦å‘ä¸­æ–­)ã€‚ä½†å…¶é«˜çº§æŒ‡å‡ºä¹Ÿå°±åœ¨äºæ‰ç”µä¹‹åè¿˜å¯ä»¥æ­£å¸¸è¿è¡Œã€‚\n\nä¸¤ä¸ª 32 ä½å¯„å­˜å™¨åŒ…å«äºŒè¿›ç åè¿›æ•°æ ¼å¼ (BCD) çš„ç§’ã€åˆ†é’Ÿã€å°æ—¶ï¼ˆ 12 æˆ– 24 å°æ—¶åˆ¶ï¼‰ã€æ˜ŸæœŸå‡ ã€æ—¥æœŸã€æœˆä»½å’Œå¹´ä»½ã€‚æ­¤å¤–ï¼Œè¿˜å¯æä¾›äºŒè¿›åˆ¶æ ¼å¼çš„äºšç§’å€¼ã€‚ç³»ç»Ÿå¯ä»¥è‡ªåŠ¨å°†æœˆä»½çš„å¤©æ•°è¡¥å¿ä¸º 28ã€29ï¼ˆé—°å¹´ï¼‰ã€30 å’Œ 31 å¤©ã€‚\n\nä¸Šç”µå¤ä½åï¼Œæ‰€æœ‰RTCå¯„å­˜å™¨éƒ½ä¼šå—åˆ°ä¿æŠ¤ï¼Œä»¥é˜²æ­¢å¯èƒ½çš„éæ­£å¸¸å†™è®¿é—®ã€‚\n\næ— è®ºå™¨ä»¶çŠ¶æ€å¦‚ä½•ï¼ˆè¿è¡Œæ¨¡å¼ã€ä½åŠŸè€—æ¨¡å¼æˆ–å¤„äºå¤ä½çŠ¶æ€ï¼‰ï¼Œåªè¦ç”µæºç”µå‹ä¿æŒåœ¨å·¥ä½œèŒƒå›´å†…ï¼ŒRTCä½¿ä¸ä¼šåœæ­¢å·¥ä½œã€‚\n\n### 4.2. åŠŸèƒ½ç®€ä»‹\n\n![](Snipaste_2025-02-06_18-46-47.png)\n\n- **æ¿€æ´»æ—¶é’Ÿæº**ï¼š**ä¸€èˆ¬é€‰ç”¨LSE**ï¼ŒRTCè®¾å¤‡å› ä¸ºå…¶ç‹¬ç‰¹çš„è¿è¡Œæ–¹å¼ï¼ˆå³æ‰ç”µä¾æ—§è¿è¡Œï¼‰ä½¿ç”¨HSEåˆ†é¢‘æ—¶é’Ÿæˆ–è€…LSIçš„æ—¶å€™,åœ¨ä¸»ç”µæºVDDæ‰ç”µçš„æƒ…å†µä¸‹,è¿™ä¸¤ä¸ªæ—¶é’Ÿæ¥æºéƒ½ä¼šå—åˆ°å½±å“ï¼Œèµ„æºæ¶ˆè€—å¤ªå¤§ï¼Œå°å°çš„çº½æ‰£ç”µæ± æ ¹æœ¬åƒä¸æ¶ˆã€‚æ²¡æ³•ä¿è¯RTCæ­£å¸¸å·¥ä½œ.æ‰€ä»¥RTCä¸€èˆ¬éƒ½æ—¶é’Ÿä½é€Ÿå¤–éƒ¨æ—¶é’ŸLSE\n- **ä½¿èƒ½RTCæ—¥å†**\n- **å¯ç¼–ç¨‹çš„é—¹é’ŸA/B**ï¼Œå¦‚æœè®¾ç½®äº†é—¹é’ŸA/Bçš„æ—¶é—´ï¼Œåˆ™é—¹é’ŸA/Bè®¾å®šæ—¶é—´ä¼šå’Œå½“å‰æ—¥å†æ—¶é—´å¯¹æ¯”ï¼Œå¦‚æœæ—¶é—´ç›¸ç­‰ï¼Œä¼šäº§ç”ŸALRA/BFäº‹ä»¶\n- **å‘¨æœŸå”¤é†’**ï¼šå¯ä»¥ä½¿ç”¨RTCå†…éƒ¨ä¸€ä¸ª16ä½å”¤é†’è‡ªåŠ¨é‡è½½å¯„å­˜å™¨æ¥å®ç°ï¼Œå‘¨æœŸå”¤é†’çš„æ—¶é’Ÿä¿¡å·å¯ä»¥æ¥è‡ªäºæ›´æ–°æ—¥å†çš„1Hzï¼ˆck_spreï¼‰ä¿¡å·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨RTCæ—¶é’Ÿçš„2/4/8/16åˆ†é¢‘åçš„æ—¶é’Ÿï¼Œè®¾ç½®è¯¥è‡ªåŠ¨é‡è½½å¯„å­˜å™¨çš„å€¼ï¼Œ**æ ¹æ®æ—¶é’Ÿé¢‘ç‡å‘ä¸Šè®¡æ•°ï¼Œå½“è®¡æ•°æº¢å‡ºæ—¶å‘ç”Ÿå‘¨æœŸå”¤é†’äº‹ä»¶**\n- **æ—¶é—´æˆ³**\n- **Tamper**ï¼šå…¥ä¾µæ£€æµ‹\n- **æ—¶é’Ÿæ ¡å‡†**\n- **å‚è€ƒæ—¶é’Ÿæ£€æµ‹ï¼Ÿï¼Ÿï¼Ÿ**\n\n### 4.3. </a>å‚è€ƒ\n[How to calibrate the STM32's real-time clock (RTC) - STMicroelectronics Community](https://community.st.com/t5/stm32-mcus/how-to-calibrate-the-stm32-s-real-time-clock-rtc/ta-p/744958)\n[STM32CubeMXæ•™ç¨‹10 RTC å®æ—¶æ—¶é’Ÿ - å‘¨æœŸå”¤é†’ã€é—¹é’ŸA/Bäº‹ä»¶å’Œå¤‡ä»½å¯„å­˜å™¨_stm32cubemx rtc-CSDNåšå®¢](https://blog.csdn.net/lc_guo/article/details/135225854)\n[ã€STM32ã€‘RTCå®æ—¶æ—¶é’Ÿï¼Œæ­¥éª¤è¶…ç»†è¯¦è§£ï¼Œä¸€æ–‡çœ‹æ‡‚RTC_rtcæ¨¡å—-CSDNåšå®¢](https://blog.csdn.net/as480133937/article/details/105026033)\n\n","tags":["STM32","CubeMX","åµŒå…¥å¼","Timer"],"categories":["åµŒå…¥å¼","CubeMXé…ç½®åŠŸèƒ½"]},{"title":"ç›¸æœºæ§è‰²","url":"/posts/50403/","content":"\næ•™ç¨‹åŠæˆªå›¾æ¥è‡ªbç«™ï¼š https://www.bilibili.com/video/BV1DQiyYkEJC/\n\n---\n\n## è‰²æ¸©ï¼ˆKï¼‰\n\n- è‰²æ¸©é«˜ï¼šå‘ˆç°æš–è‰²ï¼Œè‰²æ¸©ä½ï¼šå‘ˆç°å†·è‰²ï¼ˆä¸ç¯å¢ƒè‰²æ¸©æ˜¯åçš„ï¼‰\n- ![](Snipaste_2025-01-21_22-20-26.png)\n- `åè‰²`ï¼šæ‹æ‘„æ—¶ç”±äºå…‰çº¿å¹²æ‰°ï¼Œè‰²æ¸©ç­‰å› ç´ å½±å“ï¼Œä½¿å¾—ç‰©ä½“æœ¬èº«è‰²å½©å—åˆ°å¹²æ‰°\n\t- çŸ«æ­£ï¼šå°†ç›¸æœºè‰²æ¸©æ•°å€¼è°ƒåˆ°ä¸ç¯å¢ƒè‰²æ¸©æ•°å€¼ç›¸åŒ\n- ä¸€äº›æ¨èè‰²æ¸© #æ‹æ‘„æŠ€å·§ \n\t- å†°å¤©é›ªåœ°ã€è“è°ƒã€å¤œæ™šã€å¤©ç©ºï¼šå†·è‰²è°ƒï¼ˆunder 5000kï¼‰\n\t- å†¬æ—¥æš–é˜³ã€æ¸©æš–ã€é»„æ²™ï¼šæš–è‰²è°ƒï¼ˆup 6000kï¼‰\n\n## ç™½å¹³è¡¡ï¼ˆWBï¼‰\n\n- æ ¡æ­£ç¯å¢ƒåè‰²ã€‚![](Snipaste_2025-01-21_22-31-07.png)\n- **ä¸€èˆ¬ä½¿ç”¨ç™½å¹³è¡¡è‡ªåŠ¨æˆ–è€…ç›´æ¥è‡ªå·±æ ¡æ­£è‰²æ¸©**\n- æ„Ÿè§‰å¹³å¸¸å¯ä»¥ç›´æ¥ç™½å¹³è¡¡è‡ªåŠ¨ï¼ŒåæœŸè°ƒå•Šã€‚ã€‚\n\n## æ ¹æ®ä¸»å¯¼è‰²ç¡®å®šç”»é¢è‰²æ¸©\n\n- å¦‚æœä¸»å¯¼è‰²åæš–ï¼Œå¯ä»¥å¾€æš–è‰²è°ƒè‰²æ¸©\n- å¦‚æœä¸»å¯¼è‰²åå†·ï¼Œå¯ä»¥å¾€å†·è‰²è°ƒè‰²æ¸©ï¼Œä½¿ç”»é¢æ›´å…·**æ°›å›´**\n- æ³¨æ„ï¼šç…§ç‰‡ä¹Ÿ**ä¸ä¸€å®šè¦åå†·å’Œåæš–**ï¼Œåè‰²ç”¨äºè¥é€ æ°›å›´ï¼Œæœ‰äº›ä½œå“éœ€è¦ä¿è¯ä¸è¦åè‰²ï¼Œè¿˜åŸçœŸå®è‰²å½©\n\n## ç™½å¹³è¡¡åç§»\n\n![](Snipaste_2025-01-21_23-10-03.png)\n\n![](Snipaste_2025-01-21_23-11-23.png)\n\n- ä¸¤å¤§ä½œç”¨ï¼š\n\t- ç”»é¢æ°›å›´æ¸²æŸ“\n\t- æ§åˆ¶é¢œè‰²åç§»çš„ç¨‹åº¦ï¼šè§£å†³è°ƒæ•´è‰²æ¸©å¯¼è‡´ä¸€äº›ç»†èŠ‚çš„è‰²å½©ä¸å¯¹ï¼Œä¾‹å¦‚è‰²æ¸©è¿‡é«˜å¯¼è‡´äººåƒæ³›çº¢ï¼Œè°ƒæ•´ç™½å¹³è¡¡åç§»å¾€çº¢è‰²**åæ–¹å‘è°ƒ**ã€‚","tags":["æ‘„å½±åŸºç¡€","å­¦ä¹ ç¬”è®°","ç›¸æœºæ§è‰²","ç™½å¹³è¡¡"],"categories":["æ‘„å½±å­¦ä¹ "]},{"title":"æ„å›¾","url":"/posts/40301/","content":"# ç¬¬ä¸€ä¸ªæ•™ç¨‹\nä»¥ä¸‹å›¾ç‰‡ä¸æ•™ç¨‹æ¥è‡ªbç«™ï¼š https://www.bilibili.com/video/BV1pv411H78e\n\n---\n\n## æ„å›¾çš„æ ¸å¿ƒ\n\n1. ç¡®è®¤ç”»é¢ä¸»ä½“æˆ–ä¸»é¢˜\n2. å»æ‰ç”»é¢ä¸­ä¸ä¸»ä½“æ— å…³çš„å…ƒç´ \n3. **åŠ å…¥**çªå‡ºä¸»é¢˜æˆ–ä¸»é¢˜è¡¨è¾¾çš„å…ƒç´ å¹¶åˆç†æ‘†æ”¾ï¼ˆåˆ©ç”¨æŠ½è±¡å‡ºçš„å‡ ä½•çº¿æ¡ï¼‰\n4. æˆåŠŸè¡¨è¾¾æƒ³è¡¨è¾¾çš„å†…å®¹\n\n## å¦‚ä½•é€‰æ‹©åˆé€‚çš„å–æ™¯èŒƒå›´ï¼Ÿ\n\nè¿˜æ˜¯æ ¹æ®ä¸»é¢˜æˆ–ä¸»é¢˜......ä¸ç¡®å®šå¯ä»¥å¤šå¤šè¯•ä¸€ä¸‹\n\n## è®©ç”»é¢æ›´åŠ å¸å¼•äººçš„æ–¹æ³•\n\n- åˆ©ç”¨äººçœ¼çš„è§†è§‰æµåŠ¨ï¼š \n\t- è§†è§‰å‡èšï¼šæ˜æš—ã€é²œè‰³æš—æ·¡ã€å¯¹æ¯”è‰²ã€é‡å¤å…ƒç´ \n\t\t- ![](Snipaste_2025-01-19_21-52-29.png)\n\t\t- ![](Snipaste_2025-01-19_21-53-32.png)\n\t\t- ![](Snipaste_2025-01-19_21-54-29.png)\n- è§†è§‰å¼•å¯¼ï¼š\n\t- å¼•å¯¼çº¿\n\t\t- ![](Snipaste_2025-01-19_21-55-44.png)\n\t- è§†çº¿\n\t\t- ![](Snipaste_2025-01-19_21-56-10.png)\n\t- è§†è§‰æ§åˆ¶\n\t\t- ![](Snipaste_2025-01-19_21-57-23.png)\n\n## å¸¸ç”¨çš„æ„å›¾æŠ€å·§ï¼ˆè¦å’Œä¸Šé¢çš„æŠ€å·§ç»¼åˆè¿ç”¨ï¼‰\n\n- ä¸‰åˆ†\n\t- ![](Snipaste_2025-01-19_21-59-29.png)\n- å±…ä¸­ï¼ˆå¯¹ç§°ï¼‰ æ‹æ‘„æ¯”è¾ƒåº„ä¸¥è‚ƒç©†çš„ç‰©ä½“\n\t- ![](Snipaste_2025-01-19_22-00-43.png)\n- ä¸‰è§’å½¢\n\t- ![](Snipaste_2025-01-19_22-01-27.png)\n- å‰ä¸­åæ™¯å±‚æ¬¡æ„å›¾\n\t- ![](Snipaste_2025-01-19_22-02-21.png)\n\n## ç”»é¢çš„å¹³è¡¡\n\n- æ´»ç”¨ä¸‰åˆ†æ³•ã€å¯¹ç§°æ³•ï¼šæ ¹æ®æƒ…å†µè°ƒæ•´\n- ç•™ç™½å¤„ç‚¹ç¼€\n\t- ![](Snipaste_2025-01-19_22-10-09.png)\n\n---\n\n# ç¬¬äºŒä¸ªæ•™ç¨‹\nä»¥ä¸‹æ•™ç¨‹ä¸å›¾ç‰‡æ¥è‡ªï¼š https://www.bilibili.com/video/BV1eZCzYUEKD åå‘äºäººåƒ\n\n---\n\n## ç¬¬ä¸€é˜¶æ®µï¼šå½¢å¼çš„æ„å›¾\n\n- å±…ä¸­æ„å›¾ï¼šçªå‡ºä¸»é¢˜ä½†å®¹æ˜“å¹³æ·¡\n- ä¸‰åˆ†æ³•\n\t- ![](Snipaste_2025-01-19_22-13-39%201.png)\n- å¯¹è§’çº¿ï¼šæœ‰å¼ åŠ›ã€æœ‰çº¿æ¡æ„Ÿï¼Œ**è¡¨è¾¾ä¸»ä½“çš„å»¶ç”³æ„Ÿ**\n\t- ![](Snipaste_2025-01-19_22-14-45.png)\n- å¯¹ç§°ï¼šå‡åŒ€åè°ƒï¼Œç¨³å®š\n- æ¡†æ¶æ„å›¾ï¼ˆè§†è§‰æ§åˆ¶ï¼‰\n- å¼•å¯¼æ„å›¾ï¼šåˆ©ç”¨çº¿æ¡å»å¼•å¯¼ï¼Œè¦å¼•å¯¼å»ä¸»ä½“ï¼Œä¸æ˜¯éšä¾¿å¼•å¯¼\n\t- ![](Snipaste_2025-01-19_22-17-14.png)\n- ä¸‰è§’æ„å›¾ï¼šå¹¶ä¸å±€é™äºä¸€ä¸ªï¼Œå¯ä»¥æ‹¼å‡‘å¤šä¸ª\n\t- ![](Snipaste_2025-01-19_22-18-18.png)\n**ä½†æ˜¯ï¼Œä¸€å®šä¸è¦ç”Ÿæ¬ç¡¬å¥—ï¼ï¼ï¼**\nä»¥ä¸‹æ˜¯ä¸€äº›é”™è¯¯ä¾‹å­\n- ç›²ç›®å¥—ç”¨ï¼Œæ²¡æœ‰çªå‡ºæ‹æ‘„çš„ä¸»ä½“\n\t- ![](Snipaste_2025-01-19_22-20-48.png)\n\t- ![](Snipaste_2025-01-19_22-22-00.png)\n- ç›²ç›®å‰åæ™¯\n\t- ![](Snipaste_2025-01-19_22-23-02.png)\n- å‰æ™¯å¤ªå¤§ï¼šæ·¡åŒ–ä¸»ä½“\n\t- ![](Snipaste_2025-01-19_22-23-51.png)\n\n## ç¬¬äºŒé˜¶æ®µï¼šç»“æ„æ„å›¾\n\n- åˆ†æç”»é¢ï¼šç‚¹çº¿é¢çš„è¿ç”¨ï¼Œä¸€äº›å…ƒç´ ä¸å†æ˜¯å…ƒç´ æœ¬èº«ï¼Œè€Œæ˜¯å¼•å¯¼è§‚çœ‹ä¸»ä½“çš„å·¥å…·\n\n- æ ¹æ®ç”»é¢å†…å®¹ï¼Œåˆç†å®‰æ’ç”»é¢ä¸­çš„æ¯ä¸ªå…ƒç´  è€Œä¸æ˜¯ç”Ÿæ¬ç¡¬å¥—\n- å½“ç”»é¢ä¸»ä½“æ˜¯äººæ—¶ï¼Œäººé¢æœçš„æ–¹å‘å’Œè§†çº¿ä¹Ÿæ˜¯éšå½¢çš„çº¿æ¡ï¼Œåˆç†è¿ç”¨èƒ½å¼•å¯¼ç”»é¢æ•´ä½“èµ°å‘\n\n## ç¬¬ä¸‰é˜¶æ®µï¼šå¿˜æ‰æ„å›¾ï¼Œä¸“æ³¨äºç”»é¢å†…å®¹ä¸ä¸»é¢˜ï¼Œè¿”ç’å½’çœŸ\n\n![](Snipaste_2025-01-19_22-38-26.png)\n![](Snipaste_2025-01-19_22-39-01.png)\n![](Snipaste_2025-01-19_22-39-21.png)\nå¦‚ä¸‹é¢å›¾ç‰‡ï¼šå…¶ä¸»æ—¨æ›´åŠ ä¸°å¯Œï¼Œè€Œæ„å›¾ä¸é‚£ä¹ˆæ˜æ˜¾\n![](Snipaste_2025-01-19_22-41-51.png)\n\n## æ€»ç»“\n\nè¯´åˆ°åº•ï¼Œæ„å›¾è¿˜æ˜¯æœä»ç”»é¢ä¸å†…å®¹ï¼Œç…§ç‰‡çš„æ„ä¹‰ï¼Œæœ‰æ—¶å€™ä¸éœ€è¦åä¸½çš„æ„å›¾æŠ€å·§å’Œå½¢å¼ï¼Œç®€å•ï¼ŒçœŸå®ï¼Œæœ‰æ„ä¹‰ï¼Œèƒ½è®©è§‚çœ‹è€…äº§ç”Ÿå…±é¸£å°±å¤Ÿäº†ã€‚\n","tags":["æ‘„å½±åŸºç¡€","å­¦ä¹ ç¬”è®°","æ„å›¾"],"categories":["æ‘„å½±å­¦ä¹ "]},{"title":"å½±è°ƒæ§åˆ¶","url":"/posts/55817/","content":"ä»¥ä¸‹å›¾ç‰‡ä¸æ•™ç¨‹æ¥è‡ªbç«™ï¼š https://www.bilibili.com/video/BV1pv411H78e\n\n---\n\n## ä»€ä¹ˆæ˜¯å½±è°ƒ\n\n - ç”»é¢ä¸­çš„æ˜æš—\n - ![](Snipaste_2025-01-21_16-45-24.png)\n- ![](Snipaste_2025-01-21_16-54-04.png)\n\n## å½±è°ƒçš„é‡åŒ–\n\n- æµ‹å…‰æ ‡å°ºï¼šå‘å·¦ï¼Œä½è°ƒï¼Œå‘å³ï¼Œé«˜è°ƒã€‚\n\t- æµ‹å…‰æ¨¡å¼\n\t\t- ![](Snipaste_2025-01-21_17-00-29.png)\n\t\t- æ‹æœˆäº®å¯ä»¥ç”¨ç‚¹æµ‹å…‰\n- ç›´æ–¹å›¾\n\t- **åˆ¤æ–­æ˜¯å¦è¿‡æ›ã€æ¬ æ›**ï¼šè¢«æˆªæ–­ã€‚åœ¨æŸä¸€æ–¹å‘çªç„¶é™¡å¢\n\t\t- ![](Snipaste_2025-01-21_17-03-12.png)\n\t-  ç›´æ–¹å›¾å¯ä»¥ç”¨äºåˆ¤æ–­å½±è°ƒï¼Œä¾‹å¦‚ï¼š\n\t\t- ![](Snipaste_2025-01-21_17-06-14.png)\n\n## æ•°ç æ—¶ä»£çš„æœ€ä½³æ›å…‰æ–¹å¼\n\n- **å‘å³æ›å…‰ï¼Œä½†ä¸æ˜¯è¿‡æ›**\n\t- ä¸ºäº†è®°å½•æ›´å¤šçš„ç”»é¢ç»†èŠ‚ï¼Œè€Œåœ¨åæœŸå¯ä»¥è¿›ä¸€æ­¥è°ƒæ•´\n\t- è®©ç›´æ–¹å›¾å³ä¾§å°½é‡è´´è¿‘å³è¾¹ç¼˜ä½†æ˜¯**ä¸è¢«æˆªæ–­**\n\t- å¯ä»¥åŠ ä¸€ç‚¹EVï¼ˆæ›å…‰è¡¥å¿ï¼‰\n\t- ![](Snipaste_2025-01-21_17-11-27%201.png)\n\n## å¤§å…‰æ¯”æƒ…å†µä¸‹ï¼Œå¹³è¡¡å…‰æ¯”çš„å¤šç§åº”å¯¹æ–¹å¼\n\n- å¦‚ä½•å®šä¹‰å¤§å…‰æ¯”æƒ…å†µ\n\t- æ˜æš—åå·®å¾ˆå¤§ï¼Œå¯ä»¥ç†è§£ä¸ºæœ€äº®å’Œæœ€æš—çš„åå·®\n\t- ![](Snipaste_2025-01-21_17-19-56.png)\n\t- ![](Snipaste_2025-01-21_17-20-33.png)\n\t- ![](Snipaste_2025-01-21_17-21-18.png)\n- ä¸åŒæƒ…å†µä¸‹çš„åº”å¯¹æ–¹å¼\n\t- å¹³è¡¡å…‰æ¯”æ˜¯ç¬¦åˆ**è‚‰çœ¼çœ‹åˆ°çš„ç›´è§‚æ„Ÿè§‰**ï¼Œè€Œä¸æ˜¯æ²¡æœ‰å…‰æ¯”\n\t1. `æ›å…‰åˆæˆ` ï¼šæ‹æ‘„å¤šå¼ ä¸åŒæ›å…‰åŒºé—´ä¸‹çš„ç…§ç‰‡ï¼ŒåæœŸåˆæˆåˆ°ä¸€èµ·\n\t\t- ç…§ç‰‡å†…å®¹éœ€è¦ä¿æŒä¸€è‡´ï¼Œä½¿ç”¨ç¨³å®šæ‹æ‘„\n\t\t- ä¸€äº›ç…§ç‰‡ä¿ç•™æš—éƒ¨ç»†èŠ‚ï¼Œå¦ä¸€äº›ä¿ç•™äº®éƒ¨ç»†èŠ‚ï¼ŒåæœŸåˆæˆä¸€å¼ HDRç…§ç‰‡\n\t\t- ç›¸æœºé‡Œæœ‰ä¸€ä¸ªé˜¶æ®µæ›å…‰è¿æ‹åŠŸèƒ½\n\t2. `å®æ¬ å‹¿è¿‡ï¼ŒåæœŸæäº®` ï¼šå‰æœŸé€‚å½“å‘å·¦æ›å…‰ï¼Œä¿æŠ¤é«˜å…‰ç»†èŠ‚ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½å¯¼è‡´æš—éƒ¨ç»†èŠ‚æ— æ³•è¿˜åŸ\n\t3. `è¡¥å…‰` ï¼šå¤šç”¨äºäººç‰©\n\t4. `æ‹æ‘„å‰ªå½±` ","tags":["æ‘„å½±åŸºç¡€","å­¦ä¹ ç¬”è®°","å½±è°ƒæ§åˆ¶"],"categories":["æ‘„å½±å­¦ä¹ "]},{"title":"æœºä½æŒæ§","url":"/posts/5778/","content":"\næ•™ç¨‹åŠæˆªå›¾æ¥è‡ªbç«™ï¼š https://www.bilibili.com/video/BV1DQiyYkEJC/\n\n## ä»€ä¹ˆæ˜¯æœºä½\n\nç®€è€Œè¨€ä¹‹ç›¸æœºçš„ä½ç½®ã€‚ç›¸æœºä¸æ¨¡ç‰¹çš„ä¸‰ç»´ä½ç½®\n\n## ä¸‰ç»´\n\n### é«˜åº¦\n\n- å¹³è§†æœºä½\n\t- å–å†³äºå–æ™¯æ¡†ä¸Šçš„**ä¸­å¿ƒå¯¹ç„¦ç‚¹**ï¼Œåº”ä¸ä¸­å¿ƒå¯¹ç„¦ç‚¹**æŒå¹³**\n\t- ä¼˜åŠ¿ï¼š\n\t\t- ç›¸æ¯”é«˜ä½æœºä½ï¼Œæ›´å…·çœŸå®æ„Ÿ  é€‚åˆä¸¥è°¨çš„æƒ…å¢ƒ å¦‚è¯ä»¶ç…§ã€äººæ–‡çºªå®ã€‚![](Snipaste_2025-01-19_20-36-03.png)\n\t\t- æ›´å®¹æ˜“äº§ç”Ÿæƒ…æ„Ÿå…±é¸£ï¼Œåˆ©äºæƒ…ç»ªä¼ è¾¾ï¼Œå¦‚ä¸Šå›¾å°±æ˜¯ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚**çªå‡ºäººç‰©æƒ…ç»ªçš„å…³é”®**ï¼šåˆ©ç”¨**è¿‘æ™¯æˆ–ç‰¹å†™**![](Snipaste_2025-01-19_20-49-10.png)\n\t\t- å°æŠ€å·§ï¼š #æ‹æ‘„æŠ€å·§ \n\t\t\t- ä¸Šé¢çš„ç…§ç‰‡ä¹Ÿæ²¡æœ‰å®Œå…¨æŒå¹³å“¦ï¼Œå¯ä»¥æŠŠç›¸æœºç¨å¾®æ‹‰é«˜æˆ–æ‹‰ä½ï¼Œæ›´èƒ½è¡¨ç°æƒ…ç»ªçŠ¶æ€\n\t\t\t- é‚£ä¹ˆé«˜åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Œä½åˆ°ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ**ä¸Šä¸‹15åº¦èŒƒå›´ï¼Œé¿å…æˆä¸ºé«˜ä½æœºä½çš„è§†è§‰è§‚æ„Ÿ**\n\t- åŠ£åŠ¿ï¼š\n\t\t- æ•ˆæœä¸æƒŠè‰³ï¼šä¸è¦æ‹è¿œã€å…¨ã€ä¸­æ™¯\n\t- è¿›ä¸€æ­¥æ‹”é«˜ï¼š\n\t\t- å¼ºåŒ–ï¼šææ¸…æ¥šæƒ³è¦è¡¨è¾¾çš„ä¸»é¢˜ï¼Œä½¿ç”¨æŠ€å·§å¼ºåŒ–å®ƒ\n\t\t- è§„é¿ï¼šå¯ä»¥æŠŠä¸å¥½çœ‹çš„äººç‰©äº”å®˜åˆ©ç”¨æœºä½çš„å˜åŒ–è§„é¿æ‰ å£è¯€ï¼š**è¿‘å¤§è¿œå°**\n- é«˜æœºä½\n- ä½æœºä½\n\n### è§’åº¦\n\n- æ­£é¢\n- ä¾§é¢\n- èƒŒé¢\n\n### è·ç¦»\nå–æ™¯èŒƒå›´ï¼ˆæ™¯åˆ«ï¼‰\n- è¿œ\n\t- å³è¿œæ™¯æ‹æ‘„\n\t- ![](Snipaste_2025-01-19_17-41-06.png)\n- å…¨\n\t- ä¸»ä½“å®Œæ•´å‘ˆç°äºç”»é¢ï¼Œ äººç‰©å æ¯”å¤§\n\t- ![](Snipaste_2025-01-19_17-43-05.png)\n- ä¸­\n\t- å–æ™¯èŒƒå›´ä¸ºäººç‰©çš„è†ç›–ä»¥ä¸Šæˆ–èƒ¸éƒ¨ä»¥ä¸‹\n- è¿‘\n\t- å–æ™¯èŒƒå›´ä¸ºäººç‰©çš„èƒ¸éƒ¨ä»¥ä¸Šæˆ–è‚©éƒ¨ä»¥ä¸‹\n- ç‰¹\n\t- ç‰¹å†™","tags":["æ‘„å½±åŸºç¡€","å­¦ä¹ ç¬”è®°","æœºä½æŒæ§"],"categories":["æ‘„å½±å­¦ä¹ "]},{"title":"markdownæ¸²æŸ“å™¨æµ‹è¯•","url":"/posts/50034/","content":"\n@[TOC]\n\n# Markdown æµ‹è¯•æ–‡æœ¬\n\n## æ ‡é¢˜2\n\nè¿™æ˜¯ä¸€ä¸ªæ®µè½ï¼Œä¸‹é¢æ˜¯**åŠ ç²—**å’Œ*æ–œä½“*æ–‡æœ¬çš„ç¤ºä¾‹ã€‚\n\n### åˆ—è¡¨\n\n- é¡¹ç›®1\n- é¡¹ç›®2\n  - å­é¡¹ç›®2.1\n  - å­é¡¹ç›®2.2\n- é¡¹ç›®3\n\n### æœ‰åºåˆ—è¡¨\n\n1. ç¬¬ä¸€é¡¹\n\n2. ç¬¬äºŒé¡¹\n\n3. ç¬¬ä¸‰é¡¹\n\n### é“¾æ¥\n\n[ç‚¹å‡»è¿™é‡Œè®¿é—®OpenAI](https://www.openai.com)\n\n### å›¾ç‰‡\n\n![OpenAI logo](https://openai.com/favicon.ico)\n\n### ä»£ç å—\n\n```python\ndef hello_world():\n    print(\"Hello, World!\")\n```\n\n### å¼•ç”¨\n\n> \"æˆ‘çˆ±åƒé¦™è‚ \"\n\n### è¡¨æ ¼\n\n| åç§°   | å¹´é¾„ | èŒä¸š  |\n|--------|------|-------|\n| Alice  | 28   | åŒ»ç”Ÿ  |\n| Bob    | 34   | å·¥ç¨‹å¸ˆ |\n| Carol  | 25   | è®¾è®¡å¸ˆ |\n\n### åˆ’çº¿\n\n~~æˆ‘è¢«åˆ’äº†~~\n\n### å…¶ä»–\n\n<mark>åˆ’é‡ç‚¹ï¼Œæ ‡è®°</mark>\n\n<details>\n<summary>å¯æ”¶èµ·æ–‡æœ¬</summary>\nè¿™æ˜¯å¯æ”¶èµ·æ–‡æœ¬. å¯ä»¥åŒ…å«ä»»æ„å…ƒç´ , æ¯”å¦‚ **ç²—ä½“**, *æ–œä½“*,ä»£ç å—\n\n```python\nprint(\"Hello, World!\")\n```\n</details> \n\n!!é˜²å‰§é€!!\n\n- [ ] TODO List ï¼æ¸²æŸ“å¤±è´¥\n\nH~2~0\nx^2^\n\nè„šæ³¨æµ‹è¯•[^1]\n\n[^1]: è¿™æ˜¯ä¸€ä¸ªè„šæ³¨è§£é‡Š\n\n#### hexo-admonition\n\n!!! note Hexo-admonition æ’ä»¶ä½¿ç”¨ç¤ºä¾‹\n    è¿™æ˜¯åŸºäº hexo-admonition æ’ä»¶æ¸²æŸ“çš„ä¸€æ¡æç¤ºä¿¡æ¯ã€‚ç±»å‹ä¸º noteï¼Œå¹¶è®¾ç½®äº†è‡ªå®šä¹‰æ ‡é¢˜ã€‚\n    \n    æç¤ºå†…å®¹å¼€å¤´ç•™ 4 ä¸ªç©ºæ ¼ï¼Œå¯ä»¥æœ‰å¤šè¡Œï¼Œæœ€åç”¨ç©ºè¡Œç»“æŸæ­¤æ ‡è®°ã€‚\n\n\n\n!!! warning \"\"\n     This is warning without title.\n\n!!! todo \n    This is todo.\n\n!!! error\n    This is error.\n\n\n####  ~~hexo-tips~~ \n\n<details>\n\n<summary>è‡ª2025.09.07èµ·ä¸å†ä½¿ç”¨ï¼Œæ”¹ç”¨ admonitionã€‚</summary>\n\n:::warning\nwarning\n:::\n     \n:::danger\ndanger\n:::\n    \n:::tip\ntip\n:::\n    \n:::mention\nmention\n:::\n   \n:::recommend\nrecommend\n:::   \n\n:::note\nnote\n:::    \n\n:::info\ninfo\n:::     \n\n:::success\nsuccess\n:::\n\n:::error\nerror\n:::    \n\n:::bug\nbug\n:::   \n\n:::todo\ntodo\n:::  \n\n:::example\nexample \n:::   \n\n:::quote\nquote\n::: \n\n:::link\nlink\n:::\n\n:::code\ncode\n:::\n\n:::update\nupdate\n:::\n\n:::star\nstar\n:::\n\n:::time\ntime\n:::  \n\n</details>\n\n# æ ‡é¢˜å¤§å°å¯¹æ¯”\n## 2çº§\n### 3çº§\n#### 4çº§\n##### 5çº§\n###### 6çº§","tags":["åšå®¢"],"categories":["å…¶ä»–"]},{"title":"æ›å…‰ä¸‰è¦ç´ ","url":"/posts/27350/","content":"\næ•™ç¨‹åŠæˆªå›¾æ¥è‡ªbç«™ï¼š https://www.bilibili.com/video/BV1DQiyYkEJC/\n\n## è®¤è¯†å¿«é—¨\n\n- å¿«é—¨ï¼šæ§åˆ¶æ¥æ”¶å…‰çº¿çš„æ—¶é—´ æ—¶é—´é•¿ï¼Œè¿›å…‰é‡å¤§ï¼Œç”»é¢äº®ã€‚\n- åœ¨Mæ¡£ã€å¿«é—¨ä¼˜å…ˆæ¡£ï¼ˆSæ¡£ï¼‰æ§åˆ¶ã€‚\n- **å¿«é—¨å½±å“ç‰©ä½“çš„åŠ¨æ€æ¨¡ç³Šã€‚**\n\t- åœ¨å¿«é—¨æ‰“å¼€å…³é—­æ—¶é—´å†…ï¼Œæ‰€æ‹æ‘„ç‰©ä½“æ²¡æœ‰è¶³å¤Ÿæ—¶é—´ç§»åŠ¨ï¼Œé‚£ä¹ˆæ‰€æ‹æ‘„ç‰©ä½“æ—¶é™æ­¢çš„\n\t- ç›¸åï¼Œè‹¥ç‰©ä½“æ˜¯è¿åŠ¨çš„ï¼Œåˆ™ä¼šæŠŠè¿åŠ¨è½¨è¿¹è®°å½•èµ·æ¥ã€‚\n![](Snipaste_2025-01-19_11-59-54.png)\n\n### å®‰å…¨å¿«é—¨\n\n- èƒ½ä¿è¯ç”»é¢æ¸…æ™°æ‰€ä½¿ç”¨çš„æœ€ä½å¿«é—¨é€Ÿåº¦ï¼ˆæ‰‹æŒæ‹æ‘„ï¼‰\n- å…·ä½“æ•°å€¼ä¸ºç„¦è·çš„å€’æ•°ï¼Œä¾‹å¦‚50mmç„¦è·ï¼Œå®‰å…¨å¿«é—¨ä¸ºï¼š1/50s\n\n- ä¸€äº›å¸¸è§„é¢˜æå¿«é—¨é€Ÿåº¦æ¨èï¼ˆå¸¸ç”¨è°ƒæ•´å€¼ï¼‰ï¼š #æ‹æ‘„æŠ€å·§ \n\t- äººæ–‡é¢˜æ æ–°é—»æŠ¥é“  **å¿«é—¨å¸¸ç”¨ 1/125s**\n\t- è¡Œäººï¼Œè·‘åŠ¨çš„å°å­©   **å¿«é—¨å¸¸ç”¨ 1/500s**\n\n### é«˜é€Ÿå¿«é—¨\n\n- ç”»é¢äº®åº¦ä¼šé™ä½ï¼Œå¯ä»¥æ¸…æ™°çš„æ‹æ‘„é«˜é€Ÿè¿åŠ¨çš„ç‰©ä½“\n- é™åˆ¶ï¼šåœºæ™¯å…‰çº¿å¼ºï¼Œå¦åˆ™ç”»é¢éå¸¸æš—\n\n- ä½¿ç”¨é«˜é€Ÿå¿«é—¨æ‹æ‘„çš„é¢˜æ #æ‹æ‘„æŠ€å·§  \n\t- ![](Snipaste_2025-01-19_12-16-50.png)\n\n\t- ![](Snipaste_2025-01-19_12-27-34.png)\n\n### ä½é€Ÿå¿«é—¨\n\n- æ›å…‰çš„æ—¶é—´è¾ƒé•¿ï¼Œç”»é¢ä¸­è¿åŠ¨çš„ç‰©ä½“çš„ä¸»é¢˜ä¼šç•™ä¸‹è¿è¡Œçš„è½¨è¿¹ï¼Œä¼šå˜å¾—æ¨¡ç³Šï¼Œ**åŒæ—¶ç”»é¢çš„äº®åº¦ä¼šè¢«æé«˜ã€‚**\n- ä¸€èˆ¬éœ€è¦ç¨³å®šæ‹æ‘„ï¼Œæ‰‹æŒçš„æŠ–åŠ¨å¯¹ç”»é¢å½±å“å¤§\n\n - ä½¿ç”¨ä½é€Ÿå¿«é—¨çš„é¢˜æ #æ‹æ‘„æŠ€å·§ \n\t - ![](Snipaste_2025-01-19_13-32-09.png)\n\t\t- å¯¹äºæ‘‡æ‹çš„è¡¥å……ï¼šåˆ©ç”¨ç›¸å¯¹é™æ­¢çš„åŸç†ï¼Œè·Ÿéšè¿åŠ¨ç‰©ä½“è¿›è¡Œå¹³è¡Œç§»åŠ¨ï¼Œå¯ä»¥å®ç°æ‹æ‘„ç‰©ä½“æ¸…æ™°ï¼Œè€Œå…¶ä»–èƒŒæ™¯æ¨¡ç³Šï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸æœºè¿æ‹åŠŸèƒ½å®ç°è¯¥æ•ˆæœ\n\t- ç€‘å¸ƒæ°´æµæ‹‰ä¸æ•ˆæœï¼š **å¿«é—¨å¸¸ç”¨ 5~10s** é…åˆå‡å…‰é•œç¨³å®šæ‹æ‘„ï¼ˆä¸‰è„šæ¶ï¼‰ã€‚æˆ–è€…è°ƒæ•´å…‰åœˆf/22å·¦å³\n\t- è½¦è½¨ çƒŸèŠ±ï¼š**å¿«é—¨å¸¸ç”¨ 5~10s** ç¨³å®šæ‹æ‘„ï¼ˆä¸‰è„šæ¶ï¼‰ã€‚è°ƒæ•´å…‰åœˆf/16é…åˆã€‚\n\n### å¿«é—¨ä¼˜å…ˆï¼ˆTV/Sï¼‰\n\n- åªéœ€è°ƒæ•´å¿«é—¨é€Ÿåº¦\n- ä¸ºæ»¡è¶³æ—¥å¸¸çš„ é£å…‰æ‹æ‘„ å’Œ è¿åŠ¨æ‘„å½±\n\n### ç»ƒä¹ \n1. é«˜é€Ÿè¿åŠ¨çš„ç‰©ä½“\n2. è¿½ç„¦æ‹æ‘„ï¼ˆæ‘‡æ‹ï¼‰\n3. è½¦è½¨\n\n![å¿«é—¨çš„é€‰æ‹©](Snipaste_2025-01-19_17-05-08.png)\n\n---\n\n## è®¤è¯†å…‰åœˆ\n\n- æ§åˆ¶è¿›å…‰é‡çš„è£…ç½®\n\n### å…‰åœˆå½±å“è¿›å…‰é‡\n\n- ![](Snipaste_2025-01-19_15-49-45.png)\n- ä¸åŒçš„æ›å…‰çŠ¶æ€ï¼šæ¬ æ›ã€è¿‡æ›\n- **å…‰åœˆä¼šå’Œå¿«é—¨é€Ÿåº¦ä¸€èµ·å½±å“è¿›å…‰é‡**\n\n### å…‰åœˆå½±å“æ™¯æ·±\n\n- ![](Snipaste_2025-01-19_15-55-04.png)\n- å…‰åœˆçš„è¿ç”¨ï¼š #æ‹æ‘„æŠ€å·§ \n\t- **å¤§å…‰åœˆçš„è·‘ç„¦é—®é¢˜**ã€‚ä½¿ç”¨è¶…å¤§å…‰åœˆé•œå¤´æ—¶ï¼Œæœ€å¥½ä¸è¦ä½¿ç”¨æœ€å¤§å…‰åœˆå»æ‹ï¼Œé™ä½ä¸€ä¸ªæŒ¡ä½ã€‚\n\t- æœ‰æ—¶**ä¸»é¢˜çªå‡º**ä½¿ç”¨å¤§å…‰åœˆ\n\t\t- ![](Snipaste_2025-01-19_16-00-53.png)\n\t- æ‹äººåƒæ—¶**ä¸è¦ä¸€å‘³çš„ä½¿ç”¨æ™¯æ·±æ•ˆæœ**ï¼ˆä¸ºäº†çªå‡ºä¸»é¢˜è€Œçªå‡ºä¸»ä½“ï¼‰ï¼šéœ€è¦ç»“åˆç¯å¢ƒï¼Œæœ‰äº›æƒ…å†µéœ€è¦ç¯å¢ƒé…åˆæˆ–äº¤ä»£ç¯å¢ƒ\n\t\t- ![](Snipaste_2025-01-19_16-04-53.png)\n\t- æœ‰æ—¶éœ€è¦**å…¨å±€æ¸…æ™°**ä½¿ç”¨å°å…‰åœˆ è¡¨ç°å¤§ç¯å¢ƒ\n\t\t- ![](Snipaste_2025-01-19_16-06-22.png)\n### æœ€ä½³ç”»è´¨å…‰åœˆ\n\n- ä¸€èˆ¬åœ¨æœ€å¤§å…‰åœˆç¼©å°2~3æ¡£ä½\n\n### å…‰åœˆä¼˜å…ˆï¼ˆAV/Aï¼‰\n\n- æ‰‹åŠ¨è°ƒæ•´å…‰åœˆ\n- æ»¡è¶³äºæ—¥å¸¸çš„äººåƒæ‹æ‘„ã€é™ç‰©æ‹æ‘„\n\n### ç»ƒä¹ \n\n- è™šåŒ–æ•ˆæœçš„å°èŠ±\n\n---\n\n## è®¤è¯†æ„Ÿå…‰åº¦ï¼ˆISOï¼‰\n\n- æ„Ÿå…‰å™¨ä»¶å¯¹å…‰çš„æ•æ„Ÿç¨‹åº¦\n- æ§åˆ¶äº®åº¦å’Œæˆç‰‡è´¨é‡\n- æ•°å€¼è¶Šå¤§ï¼Œæ„Ÿå…‰åº¦é«˜ï¼Œé‚£ä¹ˆç”»é¢äº®\n\n### ISOå½±å“ç”»è´¨ï¼ˆå™ªç‚¹ï¼‰\n\n- ![](Snipaste_2025-01-19_16-38-20.png)\n\n - æ„Ÿå…‰åº¦çš„è¿ç”¨ #æ‹æ‘„æŠ€å·§ \n\t - **å¯¹äºISOï¼Œå…¶ä½œç”¨ç›¸å½“äºç»™ä½ ä¸€ç›ç¯ï¼Œåœ¨é»‘æš—ç¯å¢ƒä¸‹æˆ‘ä»¬éœ€è¦æ‰“å¼€ç¯çœ‹æ¸…ç”»é¢ï¼Œç¯çš„åŠŸç‡æœ‰ä¸åŒçš„ç“¦æ•°ã€‚**\n\t - é€šå¸¸æƒ…å†µ\n\t\t - ![](Snipaste_2025-01-19_16-41-30.png)\n\t - è¿‡æš—ç¯å¢ƒ ISOå¤ªé«˜å¯¼è‡´å™ªç‚¹\n\t\t - å…¼é¡¾ç”»è´¨å’Œç”»é¢ï¼š**è¡¥å…‰** é—ªå…‰ç¯ã€å¸¸äº®ç¯\n\t\t - ç”»é¢ä¼˜å…ˆï¼šæé«˜ISO\n\t- æƒ³è¦å¤å¤æ„Ÿï¼Œæƒ³è¦å™ªç‚¹ï¼šä¸»åŠ¨æé«˜ISO\n\n---\n\n## æ›å…‰ä¸‰è¦ç´ çš„ç»“åˆä½¿ç”¨\n\n![](Snipaste_2025-01-19_17-03-48.png)\n\n### åœ¨ä¸€ä¸ªé˜³å…‰ç¿çƒ‚çš„ä¸­åˆæ‹æ‘„æœ‰è™šåŒ–æ•ˆæœçš„å°èŠ±\n\n- é¦–å…ˆå…‰åœˆè¦å¤§ä¸€ç‚¹ï¼Œæ‰æœ‰è™šåŒ–æ•ˆæœï¼Œé™æ­¢ç‰©ä½“ï¼Œä¸éœ€è¦é«˜é€Ÿæˆ–ä½é€Ÿå¿«é—¨ï¼Œå®¤å¤–é˜³å…‰å¤©æ°”å…‰çº¿å……è¶³ï¼ŒISOè°ƒåˆ°æœ€å°\n- f/1.8 1/500 100\n- æ²¡æœ‰å¤§å…‰åœˆï¼Œæ€ä¹ˆåŠ #æ‹æ‘„æŠ€å·§ \n\t- ä¸»ä½“ç¦»èƒŒæ™¯è¶³å¤Ÿè¿œï¼Œä¹Ÿä¼šæœ‰è™šåŒ–æ•ˆæœ\n- æ„Ÿè§‰å¯ä»¥ä½¿ç”¨å…‰åœˆAä¼˜å…ˆã€‚ã€‚\n\n### æ‹æ‘„äººåœ¨å¤œæ™šè·‘æ­¥\n\n- å¤œæ™šç¯å¢ƒè¾ƒæš—ï¼Œä½¿ç”¨è¾ƒå¤§å…‰åœˆæé«˜è¿›å…‰é‡ï¼Œä½†æ˜¯å¤ªå¤§ä¼šè·‘ç„¦ï¼Œæ‹æ‘„è¿åŠ¨çš„ç‰©ä½“ï¼Œå¿«é—¨speeçš„å¿«ä¸€ç‚¹ï¼Œä½†æ˜¯å¿«é—¨å¤ªå¿«ç”»é¢å¤ªæš—ï¼Œäºæ˜¯è°ƒé«˜æ„Ÿå…‰åº¦\n- f/2.8 1/250 800\n- ä¸ªäººæ„Ÿè§‰å¯ä»¥ä½¿ç”¨å¿«é—¨Sä¼˜å…ˆã€‚ã€‚\n","tags":["æ‘„å½±åŸºç¡€","å­¦ä¹ ç¬”è®°","æ›å…‰ä¸‰è¦ç´ "],"categories":["æ‘„å½±å­¦ä¹ "]}]
<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>GoDm@&#39;s Blog</title>
  
  <subtitle>è®°å½•è‡ªå·±æ‰€çˆ±ã€‚</subtitle>
  <link href="https://blog.godmao.top/atom.xml" rel="self"/>
  
  <link href="https://blog.godmao.top/"/>
  <updated>2025-10-14T12:13:45.233Z</updated>
  <id>https://blog.godmao.top/</id>
  
  <author>
    <name>GoDm@</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è®°å½•æ­å»ºä¸€å°äº‘æœåŠ¡å™¨ç¯å¢ƒçš„è¿‡ç¨‹</title>
    <link href="https://blog.godmao.top/posts/2446/"/>
    <id>https://blog.godmao.top/posts/2446/</id>
    <published>2025-10-14T06:07:43.000Z</published>
    <updated>2025-10-14T12:13:45.233Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><ul><li><a href="#1-%E5%89%8D%E8%A8%80">1. å‰è¨€</a></li><li><a href="#2-%E6%93%8D%E4%BD%9C%E4%B9%A0%E6%83%AF%E9%83%A8%E5%88%86">2. æ“ä½œä¹ æƒ¯éƒ¨åˆ†</a><ul><li><a href="#21-%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%BA%E5%90%8D">2.1. ä¿®æ”¹ä¸»æœºå</a></li><li><a href="#22-%E9%85%8D%E7%BD%AE%E6%97%B6%E5%8C%BA">2.2. é…ç½®æ—¶åŒº</a></li></ul></li><li><a href="#3-%E5%AE%89%E5%85%A8%E9%83%A8%E5%88%86">3. ğŸ”å®‰å…¨éƒ¨åˆ†</a><ul><li><a href="#31-%E9%87%8D%E6%96%B0%E8%AE%BE%E7%BD%AEroot%E5%AF%86%E7%A0%81%E4%B8%BA%E5%BC%BA%E5%AF%86%E7%A0%81">3.1. é‡æ–°è®¾ç½®rootå¯†ç ä¸ºå¼ºå¯†ç </a></li><li><a href="#32-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%B9%B6%E8%AE%BE%E7%BD%AE%E5%BC%BA%E5%AF%86%E7%A0%81">3.2. æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¼ºå¯†ç </a></li><li><a href="#33-%E7%B3%BB%E7%BB%9F%E5%8D%87%E7%BA%A7">3.3. ç³»ç»Ÿå‡çº§</a></li><li><a href="#34-%E4%BD%BF%E7%94%A8ssh-key%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95%E8%80%8C%E4%B8%8D%E6%98%AF%E5%AF%86%E7%A0%81">3.4. ä½¿ç”¨SSH Keyè¿œç¨‹ç™»å½•è€Œä¸æ˜¯å¯†ç </a><ul><li><a href="#341-%E5%9C%A8%E6%9C%AC%E5%9C%B0%E7%94%B5%E8%84%91%E4%B8%8A%E7%94%9F%E6%88%90%E5%AF%86%E5%8C%99%E5%AF%B9">3.4.1. åœ¨æœ¬åœ°ç”µè„‘ä¸Šç”Ÿæˆå¯†åŒ™å¯¹ï¼š</a></li><li><a href="#342-%E5%88%9B%E5%BB%BAconfig%E6%96%87%E4%BB%B6">3.4.2. åˆ›å»ºconfigæ–‡ä»¶</a></li><li><a href="#343-%E5%A4%8D%E5%88%B6%E5%85%AC%E5%8C%99%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8">3.4.3. å¤åˆ¶å…¬åŒ™åˆ°æœåŠ¡å™¨</a></li><li><a href="#344-%E7%99%BB%E5%BD%95">3.4.4. ç™»å½•</a></li></ul></li><li><a href="#35-%E6%94%B9ssh%E7%AB%AF%E5%8F%A3%E9%85%8D%E7%BD%AE%E9%98%B2%E7%81%AB%E5%A2%99">3.5. æ”¹sshç«¯å£&amp;é…ç½®é˜²ç«å¢™</a><ul><li><a href="#351-%E5%88%9D%E6%AD%A5%E9%85%8D%E7%BD%AE">3.5.1. åˆæ­¥é…ç½®</a></li><li><a href="#352-%E6%94%B9ssh%E7%AB%AF%E5%8F%A3">3.5.2. æ”¹SSHç«¯å£</a></li><li><a href="#353-%E5%85%B3%E9%97%AD22%E7%AB%AF%E5%8F%A3">3.5.3. å…³é—­22ç«¯å£</a></li></ul></li><li><a href="#36-ssh%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">3.6. sshé…ç½®æ–‡ä»¶</a><ul><li><a href="#361-%E7%A6%81%E7%94%A8-root%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95">3.6.1. ç¦ç”¨ rootè¿œç¨‹ç™»å½•&amp;å¯†ç ç™»å½•</a></li><li><a href="#362-%E4%BD%BF%E7%94%A8ssh2">3.6.2. ä½¿ç”¨SSH2</a></li><li><a href="#363-%E9%87%8D%E5%90%AFssh">3.6.3. é‡å¯ssh</a></li></ul></li><li><a href="#37-fail2ban%E5%B7%A5%E5%85%B7%E9%98%B2%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3">3.7. Fail2banå·¥å…·é˜²æš´åŠ›ç ´è§£</a><ul><li><a href="#371-%E9%85%8D%E7%BD%AEfail2ban">3.7.1. é…ç½®fail2ban</a></li><li><a href="#372-%E6%9F%A5%E7%9C%8B%E7%8A%B6%E6%80%81">3.7.2. æŸ¥çœ‹çŠ¶æ€</a></li><li><a href="#373-%E8%A7%A3%E5%B0%81ip">3.7.3. è§£å°ip</a></li><li><a href="#374-%E5%90%AF%E7%94%A8fail2ban">3.7.4. å¯ç”¨fail2ban</a></li><li><a href="#375-%E5%B0%8F%E8%B4%B4%E5%A3%AB">3.7.5. å°è´´å£«</a></li></ul></li></ul></li><li><a href="#4-%E7%B3%BB%E7%BB%9F%E7%BB%B4%E6%8A%A4%E9%83%A8%E5%88%86">4. ç³»ç»Ÿç»´æŠ¤éƒ¨åˆ†</a><ul><li><a href="#41-%E4%BD%BF%E7%94%A8expkg">4.1. <s>ä½¿ç”¨expkg</s></a></li></ul></li><li><a href="#5-%E7%B3%BB%E7%BB%9F%E8%BF%90%E8%A1%8C%E9%83%A8%E5%88%86">5. ç³»ç»Ÿè¿è¡Œéƒ¨åˆ†</a></li></ul><h2 id="1-å‰è¨€"><a class="markdownIt-Anchor" href="#1-å‰è¨€"></a> 1. å‰è¨€</h2><p>å‰å‡ å¤©åœ¨ä¸ƒç‰›äº‘ç§Ÿäº†ä¸€å°è½»é‡åº”ç”¨çº§æœåŠ¡å™¨ï¼Œ2c4gbï¼Œè¶³å¤Ÿæ»¡è¶³ç©å…·çš„éœ€æ±‚äº†ã€‚ç¬¬ä¸€æ¬¡ç©æœåŠ¡å™¨ï¼Œç°åœ¨æŠŠè‡ªå·±çš„æ­å»ºç¯å¢ƒçš„è¿‡ç¨‹è®°å½•ä¸€ä¸‹ï¼Œæ–¹ä¾¿æ—¥åæ“ä½œã€‚</p><p>äº‘æœåŠ¡å™¨ç³»ç»Ÿï¼šUbuntu 24.04 LTS<br />äº‘æœåŠ¡å™¨å‚å•†ï¼šä¸ƒç‰›äº‘<br />äº‘æœåŠ¡å™¨è§„æ ¼ï¼šè½»é‡å‹ T1 2C4GB CPUå‹</p><h2 id="2-æ“ä½œä¹ æƒ¯éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#2-æ“ä½œä¹ æƒ¯éƒ¨åˆ†"></a> 2. æ“ä½œä¹ æƒ¯éƒ¨åˆ†</h2><h3 id="21-ä¿®æ”¹ä¸»æœºå"><a class="markdownIt-Anchor" href="#21-ä¿®æ”¹ä¸»æœºå"></a> 2.1. ä¿®æ”¹ä¸»æœºå</h3><p>sshç™»å½•åˆ°æœåŠ¡å™¨åï¼Œå‘ç°ä¸»æœºåæ˜¯ä¸€å¨ä¹±ç ï¼Œçœ‹ç€å¤ªéš¾å—äº†ï¼Œå¿…é¡»æ”¹äº†ã€‚<br /><img src="Snipaste_2025-10-14_14-17-13.png" alt="" /></p><p>æ°¸ä¹…ä¿®æ”¹ä¸»æœºåå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> hostnamectl set-hostname myserver<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‡å¯ç”Ÿæ•ˆã€‚</p><h3 id="22-é…ç½®æ—¶åŒº"><a class="markdownIt-Anchor" href="#22-é…ç½®æ—¶åŒº"></a> 2.2. é…ç½®æ—¶åŒº</h3><p>è¾“å…¥ <code>date</code> å‘½ä»¤ï¼Œå‘ç°æœåŠ¡å™¨ä½¿ç”¨çš„ä¸–ç•Œåè°ƒæ—¶ï¼ˆUTCï¼‰ï¼Œæ”¹ä¸ºä¸­å›½æ ‡å‡†æ—¶ï¼ˆUTC+8ï¼‰ï¼Œç¬¦åˆä¹ æƒ¯ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> timedatectl set-timezone Asia/Shanghai<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿è¡Œåï¼Œä½¿ç”¨  <code>timedatectl</code> å‘½ä»¤ç¡®è®¤æ˜¯å¦ä¿®æ”¹æˆåŠŸï¼Œå¹¶æŸ¥çœ‹ <code>NTP service</code> æ˜¯å¦å¯ç”¨ï¼Œè¿™æ˜¯è‡ªåŠ¨åŒæ­¥ç½‘ç»œæ—¶é—´ï¼Œå¯ä¿æŒæ—¶é—´ç²¾å‡†ã€‚è‹¥æœªå¯ç”¨åˆ™éœ€æŸ¥è¯¢ç›¸å…³æ•™ç¨‹å¯ç”¨ã€‚</p><h2 id="3-å®‰å…¨éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#3-å®‰å…¨éƒ¨åˆ†"></a> 3. ğŸ”å®‰å…¨éƒ¨åˆ†</h2><p>æ­¤éƒ¨åˆ†éœ€æ ¼å¤–é‡è§†ï¼</p><h3 id="31-é‡æ–°è®¾ç½®rootå¯†ç ä¸ºå¼ºå¯†ç "><a class="markdownIt-Anchor" href="#31-é‡æ–°è®¾ç½®rootå¯†ç ä¸ºå¼ºå¯†ç "></a> 3.1. é‡æ–°è®¾ç½®rootå¯†ç ä¸ºå¼ºå¯†ç </h3><p>ä¸ç”¨å¤šè¯´ï¼Œ<code>passwd</code> å‘½ä»¤å³å¯ã€‚</p><h3 id="32-æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¼ºå¯†ç "><a class="markdownIt-Anchor" href="#32-æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¼ºå¯†ç "></a> 3.2. æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®å¼ºå¯†ç </h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">adduser yourname<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ·»åŠ åˆ°sudoç»„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">sudo</span> yourname<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥çœ‹ç”¨æˆ·ç»„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /etc/group<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥çœ‹å½“å‰ç”¨æˆ·æ‰€å±ç»„ï¼š<code>groups</code>å‘½ä»¤ã€‚</p><blockquote><p>è®¾ç½®å®Œæˆåï¼Œé€€å‡ºrootç”¨æˆ·ç™»å½•ï¼Œç”¨SSHä»¥æ™®é€šç”¨æˆ·é‡æ–°ç™»å½•åˆ°æœåŠ¡å™¨ã€‚</p></blockquote><h3 id="33-ç³»ç»Ÿå‡çº§"><a class="markdownIt-Anchor" href="#33-ç³»ç»Ÿå‡çº§"></a> 3.3. ç³»ç»Ÿå‡çº§</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span class="token function">sudo</span> <span class="token function">apt</span> upgrade<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="34-ä½¿ç”¨ssh-keyè¿œç¨‹ç™»å½•è€Œä¸æ˜¯å¯†ç "><a class="markdownIt-Anchor" href="#34-ä½¿ç”¨ssh-keyè¿œç¨‹ç™»å½•è€Œä¸æ˜¯å¯†ç "></a> 3.4. ä½¿ç”¨SSH Keyè¿œç¨‹ç™»å½•è€Œä¸æ˜¯å¯†ç </h3><p>SSH Key ç™»å½•æ¯”å¯†ç å®‰å…¨å¾ˆå¤šï¼Œå‡ ä¹æ— æ³•ç ´è§£ã€‚æœ¬è´¨å°±æ˜¯è®©æœåŠ¡å™¨è¯†åˆ«ä½ çš„ç”µè„‘ï¼Œåªæœ‰ä½ çš„ç”µè„‘æ‰èƒ½ç™»å½•åˆ°æœåŠ¡å™¨ã€‚</p><h4 id="341-åœ¨æœ¬åœ°ç”µè„‘ä¸Šç”Ÿæˆå¯†åŒ™å¯¹"><a class="markdownIt-Anchor" href="#341-åœ¨æœ¬åœ°ç”µè„‘ä¸Šç”Ÿæˆå¯†åŒ™å¯¹"></a> 3.4.1. åœ¨æœ¬åœ°ç”µè„‘ä¸Šç”Ÿæˆå¯†åŒ™å¯¹ï¼š</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh-keygen <span class="token parameter variable">-t</span> rsa <span class="token parameter variable">-b</span> <span class="token number">4096</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>-t</code>ï¼šæŒ‡å®šå¯†åŒ™ç±»å‹ï¼Œrsaæ˜¯ç»å…¸ç®—æ³•ï¼Œå…¼å®¹æ€§å¥½ã€‚</li><li><code>-b</code>ï¼šæŒ‡å®šå¯†åŒ™é•¿åº¦ä¸º4096ä½ã€‚</li></ul><p>å®ƒä¼šæç¤ºä½ å‡ ä¸ªé—®é¢˜ï¼š</p><pre class="line-numbers language-none"><code class="language-none">Generating public&#x2F;private rsa key pair. Enter file in which to save the key (&#x2F;home&#x2F;yourname&#x2F;.ssh&#x2F;id_rsa):<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ—¶å€™ï¼š</p><ul><li><strong>ç›´æ¥å›è½¦</strong> å°±ä¼šæŠŠå¯†é’¥ç”Ÿæˆåœ¨é»˜è®¤ä½ç½®ï¼š<ul><li>ç§é’¥ï¼š<code>~/.ssh/id_rsa</code> ï¼Œ<strong>ç»å¯¹ä¸èƒ½æ³„éœ²ï¼</strong></li><li>å…¬é’¥ï¼š`~/.ssh/id_rsa.pub</li></ul></li><li><strong>æˆ–è€…</strong>æŒ‡å®šä½ç½®åŠæ–‡ä»¶åã€‚<br />æ¥ç€ä¼šæç¤ºï¼š</li></ul><pre class="line-numbers language-none"><code class="language-none">Enter passphrase (empty for no passphrase):<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œä½ å¯ä»¥é€‰æ‹©ï¼š</p><ul><li><strong>ç›´æ¥å›è½¦</strong>ï¼šä¸è®¾ç½®å¯†ç ï¼Œç™»å½•æ›´æ–¹ä¾¿ï¼›</li><li><strong>è¾“å…¥å¯†ç çŸ­è¯­</strong>ï¼šå¤šä¸€å±‚ä¿æŠ¤ï¼ˆæ¯æ¬¡ç”¨ç§é’¥ç™»å½•éƒ½è¦è¾“å…¥è¿™ä¸²å¯†ç ï¼‰ã€‚</li></ul><h4 id="342-åˆ›å»ºconfigæ–‡ä»¶"><a class="markdownIt-Anchor" href="#342-åˆ›å»ºconfigæ–‡ä»¶"></a> 3.4.2. åˆ›å»ºconfigæ–‡ä»¶</h4><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬ä¸åªæœ‰ä¸€ä¸ªsshå¯†åŒ™å¯¹ï¼Œæ¯”å¦‚æˆ‘ä¸ºgithubç”Ÿæˆäº†ä¸€ä¸ªå¯†åŒ™å¯¹ï¼Œä¹Ÿç»™æœåŠ¡å™¨ç”Ÿæˆäº†ä¸€ä¸ªã€‚å¦‚æœä½¿ç”¨äº†éé»˜è®¤åç§°çš„å¯†é’¥æ–‡ä»¶ï¼Œéœ€è¦åœ¨Â <em>~/.ssh/config</em>Â æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚</p><p>åœ¨æœ¬åœ°ä¿å­˜sshå¯†åŒ™å¯¹æ–‡ä»¶çš„æ–‡ä»¶å¤¹é‡Œï¼Œæ‰“å¼€æˆ–åˆ›å»ºåä¸º <code>config</code> çš„æ–‡ä»¶ï¼Œæ— éœ€åç¼€åã€‚ç¼–è¾‘è¯¥æ–‡ä»¶ï¼Œç¤ºä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none"># GitHubï¼ˆå¸¸è§ï¼‰Host github.com  HostName github.com  User git  IdentityFile ~&#x2F;.ssh&#x2F;id_ed25519_github  IdentitiesOnly yes# æˆ‘çš„æœåŠ¡å™¨Host myserver #ä½ çš„ä¸»æœºå  HostName 1.2.3.4 #ä¸»æœºipåœ°å€&#x2F;åŸŸå  User someone #ä½ è¦ç™»å½•çš„ç”¨æˆ·  Port 22        # å¦‚æœä½ æ”¹è¿‡SSHç«¯å£å°±å†™ä¸Šï¼Œé»˜è®¤22  IdentityFile ~&#x2F;.ssh&#x2F;id_rsa_server  IdentitiesOnly yes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>Host</code></td><td>è‡ªå®šä¹‰çš„åˆ«åï¼ˆå¯ä»¥éšæ„èµ·åï¼‰</td></tr><tr><td><code>HostName</code></td><td>å®é™…çš„æœåŠ¡å™¨åŸŸåæˆ– IP åœ°å€</td></tr><tr><td><code>User</code></td><td>ç™»å½•ç”¨æˆ·å</td></tr><tr><td><code>Port</code></td><td>SSH ç«¯å£ï¼ˆæ²¡æ”¹çš„è¯é»˜è®¤ 22ï¼‰</td></tr><tr><td><code>IdentityFile</code></td><td>ç§é’¥æ–‡ä»¶è·¯å¾„</td></tr><tr><td><code>IdentitiesOnly yes</code></td><td>åªä½¿ç”¨æŒ‡å®šçš„ç§é’¥ï¼Œé¿å…è‡ªåŠ¨å°è¯•å…¶ä»– key å¯¼è‡´æ‹’ç»</td></tr></tbody></table><h4 id="343-å¤åˆ¶å…¬åŒ™åˆ°æœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#343-å¤åˆ¶å…¬åŒ™åˆ°æœåŠ¡å™¨"></a> 3.4.3. å¤åˆ¶å…¬åŒ™åˆ°æœåŠ¡å™¨</h4><p>æ–¹å¼1</p><hr /><p>åœ¨æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¿å­˜sshå…¬åŒ™ï¼ŒæœåŠ¡å™¨ç”¨å®ƒæ¥è¯†åˆ«è¿œç¨‹ç™»å½•åˆ°å®ƒçš„ç”µè„‘ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> ~/.ssh<span class="token function">touch</span> ~/.ssh/authorized_keys<span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">700</span> ~/.ssh<span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">600</span> ~/.ssh/authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹‹åä½¿ç”¨nanoç¼–è¾‘å™¨ï¼Œå°†æœ¬åœ°çš„.pubæ–‡ä»¶é‡Œçš„å†…å®¹å¤åˆ¶åˆ°authorized_keyså³å¯ã€‚</p><blockquote><ul><li><strong>åƒä¸‡åˆ«ä¸Šä¼ ç§é’¥</strong>ï¼ˆä¾‹å¦‚ <code>id_rsa</code>ã€<code>id_ed25519</code>ï¼‰ã€‚åªä¼  <code>*.pub</code>ã€‚</li><li><strong>æƒé™å¿…é¡»æ­£ç¡®</strong>ï¼š- ç¡®ä¿æœåŠ¡å™¨ <code>~/.ssh</code> æƒé™æ˜¯ <code>700</code>ï¼Œ<code>~/.ssh/authorized_keys</code> æƒé™æ˜¯ <code>600</code>ï¼Œå¦åˆ™ SSH ä¼šæ‹’ç»ä½¿ç”¨å¯†é’¥ã€‚</li><li><strong>æ¯ä¸ªå…¬é’¥ä¸€è¡Œ</strong>ï¼Œä¸è¦æ’å…¥æ¢è¡Œæˆ–ç©ºæ ¼ã€‚<code>authorized_keys</code> å¯åŒ…å«å¤šæŠŠå…¬é’¥ï¼ˆå¤šå°ç”µè„‘å¯å…±ç”¨ï¼‰ã€‚</li></ul></blockquote><p>æ–¹å¼2</p><hr /><p>windowå¯ä½¿ç”¨gitbashã€‚linuxç›´æ¥è¾“å…¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/id_rsa_server.pub root@SERVER_IP<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>-i</code> åé¢æ˜¯ä½ æœ¬åœ°çš„å…¬é’¥æ–‡ä»¶ï¼ˆæ¯”å¦‚ <code>~/.ssh/id_rsa_server.pub</code>ï¼‰ã€‚</li><li>è¿è¡Œä¼šæç¤ºè¾“å…¥æœåŠ¡å™¨å¯†ç ï¼Œç„¶åæŠŠå…¬é’¥è¿½åŠ åˆ°æœåŠ¡å™¨ <code>~/.ssh/authorized_keys</code>ã€‚<br /><strong>æ³¨æ„ä¸è¦é”™ä¼ æˆç§åŒ™ï¼</strong></li></ul><hr /><h4 id="344-ç™»å½•"><a class="markdownIt-Anchor" href="#344-ç™»å½•"></a> 3.4.4. ç™»å½•</h4><p>å°è¯•åœ¨æœ¬åœ°sshç™»å½•ã€‚æ­£å¸¸çš„è¯ä¸ç”¨è¾“å¯†ç å°±å¯ä»¥ç›´æ¥ç™»é™†ä¸Šï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> Host<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="35-æ”¹sshç«¯å£é…ç½®é˜²ç«å¢™"><a class="markdownIt-Anchor" href="#35-æ”¹sshç«¯å£é…ç½®é˜²ç«å¢™"></a> 3.5. æ”¹sshç«¯å£&amp;é…ç½®é˜²ç«å¢™</h3><blockquote><p>è­¦å‘Šï¼šæ­¤æ­¥æ“ä½œéœ€è¦è°¨æ…ï¼Œè‡³å°‘ä¿ç•™ä¸€ä¸ªå·²ç™»å½•çš„sshç»ˆç«¯ï¼Œå¦åˆ™å¦‚æœæ“ä½œä¸å½“ä¼šå¯¼è‡´è¢«é”ï¼ˆæ— æ³•ç™»å½•åˆ°æœåŠ¡å™¨ï¼‰ï¼Œæ­£ç¡®é…ç½®ä¹‹å‰å…ˆä¸è¦å¯ç”¨é˜²ç«å¢™ã€‚</p></blockquote><h4 id="351-åˆæ­¥é…ç½®"><a class="markdownIt-Anchor" href="#351-åˆæ­¥é…ç½®"></a> 3.5.1. åˆæ­¥é…ç½®</h4><p>Ubuntu å†…ç½®äº†UFWé˜²ç«å¢™ã€‚é€šè¿‡é˜²ç«å¢™ï¼Œå°½å¯èƒ½å°‘çš„æš´éœ²ç«¯å£ï¼Œæå‡å®‰å…¨æ€§ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆå…è®¸ä»¥ä¸‹ç«¯å£ï¼š</p><ul><li>22ç«¯å£ï¼šSSHé»˜è®¤ç«¯å£</li><li>80ç«¯å£ï¼šHTTPæœåŠ¡ï¼Œå¦‚æœä½ åœ¨æœåŠ¡å™¨ä¸Šæ¶ç½‘ç«™ï¼Œè¿™ä¸ªç«¯å£å¿…é¡»å¼€æ”¾ã€‚</li><li>443ç«¯å£ï¼šHTTPSæœåŠ¡</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ufw default deny incoming<span class="token function">sudo</span> ufw default allow outgoing<span class="token function">sudo</span> ufw allow <span class="token number">22</span>/tcp    <span class="token comment"># SSHç«¯å£</span><span class="token function">sudo</span> ufw allow <span class="token number">80</span>/tcp      <span class="token comment"># HTTP</span><span class="token function">sudo</span> ufw allow <span class="token number">443</span>/tcp     <span class="token comment"># HTTPS</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>sudo ufw default deny incoming</code>ï¼šé»˜è®¤æ‹’ç»æ‰€æœ‰è¿›å…¥æœåŠ¡å™¨çš„æµé‡ï¼ˆincoming trafficï¼‰ã€‚é™¤éä½ æ˜ç¡®å…è®¸æŸä¸ªç«¯å£ï¼Œå¦åˆ™å¤–éƒ¨æ— æ³•è¿æ¥åˆ°ä½ çš„æœåŠ¡å™¨ã€‚<br /><code>sudo ufw default allow outgoing</code>ï¼šé»˜è®¤å…è®¸æœåŠ¡å™¨å‘å‡ºçš„æ‰€æœ‰æµé‡ï¼ˆoutgoing trafficï¼‰ã€‚æœåŠ¡å™¨å¯ä»¥è‡ªç”±è®¿é—®å¤–éƒ¨ç½‘ç»œï¼ˆæ¯”å¦‚ä¸‹è½½æ›´æ–°ã€è®¿é—® API ç­‰ï¼‰ã€‚</p><h4 id="352-æ”¹sshç«¯å£"><a class="markdownIt-Anchor" href="#352-æ”¹sshç«¯å£"></a> 3.5.2. æ”¹SSHç«¯å£</h4><blockquote><p><strong>æ³¨æ„</strong>ï¼šä¿ç•™ä¸€ä¸ªå·²ç»ç™»å½•çš„ SSH çª—å£ï¼Œå…ˆæµ‹è¯•æ–°ç«¯å£å¯ç”¨å†å…³é—­æ—§çª—å£ï¼Œé¿å…è‡ªå·±è¢«é”ã€‚</p></blockquote><p>ä¸ä½¿ç”¨é»˜è®¤SSHç«¯å£ç™»å½•ï¼Œæé«˜å®‰å…¨æ€§ã€‚</p><ol><li>ç¼–è¾‘ SSH é…ç½®ï¼š</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /etc/ssh/sshd_config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰¾åˆ°ï¼š<code>#Port 22</code><br />ä¿®æ”¹ä¸ºï¼š<code>Port your_ssh_port</code></p><blockquote><p>å»ºè®® SSH æ”¹åˆ° <strong>1024 ä»¥ä¸Šï¼Œæœ€å¥½ 2000~65000 çš„èŒƒå›´</strong>ï¼Œä¾‹å¦‚ 2222ã€22022ã€55222ã€‚</p></blockquote><ol start="2"><li>é˜²ç«å¢™å…è®¸è¯¥ç«¯å£å¹¶å¯ç”¨é˜²ç«å¢™</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ufw allow your_ssh_port/tcp<span class="token function">sudo</span> ufw <span class="token builtin class-name">enable</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿è¡Œ <code>sudo ufw status</code> å‘½ä»¤æ£€æŸ¥é˜²ç«å¢™è§„åˆ™ã€‚<br />åº”è¯¥æ˜¾ç¤ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">To                         Action      From--                         ------      ----22&#x2F;tcp                     ALLOW       Anywhere80&#x2F;tcp                     ALLOW       Anywhere443&#x2F;tcp                    ALLOW       Anywhereyour_ssh_port&#x2F;tcp          ALLOW       Anywhere22&#x2F;tcp (v6)                ALLOW       Anywhere (v6)80&#x2F;tcp (v6)                ALLOW       Anywhere (v6)443&#x2F;tcp (v6)               ALLOW       Anywhere (v6)your_ssh_port&#x2F;tcp (v6)     ALLOW       Anywhere (v6)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><p>é‡å¯ SSHï¼š<br /><code>sudo systemctl restart ssh</code></p></li><li><p>æµ‹è¯•æ–°ç«¯å£ï¼š<br /><code>ssh -p your_ssh_port root@SERVER_IP</code></p></li></ol><p>å¦‚æœç¬¬å››æ­¥è®¿é—®è¢«æ‹’ç»ï¼Œåˆ«æ…Œï¼Œä½¿ç”¨å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> sshd <span class="token parameter variable">-T</span> <span class="token operator">|</span> <span class="token function">grep</span> port<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœè¾“å‡ºçš„æ˜¯ä½ è®¾å®šçš„ç«¯å£å·ï¼Œ<strong>ä¸”ufwä¸­å…è®¸äº†è®¾å®šç«¯å£</strong>ï¼Œé‚£ä¹ˆå¯ä»¥å¿½ç•¥ä¿ç•™sshçª—å£çš„noteï¼Œç›´æ¥é‡å¯äº‘æœåŠ¡å™¨ï¼Œé‡æ–°ä»¥æ–°ç«¯å£å·ç™»å½•ï¼Œåº”è¯¥å¯ä»¥æˆåŠŸã€‚</p><h4 id="353-å…³é—­22ç«¯å£"><a class="markdownIt-Anchor" href="#353-å…³é—­22ç«¯å£"></a> 3.5.3. å…³é—­22ç«¯å£</h4><p>æˆåŠŸç™»å½•åï¼Œå¯ä»¥å…³é—­22ç«¯å£äº†</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ufw delete allow <span class="token number">22</span>/tcp<span class="token function">sudo</span> ufw reload<span class="token function">sudo</span> ufw status<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="36-sshé…ç½®æ–‡ä»¶"><a class="markdownIt-Anchor" href="#36-sshé…ç½®æ–‡ä»¶"></a> 3.6. sshé…ç½®æ–‡ä»¶</h3><p>ä¾æ—§ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /etc/ssh/sshd_config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="361-ç¦ç”¨-rootè¿œç¨‹ç™»å½•å¯†ç ç™»å½•"><a class="markdownIt-Anchor" href="#361-ç¦ç”¨-rootè¿œç¨‹ç™»å½•å¯†ç ç™»å½•"></a> 3.6.1. ç¦ç”¨ rootè¿œç¨‹ç™»å½•&amp;å¯†ç ç™»å½•</h4><p>é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š</p><pre class="line-numbers language-none"><code class="language-none">PermitRootLogin no # ç¦ç”¨rootç™»å½•PasswordAuthentication no # ç¦ç”¨å¯†ç ç™»å½•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯¹äºç¬¬äºŒä¸ªé€‰é¡¹ï¼Œè¯·è‡ªè¡Œå†³å®šã€‚è‡³äºæš´åŠ›ç ´è§£ï¼Œç”¨Fail2banå·¥å…·å¯ä»¥é˜²æš´åŠ›ç ´è§£ã€‚</p><table><thead><tr><th>é…ç½®</th><th>ä¼˜åŠ¿</th><th>é£é™©</th></tr></thead><tbody><tr><td>PasswordAuthentication yes</td><td>å¯ä»¥ç”¨å¯†ç ç™»å½•ï¼ˆçµæ´»ï¼‰</td><td>å®¹æ˜“è¢«æš´åŠ›ç ´è§£ï¼Œå®‰å…¨æ€§ä½</td></tr><tr><td>PasswordAuthentication no</td><td>å®‰å…¨æ€§é«˜ï¼Œé˜²æ­¢æš´åŠ›æ”»å‡»</td><td>å¦‚æœ SSH Key é…ç½®æœ‰é—®é¢˜ï¼Œå¯èƒ½ç™»å½•ä¸ä¸Š</td></tr></tbody></table><h4 id="362-ä½¿ç”¨ssh2"><a class="markdownIt-Anchor" href="#362-ä½¿ç”¨ssh2"></a> 3.6.2. ä½¿ç”¨SSH2</h4><ul><li><code>Protocol</code> æŒ‡å®š SSH ä½¿ç”¨çš„åè®®ç‰ˆæœ¬ï¼š<ul><li><strong>Protocol 1</strong>ï¼šSSH-1ï¼Œå­˜åœ¨ä¸¥é‡å®‰å…¨æ¼æ´ï¼Œä¸å†æ¨è</li><li><strong>Protocol 2</strong>ï¼šSSH-2ï¼Œæ›´å®‰å…¨ï¼Œæ›´ç¨³å®š</li></ul></li><li>ç°ä»£ Linux å‘è¡Œç‰ˆé»˜è®¤ä½¿ç”¨ <strong>Protocol 2</strong>ï¼Œä½†æœ€å¥½ç¡®è®¤é…ç½®æ–‡ä»¶é‡Œæ˜ç¡®æŒ‡å®šã€‚</li></ul><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹æˆ–åœ¨é€‚å½“ä½ç½®æ·»åŠ ï¼š</p><pre class="line-numbers language-none"><code class="language-none">Protocol 2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="363-é‡å¯ssh"><a class="markdownIt-Anchor" href="#363-é‡å¯ssh"></a> 3.6.3. é‡å¯ssh</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl restart <span class="token function">ssh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="37-fail2banå·¥å…·é˜²æš´åŠ›ç ´è§£"><a class="markdownIt-Anchor" href="#37-fail2banå·¥å…·é˜²æš´åŠ›ç ´è§£"></a> 3.7. Fail2banå·¥å…·é˜²æš´åŠ›ç ´è§£</h3><p>è¯¥å·¥å…·å¯ä»¥è‡ªåŠ¨å°ç¦æš´åŠ›ç ´è§£ IPã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> fail2ban<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> fail2ban<span class="token function">sudo</span> systemctl start fail2ban<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="371-é…ç½®fail2ban"><a class="markdownIt-Anchor" href="#371-é…ç½®fail2ban"></a> 3.7.1. é…ç½®fail2ban</h4><pre class="line-numbers language-none"><code class="language-none">sudo nano &#x2F;etc&#x2F;fail2ban&#x2F;jail.local# æ·»åŠ ï¼š[sshd]enabled &#x3D; truemaxretry &#x3D; 5findtime &#x3D; 86400bantime &#x3D; 86400<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>enabled</strong> â†’ æ˜¯å¦å¯ç”¨è¯¥ jail</li><li><strong>port</strong> â†’ SSH æœåŠ¡ç«¯å£ï¼ˆå¯ç”¨é€—å·æŒ‡å®šå¤šä¸ªç«¯å£ï¼Œå¦‚ 22,2222ï¼‰</li><li><strong>maxretry</strong> â†’ è¶…è¿‡å¤šå°‘æ¬¡å¤±è´¥è¢« ban</li><li><strong>bantime</strong> â†’ å°ç¦æŒç»­æ—¶é—´ï¼Œå¯æ”¹ä¸º <code>-1</code> æ°¸ä¹…å°ç¦</li><li><strong>findtime</strong> â†’ åœ¨findtimeæ—¶é—´å†…è¾“å…¥maxretryæ¬¡é”™è¯¯å¯†ç å³è¢«å°ç¦ã€‚</li></ul><h4 id="372-æŸ¥çœ‹çŠ¶æ€"><a class="markdownIt-Anchor" href="#372-æŸ¥çœ‹çŠ¶æ€"></a> 3.7.2. æŸ¥çœ‹çŠ¶æ€</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> fail2ban-client status<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">Status for the jail: sshd|- Filter|  |- Currently failed: 3|  |- Total failed: 15|  &#96;- File list: &#x2F;var&#x2F;log&#x2F;auth.log&#96;- Actions   |- Currently banned: 1   |- Total banned: 5   &#96;- Banned IP list: 123.45.67.89<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>Banned IP list</code> â†’ è¢«å°ç¦çš„ IP</li><li><code>Currently banned</code> â†’ å½“å‰å°ç¦æ•°é‡</li></ul><h4 id="373-è§£å°ip"><a class="markdownIt-Anchor" href="#373-è§£å°ip"></a> 3.7.3. è§£å°ip</h4><p>å¦‚æœè‡ªå·±è¢« banï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è§£å°ï¼ˆå‡è®¾ä½ çš„ IP æ˜¯ <code>1.2.3.4</code>ï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> fail2ban-client <span class="token builtin class-name">set</span> sshd unbanip <span class="token number">1.2</span>.3.4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£å°åä½ å¯ä»¥æ­£å¸¸ SSH ç™»å½•ã€‚</p><h4 id="374-å¯ç”¨fail2ban"><a class="markdownIt-Anchor" href="#374-å¯ç”¨fail2ban"></a> 3.7.4. å¯ç”¨fail2ban</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> fail2ban<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="375-å°è´´å£«"><a class="markdownIt-Anchor" href="#375-å°è´´å£«"></a> 3.7.5. å°è´´å£«</h4><ol><li><strong>æ”¹è§„åˆ™å‰ä¿æŒä¸€ä¸ªæ´»åŠ¨ SSH ä¼šè¯</strong>ï¼Œæµ‹è¯•æ–°è§„åˆ™ç”Ÿæ•ˆå†é€€å‡º</li><li><strong>å…ˆå°èŒƒå›´æµ‹è¯•</strong>ï¼šä¾‹å¦‚ <code>maxretry = 3, bantime = 60</code>ï¼Œç¡®è®¤ä¸ä¼šè¯¯é”è‡ªå·±</li><li><strong>å®šæœŸæ£€æŸ¥</strong>ï¼š</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> fail2ban-client status sshd<span class="token function">sudo</span> fail2ban-client status<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>åšå®Œä¸Šé¢éƒ¨åˆ†åï¼Œåœ¨äº‘æœåŠ¡å™¨åå°åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰é•œåƒï¼Œå¤‡ä»½ä¸€ä¸‹ï¼Œæ–¹ä¾¿æ—¥åå¿«é€Ÿæ¢å¤ã€‚</p></blockquote><h2 id="4-ç³»ç»Ÿç»´æŠ¤éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#4-ç³»ç»Ÿç»´æŠ¤éƒ¨åˆ†"></a> 4. ç³»ç»Ÿç»´æŠ¤éƒ¨åˆ†</h2><h3 id="41-ä½¿ç”¨expkg"><a class="markdownIt-Anchor" href="#41-ä½¿ç”¨expkg"></a> 4.1. <s>ä½¿ç”¨expkg</s></h3><h2 id="5-ç³»ç»Ÿè¿è¡Œéƒ¨åˆ†"><a class="markdownIt-Anchor" href="#5-ç³»ç»Ÿè¿è¡Œéƒ¨åˆ†"></a> 5. ç³»ç»Ÿè¿è¡Œéƒ¨åˆ†</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="VPS" scheme="https://blog.godmao.top/categories/VPS/"/>
    
    
    <category term="VPS" scheme="https://blog.godmao.top/Tags/VPS/"/>
    
  </entry>
  
  <entry>
    <title>å“ˆå¸Œè¡¨ä¸è®¾å¤‡å·</title>
    <link href="https://blog.godmao.top/posts/7167/"/>
    <id>https://blog.godmao.top/posts/7167/</id>
    <published>2025-10-10T08:31:46.000Z</published>
    <updated>2025-10-10T09:46:29.493Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><h2 id="1-å“ˆå¸Œè¡¨çš„é€šä¿—ç†è§£"><a class="markdownIt-Anchor" href="#1-å“ˆå¸Œè¡¨çš„é€šä¿—ç†è§£"></a> 1. å“ˆå¸Œè¡¨çš„é€šä¿—ç†è§£</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œçº¿æ€§é“¾è¡¨çµæ´»æ€§é«˜ï¼Œæ‰©å±•æ€§å¼ºï¼Œä½†æ˜¯æŸ¥æ‰¾æ•ˆç‡ä½ï¼›è€Œæ•°ç»„è™½ç„¶æŸ¥æ‰¾æ•ˆç‡é«˜ï¼Œä½†æ˜¯æ‰©å±•æ€§ï¼Œçµæ´»æ€§éƒ½ä¸é«˜ã€‚å“ˆå¸Œè¡¨åˆ™å·§å¦™çš„ç»“åˆäº†è¿™ä¸¤ç§æ•°æ®ç»“æ„çš„ä¼˜ç‚¹ï¼Œä¸ä»…æ’å…¥ã€åˆ é™¤æ•°æ®é«˜æ•ˆï¼ŒåŒæ—¶æŸ¥æ‰¾æ•ˆç‡ä¹Ÿé«˜ï¼Œä½†æ˜¯å†…å­˜å ç”¨ä¹Ÿé«˜ï¼Œç›¸å½“äºç”¨ç©ºé—´æ¢æ—¶é—´ã€‚</p><h3 id="11-ç±»æ¯”å¿«é€’ä»“åº“"><a class="markdownIt-Anchor" href="#11-ç±»æ¯”å¿«é€’ä»“åº“"></a> 1.1. ç±»æ¯”ï¼šå¿«é€’ä»“åº“</h3><p>æƒ³è±¡ä½ åœ¨ä¸€ä¸ªå¿«é€’ä»“åº“å·¥ä½œï¼Œ</p><ul><li>è¿™ä¸ªä»“åº“æœ‰100ä¸ªè´§æ¶ï¼ˆ0~99ï¼‰ã€‚</li><li>æ¯ä¸ªå¿«é€’éƒ½æœ‰ä¸€ä¸ªå¿«é€’åã€‚</li><li>æœ‰ä¸€ä¸ªhashç‰Œçš„ç¼–ç å™¨ï¼Œä¸“é—¨æŠŠè¿™äº›å¿«é€’åç¼–ç æˆ0~99çš„æ•°å­—ï¼Œä½ æ ¹æ®è¿™äº›æ•°å­—æŠŠå¿«é€’æ”¾åœ¨ç›¸åº”çš„è´§æ¶ã€‚</li></ul><p>Like thisï¼š</p><table><thead><tr><th>å¿«é€’å</th><th>ç¼–ç ç»“æœï¼ˆè´§æ¶å·ï¼‰</th><th>æ”¾åˆ°å“ªä¸ªæ¶å­</th></tr></thead><tbody><tr><td>Alice</td><td>hash(â€œAliceâ€) % 100 = 37</td><td>37å·æ¶</td></tr><tr><td>Bob</td><td>hash(â€œBobâ€) % 100 = 12</td><td>12å·æ¶</td></tr><tr><td>Carol</td><td>hash(â€œCarolâ€) % 100 = 37</td><td>37å·æ¶</td></tr></tbody></table><p>WTFï¼ŸAlice å’Œ Carol éƒ½è¢«åˆ†åˆ°äº†37å·æ¶ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><p>èªæ˜çš„ä½ åœ¨37å·æ¶ä¸Šæ”¾ä¸€ä¸ªâ€œå°ç¯®å­â€ï¼ŒæŠŠæ‰€æœ‰æ’åˆ°è¿™é‡Œçš„å¿«é€’éƒ½æ”¾ä¸€èµ·ã€‚<br />æŸ¥æ‰¾æ—¶ï¼Œåªéœ€è¦åœ¨ç¯®å­é‡Œç¿»å‡ ä¸‹ã€‚</p><h3 id="12-ç†è§£å“ˆå¸Œè¡¨çš„åŸç†"><a class="markdownIt-Anchor" href="#12-ç†è§£å“ˆå¸Œè¡¨çš„åŸç†"></a> 1.2. ç†è§£ï¼šå“ˆå¸Œè¡¨çš„åŸç†</h3><ul><li>hashè¡¨å°±æ˜¯è¿™ä¸ªè´§æ¶ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œé“¾è¡¨æ•°ç»„â€ã€‚</li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TABLE_SIZE</span> <span class="token expression"><span class="token number">10</span></span></span><span class="token keyword">struct</span> <span class="token class-name">hash_node</span> <span class="token operator">*</span>table<span class="token punctuation">[</span>TABLE_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// æ•°ç»„ï¼Œæ¯ä¸ªæ§½ä½ä¸€ä¸ªæŒ‡é’ˆï¼Œåˆå§‹å…¨ä¸ºNULL</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>æ•´ä¸ªå¿«é€’åŒ…è£¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä½œä¸€ä¸ªç»“æ„ä½“ã€‚ç»“æ„ä½“æˆå‘˜â€œå¿«é€’åâ€å³ä¸ºâ€œé”®â€ï¼Œå®ƒä»¬ç”¨æ¥ç´¢å¼•å¯¹åº”çš„å¿«é€’ï¼›å½“ç„¶ï¼Œç»“æ„ä½“æˆå‘˜â€å¿«é€’é‡Œè£…çš„ç‰©å“â€œå°±æ˜¯â€œå€¼â€ã€‚</li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">hash_node</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">;</span>                <span class="token comment">// é”®</span>    <span class="token keyword">char</span> <span class="token operator">*</span>value<span class="token punctuation">;</span>              <span class="token comment">// å€¼</span>    <span class="token keyword">struct</span> <span class="token class-name">hash_node</span> <span class="token operator">*</span>next<span class="token punctuation">;</span>   <span class="token comment">// æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>ç¼–ç å™¨å‘¢ï¼Œå°±æ˜¯æ‰€è°“çš„å“ˆå¸Œå‡½æ•°ï¼Œå®ƒä¼šè®¡ç®—å‡ºä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºå°†â€œé”®â€ æ˜ å°„åˆ°æ•°ç»„ï¼ˆå“ˆå¸Œè¡¨ï¼‰çš„æŸä¸€ä¸ªæ§½ä½ä¸­ï¼Œä¹Ÿå°±æ˜¯æŸä¸ªå†…å­˜å—å•¦ã€‚</p></li><li><p>ä¸€æ§½ä¸å®¹ä¸¤é”®ï¼Ÿnononoï¼è¢«ä¼Ÿå¤§çš„hashç¥åˆ†é…åœ¨åŒä¸€æ§½çš„é”®å€¼ä¼šå½¢æˆé“¾è¡¨å•¦~</p></li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>value<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">%</span> TABLE_SIZE<span class="token punctuation">;</span>  <span class="token comment">// è®¡ç®—æ§½ä½</span>    <span class="token keyword">struct</span> <span class="token class-name">hash_node</span> <span class="token operator">*</span>new_node <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">hash_node</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    new_node<span class="token operator">-></span>key <span class="token operator">=</span> <span class="token function">strdup</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    new_node<span class="token operator">-></span>value <span class="token operator">=</span> <span class="token function">strdup</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å°†æ–°èŠ‚ç‚¹æ’å…¥åˆ°é“¾è¡¨å¤´éƒ¨</span>    new_node<span class="token operator">-></span>next <span class="token operator">=</span> table<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// æŒ‡å‘åŸæ¥çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span>    table<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> new_node<span class="token punctuation">;</span>         <span class="token comment">// æ•°ç»„è¯¥æ§½ä½ç°åœ¨æŒ‡å‘æ–°èŠ‚ç‚¹</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ›´ç›´è§‚ä¸€ç‚¹</p><pre class="line-numbers language-none"><code class="language-none">[æ§½ä½2ï¼šé“¾è¡¨é¦–åœ°å€]---------[æ§½ä½3ï¼šé“¾è¡¨é¦–åœ°å€]---------[æ§½ä½4ï¼šç©º]---------| -&gt; æœ€æ–°æ·»åŠ çš„èŠ‚ç‚¹         | -&gt; èŠ‚ç‚¹| -&gt; åç»­æ·»åŠ çš„| -&gt; é¦–æ¬¡æ’å…¥çš„èŠ‚ç‚¹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šæ–‡æä¾›çš„é“¾è¡¨æ’å…¥æ–¹æ³•æ˜¯é¦–æ’æ³•ï¼Œé“¾è¡¨é¦–åœ°å€ç”±æœ€æ–°æ·»åŠ çš„èŠ‚ç‚¹åœ°å€å‘ˆç°ã€‚</p><h2 id="2-å“ˆå¸Œè¡¨åœ¨linuxä¸­çš„åº”ç”¨"><a class="markdownIt-Anchor" href="#2-å“ˆå¸Œè¡¨åœ¨linuxä¸­çš„åº”ç”¨"></a> 2. å“ˆå¸Œè¡¨åœ¨linuxä¸­çš„åº”ç”¨</h2><p>åœ¨ Linux é‡Œï¼Œæ¯ä¸ªè®¾å¤‡ï¼ˆæ¯”å¦‚ <code>/dev/sda</code>, <code>/dev/ttyS0</code>ï¼‰éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼š<br /><strong>è®¾å¤‡å· = ä¸»å· + æ¬¡å·</strong>ã€‚<br />ä½ å¯ä»¥ç†è§£ä¸ºï¼š</p><ul><li>ä¸»å·ï¼šè®¾å¤‡ç±»åˆ«ï¼ˆæ¯”å¦‚â€œç¡¬ç›˜ç±»â€ã€â€œä¸²å£ç±»â€ï¼‰</li><li>æ¬¡å·ï¼šåŒç±»ä¸­çš„ç¼–å·ï¼ˆç¬¬1ä¸ªã€ç¬¬2ä¸ªï¼‰</li></ul><p>è®¾å¤‡å·ç±»å‹å®šä¹‰ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token class-name">dev_t</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸»æ¬¡è®¾å¤‡å·å¯ä»¥é€šè¿‡ä»¥ä¸‹å®æ“ä½œï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">MAJOR</span><span class="token punctuation">(</span><span class="token class-name">dev_t</span> dev<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–ä¸»è®¾å¤‡å·</span><span class="token function">MINOR</span><span class="token punctuation">(</span><span class="token class-name">dev_t</span> dev<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–æ¬¡è®¾å¤‡å·</span><span class="token function">MKDEV</span><span class="token punctuation">(</span><span class="token keyword">int</span> major<span class="token punctuation">,</span> <span class="token keyword">int</span> minor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç»„åˆæˆä¸€ä¸ªdev_t</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>å·²æ³¨å†Œçš„è®¾å¤‡å·å¯ä»¥ä½¿ç”¨<code>cat /proc/devices</code>æŸ¥çœ‹</li><li>å†…æ ¸æ˜¯å¸Œæœ›ä¸€ä¸ªè®¾å¤‡é©±åŠ¨(file_operation)å¯ä»¥ç‹¬è‡ªå æœ‰ä¸€ä¸ªä¸»è®¾å¤‡å·å’Œå¤šä¸ªæ¬¡è®¾å¤‡å·ï¼Œè€Œé€šå¸¸ä¸€ä¸ªè®¾å¤‡æ–‡ä»¶ç»‘å®šä¸€ä¸ªä¸»è®¾å¤‡å·å’Œä¸€ä¸ªæ¬¡è®¾å¤‡å·ï¼Œæ‰€ä»¥è®¾å¤‡é©±åŠ¨ä¸è®¾å¤‡æ–‡ä»¶æ˜¯ä¸€å¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šçš„å…³ç³»ã€‚</li></ul><p>å†…æ ¸å°±åƒä¸€ä¸ªå¤§ä»“åº“ï¼Œå­˜ç€æˆåƒä¸Šä¸‡ä¸ªè®¾å¤‡ã€‚<br />ç³»ç»Ÿè¦æ ¹æ®è®¾å¤‡å·ï¼Œ<strong>å¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„è®¾å¤‡ç»“æ„ä½“</strong>ï¼ˆé‡Œé¢ä¿å­˜æ“ä½œå‡½æ•°ã€çŠ¶æ€ç­‰ä¿¡æ¯ï¼‰ã€‚</p><p>äºæ˜¯å®ƒç”¨å“ˆå¸Œè¡¨æ¥å®ç°ï¼š<br />æŠŠè®¾å¤‡å·ç®—ä¸€ç®— â†’ å¾—å‡ºâ€œè´§æ¶å·â€ â†’ ç›´æ¥æ‰¾åˆ°è®¾å¤‡å¯¹åº”çš„ä¿¡æ¯ç»“æ„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/categories/Linux/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
    <category term="å“ˆå¸Œè¡¨" scheme="https://blog.godmao.top/Tags/%E5%93%88%E5%B8%8C%E8%A1%A8/"/>
    
    <category term="è®¾å¤‡å·" scheme="https://blog.godmao.top/Tags/%E8%AE%BE%E5%A4%87%E5%8F%B7/"/>
    
    <category term="æ•°æ®ç»“æ„" scheme="https://blog.godmao.top/Tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>Linuxæ–‡ä»¶æ“ä½œçš„è°ƒç”¨é“¾æ¢ç©¶</title>
    <link href="https://blog.godmao.top/posts/31088/"/>
    <id>https://blog.godmao.top/posts/31088/</id>
    <published>2025-10-09T12:57:35.000Z</published>
    <updated>2025-10-13T14:25:44.456Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="ERRORã€‚" data-whm="è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡ä½ è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹ã€‚">  <script id="hbeData" type="hbeData" data-hmacdigest="8b05ba2651631f7cb1047ba543a4fd394e79cfda7518f01522219d4a419b998b">472f0d2124ee617a2f29ff331422d5d3c786bf02d6cb05b48659c7bd0efc234c66e4d05e5e352805b8be7fb548f5db1dc6ce19185f33969b60366e77544d242a4ad3617be960d1cc6fb50f20f9bc3fa3dc4611c1b7fe65e71a5a3a53a2361ac23d01b5245c304a9c64d1f2d42467b313e7b98b9941501c7f62ba70ae803acc1147cacc437bdd5678ef1810bb19b628c6a4bce1bcb2f217b0631590f4a05267a7a121c769458bb6d0d3a007991a4e5946e6e80bfdd70ada16fe8b7f425cd91ff2fd2c0d96e6a7a61f2a495ff7c5d17f33392096a74bcf83fe0a2a1b47dd5a8cc11585947ae9ce708ca44fe807a441afd12f8304730781830b4f9cc4f4cdf370535e05cecdcdde5fb485d559476d4a130b41d70fc5d6999e8bb9a1105d9fc8bad1acf6b48e4bca65932d62ce795949be362d42d3c4aa5b1a3df4213ed5be2d1da2e61473992a40a821237717333de4627358fc2994316e97947ee4226e077242b96086c45a364e40afbd1f146cdfc7147a4d6e76c5979b94a4913307ad1085c446a233c9f26cbad42cccf32b2f436b75b9dcf8678cf6a17b224aa41a3d85e7a486ebecb8cd72248741212a2637a718e6176293c38b1c78550d6f4e8d3efe378f35d4b0379629ce082eaacc3d549f856b134d425bb37b7f81062f40a5c585da897251fc57c0da02b739734217eb24b2b9b0b5bf093288acbe74532cfe9cc780af37bef054afc0ac5dc1df62f7e1e599c8e58e70d0d2781aaa947a153a309aea5317c21277568703ea62f374771fe624ade7ab3318db9ed4ef946ae1420c7b6648a7446bfb6c4909da63daca987a295a75840ba95a8fbb6aea4606a0104ea0a84995853d8a17d29a1c28ac604ef2a4b8d955db6b4250741d0c2c801cf92b412b118c27ed5cd79a57efb4aa44dd808f9fae8cacdcccae4a45e1c7efb1ddd71f26c5252d7657eee98753bc33eb7dd19fb9856b7dccee8b56d7d66b9d94a08bd1883b297b35c1138a47783d4c692cb9cb65d51e7404a79808fc68440353504642d52713e9d3507b0d12d9cde90331cb225a7d30d266990de664c56c76c40e7f524fdf61794f617654fd57a993ca2db16d9caf5c090d0d8e7b2f7ed5dc799a1b88f6ca2465e494f565d9a63eec0abec2a9c364b19fd94ed4ab4f64067928a12ed2539a4d2fb1bb4d1fac682a30482be6a402ee51a2ff07a32639ac224b60e181532aea7d0c1395456ae885ed61984949a8d24b302dc0f416aa7b18273adfd1846027a8e6e73f658d134769c48e3cf0ee57e0a3ca0f08cddfbd6df66e1b4cefad811fd12b2795aec7f4cdf8e48bd5e93699bf27de8bb279e29d4c5dfbd440b54f513416501f2a43df4a583d9ff321253244e2c225cd0532c5ed5f7519960b8d2ddd0a581506e535f7bf56d15edcc78658e32b4e36d2b71e33a1dff0bd55e4339a0702b60d62f343a0a6e1dc75a38eaa103a5d4c3e21764cf8070f337b12fc9dfbec24cba17fd783181b69a67be742569cd829622cccdc612c891e67f7844efaeb4ddceefde0726f29a394965ce92e97d0752514289a99b588c7221fa9c740f0f75bd9006005b68d35dce4af250a8d873b0217238ea45e748585767eb17dcb0573edf798cfb51cdf86dad758424cde24a60b741b90a537d033186725be897fd86b3aebdcfc20f56b58dd2ea544c1c5b98e04f984a0488c76b9b43796efd2dbcfaabe5f9d3d3d9e5698f67c8fd1d547e8cc4aef1d3792c43331a24dacbad8bc8145c3d8c3874d40f911fe88cfe88e8ef54e920f8f702be7c0375090e63bda64985a5121f542b4a7e571dc2ba134293fcc9960fd389e99f349040b76c9c48f78564c3d1d70ef2742ecab88c3997f2858424c01a6b93197b0c56437ce6a1a8ddff8fcbd11224e233025f4340b86c4ecd60d902d7cfa3d10c4fb7bc9014bc77a5f41af09e35c6bad7f14b7d4e3f3fc353e28c1b029ee0decf5a694b8b90088f2afc9cc8177dc83f548edf1c84dbf680c1ece5508ce119b2cd26b46d0262a8c8ba471fdbda632ffce0843ce435862ecba0c59f9ed902084315613dadb3c9d29bec27b5ac3942c44f5575e71bb82efc985dc1bb451a06bd6cf013f12e7685a2f97b9781f68d936a61edfa1693e38ea7bfbf690dbfda37062f69eb4d27337190116a2d4f10f70af8cf361345ee02dbe49e826885d80a75225720715621161a28694ff9a36c7d49fbf1e1d373e5f15a81ff162c245cd5284ba8de5502c0815531132a843cbd424d7892c5c6991eee74635ef3d40a5d85684a75b78e88f437ba1cb60370c56cac0085c49afad4bf3b92c3d9b195d466e7c954ccd2cc28a7df27d2a83289d13e5c6fdf26047f7cb87ebf81fc32705a0e68d027fb11e723cfcf621dc76eba3359b0cb7a5ec1c7315d3669a4671a1d8cfdaee2a1cf4ef9c26ded844ed61ad8aa126167e34e41f9fa5a0b79808bd3ce0bf158dc6efd274bf7e4b7af19ef72800031b2fa6a0bbbfef608af530eda9049237a644d4e91915ddbec564c68ef05cf8436a62c8754b3af165e0c187877d5360a48d43b9865eef88a077e4acd9f361111a9512f69c162e302123d6b7991a61e0208eaaabba82809be0f1574e4e05761e3f09dd52ac89ba7463ef6fa3f1382436db28e49400373cc777bdff68c677ef9b8485ca24ccfc90d7b1f0014f57c61bd0f0f767262407e4831d28e9e72efdd04c411f79204848b9f76e94b39a5e42b96856b06e4d570289e84cac93ff23b41f8281ddcbc79773fe76768af7893dfebcb0fb19f607820dc9f4d4534e6816d245b38ba0a7ac6cffb0f473d9e57e66e22053352cf376522e932dd55d2d7dd5c2901a99fca59baf59680d2f2814b619815011f2a636ada9b11b7b32a6760ce2246422379b49edabd2d24f11e0680170673d8cc0a74f36106132b16285c4592bc6d3945d8fd9f35e8cb8c6379c5607d1bb3a51057eb9192b98e934ecc957fe2c5d9d3c3599afae3bf2d9936d4a6737ecb3c9f090bd9838054483b120d5592d8c3c302fa3cc6fd34ace01564126318558ffbdcafaa47e122eae848537bdfbfb996ecb46c3e6505829edf55ae95489a481a453acf136130c1d5febc210ce27b2a8cecf5644491689be529935f12b9fd4eee08efa3177c3b63dc28121be5687ed48d14e06e0b3766205da7ecd94e6be694fca83c3089bdbaabd35aecdcf6e43b92307f97448576b3781a53c5d9533f6f992563f0f2f9e39d744f753986de96feec1e9ff821d42201a33964f092d146949c5469e4952767af3be76e0308b09065257bda87e057fcc323d3769c9ea039ee6af7c5ed1bf2aa06612b13ace98d86c33c0d349388f297347b65f7ac57d36b68592c2512a317334bd73181eb498e65212e1be85048dacbd38b24bf942a8608f69a4be8ca982748fc3c9e811d701f7520344d71329a21a8b8b5017da4c8842e4e4982a9477917cf9bfeed7feb3f3dd762e3933f7cbd2a4f176b9c0ca77c359841395a1ba0470233c9ef80b1bd12bc5d033a260ed6b11839219774525c69be3a2b753917790884c718429744902cbef6c75e04eb4a38fafd03412e3fc17a4b7d37e04b08de406fc795f0c9cdaaf3aaa21236966a90b6cde73ff3e8fabdf2556f5b6aa0bddf6aa8b68210f796aabdf9543459d529248869a25160298deb86e14a1760b2b221e9869d3cbc9c54c66bd811441b2cbed34dc20968755a2b61ef382843a0ea887edd5a35ebebaee506ba4a7092418ae3139bae6572b9e3a9b04f15f604066ecea0ac14f7becfb37b0b7f4ed72b75bee92311aa4b931132ef3102b2262dcab3d631c559f511b3e7c716ce379457f6bf51cc38b0d74f64246d084c4ec374c8ff76c72dcd5d9d88e77c1ff8258063ba7a3d4ca82232868d9980de85bb7a9aa7c17f6adfe3367eaa549f0ea3c6c4a27b724ebcfcf8e12bb82477d3faba4e8caf9434f247baa92da6cb7733110125e7dc6a9393929e4b75ff522653a71692a21acb23f41b77870c14932dac96a842685805efd7a786adb819c021a8355d9b930091ceefec6d7041b5d90da718ac9ad415beccf59e00c9366751825da7c22ce16b41e6b599cf8006026c7dc090e3c3dbbcfe0b4f3ba373b6db3bdd9aeadbca283f0be51ce642358b260d6bad01f5ba322e442f839194f1f91977880e069f58f56ac0477abef09745e76ef9fba2b049a2b470941d62e688cb1e83cf8599f816922d58867089d85397f65ef337f5f6393ab183ee7b0b8b5bd694361dcae8f4566537a498a6df608ca00d2f23b4bb50b6ed0e378bdb93c345a47dd2d10514825973aee45a6c1dc2c6671857d4579e8e2bdb60c1716bd16cec7705e674a5b6b4186c11f8f7cac1b06e4bba5bbd9e1171eb3db76e27dbeba61f68f1420e71772f0f4228773b8749bf0cd738fd4052dd0c90a78d89f1dc8281ff4b43db80fccd14bf304e7d8d1539500b524b7d865f4254d2d8ed342f4f746e0cc9c2089f1a5a095c98797aa959c471c34aaca16a002804dd15bd0aad4a5c7e636d65757188135b4dbaf3b96d1a81d75d45bfc362ea5af32551e2577ca375fcd4ed3c766226fbcd310fabf4ea51fca453a08416f1562e15220851c9be6b8c3bc08750b868a757952e20f234f9cce0d41b93a3349083b54e2c66d9f9d7c4c3f9b644ed4d095130e2cb3a4136f18da5bb11e7169b059d4995829a9979766631378b321047a3dc76514d043f17b4d6599680b6efc87008204b0ff24acd2aa04b0f1840d32c1fba2e55f6cdb442dc3630c177ac97091a65643d3ff60f5bf6bca44acfee08b24e5ca14e8078cb24c5f5ede9c5683c0075ba8a3de1f30f51b34c3de4edb6838d3aef7d3d04bbcfa8a4b6087b2d7abe5eef5fda10202449a39907f7a5a47c55c8b6cf7d657d26dc7d4f69692bdf4ba02ccee47309c731db4aed0a0810207501ce68f39d2205658d14bd983ebf708ef3a888dfb77790ae3d73363abd24ff9005dcde0227dd12338ec9f0ec56eb5fd1a5f058b6f18ce725f537ee327b7c6798d3ff98ab1c498e4f844cb0184ae1f364eaf5ad19047ccc4a499a16b5966dbd630cbc4affaa43f12d8b3b2409a9aa66d1b412861433069dcc3a75051d3035ee28ae7b1828ba7b0de61f812a463543668aa675306489442d6ed957f085d107b3075a1068418d364a79362f247c1ea57ffc3d6181bacf7f5b293d02270009feda9f02ff9035637ebf6095e4422b1a888339dc099e55479626cd0dbcc6c81ed83153e8dd253dcfd774f97483bdaf0e458ce7c78a2a02e9e1c1fb83df4ded5239f5e63271ca13a68bab06734f932ed5ea7c6f474042286873b6bb8bf7c3cda6a0ca3e7103642d1432a2ce45a89796d87c7d1cc5dd416ee968d5463957d9aca385f645880c90aa1c05b8c0d81fe5990bf4f0c228101707254a83f1ccf16d73fae8bd388500b72e5b20cfdc212bbc932767cc7012b1129d60715fe19753b2dec76daa4b5af76790d080f46aed9e1aa950336a2d0a3603ab897f552b1fdeb5e47c250783707c193f727d74d6ce09a3d2e806078e59be2c9dc037d108dcf7c8b04dd8277e0bef7bffc24b08fbd996173f56e4dae94b40b1c0977ecd9e055ae38302676a1dba883cbabcca90ee8ee08ef11eeebb65d3dfffc90d6c8a0b299245185504ee49e3ebce234e50f32be3fe633c3df3c96ea85d754779b69aede8e356bbdc5dc0668c8f2f547c31f9551ac47348d5fcddc980ccb9a00b473f3a8e835bd42a89046fd475630ef7461976290963da295f99791dde4a4907f5aa72521000a439d0bc7f2e16ba77a8f25920d5db067bd010f255fec12aa3a5191cf85f857d869cb85b79c83a4569d3ca96d3806c95946db16a7d8b42ace5d3c0141743feb2a58e71f4462da25587a1ab24a1921199deee523b9e7d9df15507f4d7ee10441fcc851c690861c046aeeccc831e4f0f2978e24e8fa9ad4803f31558b5a1a349e900d879804845eea69d905056b0e695789445d7fd468543fab38fe62fd68909670578c8c938fc5288c11e0e0398345a157098d6c562c5b667500b447c29e340ddc9a5daa852e944e67ece01ed5e10487db01359593d0c54cdbaf5f55338b117a2322b9962b07d4b80c93e2fb942f19ce4f419204918f4fa82e8ce818f477abfd9bf1ad5bf3fce6dde1c2db34f46cc172ea0b6c5920b1f77847ef423ab5ed108f7b60288574e9a3e95b3f821726876aeec650cb8819688871d59cc0f6a7b5bbab3b925ba3676b4fe77456bcdee83a3747be9616d43cb8f6aafc4189176a816faa00e1caeb3d15ac81ba033e97cc901a1537bacdb25f9a8924393dcbd9d85639b43b0a9ef21ff3b85936d945152472daa73a9ebe977208a860e285c030a89b2dd3dbf2c5f5308d30cf7a8b2bc5c3b3233bb138eca0fce05dd139f2611bc8d2f590270c02745002c8ea8bd21db500fe26bd95402c1115978fcbe6fec553fb1862ea2a24b93eb73fb53b4e9fa412d342842e0f0fd612701e4aa5cd6ef513bf153bb2a05819cd4e942c65ac8febe2545a71bb343efb410b7ddce0a9263cc555723cd141c96326144cc6173de4c8c16c87ed776a63ea437e39233e5f31184da691c9bdd0e976d9db026940a9a2e955a4f50008a4bbf080b948d7e3bd074cad32e4296f0d5a937356cdcc3e26a5a85897f7b1a8a8d9dc2cfb5b9f6a15efe7d65f762c4f33509391c3558198af3a2eac918527082c95dbf5f9e59241b4b131ea7e60103afee7795769dc11dbf1c31524214ce6173774011b5d57bf5be970418be9534709352f10da901fc9fa023611d15c163902f5eb75f77e469f8a221afab5d45d16c6d29d350289be4b29a146fd8895c87f1eabc8e9211f066b7b9f80637d2a064fd38e726552a26c86bd0e747453fa6b483383ffa583c83bb7ed1dac83f67bfd22c8a45bb49b7bd900a30b8a23d6448bcb3bcca526a1856dcd841c6a94d901e49ed1200c836d2bd46a72b57f8a8694cef564b461abe050a7284979fe30e630ba7e1c37b2b01f73fa557f224b89848647469008087333c99a255f24f9038c233fec0126ebe608fd309eea2d63f8ba1b42cfa619fd2b93e66d3b1258712f60cf20b4116e34eb51ddc9d5b13ff5a79801bafc81d0e6bae10e76677b6c33182a8bd1646839f9a07d48bea7fee1ad7bda6e810448e2946fd4ef9a4506a307624ce85cf0611c1e09f3d3579e4c7e7f2986afedeba182df56824ef32e376acf789c0e38d5b09e03a9e76609716bb9d48190a8abb0437191422d533d1c10d16c830853aa207d68391342d2365f15b107921da3ec1719d480b8ad418281460217cb1175158d38efa68f6729c1f3b8d36fe6adcd111e5ed4f55dd31c1265da890386e726e451a33560ee977713105427ffffda546b8aa646b413ba3efb3203664ab2b7c36fa23bc4454e4829d66fd1ca0ae3ac4c96cf4afd134861deb53becb866d3b9cb1e04852ee41f78238ddd03357b7283d39f48746162dd4b2e6e74e587890bab94463ce20143827e481d7a9c84ce1a2ca0ac7809e94492200f75bba094f9f7265fa4f8f287e0e82ca2f91b402f367075235f36ad9b8645b0571b7daeb146e96c2eea42de1f2225fa7704a17c198d3ec3e978a57caed0ead7570fe9ec08c9013a59587965187f42465b417c9580295766a182a5440c13ed38f7b4beae40f4234abac7cf4b75e9427bc6cc83e32fd17046092c5f06c58f6bbc65de324f983d345bf3d36303c127bd238bfeeaaf49dc79f336a9f70e7ceea176572b4bde197020bec76b5b4dc353e9426a8da44673d234399ea08951b5519e35d2fca68f71f99c12d4f1674c055586189d3a3477b0cc6f5fccc5a469e346ca482fd2a3366e7e2ce5ec4a5afeefc169502f803fc9110370310dfebab84d64ee3d06395ade39790617e07160cd95c2e66807657c0eebdb4b753315e1a3ff12980cd524bb91338c2ad426a80978c63076aa9357217ba76742cc623590ae8b9c68c782a8e68797ba719f43056ea9ec90e96447d0854f961b5360509b5314a4f31629f1a8820fe31f1b85655bce37913573a9cdb6004fb650bc422591f9727b684b46527c63f19f20aa65fcaa755f31095fa62f1a52305b254e50fe88ba03b279816bdff32f71a93f4a1aaf997dcd0691b20e2029da1bb047784607bc6009f8d09322705474dec0ad7720f7a871be1f5f5bcc1e4929364a78b71555cf21ffa35e303196eeb6e87affa984a026ce53610eb398c2bb1b76c9605de92599a145ba2200c788084c7262178eb09d65bc085484a39c1c4cb31b7325c2a8c19ce855be0b384a897c04168af60ec672d6259b1e8e1f98553dd2284f83382fa88439c9c9fcfe514d2e2e09ce84b311826f2e165b8d8049629cae50159eaa6c33f20e5763bb8465485a4943433aff43e03d5f3aa104910ccf72a7bc8cc60896fd37ee4bf53f48677cd68be15e1c04e6092f1beb81b6e37f35d1cf1b652040034e23df79d9bbbaf1ecf088ec9a49e49b80a19938cc25e888b37f862667e734455615a9726d2efd681aa3286a7540a276bb8a7ab3cea47c2dc5f2ec3e520ead5eea16938b4f9268a837cf3eb398de8441d06ffe061fc6abca94c8f8dac402aef2887d6641ef8686c321cadc5b2ff4d0ae93395dc7fb9d1dd3d74b233457b42e3fa1eb0ba6cac77695548818fa92e8d21803af2d47378fa6b93f6d35875184347dc1b44a8cac30d17587b3dab80376f0a8705ff156a04d89dd5c10716ea84b41bfd9944b06ee4472b848e7505286f4b8b3f58ea31039f408d5c74965248c6205c4c3597ea9ebbf58b13786434175ab89c6789a70526391fbede009189c4af0037b4bea6810103a852c64fa372a930607ab8b4c2a5c0332d61232bcb4ac46d96a78c1d7d2e39788009c6a080cb56a9d605a8b2424864f7d14af25f364d3de60eb43f544401b0174a2df898adbab871d674a833bc6710467a5c72f899d31533d66b08761ddcfd65302772ba68b02945b630aab95f2ac265338e70288e15d380f5ae6be72c6b4c7863795329fc1fa403f6029ade0f7e298b4b3bc3d114e2b061e59341166548dd138078cb1934ad5638e62df3737e1bef96ef54b5de25fb9ec06f364b996841811e92c061913f09d8ff6731e44fa56d29ca91c1deec148f4c5d1627dd0f5f8e982baecb13ebff4911460ca0e7c8acbea900d79d90092c4525e7aeeb9bda92ee7b9cd6d40e8e1067ef44aa930660c2174cd045fc434026051ccf7f8a4e1c9dbda3f8f95d9e3361be80bd0eb68114e41f318390539526260b3e1fd5dd9a60f71eb3143e592cc7101882818981e8f068db5f425cfb34f96523a92eefc3753b3b7536b519b01ff844a88b26129928139ed00159f6f2381d92e217247f5f111db5c346ca2cc32774837016da1f3f0710dc963cddf15c41ee3a32c72f98f4da6fb28033574654fe6a0fa6af1dc0e57929fe4f9df0d9dfc7469cb2c2e11e808517bcf6fdec5585f8117d9149afc5e597f3ceea041c9df28536035bf56f4f917699624daa3309f3b4bf1d325deb3541fa048ef70c75e0ba739ccf26193113e19071695808b47b3465780a19ac26e804632b707066f755ddfa26f11be50c8f349edbe5ec86972a7b1f8f9694423e6144d941cf767d7605000dccb036c047d165a4643eba087a3675f20d725a49855b86716d72ae2b2353be5e4875748069d03fbdf8b35d513e404aa2783d22be16ac9b87d1c17ebf58efbd50444a99a25d2c4fc7bdb6f9840896db6d2d1327d2cac0406cee42bea7513fb4d5527caf74af96b207f3cbc452a725b05021425b97ccaf67b2eb6ebd11c28d597baaf8b125d6cafff3b64522025502fb4f25de324b382e7b2356f6bf6ff1a4b81de71a130863033101972e56d2425c6d695a9409c5361b1eb5b893467e25ba345e776e21eeebdc298574b231e225f202316515c1491af9fbf7fb583690a3bf402a4dc30e39b144e57dd8a5e51881772100295dc79afb65248bbc5faeaf7581e5bb118d790c8ff60afe14cc344060e4017f5742323d323559adbc767ea67b6c9daadb4a778a5907d188349082c5eadc71be0ac256c139780292520be15765109c0b572b1c0e31190aa613282b5000145d699f9d8aba3ebde83490b8c95f251c55e3e4fd78a91a2517cad72af3fdcafccce14bee54cd268b25afaa3925ddbd6e8bb766e63ac3c12bda1e796a2994b78b2e73a67226bd5db480ae7b47d63e6e42bd653f129b32132a73d650db5aac82c492c7d68d1063b556194364d70b179d1e7bbd0d322a2d15c671698fbb299de7069ea335288d7e9c23abf0450186e539b0a9e8828ab402c1e83118020e5b7953cb194f706d001ab7a4e270ed7313badd75166d1ae108ba5421521d6250af1a4b8cfc18679c320d0e0d168156d74dbeea64c05ddc7d00093db23040adf498edd48514441853c00ef77c6720b24414987e756abff57c3900e8142d2f3fae12ae4dcd2f2c5096db12630f56d2a5ced5946c02395bdbf62516bfa4431cce18cbf53ec0795c03a37fa51f3610dac9d9ac26864d98e9d46c6b64d948e96dce6fa59a49570dcd05173fe1fba2d313082ea6d86df02da19e0d4ea6c74b7f9bc98138037d6d7587de98a642ba1014541d7e6572f0d8db0f6b179391e6c34da7fb15994a3ee3da6a8db7292d05b42f904bcea23520869edaac9998eebbd73de1b2e9d1ab4f2b9b841d526a98f5b7ca81551026b94509dfb36549d4bb1704ff4efd844fb090d4e8eb325e3d11416896694b5981c1101afc087bcef2015574dbc64fdaf4741352b3f1fbda58d5de9f8477cd3f93a67ef2c5f31c4b0926dad376d675882d3373fc747633bec3552095e37288bb7ddd7eaaf20ae05b3735a75a404f87141cd3fe98699316594f67b701dfe8195fac766098a0db5cf73d6865c80152b6573d350fe39cb4195beade2119a77737d91a5d8ac2b9cea1a51b376f04b903f6ba65d4bfa9e9109c9e378e7cbf7f226917aa590fe7652e4aca5e316821c161d344da0320e7acd5efe3ab8c4e9d587aedcb584ebb124f417d2b0df39cad75cdc1d5bdccc5a1c555382dd043b921a56ad908be01e9901fbc20f58b5476b74b5fd7186966fe467a80662a647ce8dcf59be3da0910d6ceb68fb59d9a4a3b44bf3bacda5a7b509953b597cc50720b7e5de4d3f24fcd7f5485fd06bf7d55eb84956e787cae21b800539cdf4880c686fd50c1143c1a07d1b120ac5daf0642971bbf2217b11e6d7dc1fcde30cfaff22f994f5aaea1738049b9d1d89836596ec61f5070ac179ac266631b5a29c587ad9975efe6601fe12e5c68d388921b95d6e0b9158434e8f423a2dc6d0171fa097193206602057879191b965b6ec0f6d4f8c920ae49b67eb1e2af0e1c5cf42532639e4738106cd662b811f39eabb1726c877528450ccfee4e32b30b42868976f1e1f6560265ad61c64a00468aa5e233acf7aa226b5c60e6ddc5b4a0e9d89520c8f21bf102baed6de2cbac56f4a4c841f019386f34b57e212eb8f523acbc7728ecfb1b11c9565e533927a88f897b7143ecac769d0eb62abd1ce655f1e8f0fd45677be021c3049b409cd256eba99b8190be9071f3b6a6215ed01aad234471b2c0b1bea8ed936591abf0006fd0f1f21c8790e4fd6ca1024df7c69ce98139cf0dde3a0b68bc7c3fab8d9fb2aa269aa05da54e902b3630daa8cc06178b6d6508a3530acbeb83bb829063b5cb05afad980bc1666afc46a3f102eb9a82a8539c0b18e4f1846b1988b6ec9defde02378227ae26ab50648aaabeb956d877f9cb2085e4a8af146c816ebd26e49d581cd58872143aa57e00688da97601ce85a472b727400d2e3fe63045e2f85f133d98f6ba0189dab7a2294ef277d63dc9b91975e7b196ef80eeecc35cb011de1dfb3389b09e32d431ff3131b4af46a7d0e6216da2f3cd44c49a23098803c8bdae41b17c58c0741cdf99d72086e2a1c3d305807b9fcffc2422de60346b081dd91f656fe1ac7f4db6c7e3d2318253f82f2fbae368f92e0f31dd11ecb42ebd0d5e6245291e7bfd685856747d990a92ca972479df0dc47a578e4da116ee94ca359d7faf829f02a49a202b6aeba0eae258f351dd14126943fbfc588b22a99a524a7faa0575f802606d00ce00544c00991f932512972ca10e50cfd2d8c830e7afd2c6a2dd1445e7f480d41941795cc542ec60f04046259dd0dfa9b967e9b1045ca7e7a4fa8d87839e0880575943a9d62eb9d8b9bf5ad759315970f20a718a0f28e446ae3aff7cc5bd2ba6fcd5dad0ef11da9be81c269f84a9594d1a6777fc6a1cb9b4d509dde8532acb39f0168f5e495e99f86aaa414de806f9dce53c2e1d813f0ceb6c328183158e3d99c866942c9fc6aa4479c00713e3bfbfc27fdf60fa985c3774234d04bb853e15e5d6aabdc4d3c37d7e911c5525b8473a54aa254ff9b71a86575b17a96a52af1f015b9c83c618d96c3425814cf9a1137f3fb65fdd981bedf89514aef2245d6a650fd2a366c43b8e902bc5e7f8b92108871b5d98fb76fedab45983f5cf7d7d2679a8abaada4da31babb53a81b3c601106f4f1c4e2cc15753d91c9eed9fc0e68baab8e123935f67800c7035dfd1b1a102e3f539928c2ace7e143a9c868665a3598c7574f685e749082291aa59648342d5a0e4962d372659b08542926e0caffb3c642ba8dc04be82394bf73a6f6037abc0294be2c6a9166eab32ce90d9afad79f93e5c066644ad116a9c30cdd8d72f9f7a04f110ee52cb8609b4cd5d557c93dcfeaefc37b5572107917efcddaa4342c9391e6cf90fbdfab562d8e1ac73d9146eb73c433d91834f1c70eccc07d774e9f52c8fc0ad41c3541131d2604c572aa4d5b4addcdba7395f89b3b9a510c682e450fc4971b7b62fa6f7960846f461d72d298431a6584b688626e581a37c8b2c9087562fa0c1072da6d408df88ab6b351eb1bb2f57574b09ac4a6228e991eb257e1730ea7a0da6a1980cb19791c77138c693da2c5719909dfba32448fe509dfda6e1339d779ccca89256440958bf49a0e56f40f1e314095951ea25f86d7484c9c2eb93747d3122ebee743b39746ac204619992daaaff1367d1e8debb43060598e1d0572aafb285c5d892938868039e063d45c4239e74c1e90609bfa1ab8c67a6aad648d377ef52d1154c5cb711a626eeedf11f36ba3a4a2d77917efa89786880f4914d229d9fa447c47c7139dd85e0ca47ffbfe13563cf85faa489215fb4e73ac219c8b326170fadd3f1ed2ccff81693e1452e328d3ebc0509c7de10413f7e77fc1c9ff98f397f97fd03d811b59209b79e22b734fc1fdd5da8d2c698867a7c981fc124bfc024806cd307b92459c639850152ebb5eaa0a6c3c8063c85614ec613ea166f611300f72482c022ef5c555539eb9eb1fb6e339211af94e2b2321059e9349b891dc113ce167f7cb5375eb72c1ecaa4f400166718a8b72bf6e41c8a387cd53334779046d72a3ce5b9e098f6f7f727c2185f36ac27b669dd0d2865cb939e79b8c70501fbd6e0b39ced3ee9ce99be316527dba11ede47da6e91066e3b3fbce7cb40b921fbddfb7102e10299565cb2822f0fad434b2e459c27f4a959fff1ff7b04624e540bc363013f762b044eff9730fa3d22862697a2ba9176fa7259879f0cd1e168c44a5a45f3acdccf5e74eb53cd458bc5f6573327164ed510e9c5c0aa01f9167be1e0781e6f42de6469276f570c5ba620d47600aea6fd98c9ba198408960fc5bd57ff94aa86f4fa73088e1ca0b4c5b2996c2c0d4ba4030e3268b123b6ad5dc442201e3024e36de69ce2c390a21b3cb6aec4c6a15f0a567f6c55d5f9f95ecc95bf19b3812dd6eda7524f54ded9da2ad475121c524fab84b77c5cfe9f06fede5caa46b70428531bb9a62dbb1d06b136d0cdf186daaa2d19212177fa4c0e7065b77e06a9f5f54d45188de4137d655c6aee43a400af51efeb0b46611aea6dbc2411efb38c9a63f1893fb9dac7a2342ff7df5f85918097cd235ea3511123210fd61de198835e021a94a84062292f24fbcc38ec1d31787b9ac9d34ba3d5e71c4d9b5c1a7e319b7f277ce9dd47bcda7900b48c32a29f88a248b74eeaaba454d9cf23f3c58798ef6ad98e7813e1056d8eb9f8d4c2ba5d7b9a51c3b52bad04eea2cfcfb34d03bad0239d14d148795a98e0aa965cf90a71f0f0d2f65264e9ba834eef675a1374148ec9fa9a44423cbe1963d39c7f13c12b0c260fe9d8b65958ca0ba8d8810e30ab3f91903b965ee424f3f77c0d4f3c000d554a6df74359fb21266d4d461b872d9e5b78100032698ae9c42eda257a72def8e8b3a3fa07f8d3bf92293fee73fa3613e91a59b8156714bca31dc87f5493599803a5cb0a13469a0e3926938754e4e36c0159087ad93d3b7bcdf59f482d3067d7e801a7e70c180ddc7d1aace64fdc29853fbb6e5f3f1d16f3661e8be9749aa0408635df7e733f5f07242336e2b4d205885f95ba9b448fbbd4f40e66a1a99b8c082e7ebf85a688812d666a8b54f9dc0c66c22f0b0b3605ab54e2813faf45899913769a0b968f675907a71be0f7c6fcddd2ef0d9579d7ea7160ffa0c0c47034645e2d0b2b48f557cbe6227adbcbd45b4e38da8dc3963f39228238a6d309d3d16514cc602579d8b25fbbd1626a463ebed0de7245e2ea713759cfc5045ca731a5c10347e2b2631f4aca8e23313032f2c610ca9dc166fb6e8582453a32d28f4eb2bb9ce2cfb0a3473121d1341b533d69ca805ce2c2000b3e4bcb417d9e5b042466dbcbce954605d835aadab7d2f7f752d112d0994672d179406d0e27f4d57107d01ae788cc7fbcc50fb8e657b2d86372a5a55d25e8c6c54b8864a07f720642bb580738ffc2f0720518f1f86991e63bd642bd73b5553dff7e8c47a4ebb362643ed306059246e13626194dd5e4df2f16fd96d10c6336ddf632ac92cdd8a74059a6d4a93585d4221230ce59399ae1190d611cf4b9910c48a29c0ac16c6d00b5e68e5a8265c6f902584395522057ff51bc2d7dcff284cfe79cc46580110f1bfbf444ec6e1bd2a1ea74db940fe4236e6920f87bbbf7d6bc18cf6d4057bd1b0db71676959d196bc42a26dea5e7972644ad12879cbce500c356ad277103cb6dbcddd933bc0cf9f5312dbfd495494f2002d0662bf1639ddd8f22e3d90a3298acb227f5c3994c1e008fb0ed01a0f05f37ae8a7d01b51d5d36755741bda818239a7bad6348f37e50c48072985ba3e760be3b1dda75125f1017566d5fad13e596dfe56414d2bcb01037221308bee722a60770be291e3f11af2af1f16b2ffe177e699c81ebeb8c33d72b518337fd5a83400c2e242a3d21e0c554f69912687addb9f19a1097120453eb18bce319830155cc3c808bbae8416f50e037966cce1afac347fb835068cf6a16efbc5c90eec9114d115b535b74bfc6872243062e67c3cb8cfbad19a7b2ae843408c693c8b2e70f0e92e3852355b2eef463f5eb12b47834f3c61b43c23a05b3f14950ac2be6ee698a41d1dfd4a4b20a6e549627145dc9ba389f443ff308973149cd950f717c63278cf5e34ae1e8e0ec11d75769faaa23fa811cd7f87f462f47e23a5f63a430dafda6d698b1edc2ef9b921618d7670ca78aa43669abfdf12e09fe105f5ab1a9b0cbc15f66cb49f7e3caefbcb383407df2b5e045baca5ad09418780e00d108e3dfbea05c642322f3a1b58c71d5bcc956949ae2db3993c85d5a36f1931fe2aeb031d9a50e077eb913685afd57ca9c9c9b6e9778afe676b36e1d43d54e0a875c492651d1dc52b01cc46656d434ae0b6249c07a92fee06eab6fdb449200f4ecf0e5739ae21bc9dae0947566bd46c6ae54c95d74fe3f73bf2c267e8ccadb6da9c16f62eaf4804eb1efc2b3eb0288cf1fd4cb114d0acc3aa0d9cc6fd131e82cff1eb181202c96ad3959df6f2d33c5217cbc59e0fc87e0d25a4f7b36acfe07ea40ba9537383849f4a8707d0224d2091f66a4fc2f38056a542da8af71183cadfbb10a8d07348d1eace61f1c6de2fcbaf5be9f0d54ac4451d6fe65df1ef794b77039a67af8d663e236ecfdb9916aef7b767cf1df546418539ea8e8cc1976b73d9d2dde9854828f2cb60f3bc8c6c0c581e4b4e6f1e4e15d7c04d89efae46c5439c11fc2261812385067417b0e170e6ef150b12615561f54e4fba964aad6166463c6de943dc10254c9f0cd1bc9e92e136ea0d5f92aa2ecd52885ec649ad75847ea37247601e0eb1ebb5a489d4f44b498fc9250207c36663883a5c08509fcd44073f8a67189eaa41f7c89476ba6b0113662946a374c61ff329250aca37ddf0e407a4a82c2737e1bd9e20b0423d84c2d7ad65d55c6bd6df94cea8ca9b8fa5ff1d78ed9c3e4403d4bac4f8e4a2c6ad2757d50d45daf8cc491e6b9bdb9c3d74133f2b7d73e287fc93b9db8881e4a699849402664cf4f5d6409582f8a530e14b232e0e72854b099ac7f8b7db08d6e71cc08260ba715d57e9a196a767ca319bc788e6a45e576f8723aabe9069f43aaf785be49cdd66a0d6ee1f4fe1205a162d4c655f488b492bd5999989d62f92817a5f738b685bffc8dff51f668fa1fdcae51968eb6ae46a954d7ea6b0c857b629052b05945b766a9f9039667572f32a7b4bb54edef983aecfe7e862bb4e7b288977b9a885f29b4aa443bd8e625511141b650a8fd02952c18e81ce61c1f2ea4f55113ae5e9cb7a42612e1839b9936adfae622fa3868f0f4c1527d9e24f62deba7a70aa106dcd1623da6961ce7f84632068d5b7e896ef81e82816a4e849a2e4f889fde95d5e8d0548feb39c6b5b3818a8836c2d5f2c5aee66cac59ae3385d34373bd97b99b60479dbe0e6396585edea093d32080634fbe03cd549b5c210e34b66f0aaba461ac63fc5a6c111c3e376fb416949b405b03a38434b496f5211b34a424e8313e027bbfbe0d69756299f92d6818d4c0bb7cdddac9f862209614b68d86a740cad8ca72ecbe4c2f45f5d17f8e2f0e4bbfe7412807167c65d1343f0d77159e60ceda1882be8b1b7a7832ecb2f60128116237f6e16eaa952cdea76dea2dcb850a221189737bfbdf0d1a4bff17b0456abdf4830420a67dc12ed2859dbcad35b807550c8849207ccfa5c87ec7f746248b987b20911d8ae57e39bd0e2c37af00625ae2b765807ef97c7c5ccc1c044c84aea28171f71aa07849e52d397cdbe4addfc5cf9d5dbcdb8ca07920e1979fe223ec3cf2dfd3277f3279d5cd82fd13638f985c9c67ced97ad1319726d47b1307d175c44feb54321afcf4eb45bef88fb4d83b6e717ab0f6ad4364db7c937d1caeac918778bef6ab626b8917e784fa38c84d71fd0b54be2d35d09d352dfb243ee6b054c24d58fad97548449886b0f9949cbbced759d9caf67115f0ec17a59ed9f990fc6d94077bda13765f5b7b27d3decdc657870ea6dbff5136fd10381e11cb7d2aaf0b25307bad7059b70a29731f5bd497dd47ed6e1b59454904b7fb455c5ef5be9af8ac917ac84111ace3b3522266baf85ce104def20f4a20416eeb1d79c5929ada8b561387c7d1a7775e0598706b34deaca91ca566b8426770b5536229bf90d98e01ccbe0f4b591e675dfa5b3cb649eeaab9f814e1a797dbe65dca8de3b03e4621071f58376bdb968605ac945e91e27d990eb8252c6f3b6b08296de6760ccb45f7fb764e027ec7104dac6d5be918a81880b981ddaf156429ab1850d729ffe93ddddc066a04399ef5cc6fa3da55f7da33bd255e9fbfd0f2c8fde4a3941846bbbf1dc6df7a845af1ca52b68eae1e92ee4c64a63901fac5bf2c6e96fcfb1c1865ede5ece9fd2ca4ecdaefeefc2cf4443fafce22d7ffe73b831224616113376eb15e9d8bd28b4216b9e47f3c8ce0c1577de74323d8de6d4f4134dec211d4138f04a6adb0b7938d775bc6458e979465f83ac8b05beb593a75aeb620fc32237c6927b6c5ad605c06d8e4e1f058066fe90e0195370007f7ca4eb9a04a634734a5de490dd27f76f8702d97a63dbb5c181c6f75679cefba73e611d1424d289e97f999ba5844281417bac651d0b91ad10138214ed981baf2dbf7223e940dc13995fec17a1b4bd0a5f9339d79d92964b4c2c039cc19917eeecf58ad57f1cee2c547ade124be9fd99d56d42a1b7493544540ea54350db498b90a292b5074590db62f8ed0201a48e508bb412bd8d5a1b0b2ac524733ef6ad859edcb03105aa689216a4a2b2a3a3608799b46aa8531ff05dceb4db5e88f2287c0a1bbe6c0cf9b6e0fd506aaa60b23ca93935fb161d24eea2006262f2fca48b115f372c109838d3a10998cd839073e484d2fce615b5ae2b2dbdec9d13992a83d7d1a0cf414b9c7f154b94344ae300f4918c69ca86d96fc5bcbd9e562c7d5e6ff285cbbfb11d435abd50259dbac9c3dcb18aa41f667832867955edb5497acf721ee206e3fa9b7747c09ffb71ea9da744ccf802809015356f4c91fffb5725095d3708715f7738ef880895ae17e07bd119a305c89922135647a003dc78cc962962f16f2209db45ca7fc5d1ab9ccb207939752cbdd96c7bf8fabaf43c455c3bd48e353d01175239e42625bf740c5307653fd3f5e1471ff975975ea835e454471fa35e757ed5eb346f0491068a11d490c9615164a4ace6dfbbc5ff248bdf4861bce9157469e8a77f3ff362a6c3541203ed835568f3f2c28115486ecb3a765e1a5450ff57a0404b3b768130f7e3ef702cbf846d9240eab479ca610f9cb298241decde2409d9f17cb2c3a831ec6469b62474dbdb240087037daea9d22dbd93020b64a69223a478e74fbed212feaf201a9c625c07fd51a1eb9dbfe501944860a8a5da02c083c9af47e349e1a904dd9848d6a450de4deac3141ef1c73b543859063d0796decc4802285801be1ed17fe164600bb9939da377d28cf2d09f5be4a64c99b90eea40a824406e0143087bf100d50527ba34df186eddf82e087bec8e04342c0db0d1fd25393e4e927f993df4b57747660c5901da2c50f6bd4c927a243fb22c1b4ca85ff76c748c05d9eea48d86d4d28b47d2bd460abb65ca12e6486433acea4d9c9c446f303e9e45707f52b109d37d6d79a6e500334ecca0fc2a49a4fb52fcbfb17c9f7ec266ffed770ec69e7069b07982c7edff404c211833ceb313404bbf96d924bb18c7465f3fb6ead1336a48bec2afb510c8192481a038d3d86c7722ef4bf7d347ce59db584d4ca4a665b1206545531e19262e8edf490b851231b22ed94dceb2d09f37cd6f2f075f6119f88ebe2a571d6402f077dc7c858f46c9d1a94ad54a4e8a1e4076d0bbeb110ec8e5ead772f9ef24518b60576939d3ffb00940a67c2a792d2e2edc3af027907c65956e234bb0d2cfe9a7427825965f3aeed679d2d6280a98d9b07dcfdb1a8a9039b4345c1d66cf3f0b609d25dce4378b04f21971d353e381e1e874404eb0795685a73564a7c48c2623d59285e3be66f44e06f35aceebd45f6d37353086d3e9d14f2d917a08954d29d68a8a315992dbb34f564f424e24dae2ec520f31d310b4067620c974d0fb69d943df705d9d9710d8d53590d5d13c32d2a28a0e32187d3ec4270690ed64ccf06c199e8167040d3571d417b5f613d62df8d4d8ff45044c27817b3f5f0add12db6b840d2b32022114dfd72558d406a585b4b0b2061809aba436f1ab5cc12ad8cd62e6df9270b29ce01e00d96ad1ab4189e9d79ba09f83970267ac989496530889e39bfa76c97202a0a34f7c92d4ae20cc3c04d30ad0b16bfe4ff26ed96f9d03a5bba96c87e99752ef80f8656247d38d1c7899c5cce909bbc5c73e47a40389b7cb5098f0d01d2a614cc7d993911be029ba264192c1293cdf3bbba503e4649a0d70731ed8048c01e10c1683dc251cc0dd48f99857f59224d99fef139a03092c2e80c97a7742a352e1ac1dd3d803a11c87fa7d712952f87efaa1444c9cc5ad4a3a4b663b3974ff0face3757343d0a392fd268b2d1e22e88cabdede0a1c66091ae16c8991927622cd65cf1a57e2ea3b605d5f14c3148250a7376cda43b50eb29c84d6c20d839d4b19f354985185f54d431cac40758751099f4e3aeea7032904e7341aa553da50f6a775ab1e412a754ff052abdb67e17b41e36f6e52df09a013ced5483dccb77b06d874fe6e5e3e01d943580003a4bbc68a06de6db44aa70cb0d550d0215e55a46ebdd8af0c943eeedc144b61853a8c28d0b18626aa12615304302468b5dc4994fbe5ff56e69272c90781106f64560f95866e5ad49e03879edbcf3f326016b5e172293b066ebdf83bf25422460c852b0f35e7918dc126efe60e0c7bd0c3da1cd80754490468cecc7c5e95ce76e8bf3a27357103a30213c05223da9943690dbcfd071b912780a6fdacf6de15312bf3da3181a6c0b09a07b3fc4acc8839c7acde54b0d37bf7c11f969c1b555d2148f448754f9139db16eda75da5ce286127c6fa2fef64db0034e9a835d49ca564136f893fdd0b37eaaaecd189518a79740f5c0e25c89a6968ed69a2b976160b5433e08eac6113d99272edf1955a129ce9415479f0ccce1a2b79364852d2a8f41ccc05ec11cee58ad0337a5124f6b033d2f1c1b4fa00700c261e7d6beb2d4dc083a4ed24f736d8b8fdadd051df9812fc9e024688fafc01066ca6511999674bbc6aa459a50f8360a8a9561df8627c7e8b89dd7be99d2aabaf155beb42dc2bdadaf02845cfc0f0f559782d779f7940ecbd53e831f7cf582ab770d7152ea8b84b6acc6b83f58db00ac864d15bd899f62dceac48ab3ceaefb46dcd334706cfa0a79ccb53e2bd1c90a6b801b1f3349f1155493a41d494dc8509a2624a256bc8aa34c0e6ea2413fc39226cd3ed0063ab4b0c08e0d22e6cd6aeaad6a30bc9a69c340bcbf15091f24c7289a58979112293001f730b89b0232fb5e54ca9da831bab76048d0929539c895cd813e876f9631131c8acea74998f62847ca6e9aee1d8ed7d8757e7f6db8190ea5b8a480974adf815634c6406ce87de4061e4265f629d30d80a72ecebb5fcb08c861ae2dba9213cba6aaad2a4bfed4ca2ee828b0366898990b358adca8356f3d9794774c783f885f51b9997b2e04e2162c1291cc92ae9057e599bfe102f3890768a04d1c2233ef333cfb9bd710689d9d76c6c91e19706f8e1ee2ac7d7de3cd8940b57fe397782e61b03491319a7d24a8d8ae09db61a23f3b7acfea9d6e58a43f7389d801922de6c661ba455427016681f14e31feece569138286cba13d037e2e00e854d8cf5e52881a20b3e189f365ce622250d4e15eeaad3c2b68678c4f6cf95f8e0b544a5dd11184f0b0b462af735f040a71b6a53c9da6970b40531cbe29725a64c7d32a722987921e1588b87821f488578c777233e10f3fa0307c6ac2d2778b49fd6486762556cd1f068b6078dd05fa28e090fddf3c09188754dee4f1bef91f8e12a37cad5690a023ea758ba92c280f48825697e077685aa7ab84e050d0d0d1a9f13e95220488f9c9eb102c38b2a4ba11926c894be4225e86e268516f94d3d10555efd8537423bf3c1dab11595d0aa8d0b04f558291e2463e707f4a92b07bd1f867a3798ba6098495de9280e3d558d4c6fbe949776af69027941469f6f4d7e84e396d4207580dd42b410f6a7f4660f82e5c02e15520e69b98fcd040ad2c265d54a2fab157c4173345b628374952fbdc19e44cb9ac263ce426848ebd68b2463f995357007969295d2241ce0723ff52bce72769a3c8000f0639e9df68165ac85904b6557182d7bc267fc07edbf218f195ba842c59f2076bb5e70f55d4ec0dbc132a1fb1878883748a81d2bfe98af03320705a548612a8454356998168f4ec576773571be75b7213ac365d5af6b996cdba458be75b7a7deca5b76ca0533a3b2b8d9a1f45e9860d5959e0c62bbfb4335ce5aaf8da930de17f8722628328faa7d7a75d4337aef981a4406e494a2951d4e9fe6756a7ada2b5860c99991c5960bfe5bf41d00e1a0eef193da858cc5296cd85905a5705156e438d737e7f53b9432026616774c87d37c4512a167730bcb0fbbf576da22da739248992d7f559aa1947421682593f44dcdb08a750584696b20187880a1ad8d93cb5f09d1afdebaaf20accaca9c0143fb99c696c2c5fc6989938a906ec9af8dbd2a49745adca8ff3e21b1c89f864d9ad894e8c841e8985e9dded9b0efb554a43d927afc91a541092af83d2280f12ed367be4cba56dad94e62238ef274c2c53308ae0690e3d8eacbf81b76b8958b0bac9a80c64cd7b7d4a9f6ef5190eb508b891a014829905c3247c626fb6e266522dcf14b54492073e1bb30c47af1123caf1e5c34322b6c485915cbf8c741480fb964ad8075516989a1176439f0822932f5246223dd9e5826a0e70a1c81fa4f8e4c7f5b2a85f923373395646f521a89f66a4319c88cdfd5d81e1dc5b492781c91703e2d09acb450a39d35b26b93328d8da90e4ab9c078516c78a9ca3cb4347f35b7f110ac38201e289582c465968567d3ccc73b36d31597320bdc05568b0eae02436d1355de9d1a976460a237348f16c054a2f12f1a67f54d88b6454f7ac05790be75632b3e0aa78af756a0e5839c77cbc6b41deb0be6df23b822558c2f5f24b6b73b7b76a2fcb78144e760994938328314ce8cb0533c76cc8c6e2ba4cb517dab64dc7492e4cf32df816a49f47240f7aa0ca9b4c171c9be59e0c2a34af046dd7544b8cc8ec3486a60f9bdd4a74136a12f489f8535d2df99d4ef06f8ecf868615eddd5d887209b1bff30d26d7fec895445136f99c259d13f7106a698721828472eaeb35475ebb9b4a83a32f4d323f17045c16dfba248ec708c9701e696fb146ed3739326c075650c4b35c328d1aa4c7bf28f368fea0825d1a96586a46de8cb604802ea1e284d4bc46a65b945fa385e19991cd0e1832bc3bd2b5a0521668246829b406f82fbe219014be881a35e0846947944c8e4441458b7d39ede48480c3db84e5d76b85cdf5fd9e68df29996f1552a9f119d6413968ae339301bbfc7e047bde19c2889df54b7814008a0087324f1b26767e03b34f8ca73b29c28ef7f307f7fcb75ce3f4bd845d21725ce2c48d5ba6bcf3bd75023be45fb836c1358b10f44ab3794f13dcf37c2bdb5f2cb404056e522dcc321e140b8b3d3826ca03698435f3bd1e81942f455d4af8b11bff28e92cc6310a97ed72a19069d130d36fbbf118f84d93c32f1067402b5f93b5b3c5595afe0b575bf5b69a55c8a5483fc085a2304919932ce841f06f37ad3a377b774005f1055bb899aed1a230d7910754f6541b3f8af7e1742242fb428e091274c5af50b690ec34e29f8c6b8beeca3c815ab30712db732ff00f4e390ea0f8fd764bf0121997829ee8a970407e1c774c4b4cc1caebc5843597c16095dad75cabc43cde5e27d78496ad9e93277a358506566caf47ce8ed5b2fbc8ce2d5bcca82da858a7afc1ed0d9f460014a041b418a4ad584e9054c66a0008c509fda0b42e8e10afda322c3b85255fe6eff463933aec3e304248504322087705f72b0c8bdf59f917bbcd54da79f35af28d222f8022fff7aeeb4c0bf10f3096e0e5e63800a3c393a4242e9c3a38d792c78e74af1bfa775f42f3c880572b207e92515fefa69b96862847f97d5bf5a9c5d948a32e95f32051efce3248e1e7458a78c634343028b439d8885230935ff4ae803f3cf620d70d44077986392535a8c144cad713be7d1a1cc17ed00a53709f04a4cd11ef117ce36b0a7ef55b6522a52fb8b170e82d08ed0a4ce15d470af2b843df611d4acdad7a13677ac554dda3cba4264e62699ce066ab47461737dd2e2cac23e672da40e028c894c3bd52d2b8fb19e1dc044873d1e4f530c10c4ff1e6576a88ccaaf0fcce3aeaf0b9f6802a6e489e95e08d31665f5db7dea1199b669d0eba63bd971e242bcfe12b0f93479c4a78c56d6d6e6278aaf5c83c1d023ed300015e7c4c3d29f91c2bfee382b4f1b12fd12414051067804a20604c5bf467ee4d2a38b19d9f66b08c6bdf8ed884811e5c0bb2e7981a6427124a2d2adc67aa73a6fc6ff75cee9c12442dfdb9b45c02fe718194466033768caf95e2e4a744b9b0022420bb41e856b48acaa81c498d88c358a90eb91b58928980031118c5b79a460f4d5700916b74afea1859d4787ad9ce118b179a560787d9ea5c207736dba49bce26ed38716cf8c4381c05d40109143514a45733a071c610725a080e6f877796d5779a23f9a1564e3398ea828be12aba35c00d3ff8037b2a143f593d3cd184f46220fa80fad6f20625cc47532a90207d50cbe66c8540e7db095233173f7cc7d3018548c89dc112ff398fd663df734f14d8283a1ac090c2a8ec58ddd7ace5cc3761fb29dcfb76f693a084a0335c611c17df7f10e0660900f302998211f8c83dff923368382019af2a16c4e98e11ef9c17caa6aa43a34aac8b22a18cace232f06a30be498cd391563782909a77d14d4b48512d143b7ec01ff5029309175d9e819034f3164792f224b2fc4fde8208bdb44ba8ff334034ccc772bbb2c476af27d308a865e21dc88e9abe5eefd3a49caa496c14a1f7ca8d37a2201312d573e696588976b60e04d25a580e6404b8645414b89332f4192b5265bc5af2bd82d712a5e39552b4e8b13d9ea56784137f55d305840d26d529d5aa5a003c1d4434f4a92b14f7b6e89089861db8c1de82be99f8a80952f4dfddbe086c8585e89eb8d1d7254d4b1437e4755418edabe91574f6ad2fed924751d41b8bb822a834eaba81ae09f534f68798a51d50ff68d213f28608e5aff8842e873047947b2a5d5631a0fffc75ae66df1f906a26e821f5b79c73df0277baea00c48da28ab3844f24db226ab83d38cd1a75131bdbced5b09299dee2d72c49a45641332b8c1b6c06e9e1ac073c20fce2125cdbce846951e51c2acc3c3d3bb3910ba86f7401b586f58b2ef5dfebddac4f5b1eeef80d97f16c538d66922a73c07ea2490a9ee31e23b9f71db605fce2eb2fa773ef993dd9b8cf1f76e93d7f4ae4c65662424fae50cde1013afb6dff419a7d994f39483b9a68a44e081ac118e3e0d07b3910604128162123bc39c53b34a9c2a844c4794648ac54a4f455a7c62da1d5f81e7c9c6016e82df1463ac67ecf82f217b41030d753f5b344cbb94d7699f3efc9eff1c3a4b4739149d43d5148fc7010a5714d46439dfddb4b87c7501d5c18c4a6c1033328a94712583d6a1efd61774f68aeb9a75c8c285cb1683919c26b484db4e954bf64419bea1936978c26e10a3f85e1a15e5f5b62510a101b2c6b149cafe2b3080b1ef88e68ee9f87fb23ae286fd1778d296213a3ec5602b12c91aa1f001695650ad13a784dc4969953c58ed29cfd6e599f4670d20e3196c3e7d12fbca910af3bb537b9bcebca5a31a900944a9af31e65d4d351e32bbb2308d0240eddc0641cb14995a1ccc7da0200419ae2b081b9e60fe532029e4ad62dbfc6539c7c6ec9c169386db511fa7071b93299d5d8b6666ac16ebda71f5ccc17b17a098311d2f9fb3c755e1a233edd753e5ad664168656b55fe2c7b41768ef5c76afc59baaf8dbecc50fa8a1d4c286632ed0923ceeaf635f3c33071c8a2a0f5dade6459fc183ef5b6ad39da5e885e82a056884b7664d0f45a799ec3841db08d3336daeb68b91d39ab5e0d0095175035dfbe1c400a7f9cb4a3494da4d85b8d33839ac137c7eaf6e28ed785534ad3a20c797b9ef045da1cad896e1af8a81d2fdc133213d3f18260eab88523d6514840a2a34fa200f89f63553f25d49388363acc5f699804200e905ed0511ffff6463ea9738c59bd56f95fd9427bce39c7afa671bca07aa5a17477eb79a7c767415f33dea99da40e5f94912cc70837b3057d2d84529a7413966a03dad5dac3ee1592de2d3c346da5dcdaa8044fa66657acb6d1c7790d4b28631eff90d5f8ea424ff7b19fbc353131e33089dfe3330e570fcd366b481a394998344d4a216aea60de41e63a095a6a0d2a9da88acac2353cb2a842f38637345977fb67a7bd996600e401df6b467c65c5b4a5da88730ba5446a3dde1f2d156b548d86c76d9cb42e45e537e65f16ed450974fc3f86a218e08810b5c774402636324055759b314b82d0857e6da5dd4b3559a715b913e4943ebfba1d2f14153cde3459c07271efc72bab18e97ed2ced2ceea4d661a28bbe78aecf6f15df9dc50a0590d391188ea34509c7d46282d4300b30c5675fe0e8851f6f8946d3726b4ea815ed074b27733044e1b26a5593eb6a54afa04e33679586065b078f9b7393e9c25f4320f92f58f2e75e6e2bdbb08ae862f4f95c1426714784007d1b53aec9b2059232c301957bff967a873589d61a614318d06bbd389b201a3ff0e6531e8e3af94360c16edc5834888887ca86dfc9cfd7048d3b39533335339448ccbb7fe08da41c4acd542e3cb06f685a58ae0149dba4aab1a1f47ec741d1bd52298a7dfad96704797066746de39fe760d5e054eed568c7d479a724ba56b2dd85ecf8b90f44f895d03ad7953dbba2bd8bb9cae6930a7c00a04fa032a7a22d7288aad40fc702a506961a59e4cac3a6b560a575d254ee09f0c993d2ee2184991e85ea46b4ecc58e3de4eb31b5d5c72e1c329723c9c33423028d8408c9c03ffcfe72caeb842cbec0e399203650ab0c306f687ef7209c73d3ab81e98b4e074454fdc260b97d631064d5494b4382f440c78e83c4fc3db7bae2004357b27e518a9ffddb7fe3968ae778dd94720d63bff4badafc36f95407826b3513312aa5b2cdb33117e4ec171ca33da352345582f2d090fe7fa7ebb71fe01664e6009b90df433ce0222668ff9e7da1589a9e8acae28416dd31dcd59ec5942d207fef798e6260cbe91710dee2766c26e290d5bb1f0dc3afe9093f9e7952dfff319c6e334fb1a7432d2dfc80527f08e8ce0b3ba7770ff6b36125706df21ce5d192dcd2341efd69d9922a4eeea5994efa9550c39b15758bea4a9ef63718d471f9353195675f842212102d1ace4752b964dff3b0ed90bdb8440daccd26b422f9e6a1a22f9277e335a14a2944a3041d6ce323c403763d81c233976b0e73f829edb89511bb4c88b86a9cf879a856b35487518582841a5c517563edcb060b30cb798a164a22d2094a16a803120582e397fcb25ba4c1fc7badc9cce5258ded1e26ca58cd08d9b35c63a82ee6e7258175821e5d40d47f9b71b3a1449f0b56393e08129d6312f587954044cdc9c39d65cf496fe928097f20f4e0a8f06dba96d5166b6cdd83f78d17c638e0a29d85d73714456dfec50f9f0f7747e9eb695264b36a41f34b3c079bba1cfd5f8105af81ff998134e58d16b4c7a1e686b2651c2bf8b96105efc0ad7b62cc55c3ba3e44da61d3da3ff4eea08ba8c157a460986abb5721bc74d33f9b45bb394c108327b7799ce10f591be8da9a46b19eb94136a358572311ae151bc65359961f453ee9e5b0d8dcc09993fc3c687453abc0c84df84e364195ebfd85136e06cdf7e11fb55ae42230a2de6a9633ef0dc6d225594fd8fecb806f6654609e41b275d9690f99e14d8ad882645dc0fb5c091e2c4a964f402e7fd440447f9f3a4df67ff87533e683927346071c60422811e20599c1c5683ed33d2ea10369499de613051d2d4a9d3826457da73c0cc4efd4c9732a760aa72c20846219a15e9fa11e1f743be3bcecea9c663a3659ee9f2386cb24a46f348b3b105a8ce7484fad118ee67b7c8a0510c51440d8ba6d5aa5813f4d7f5e28e8f9d07ea20b02659d5aceae24c294707a102e2ffd77bbe702068266233cfa8d6f5dbcb791b9c79259b9842e12fc5a701f3e9f21d3c064472c751faa91a238e4b4756f8b3f5e396e8443f91910dd97c78e1239965f1be30baa8dc6fa46e8d4818c8143bfdeff0e051449853e17430115c4109ccec1963c1be2592d0a0934e5ded5dba87f358a33edeca5a5e41802acfedec99292e95a001ff62fb3023b3a1c9c6df1259f5cc0a1e6a04ab2a0073d41b45883e750197041d91848774ecf8bf4376fd66daa7d468ce51c995a35770c6d4f7a8870e7e44093b7c90f20650d67b304d3bdc1de733979632474814fb035e96495aaac7bb9fdc112b978d986c148fef12ae2c2a21078753aee384c7628fa5e2385be909bcfb8533da0e6c87a7a5d2d4da768a73fb5fe17559845b60b6de8899691eed416a7340986d669a1ec28fee14e1814fca35c274bb5058d7208be853bc83843f63b64092d2d2</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-up">      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-up">æ–‡ç« å·²è¢«éšè—ï¼Œå¯èƒ½ä¸ºç§å¯†å†…å®¹æˆ–è¿˜æœªå®Œæˆã€‚</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">???</summary>
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/categories/Linux/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
    <category term="è°ƒç”¨é“¾" scheme="https://blog.godmao.top/Tags/%E8%B0%83%E7%94%A8%E9%93%BE/"/>
    
  </entry>
  
  <entry>
    <title>å¤§èŸ’è›‡-sys/argparseåº“</title>
    <link href="https://blog.godmao.top/posts/22025/"/>
    <id>https://blog.godmao.top/posts/22025/</id>
    <published>2025-09-29T12:53:30.000Z</published>
    <updated>2025-09-29T14:34:58.586Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><h1 id="sysåº“"><a class="markdownIt-Anchor" href="#sysåº“"></a> sysåº“</h1><p><code>sys</code>Â æ˜¯ Python æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œæä¾›äº†ä¸ Python è§£é‡Šå™¨åŠå…¶ç¯å¢ƒäº¤äº’çš„åŠŸèƒ½ã€‚<br />é€šè¿‡Â <code>sys</code>Â åº“ï¼Œä½ å¯ä»¥è®¿é—®ä¸ Python è§£é‡Šå™¨ç›¸å…³çš„å˜é‡å’Œå‡½æ•°ï¼Œä¾‹å¦‚å‘½ä»¤è¡Œå‚æ•°ã€æ ‡å‡†è¾“å…¥è¾“å‡ºã€ç¨‹åºé€€å‡ºç­‰ã€‚å‘½ä»¤è¡Œå‚æ•°éƒ¨åˆ†å¯ç”¨<code>argparse</code>åº“æ›¿ä»£ã€‚</p><h2 id="sysargv"><a class="markdownIt-Anchor" href="#sysargv"></a> sys.argv</h2><p>æè¿°ï¼šå‘½ä»¤è¡Œå‚æ•°çš„åˆ—è¡¨ã€‚<code>sys.argv[0]</code>Â æ˜¯è„šæœ¬çš„åç§°ï¼Œåç»­å…ƒç´ æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°ã€‚<br />è¯­æ³•ï¼š<code>sys.argv[]</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è„šæœ¬åç§°:"</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å‚æ•°åˆ—è¡¨:"</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="sysexit"><a class="markdownIt-Anchor" href="#sysexit"></a> sys.exit</h2><p>æè¿°ï¼šç”¨äºé€€å‡ºç¨‹åºã€‚ä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªæ•´æ•°ä½œä¸ºé€€å‡ºçŠ¶æ€ç ï¼Œé€šå¸¸Â <code>0</code>Â è¡¨ç¤ºæˆåŠŸï¼Œéé›¶å€¼è¡¨ç¤ºé”™è¯¯ã€‚<br />è¯­æ³•ï¼š<code>sys.exit(numï¼‰</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¨‹åºå¼€å§‹"</span><span class="token punctuation">)</span>sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¿™è¡Œä»£ç ä¸ä¼šæ‰§è¡Œ"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="sysstdinstdoutstderr"><a class="markdownIt-Anchor" href="#sysstdinstdoutstderr"></a> sys.stdin/stdout/stderr</h2><p>æè¿°ï¼š<code>sys.stdin</code>ã€<code>sys.stdout</code>Â å’ŒÂ <code>sys.stderr</code>Â åˆ†åˆ«ä»£è¡¨æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯æµã€‚ä½ å¯ä»¥é‡å®šå‘è¿™äº›æµä»¥å®ç°è‡ªå®šä¹‰çš„è¾“å…¥è¾“å‡ºè¡Œä¸ºã€‚<br />è¯­æ³•ï¼š<code>sys.stderr.write(&quot;err&quot;)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token comment"># é‡å®šå‘æ ‡å‡†è¾“å‡ºåˆ°æ–‡ä»¶</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'output.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> f    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¿™è¡Œå†…å®¹å°†å†™å…¥ output.txt"</span><span class="token punctuation">)</span><span class="token comment"># æ¢å¤æ ‡å‡†è¾“å‡º</span>sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> sys<span class="token punctuation">.</span>__stdout__<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¿™è¡Œå†…å®¹å°†æ˜¾ç¤ºåœ¨æ§åˆ¶å°"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="sysversionversion_info"><a class="markdownIt-Anchor" href="#sysversionversion_info"></a> sys.version/version_info</h2><p>æè¿°ï¼šæä¾›äº†å½“å‰ Python è§£é‡Šå™¨çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚<br />è¯­æ³•ï¼š<code>sys.version</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Python ç‰ˆæœ¬:"</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>version<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç‰ˆæœ¬ä¿¡æ¯:"</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>version_info<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="syspath"><a class="markdownIt-Anchor" href="#syspath"></a> sys.path</h2><p>æè¿°ï¼šåˆ—è¡¨ï¼ŒåŒ…å«äº† Python è§£é‡Šå™¨åœ¨å¯¼å…¥æ¨¡å—æ—¶æœç´¢çš„è·¯å¾„ã€‚å¯ä»¥ä¿®æ”¹è¿™ä¸ªåˆ—è¡¨æ¥æ·»åŠ è‡ªå®šä¹‰çš„æ¨¡å—æœç´¢è·¯å¾„ã€‚<br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¨¡å—æœç´¢è·¯å¾„:"</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>path<span class="token punctuation">)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'/custom/path'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ›´æ–°åçš„æ¨¡å—æœç´¢è·¯å¾„:"</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…¶ä»–"><a class="markdownIt-Anchor" href="#å…¶ä»–"></a> å…¶ä»–</h2><table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>sys.modules</code></td><td>å·²åŠ è½½æ¨¡å—çš„å­—å…¸</td></tr><tr><td><code>sys.platform</code></td><td>æ“ä½œç³»ç»Ÿå¹³å°æ ‡è¯†ï¼ˆå¦‚Â <code>'win32'</code>,Â <code>'linux'</code>,Â <code>'darwin'</code>ï¼‰</td></tr><tr><td><code>sys.executable</code></td><td>Python è§£é‡Šå™¨çš„ç»å¯¹è·¯å¾„</td></tr><tr><td><code>sys.byteorder</code></td><td>å­—èŠ‚åºï¼ˆ<code>'little'</code>Â æˆ–Â <code>'big'</code>ï¼‰</td></tr><tr><td><code>sys.maxsize</code></td><td>æœ€å¤§æ•´æ•°å€¼ï¼ˆ<code>2**31-1</code>Â æˆ–Â <code>2**63-1</code>ï¼‰</td></tr></tbody></table><h1 id="argparseråº“"><a class="markdownIt-Anchor" href="#argparseråº“"></a> argparseråº“</h1><h2 id="argumentparser"><a class="markdownIt-Anchor" href="#argumentparser"></a> ArgumentParser</h2><p>æè¿°ï¼šç”¨äºåˆ›å»ºè§£æå‘½ä»¤è¡Œå‚æ•°çš„å¯¹è±¡ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>prog<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> usage<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> epilog<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> parents<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> formatter_class<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'argparse.HelpFormatter'</span><span class="token operator">></span><span class="token punctuation">,</span> prefix_chars<span class="token operator">=</span><span class="token string">'-'</span><span class="token punctuation">,</span> fromfile_prefix_chars<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> argument_default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> conflict_handler<span class="token operator">=</span><span class="token string">'error'</span><span class="token punctuation">,</span> add_help<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> argparseparser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">"Example parser"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="add_argumenté‡ç‚¹"><a class="markdownIt-Anchor" href="#add_argumenté‡ç‚¹"></a> add_argumentâ€”â€”é‡ç‚¹</h2><p>æè¿°ï¼šå‘ArgumentParserå¯¹è±¡æ·»åŠ å‘½ä»¤è¡Œå‚æ•°ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>name <span class="token keyword">or</span> flags<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store'</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> const<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> choices<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> metavar<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--verbose'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'Increase output verbosity'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¡¥å……ï¼š</p><table><thead><tr><th>é”®</th><th>æ¥å—çš„å€¼</th><th>ä½œç”¨</th><th>ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>name</td><td>å­—ç¬¦ä¸²</td><td>å˜é‡çš„åå­—</td><td>â€˜radiusâ€™</td></tr><tr><td>nargs</td><td>æ•°å­—æˆ–â€™?â€˜æˆ–â€™â€˜æˆ–â€™+â€™</td><td>ç”¨æ¥è¯´æ˜ä¼ å…¥çš„å‚æ•°ä¸ªæ•°ï¼ˆç¬¦å·æ„ä¹‰å’Œæ­£åˆ™è¡¨è¾¾å¼é‡Œçš„ä¸€è‡´)</td><td>nargs=â€™?â€™ nargs=2</td></tr><tr><td>type</td><td>list, str, tuple, set, dictç­‰</td><td>è®¾ç½®è¯»å–å‚æ•°çš„ç±»å‹</td><td>type=int</td></tr><tr><td>default</td><td>ç±»å‹è·Ÿtypeç»Ÿä¸€</td><td>è®¾ç½®é»˜è®¤å€¼</td><td>default=1</td></tr><tr><td>choices</td><td>è£…é€‰é¡¹çš„list</td><td>å‚æ•°å€¼åªèƒ½ä»å‡ ä¸ªé€‰é¡¹é‡Œé¢é€‰æ‹©</td><td>choices=[1,2,3,4]</td></tr><tr><td>required</td><td>Trueæˆ–False</td><td>è¿™ä¸ªå¯é€‰å‚æ•°æ˜¯å¦å¿…é¡»æœ‰ï¼ˆåªèƒ½ç”¨äºå¯é€‰å‚æ•°ï¼å¦åˆ™æŠ¥é”™ï¼‰</td><td>required=True</td></tr><tr><td>help</td><td>å­—ç¬¦ä¸²</td><td>è¯´æ˜ä¸€ä¸‹è¿™ä¸ªå‚æ•°æ˜¯å¹²å˜›çš„</td><td>help=â€œI donâ€™t knowâ€</td></tr><tr><td>action</td><td>å…­ç§å†…ç½®åŠ¨ä½œ</td><td>ä¸€æ—¦è¿™ä¸ªæœ‰å‚æ•°ï¼Œå°±ä¼šè§¦å‘ç›¸åº”çš„åŠ¨ä½œ</td><td>action=â€˜store_trueâ€™</td></tr></tbody></table><h2 id="parse_args"><a class="markdownIt-Anchor" href="#parse_args"></a> parse_args</h2><p>æè¿°ï¼šè§£æå‘½ä»¤è¡Œå‚æ•°ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span>args<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token punctuation">[</span>arg name<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="set_defaults"><a class="markdownIt-Anchor" href="#set_defaults"></a> set_defaults</h2><p>æè¿°ï¼šä¸ºæŒ‡å®šçš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>set_defaults<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parser<span class="token punctuation">.</span>set_defaults<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"John Doe"</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="print_help"><a class="markdownIt-Anchor" href="#print_help"></a> print_help</h2><p>æè¿°ï¼šæ‰“å°å¸®åŠ©ä¿¡æ¯ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>print_help<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parser<span class="token punctuation">.</span>print_help<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="add_subparsers"><a class="markdownIt-Anchor" href="#add_subparsers"></a> add_subparsers</h2><p>æè¿°ï¼šä¸ºArgumentParserå¯¹è±¡æ·»åŠ å­å‘½ä»¤è§£æå™¨ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>add_subparsers<span class="token punctuation">(</span>dest<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> parser_class<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'argparse.ArgumentParser'</span><span class="token operator">></span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">subparsers <span class="token operator">=</span> parser<span class="token punctuation">.</span>add_subparsers<span class="token punctuation">(</span>dest<span class="token operator">=</span><span class="token string">'command'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¿™ä¸Šé¢å‡ ä¸ªæ˜¯æœ€å¸¸ç”¨çš„ã€‚</p></blockquote><hr /><h2 id="add_mutually_exclusive_group"><a class="markdownIt-Anchor" href="#add_mutually_exclusive_group"></a> add_mutually_exclusive_group</h2><p>æè¿°ï¼šåˆ›å»ºä¸€ä¸ªäº’æ–¥çš„å‚æ•°ç»„ï¼ŒåŒä¸€æ—¶é—´åªèƒ½ä½¿ç”¨ç»„å†…ä¸€ä¸ªå‚æ•°ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>add_mutually_exclusive_group<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">group <span class="token operator">=</span> parser<span class="token punctuation">.</span>add_mutually_exclusive_group<span class="token punctuation">(</span><span class="token punctuation">)</span>group<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--foo'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">)</span>group<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--bar'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="parse_known_args"><a class="markdownIt-Anchor" href="#parse_known_args"></a> parse_known_args</h2><p>æè¿°ï¼šè§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œä½†è¿”å›ä¸€ä¸ªåŒ…å«å·²çŸ¥å‚æ•°å’ŒæœªçŸ¥å‚æ•°çš„å…ƒç»„ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>parse_known_args<span class="token punctuation">(</span>args<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">args<span class="token punctuation">,</span> unknown <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_known_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="convert_arg_line_to_args"><a class="markdownIt-Anchor" href="#convert_arg_line_to_args"></a> convert_arg_line_to_args</h2><p>æè¿°ï¼šå°†ä»æ–‡ä»¶è¯»å–çš„ä¸€è¡Œè½¬æ¢ä¸ºå‚æ•°åˆ—è¡¨ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>convert_arg_line_to_args<span class="token punctuation">(</span>arg_line<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">args <span class="token operator">=</span> parser<span class="token punctuation">.</span>convert_arg_line_to_args<span class="token punctuation">(</span><span class="token string">"foo --bar=3"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="error"><a class="markdownIt-Anchor" href="#error"></a> error</h2><p>æè¿°ï¼šåœ¨å‘½ä»¤è¡Œå‚æ•°è§£æè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>error<span class="token punctuation">(</span>message<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parser<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Invalid argument"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="exit"><a class="markdownIt-Anchor" href="#exit"></a> exit</h2><p>æè¿°ï¼šåœ¨è§£æå‘½ä»¤è¡Œå‚æ•°æ—¶é‡åˆ°é”™è¯¯æ—¶ï¼Œé€€å‡ºç¨‹åºã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>status<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parser<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>message<span class="token operator">=</span><span class="token string">"Exiting due to error"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="parse_args_from_file"><a class="markdownIt-Anchor" href="#parse_args_from_file"></a> parse_args_from_file</h2><p>æè¿°ï¼šä»æ–‡ä»¶ä¸­è¯»å–å‚æ•°å¹¶è§£æã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>parse_args_from_file<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parser<span class="token punctuation">.</span>parse_args_from_file<span class="token punctuation">(</span><span class="token string">'args.txt'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="add_argument_group"><a class="markdownIt-Anchor" href="#add_argument_group"></a> add_argument_group</h2><p>æè¿°ï¼šåˆ›å»ºä¸€ä¸ªå‚æ•°ç»„ï¼Œç”¨äºç»„ç»‡å’Œæè¿°ç›¸å…³å‚æ•°ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>add_argument_group<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">group <span class="token operator">=</span> parser<span class="token punctuation">.</span>add_argument_group<span class="token punctuation">(</span><span class="token string">'Optional arguments'</span><span class="token punctuation">)</span>group<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--output'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'Output file'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="format_help"><a class="markdownIt-Anchor" href="#format_help"></a> format_help</h2><p>æè¿°ï¼šè¿”å›å½“å‰å¸®åŠ©ä¿¡æ¯çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ArgumentParser<span class="token punctuation">.</span>format_help<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">help_text <span class="token operator">=</span> parser<span class="token punctuation">.</span>format_help<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="python" scheme="https://blog.godmao.top/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.godmao.top/Tags/python/"/>
    
    <category term="sys" scheme="https://blog.godmao.top/Tags/sys/"/>
    
    <category term="argparse" scheme="https://blog.godmao.top/Tags/argparse/"/>
    
  </entry>
  
  <entry>
    <title>å¤§èŸ’è›‡-shutilåº“</title>
    <link href="https://blog.godmao.top/posts/22415/"/>
    <id>https://blog.godmao.top/posts/22415/</id>
    <published>2025-09-29T12:41:07.000Z</published>
    <updated>2025-09-29T14:02:36.939Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><p>shutilåº“ä¸»è¦ç”¨äºæ–‡ä»¶çš„é«˜çº§æ“ä½œï¼Œæ¯”å¦‚ç§»åŠ¨ã€å¤åˆ¶ã€å‹ç¼©å’Œè§£å‹</p><h2 id="shutilcopy"><a class="markdownIt-Anchor" href="#shutilcopy"></a> shutil.copy</h2><p>æè¿°ï¼šå¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„ã€‚<br />è¯­æ³•ï¼š<code>shutil.copy(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token string">'source.txt'</span><span class="token punctuation">,</span> <span class="token string">'destination.txt'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shutilcopy2"><a class="markdownIt-Anchor" href="#shutilcopy2"></a> shutil.copy2</h2><p>æè¿°ï¼šå¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„ï¼ŒåŒæ—¶ä¿ç•™æ–‡ä»¶çš„å…ƒæ•°æ®ã€‚<br />è¯­æ³•ï¼š<code>shutil.copy2(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>copy2<span class="token punctuation">(</span><span class="token string">'source.txt'</span><span class="token punctuation">,</span> <span class="token string">'destination.txt'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shutilcopytree"><a class="markdownIt-Anchor" href="#shutilcopytree"></a> shutil.copytree</h2><p>æè¿°ï¼šé€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•æ ‘ã€‚<br />è¯­æ³•ï¼š<code>shutil.copytree(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>copytree<span class="token punctuation">(</span><span class="token string">'source_dir'</span><span class="token punctuation">,</span> <span class="token string">'destination_dir'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shutilmove"><a class="markdownIt-Anchor" href="#shutilmove"></a> shutil.move</h2><p>æè¿°ï¼šç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•åˆ°æŒ‡å®šè·¯å¾„ã€‚<br />è¯­æ³•ï¼š<code>shutil.move(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span><span class="token string">'source.txt'</span><span class="token punctuation">,</span> <span class="token string">'destination.txt'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shutilrmtree"><a class="markdownIt-Anchor" href="#shutilrmtree"></a> shutil.rmtree</h2><p>æè¿°ï¼šé€’å½’åˆ é™¤ç›®å½•æ ‘ã€‚æ…ç”¨ï¼<br />è¯­æ³•ï¼š<code>shutil.rmtree(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>rmtree<span class="token punctuation">(</span><span class="token string">'directory'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shutildisk_usage"><a class="markdownIt-Anchor" href="#shutildisk_usage"></a> shutil.disk_usage</h2><p>æè¿°ï¼šè¿”å›ç£ç›˜çš„æ€»å®¹é‡ã€å·²ç”¨ç©ºé—´å’Œå‰©ä½™ç©ºé—´ã€‚<br />è¯­æ³•ï¼š<code>shutil.disk_usage(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutiltotal<span class="token punctuation">,</span> used<span class="token punctuation">,</span> free <span class="token operator">=</span> shutil<span class="token punctuation">.</span>disk_usage<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Total: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>total<span class="token punctuation">&#125;</span></span><span class="token string">, Used: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>used<span class="token punctuation">&#125;</span></span><span class="token string">, Free: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>free<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="shutilchown"><a class="markdownIt-Anchor" href="#shutilchown"></a> shutil.chown</h2><p>æè¿°ï¼šæ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œç»„ã€‚<br />è¯­æ³•ï¼š<code>shutil.chown(path, user=None, group=None)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>chown<span class="token punctuation">(</span><span class="token string">'file.txt'</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">'groupname'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shutilunpack_archive"><a class="markdownIt-Anchor" href="#shutilunpack_archive"></a> shutil.unpack_archive</h2><p>æè¿°ï¼šè§£å‹å½’æ¡£æ–‡ä»¶ã€‚<br />è¯­æ³•ï¼š<code>shutil.unpack_archive(filename, extract_dir=None)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>unpack_archive<span class="token punctuation">(</span><span class="token string">'archive.zip'</span><span class="token punctuation">,</span> <span class="token string">'destination_folder'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shutilget_archive_formats"><a class="markdownIt-Anchor" href="#shutilget_archive_formats"></a> shutil.get_archive_formats</h2><p>æè¿°ï¼šè·å–æ”¯æŒçš„å½’æ¡£æ ¼å¼åˆ—è¡¨ã€‚<br />è¯­æ³•ï¼š<code>shutil.get_archive_formats()</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilformats <span class="token operator">=</span> shutil<span class="token punctuation">.</span>get_archive_formats<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>formats<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="shutilmake_archive"><a class="markdownIt-Anchor" href="#shutilmake_archive"></a> shutil.make_archive</h2><p>æè¿°ï¼šåˆ›å»ºä¸€ä¸ªå½’æ¡£æ–‡ä»¶ã€‚<br />è¯­æ³•ï¼š<code>shutil.make_archive(base_name, format, root_dir=None, base_dir=None)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>make_archive<span class="token punctuation">(</span><span class="token string">'archive_name'</span><span class="token punctuation">,</span> <span class="token string">'zip'</span><span class="token punctuation">,</span> <span class="token string">'folder_to_compress'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="shutilmove-2"><a class="markdownIt-Anchor" href="#shutilmove-2"></a> shutil.move</h2><p>æè¿°ï¼šç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•åˆ°æŒ‡å®šè·¯å¾„ã€‚<br />è¯­æ³•ï¼š<code>shutil.move(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> shutilshutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span><span class="token string">'source.txt'</span><span class="token punctuation">,</span> <span class="token string">'destination_folder'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="python" scheme="https://blog.godmao.top/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.godmao.top/Tags/python/"/>
    
    <category term="shutil" scheme="https://blog.godmao.top/Tags/shutil/"/>
    
  </entry>
  
  <entry>
    <title>å¤§èŸ’è›‡-pathlibåº“</title>
    <link href="https://blog.godmao.top/posts/63515/"/>
    <id>https://blog.godmao.top/posts/63515/</id>
    <published>2025-09-28T11:21:17.000Z</published>
    <updated>2025-09-28T11:24:37.373Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><h1 id="python-pathlib-æ¨¡å—å¸¸ç”¨å‡½æ•°é€ŸæŸ¥è¡¨"><a class="markdownIt-Anchor" href="#python-pathlib-æ¨¡å—å¸¸ç”¨å‡½æ•°é€ŸæŸ¥è¡¨"></a> Python pathlib æ¨¡å—å¸¸ç”¨å‡½æ•°é€ŸæŸ¥è¡¨</h1><h2 id="path"><a class="markdownIt-Anchor" href="#path"></a> Path()</h2><p>æè¿°ï¼šåˆ›å»ºä¸€ä¸ªè·¯å¾„å¯¹è±¡<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Pathp <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">"path/to/file"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">"/home/user/test.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="exists"><a class="markdownIt-Anchor" href="#exists"></a> .exists()</h2><p>æè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="is_file"><a class="markdownIt-Anchor" href="#is_file"></a> .is_file()</h2><p>æè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºæ–‡ä»¶<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>is_file<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>is_file<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="is_dir"><a class="markdownIt-Anchor" href="#is_dir"></a> .is_dir()</h2><p>æè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºç›®å½•<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>is_dir<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>is_dir<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="is_symlink"><a class="markdownIt-Anchor" href="#is_symlink"></a> .is_symlink()</h2><p>æè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºç¬¦å·é“¾æ¥<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>is_symlink<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>is_symlink<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="iterdir"><a class="markdownIt-Anchor" href="#iterdir"></a> .iterdir()</h2><p>æè¿°ï¼šéå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>iterdir<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> child <span class="token keyword">in</span> p<span class="token punctuation">.</span>iterdir<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="glob"><a class="markdownIt-Anchor" href="#glob"></a> .glob()</h2><p>æè¿°ï¼šä½¿ç”¨é€šé…ç¬¦åŒ¹é…æ–‡ä»¶<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>glob<span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> p<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">"*.txt"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="rglob"><a class="markdownIt-Anchor" href="#rglob"></a> .rglob()</h2><p>æè¿°ï¼šé€’å½’åŒ¹é…æ–‡ä»¶<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>rglob<span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> p<span class="token punctuation">.</span>rglob<span class="token punctuation">(</span><span class="token string">"*.py"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="mkdir"><a class="markdownIt-Anchor" href="#mkdir"></a> .mkdir()</h2><p>æè¿°ï¼šåˆ›å»ºç›®å½•<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="rmdir"><a class="markdownIt-Anchor" href="#rmdir"></a> .rmdir()</h2><p>æè¿°ï¼šåˆ é™¤ç©ºç›®å½•<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>rmdir<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>rmdir<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="unlink"><a class="markdownIt-Anchor" href="#unlink"></a> .unlink()</h2><p>æè¿°ï¼šåˆ é™¤æ–‡ä»¶<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>unlink<span class="token punctuation">(</span>missing_ok<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>unlink<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="rename"><a class="markdownIt-Anchor" href="#rename"></a> .rename()</h2><p>æè¿°ï¼šé‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">"new_name.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="replace"><a class="markdownIt-Anchor" href="#replace"></a> .replace()</h2><p>æè¿°ï¼šé‡å‘½åå¹¶è¦†ç›–ç›®æ ‡æ–‡ä»¶<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"existing_file.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="read_text"><a class="markdownIt-Anchor" href="#read_text"></a> .read_text()</h2><p>æè¿°ï¼šè¯»å–æ–‡æœ¬æ–‡ä»¶å†…å®¹<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>read_text<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">content <span class="token operator">=</span> p<span class="token punctuation">.</span>read_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="write_text"><a class="markdownIt-Anchor" href="#write_text"></a> .write_text()</h2><p>æè¿°ï¼šå†™å…¥æ–‡æœ¬å†…å®¹<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>write_text<span class="token punctuation">(</span>data<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>write_text<span class="token punctuation">(</span><span class="token string">"Hello, world!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="read_bytes"><a class="markdownIt-Anchor" href="#read_bytes"></a> .read_bytes()</h2><p>æè¿°ï¼šè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶å†…å®¹<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>read_bytes<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> p<span class="token punctuation">.</span>read_bytes<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="write_bytes"><a class="markdownIt-Anchor" href="#write_bytes"></a> .write_bytes()</h2><p>æè¿°ï¼šå†™å…¥äºŒè¿›åˆ¶å†…å®¹<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>write_bytes<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>write_bytes<span class="token punctuation">(</span><span class="token string">b"binary data"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="joinpath"><a class="markdownIt-Anchor" href="#joinpath"></a> .joinpath()</h2><p>æè¿°ï¼šæ‹¼æ¥å­è·¯å¾„<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>joinpath<span class="token punctuation">(</span><span class="token operator">*</span>other<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">new_path <span class="token operator">=</span> p<span class="token punctuation">.</span>joinpath<span class="token punctuation">(</span><span class="token string">"subdir"</span><span class="token punctuation">,</span> <span class="token string">"file.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="with_name"><a class="markdownIt-Anchor" href="#with_name"></a> .with_name()</h2><p>æè¿°ï¼šè¿”å›åŒç›®å½•ä¸‹æ›´æ¢åç§°çš„è·¯å¾„<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>with_name<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">new_p <span class="token operator">=</span> p<span class="token punctuation">.</span>with_name<span class="token punctuation">(</span><span class="token string">"new.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="with_suffix"><a class="markdownIt-Anchor" href="#with_suffix"></a> .with_suffix()</h2><p>æè¿°ï¼šæ›´æ”¹æ–‡ä»¶åç¼€<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>with_suffix<span class="token punctuation">(</span>suffix<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">new_p <span class="token operator">=</span> p<span class="token punctuation">.</span>with_suffix<span class="token punctuation">(</span><span class="token string">".md"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="with_stem"><a class="markdownIt-Anchor" href="#with_stem"></a> .with_stem()</h2><p>æè¿°ï¼šæ›´æ”¹æ–‡ä»¶ä¸»å<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>with_stem<span class="token punctuation">(</span>stem<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">new_p <span class="token operator">=</span> p<span class="token punctuation">.</span>with_stem<span class="token punctuation">(</span><span class="token string">"newfile"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="resolve"><a class="markdownIt-Anchor" href="#resolve"></a> .resolve()</h2><p>æè¿°ï¼šè¿”å›ç»å¯¹è·¯å¾„<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>resolve<span class="token punctuation">(</span>strict<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">abs_path <span class="token operator">=</span> p<span class="token punctuation">.</span>resolve<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="absolute"><a class="markdownIt-Anchor" href="#absolute"></a> .absolute()</h2><p>æè¿°ï¼šè·å–ç»å¯¹è·¯å¾„ï¼ˆä¸è§£æç¬¦å·é“¾æ¥ï¼‰<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>absolute<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">abs_path <span class="token operator">=</span> p<span class="token punctuation">.</span>absolute<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="parent"><a class="markdownIt-Anchor" href="#parent"></a> .parent</h2><p>æè¿°ï¼šè¿”å›çˆ¶ç›®å½•è·¯å¾„<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>parent<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">parent_dir <span class="token operator">=</span> p<span class="token punctuation">.</span>parent<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="parents"><a class="markdownIt-Anchor" href="#parents"></a> .parents</h2><p>æè¿°ï¼šè¿”å›æ‰€æœ‰ä¸Šçº§ç›®å½•<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>parents<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> parent <span class="token keyword">in</span> p<span class="token punctuation">.</span>parents<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="name"><a class="markdownIt-Anchor" href="#name"></a> .name</h2><p>æè¿°ï¼šè·å–æ–‡ä»¶åï¼ˆå«åç¼€ï¼‰<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>name<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="stem"><a class="markdownIt-Anchor" href="#stem"></a> .stem</h2><p>æè¿°ï¼šè·å–æ–‡ä»¶ä¸»åï¼ˆä¸å«åç¼€ï¼‰<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>stem<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>stem<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="suffix"><a class="markdownIt-Anchor" href="#suffix"></a> .suffix</h2><p>æè¿°ï¼šè·å–æ–‡ä»¶åç¼€<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>suffix<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>suffix<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="suffixes"><a class="markdownIt-Anchor" href="#suffixes"></a> .suffixes</h2><p>æè¿°ï¼šè·å–æ‰€æœ‰åç¼€ï¼ˆé€‚ç”¨äºå¤šé‡åç¼€ï¼‰<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>suffixes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>suffixes<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="as_posix"><a class="markdownIt-Anchor" href="#as_posix"></a> .as_posix()</h2><p>æè¿°ï¼šè½¬æ¢ä¸ºPOSIXé£æ ¼è·¯å¾„å­—ç¬¦ä¸²<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>as_posix<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>as_posix<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="as_uri"><a class="markdownIt-Anchor" href="#as_uri"></a> .as_uri()</h2><p>æè¿°ï¼šè½¬æ¢ä¸ºæ–‡ä»¶URI<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>as_uri<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>as_uri<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="relative_to"><a class="markdownIt-Anchor" href="#relative_to"></a> .relative_to()</h2><p>æè¿°ï¼šè®¡ç®—ç›¸å¯¹è·¯å¾„<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>relative_to<span class="token punctuation">(</span><span class="token operator">*</span>other<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">rel <span class="token operator">=</span> p<span class="token punctuation">.</span>relative_to<span class="token punctuation">(</span><span class="token string">"/home/user"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="expanduser"><a class="markdownIt-Anchor" href="#expanduser"></a> .expanduser()</h2><p>æè¿°ï¼šå±•å¼€ <code>~</code> ä¸ºç”¨æˆ·ä¸»ç›®å½•<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>expanduser<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">"~/file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>expanduser<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="match"><a class="markdownIt-Anchor" href="#match"></a> .match()</h2><p>æè¿°ï¼šè·¯å¾„æ˜¯å¦åŒ¹é…æŒ‡å®šæ¨¡å¼<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">"*.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="chmod"><a class="markdownIt-Anchor" href="#chmod"></a> .chmod()</h2><p>æè¿°ï¼šä¿®æ”¹æ–‡ä»¶æƒé™<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>chmod<span class="token punctuation">(</span>mode<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>chmod<span class="token punctuation">(</span><span class="token number">0o755</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="stat"><a class="markdownIt-Anchor" href="#stat"></a> .stat()</h2><p>æè¿°ï¼šè·å–æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ï¼ˆå¤§å°ã€æƒé™ç­‰ï¼‰<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>stat<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">info <span class="token operator">=</span> p<span class="token punctuation">.</span>stat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>st_size<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="touch"><a class="markdownIt-Anchor" href="#touch"></a> .touch()</h2><p>æè¿°ï¼šåˆ›å»ºç©ºæ–‡ä»¶æˆ–æ›´æ–°ä¿®æ”¹æ—¶é—´<br />è¯­æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Path<span class="token punctuation">.</span>touch<span class="token punctuation">(</span>exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token punctuation">.</span>touch<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="python" scheme="https://blog.godmao.top/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.godmao.top/Tags/python/"/>
    
    <category term="pathlib" scheme="https://blog.godmao.top/Tags/pathlib/"/>
    
  </entry>
  
  <entry>
    <title>Pythonä¸­å…ƒç»„ã€åˆ—è¡¨ã€å­—å…¸å’Œé›†åˆçš„åŒºåˆ«</title>
    <link href="https://blog.godmao.top/posts/53459/"/>
    <id>https://blog.godmao.top/posts/53459/</id>
    <published>2025-09-28T08:38:06.000Z</published>
    <updated>2025-09-28T08:41:37.862Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><p>åœ¨Pythonä¸­ï¼Œå…ƒç»„ï¼ˆTupleï¼‰ã€åˆ—è¡¨ï¼ˆListï¼‰ã€å­—å…¸ï¼ˆDictionaryï¼‰å’Œé›†åˆï¼ˆSetï¼‰æ˜¯å››ç§å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œå®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œåº”ç”¨åœºæ™¯ã€‚</p><h2 id="åˆ—è¡¨list"><a class="markdownIt-Anchor" href="#åˆ—è¡¨list"></a> åˆ—è¡¨ï¼ˆListï¼‰</h2><p>åˆ—è¡¨æ˜¯ä¸€ç§æœ‰åºä¸”å¯å˜çš„æ•°æ®åºåˆ—ï¼Œå…è®¸å­˜å‚¨é‡å¤å…ƒç´ ã€‚</p><ul><li>å®šä¹‰æ–¹å¼ï¼šä½¿ç”¨æ–¹æ‹¬å·Â <em>[]</em>ï¼Œä¾‹å¦‚Â <em>example_list = [1, 2, â€œappleâ€, True]</em>ã€‚</li><li>ç‰¹ç‚¹ï¼šæ”¯æŒé€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ï¼Œå¯ä»¥åŠ¨æ€æ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹å…ƒç´ ã€‚</li><li>åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºéœ€è¦é¢‘ç¹ä¿®æ”¹çš„æœ‰åºæ•°æ®é›†ï¼Œä¾‹å¦‚è´­ç‰©æ¸…å•æˆ–åŠ¨æ€æ•°ç»„ã€‚</li></ul><h2 id="å…ƒç»„tuple"><a class="markdownIt-Anchor" href="#å…ƒç»„tuple"></a> å…ƒç»„ï¼ˆTupleï¼‰</h2><p>å…ƒç»„æ˜¯ä¸€ç§æœ‰åºä½†ä¸å¯å˜çš„æ•°æ®åºåˆ—ï¼Œå…è®¸å­˜å‚¨é‡å¤å…ƒç´ ã€‚</p><ul><li>å®šä¹‰æ–¹å¼ï¼šä½¿ç”¨åœ†æ‹¬å·Â <em>()</em>ï¼Œä¾‹å¦‚Â <em>example_tuple = (1, 2, â€œappleâ€, True)</em>ã€‚</li><li>ç‰¹ç‚¹ï¼šä¸€æ—¦åˆ›å»ºåï¼Œå†…å®¹æ— æ³•æ›´æ”¹ï¼Œé€‚åˆå­˜å‚¨å›ºå®šä¸å˜çš„æ•°æ®ã€‚</li><li>åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºéœ€è¦ä¿æŠ¤æ•°æ®ä¸è¢«ä¿®æ”¹çš„åœºæ™¯ï¼Œä¾‹å¦‚åæ ‡ç‚¹æˆ–æ•°æ®åº“æŸ¥è¯¢ç»“æœã€‚</li></ul><h2 id="é›†åˆset"><a class="markdownIt-Anchor" href="#é›†åˆset"></a> é›†åˆï¼ˆSetï¼‰</h2><p>é›†åˆæ˜¯ä¸€ç§æ— åºä¸”ä¸å…è®¸é‡å¤çš„å…ƒç´ é›†åˆã€‚</p><ul><li>å®šä¹‰æ–¹å¼ï¼šä½¿ç”¨å¤§æ‹¬å·Â <em>{}</em>Â æˆ–Â <em>set()</em>Â å‡½æ•°ï¼Œä¾‹å¦‚Â <em>example_set = {1, 2, â€œappleâ€, True}</em>ã€‚</li><li>ç‰¹ç‚¹ï¼šä¸æ”¯æŒç´¢å¼•è®¿é—®ï¼Œä½†å¯ä»¥è¿›è¡Œæ•°å­¦é›†åˆè¿ç®—ï¼ˆå¦‚äº¤é›†ã€å¹¶é›†ï¼‰ã€‚</li><li>åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºéœ€è¦å»é‡æˆ–å¿«é€Ÿåˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨çš„åœºæ™¯ï¼Œä¾‹å¦‚å¤„ç†å”¯ä¸€å€¼é›†åˆã€‚</li></ul><h2 id="å­—å…¸dictionary"><a class="markdownIt-Anchor" href="#å­—å…¸dictionary"></a> å­—å…¸ï¼ˆDictionaryï¼‰</h2><p>å­—å…¸æ˜¯ä¸€ç§é”®å€¼å¯¹çš„æ˜ å°„å®¹å™¨ï¼Œå…¶ä¸­é”®å¿…é¡»å”¯ä¸€ï¼Œå€¼å¯ä»¥é‡å¤ã€‚</p><ul><li>å®šä¹‰æ–¹å¼ï¼šä½¿ç”¨å¤§æ‹¬å·Â <em>{}</em>ï¼Œä¾‹å¦‚Â <em>example_dict = {â€œnameâ€: â€œAliceâ€, â€œageâ€: 25}</em>ã€‚</li><li>ç‰¹ç‚¹ï¼šä»Python 3.7å¼€å§‹ï¼Œå­—å…¸çš„æ’å…¥é¡ºåºä¿æŒä¸å˜ã€‚æ”¯æŒé€šè¿‡é”®å¿«é€ŸæŸ¥æ‰¾å¯¹åº”çš„å€¼ã€‚</li><li>åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºå­˜å‚¨é”®å€¼æ˜ å°„å…³ç³»çš„æ•°æ®ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“è¡¨ç»“æ„ã€‚</li></ul><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><ul><li>æœ‰åºæ€§ï¼šåˆ—è¡¨å’Œå…ƒç»„æ˜¯æœ‰åºçš„ï¼Œé›†åˆå’Œå­—å…¸æ— åºï¼ˆä½†å­—å…¸ä»Python 3.7èµ·ä¿æŒæ’å…¥é¡ºåºï¼‰ã€‚</li><li>å¯å˜æ€§ï¼šåˆ—è¡¨å’Œå­—å…¸æ˜¯å¯å˜çš„ï¼Œå…ƒç»„ä¸å¯å˜ï¼Œé›†åˆå¯å˜ä½†ä¸æ”¯æŒç´¢å¼•ã€‚</li><li>é‡å¤æ€§ï¼šé›†åˆä¸å…è®¸é‡å¤å…ƒç´ ï¼Œå…¶ä»–ä¸‰ç§ç»“æ„å…è®¸é‡å¤ï¼ˆå­—å…¸çš„é”®å¿…é¡»å”¯ä¸€ï¼‰ã€‚</li><li>åº”ç”¨åœºæ™¯ï¼šæ ¹æ®æ•°æ®çš„æœ‰åºæ€§ã€å¯å˜æ€§å’Œé‡å¤æ€§éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="python" scheme="https://blog.godmao.top/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.godmao.top/Tags/python/"/>
    
  </entry>
  
  <entry>
    <title>å¤§èŸ’è›‡-osåº“</title>
    <link href="https://blog.godmao.top/posts/37113/"/>
    <id>https://blog.godmao.top/posts/37113/</id>
    <published>2025-09-28T07:25:58.000Z</published>
    <updated>2025-09-28T11:21:43.056Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><h1 id="python-os-æ¨¡å—å‡½æ•°å¤§å…¨é€ŸæŸ¥è¡¨"><a class="markdownIt-Anchor" href="#python-os-æ¨¡å—å‡½æ•°å¤§å…¨é€ŸæŸ¥è¡¨"></a> Python <code>os</code> æ¨¡å—å‡½æ•°å¤§å…¨é€ŸæŸ¥è¡¨</h1><p><code>os</code> æ¨¡å—æ˜¯ Python æ ‡å‡†åº“ä¸­ç”¨äºä¸æ“ä½œç³»ç»Ÿäº¤äº’çš„æ¥å£ï¼Œæ¶µç›–äº†æ–‡ä»¶/ç›®å½•æ“ä½œã€ç¯å¢ƒå˜é‡ç®¡ç†ã€ç³»ç»Ÿä¿¡æ¯è·å–ã€è¿›ç¨‹æ§åˆ¶ç­‰è¯¸å¤šåŠŸèƒ½ã€‚æœ¬æ–‡æ•´ç†äº†å¸¸ç”¨å‡½æ•°åŠç¤ºä¾‹ï¼Œä¾¿äºæŸ¥é˜…ä½¿ç”¨ã€‚</p><h2 id="osgetcwd"><a class="markdownIt-Anchor" href="#osgetcwd"></a> os.getcwd()</h2><p>æè¿°ï¼šè·å–å½“å‰å·¥ä½œç›®å½•<br />è¯­æ³•ï¼š<code>os.getcwd()</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="oschdir"><a class="markdownIt-Anchor" href="#oschdir"></a> os.chdir()</h2><p>æè¿°ï¼šæ”¹å˜å½“å‰å·¥ä½œç›®å½•<br />è¯­æ³•ï¼š<code>os.chdir(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span><span class="token string">"/home/user"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="oslistdir"><a class="markdownIt-Anchor" href="#oslistdir"></a> os.listdir()</h2><p>æè¿°ï¼šè¿”å›æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹åˆ—è¡¨<br />è¯­æ³•ï¼š<code>os.listdir(path=&quot;.&quot;)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osmkdir"><a class="markdownIt-Anchor" href="#osmkdir"></a> os.mkdir()</h2><p>æè¿°ï¼šåˆ›å»ºå•å±‚ç›®å½•<br />è¯­æ³•ï¼š<code>os.mkdir(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osmakedirs"><a class="markdownIt-Anchor" href="#osmakedirs"></a> os.makedirs()</h2><p>æè¿°ï¼šåˆ›å»ºå¤šçº§ç›®å½•<br />è¯­æ³•ï¼š<code>os.makedirs(path, exist_ok=False)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">"a/b/c"</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osrmdir"><a class="markdownIt-Anchor" href="#osrmdir"></a> os.rmdir()</h2><p>æè¿°ï¼šåˆ é™¤ç©ºç›®å½•<br />è¯­æ³•ï¼š<code>os.rmdir(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>rmdir<span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osremovedirs"><a class="markdownIt-Anchor" href="#osremovedirs"></a> os.removedirs()</h2><p>æè¿°ï¼šåˆ é™¤å¤šçº§ç©ºç›®å½•<br />è¯­æ³•ï¼š<code>os.removedirs(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>removedirs<span class="token punctuation">(</span><span class="token string">"a/b/c"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osremove"><a class="markdownIt-Anchor" href="#osremove"></a> os.remove()</h2><p>æè¿°ï¼šåˆ é™¤æ–‡ä»¶<br />è¯­æ³•ï¼š<code>os.remove(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osrename"><a class="markdownIt-Anchor" href="#osrename"></a> os.rename()</h2><p>æè¿°ï¼šé‡å‘½åæ–‡ä»¶æˆ–ç›®å½•<br />è¯­æ³•ï¼š<code>os.rename(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">"old.txt"</span><span class="token punctuation">,</span> <span class="token string">"new.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osreplace"><a class="markdownIt-Anchor" href="#osreplace"></a> os.replace()</h2><p>æè¿°ï¼šé‡å‘½åæ–‡ä»¶ï¼Œå¦‚æœç›®æ ‡å·²å­˜åœ¨ä¼šè¢«è¦†ç›–<br />è¯­æ³•ï¼š<code>os.replace(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"a.txt"</span><span class="token punctuation">,</span> <span class="token string">"b.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osstat"><a class="markdownIt-Anchor" href="#osstat"></a> os.stat()</h2><p>æè¿°ï¼šè·å–æ–‡ä»¶çŠ¶æ€ä¿¡æ¯<br />è¯­æ³•ï¼š<code>os.stat(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">info <span class="token operator">=</span> os<span class="token punctuation">.</span>stat<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>st_size<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="oswalk"><a class="markdownIt-Anchor" href="#oswalk"></a> os.walk()</h2><p>æè¿°ï¼šé€’å½’éå†ç›®å½•æ ‘<br />è¯­æ³•ï¼š<code>os.walk(top, topdown=True, onerror=None, followlinks=False)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> root<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> files <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> files<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¡¥å……ï¼š<br /><code>top</code>ï¼šè¦éå†çš„é¡¶çº§ç›®å½•çš„è·¯å¾„ã€‚<br /><code>topdown (å¯é€‰)</code>ï¼šå¦‚æœä¸º Trueï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™ä»é¡¶çº§å¼€å§‹å‘ä¸‹éå†ã€‚å¦‚æœä¸º Falseï¼Œåˆ™ä»åº•éƒ¨çš„å­ç›®å½•å¼€å§‹å‘ä¸Šéå†ã€‚<br /><code>onerror (å¯é€‰)</code>ï¼šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºé”™è¯¯å¤„ç†ã€‚å¦‚æœæŒ‡å®šï¼Œåˆ™åº”è¯¥æ˜¯ä¸€ä¸ªæ¥å—å•ä¸ªå‚æ•°ï¼ˆå¼‚å¸¸å®ä¾‹ï¼‰çš„å‡½æ•°ã€‚å¦‚æœæœªæŒ‡å®šæˆ–ä¸º Noneï¼Œé”™è¯¯å°†è¢«å¿½ç•¥ã€‚<br /><code>followlinks (å¯é€‰)</code>ï¼šå¦‚æœä¸º Trueï¼Œåˆ™ä¼šéå†ç¬¦å·é“¾æ¥æŒ‡å‘çš„ç›®å½•ã€‚</p><h2 id="osscandir"><a class="markdownIt-Anchor" href="#osscandir"></a> os.scandir()</h2><p>æè¿°ï¼šé«˜æ•ˆè¿­ä»£ç›®å½•é¡¹<br />è¯­æ³•ï¼š<code>os.scandir(path=&quot;.&quot;)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">traversal_files</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> item <span class="token keyword">in</span> os<span class="token punctuation">.</span>scandir<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> item<span class="token punctuation">.</span>is_dir<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          dirs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">.</span>path<span class="token punctuation">)</span>        <span class="token keyword">elif</span> item<span class="token punctuation">.</span>is_file<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          files<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">.</span>path<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dirs:'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>dirs<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'files:'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">)</span>traversal_files<span class="token punctuation">(</span><span class="token string">r'./test'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ospathjoin"><a class="markdownIt-Anchor" href="#ospathjoin"></a> os.path.join()</h2><p>æè¿°ï¼šæ‹¼æ¥è·¯å¾„<br />è¯­æ³•ï¼š<code>os.path.join(path, *paths)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">"folder"</span><span class="token punctuation">,</span> <span class="token string">"file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathabspath"><a class="markdownIt-Anchor" href="#ospathabspath"></a> os.path.abspath()</h2><p>æè¿°ï¼šè·å–ç»å¯¹è·¯å¾„<br />è¯­æ³•ï¼š<code>os.path.abspath(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathbasename"><a class="markdownIt-Anchor" href="#ospathbasename"></a> os.path.basename()</h2><p>æè¿°ï¼šè·å–è·¯å¾„ä¸­çš„æ–‡ä»¶å<br />è¯­æ³•ï¼š<code>os.path.basename(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span><span class="token string">"/home/user/file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathdirname"><a class="markdownIt-Anchor" href="#ospathdirname"></a> os.path.dirname()</h2><p>æè¿°ï¼šè·å–è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†<br />è¯­æ³•ï¼š<code>os.path.dirname(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span><span class="token string">"/home/user/file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathexists"><a class="markdownIt-Anchor" href="#ospathexists"></a> os.path.exists()</h2><p>æè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨<br />è¯­æ³•ï¼š<code>os.path.exists(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathisfile"><a class="markdownIt-Anchor" href="#ospathisfile"></a> os.path.isfile()</h2><p>æè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºæ–‡ä»¶<br />è¯­æ³•ï¼š<code>os.path.isfile(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathisdir"><a class="markdownIt-Anchor" href="#ospathisdir"></a> os.path.isdir()</h2><p>æè¿°ï¼šåˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºç›®å½•<br />è¯­æ³•ï¼š<code>os.path.isdir(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span><span class="token string">"folder"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathsplitext"><a class="markdownIt-Anchor" href="#ospathsplitext"></a> os.path.splitext()</h2><p>æè¿°ï¼šåˆ†ç¦»æ–‡ä»¶åä¸æ‰©å±•å<br />è¯­æ³•ï¼š<code>os.path.splitext(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathgetsize"><a class="markdownIt-Anchor" href="#ospathgetsize"></a> os.path.getsize()</h2><p>æè¿°ï¼šè·å–æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰<br />è¯­æ³•ï¼š<code>os.path.getsize(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osenviron"><a class="markdownIt-Anchor" href="#osenviron"></a> os.environ</h2><p>æè¿°ï¼šç¯å¢ƒå˜é‡ç›¸å…³<br />è¯­æ³•ï¼š<code>os.environ</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># è·å–ç¯å¢ƒå˜é‡</span>value <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"HOME"</span><span class="token punctuation">)</span> <span class="token comment"># å¦‚æœä¸å­˜åœ¨è¿”å› None</span><span class="token comment"># ä¿®æ”¹ç¯å¢ƒå˜é‡</span>os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">"MY_VAR"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"123"</span>os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">"PATH"</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">"PATH"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">":/my/custom/path"</span><span class="token comment"># åˆ é™¤ MY_VAR</span><span class="token keyword">del</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">"MY_VAR"</span><span class="token punctuation">]</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ossystem"><a class="markdownIt-Anchor" href="#ossystem"></a> os.system()</h2><p>æè¿°ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤  <strong>ä¸æ¨èï¼Œæ¨è<code>subprocess</code></strong><br />è¯­æ³•ï¼š<code>os.system(command)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospopen"><a class="markdownIt-Anchor" href="#ospopen"></a> os.popen()</h2><p>æè¿°ï¼šæ‰§è¡Œå‘½ä»¤å¹¶è·å–è¾“å‡º<br />è¯­æ³•ï¼š<code>os.popen(command)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">output <span class="token operator">=</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="osgetpid"><a class="markdownIt-Anchor" href="#osgetpid"></a> os.getpid()</h2><p>æè¿°ï¼šè·å–å½“å‰è¿›ç¨‹ ID<br />è¯­æ³•ï¼š<code>os.getpid()</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osgetppid"><a class="markdownIt-Anchor" href="#osgetppid"></a> os.getppid()</h2><p>æè¿°ï¼šè·å–çˆ¶è¿›ç¨‹ ID<br />è¯­æ³•ï¼š<code>os.getppid()</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getppid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osgetlogin"><a class="markdownIt-Anchor" href="#osgetlogin"></a> os.getlogin()</h2><p>æè¿°ï¼šè·å–å½“å‰ç™»å½•ç”¨æˆ·<br />è¯­æ³•ï¼š<code>os.getlogin()</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getlogin<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osgetuid-osgetgid"><a class="markdownIt-Anchor" href="#osgetuid-osgetgid"></a> os.getuid() / os.getgid()</h2><p>æè¿°ï¼šè·å–å½“å‰è¿›ç¨‹ç”¨æˆ·/ç»„ ID<br />è¯­æ³•ï¼š<code>os.getuid()</code> / <code>os.getgid()</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>getgid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ossetuid-ossetgid"><a class="markdownIt-Anchor" href="#ossetuid-ossetgid"></a> os.setuid() / os.setgid()</h2><p>æè¿°ï¼šè®¾ç½®ç”¨æˆ·/ç»„ ID<br />è¯­æ³•ï¼š<code>os.setuid(uid)</code> / <code>os.setgid(gid)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>setuid<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osumask"><a class="markdownIt-Anchor" href="#osumask"></a> os.umask()</h2><p>æè¿°ï¼šè®¾ç½®æ–‡ä»¶åˆ›å»ºæ©ç <br />è¯­æ³•ï¼š<code>os.umask(mask)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>umask<span class="token punctuation">(</span><span class="token number">0o022</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="oschmod"><a class="markdownIt-Anchor" href="#oschmod"></a> os.chmod()</h2><p>æè¿°ï¼šä¿®æ”¹æ–‡ä»¶æƒé™<br />è¯­æ³•ï¼š<code>os.chmod(path, mode)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>chmod<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">,</span> <span class="token number">0o644</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="oslink"><a class="markdownIt-Anchor" href="#oslink"></a> os.link()</h2><p>æè¿°ï¼šåˆ›å»ºç¡¬é“¾æ¥<br />è¯­æ³•ï¼š<code>os.link(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>link<span class="token punctuation">(</span><span class="token string">"a.txt"</span><span class="token punctuation">,</span> <span class="token string">"b.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ossymlink"><a class="markdownIt-Anchor" href="#ossymlink"></a> os.symlink()</h2><p>æè¿°ï¼šåˆ›å»ºç¬¦å·é“¾æ¥<br />è¯­æ³•ï¼š<code>os.symlink(src, dst)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>symlink<span class="token punctuation">(</span><span class="token string">"a.txt"</span><span class="token punctuation">,</span> <span class="token string">"link.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osreadlink"><a class="markdownIt-Anchor" href="#osreadlink"></a> os.readlink()</h2><p>æè¿°ï¼šè·å–ç¬¦å·é“¾æ¥æŒ‡å‘çš„è·¯å¾„<br />è¯­æ³•ï¼š<code>os.readlink(path)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>readlink<span class="token punctuation">(</span><span class="token string">"link.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osutime"><a class="markdownIt-Anchor" href="#osutime"></a> os.utime()</h2><p>æè¿°ï¼šä¿®æ”¹æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´<br />è¯­æ³•ï¼š<code>os.utime(path, times=None)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>utime<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1620000000</span><span class="token punctuation">,</span> <span class="token number">1620000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ostruncate"><a class="markdownIt-Anchor" href="#ostruncate"></a> os.truncate()</h2><p>æè¿°ï¼šæˆªæ–­æ–‡ä»¶åˆ°æŒ‡å®šå¤§å°<br />è¯­æ³•ï¼š<code>os.truncate(path, length)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">os<span class="token punctuation">.</span>truncate<span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osurandom"><a class="markdownIt-Anchor" href="#osurandom"></a> os.urandom()</h2><p>æè¿°ï¼šç”Ÿæˆéšæœºå­—èŠ‚æ•°æ®<br />è¯­æ³•ï¼š<code>os.urandom(n)</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="oscpu_count"><a class="markdownIt-Anchor" href="#oscpu_count"></a> os.cpu_count()</h2><p>æè¿°ï¼šè¿”å› CPU æ ¸å¿ƒæ•°<br />è¯­æ³•ï¼š<code>os.cpu_count()</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>cpu_count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osuname"><a class="markdownIt-Anchor" href="#osuname"></a> os.uname()</h2><p>æè¿°ï¼šè¿”å›æ“ä½œç³»ç»Ÿä¿¡æ¯<br />è¯­æ³•ï¼š<code>os.uname()</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>uname<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osname"><a class="markdownIt-Anchor" href="#osname"></a> <a href="http://os.name">os.name</a></h2><p>æè¿°ï¼šè·å–æ“ä½œç³»ç»Ÿç±»å‹æ ‡è¯†<br />è¯­æ³•ï¼š<code>os.name</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ossep"><a class="markdownIt-Anchor" href="#ossep"></a> os.sep</h2><p>æè¿°ï¼šè·¯å¾„åˆ†éš”ç¬¦<br />è¯­æ³•ï¼š<code>os.sep</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>sep<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="oslinesep"><a class="markdownIt-Anchor" href="#oslinesep"></a> os.linesep</h2><p>æè¿°ï¼šè¡Œåˆ†éš”ç¬¦<br />è¯­æ³•ï¼š<code>os.linesep</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>linesep<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ospathsep"><a class="markdownIt-Anchor" href="#ospathsep"></a> os.pathsep</h2><p>æè¿°ï¼šç³»ç»Ÿè·¯å¾„åˆ†éš”ç¬¦<br />è¯­æ³•ï¼š<code>os.pathsep</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>pathsep<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="osdevnull"><a class="markdownIt-Anchor" href="#osdevnull"></a> os.devnull</h2><p>æè¿°ï¼šç©ºè®¾å¤‡è·¯å¾„ï¼Œç”¨äºä¸¢å¼ƒè¾“å‡º<br />è¯­æ³•ï¼š<code>os.devnull</code><br />ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>devnull<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"This goes nowhere"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="python" scheme="https://blog.godmao.top/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.godmao.top/Tags/python/"/>
    
    <category term="os" scheme="https://blog.godmao.top/Tags/os/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå†…æ ¸æ¨¡å—åˆä½“éªŒ</title>
    <link href="https://blog.godmao.top/posts/49513/"/>
    <id>https://blog.godmao.top/posts/49513/</id>
    <published>2025-09-27T07:48:35.000Z</published>
    <updated>2025-10-11T06:52:47.208Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><blockquote><p>æœ¬ç¯‡æ‘˜è‡ªé‡ç«åµŒå…¥å¼Linuxç³»åˆ—æ•™ç¨‹é©±åŠ¨å¼€å‘ç¯‡</p></blockquote><h2 id="å†…æ ¸æ¨¡å—åŸºæœ¬æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#å†…æ ¸æ¨¡å—åŸºæœ¬æ¦‚å¿µ"></a> å†…æ ¸æ¨¡å—åŸºæœ¬æ¦‚å¿µ</h2><h3 id="ç°ä»£å†…æ ¸æ´¾ç³»"><a class="markdownIt-Anchor" href="#ç°ä»£å†…æ ¸æ´¾ç³»"></a> ç°ä»£å†…æ ¸æ´¾ç³»</h3><p>å•å†…æ ¸ï¼šå…³é”®åŠŸèƒ½å’ŒæœåŠ¡åŠŸèƒ½å‡åœ¨å†…æ ¸ç©ºé—´æä¾›</p><ul><li>è¿è¡Œæ•ˆç‡é«˜</li><li>æ‰©å±•æ€§è¾ƒå·®</li></ul><p>å¾®å†…æ ¸ï¼šå†…æ ¸ç©ºé—´åªæä¾›å…³é”®åŠŸèƒ½ï¼ŒæœåŠ¡åŠŸèƒ½åœ¨ç”¨æˆ·ç©ºé—´æä¾›</p><ul><li>è¿è¡Œæ•ˆç‡è¾ƒä½</li><li>å®‰å…¨æ€§ã€æ‰©å±•æ€§è¾ƒé«˜</li></ul><p>linuxå±äºå•å†…æ ¸ï¼ŒæŒ‰ç†æ¥è¯´æ‰©å±•æ€§ä¸å¥½ï¼Œä½†å…¶çš„æ¨¡å—åŒ–è®¾è®¡åˆå¼¥è¡¥äº†è¿™ä¸€ç‚¹ã€‚</p><h3 id="å†…æ ¸æ¨¡å—åŠ è½½å¸è½½"><a class="markdownIt-Anchor" href="#å†…æ ¸æ¨¡å—åŠ è½½å¸è½½"></a> å†…æ ¸æ¨¡å—åŠ è½½/å¸è½½</h3><ul><li>ä½¿ç”¨insmodå‘½ä»¤åŠ è½½</li><li>ä½¿ç”¨rmmodå‘½ä»¤å¸è½½</li></ul><h3 id="å†…æ ¸æ¨¡å—å…¥å£å‡ºå£"><a class="markdownIt-Anchor" href="#å†…æ ¸æ¨¡å—å…¥å£å‡ºå£"></a> å†…æ ¸æ¨¡å—å…¥å£/å‡ºå£</h3><ul><li>module_init()ï¼šåŠ è½½æ¨¡å—å¼è¯¥å‡½æ•°è‡ªåŠ¨æ‰§è¡Œï¼Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œ</li><li>module_exit()ï¼šå¸è½½æ¨¡å—æ—¶å‡½æ•°è‡ªåŠ¨æ‰§è¡Œï¼Œè¿›è¡Œæ¸…ç†æ“ä½œ</li></ul><h3 id="å†…æ ¸æ¨¡å—ä¿¡æ¯å£°æ˜"><a class="markdownIt-Anchor" href="#å†…æ ¸æ¨¡å—ä¿¡æ¯å£°æ˜"></a> å†…æ ¸æ¨¡å—ä¿¡æ¯å£°æ˜</h3><ul><li>MODULE_LICENSE()ï¼šè¡¨ç¤ºæ¨¡å—ä»£ç æ¥å—çš„è½¯ä»¶è®¸å¯åè®®ï¼ŒLinuxå†…æ ¸éµå¾ªGPL V2å¼€æºåè®®ï¼Œå†…æ ¸æ¨¡å—ä¸linuxå†…æ ¸ä¿æŒä¸€è‡´å³å¯ã€‚</li><li>MODULE_AUTHOR()ï¼šæè¿°æ¨¡å—çš„ä½œè€…ä¿¡æ¯</li><li>MODULE_DESCRIPTION()ï¼šå¯¹æ¨¡å—çš„ç®€å•ä»‹ç»</li><li>MODULE_ALIAS()ï¼šç»™æ¨¡å—è®¾ç½®ä¸€ä¸ªåˆ«å</li></ul><h2 id="å†…æ ¸æ¨¡å—å®éªŒ1"><a class="markdownIt-Anchor" href="#å†…æ ¸æ¨¡å—å®éªŒ1"></a> å†…æ ¸æ¨¡å—å®éªŒ1</h2><h3 id="å®éªŒç¯å¢ƒ"><a class="markdownIt-Anchor" href="#å®éªŒç¯å¢ƒ"></a> å®éªŒç¯å¢ƒ</h3><ul><li>å¼€å‘æ¿çƒ§å½•å¥½Debiané•œåƒã€‚</li><li>SSHè¿æ¥MobaXterm</li><li>å¯åŠ¨å¼€å‘æ¿ï¼Œæ­å»ºå¥½SFTPã€‚</li><li>è·å–Debiané•œåƒçš„å†…æ ¸æºç å¹¶ç¼–è¯‘ã€‚</li></ul><h3 id="ç¼–è¯‘41971ç‰ˆæœ¬å†…æ ¸"><a class="markdownIt-Anchor" href="#ç¼–è¯‘41971ç‰ˆæœ¬å†…æ ¸"></a> ç¼–è¯‘4.19.71ç‰ˆæœ¬å†…æ ¸</h3><p>å†…æ ¸æ¨¡å—çš„åŠŸèƒ½éœ€è¦ä¾èµ–å†…æ ¸æä¾›çš„å„ç§åº•å±‚æ¥å£</p><p>1.ä¸‹è½½linuxå†…æ ¸æºç </p><p>â€‹github:</p><pre class="line-numbers language-none"><code class="language-none">git clone https:&#x2F;&#x2F;github.com&#x2F;Embedfire&#x2F;ebf-buster-linux.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â€‹gitee:</p><pre class="line-numbers language-none"><code class="language-none">git clone https:&#x2F;&#x2F;gitee.com&#x2F;Embedfire&#x2F;ebf-buster-linux.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.å®‰è£…å¿…è¦ç¯å¢ƒå·¥å…·åº“</p><pre class="line-numbers language-none"><code class="language-none">sudo apt install make gcc-arm-linux-gnueabihf gcc bison flex libssl-dev dpkg-dev lzop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>gcc-arm-linux-gnueabihf äº¤å‰ç¼–è¯‘å™¨</li><li>bison è¯­æ³•åˆ†æå™¨</li><li>flex è¯æ³•åˆ†æå™¨</li><li>libssl-dev OpenSSLé€šç”¨åº“</li><li>lzop LZOå‹ç¼©åº“çš„å‹ç¼©è½¯ä»¶</li></ul><p>3.ä¸€é”®ç¼–è¯‘å†…æ ¸</p><pre class="line-numbers language-none"><code class="language-none">sudo .&#x2F;make_deb.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å¦‚æœåœ¨ç”µè„‘ä¸Šç¼–è¯‘ä¸æˆåŠŸä¸”æ— æ³•è§£å†³ï¼Œå¯ä»¥é€‰æ‹©åœ¨å¼€å‘æ¿ä¸Šç¼–è¯‘ï¼Œä»£ä»·å°±æ˜¯ã€‚ã€‚ã€‚å—¯ it takes a long time</p></blockquote><p>4.è·å–ç¼–è¯‘å‡ºæ¥çš„å†…æ ¸ç›¸å…³æ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">YOURPATH&#x2F;ebf_linux_kernel_6ull_depth1&#x2F;build_image&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å†…æ ¸æ¨¡å—å¤´æ–‡ä»¶"><a class="markdownIt-Anchor" href="#å†…æ ¸æ¨¡å—å¤´æ–‡ä»¶"></a> å†…æ ¸æ¨¡å—å¤´æ–‡ä»¶</h3><ul><li><code>#include &lt;linux/module.h&gt;</code>ï¼šåŒ…å«å†…æ ¸æ¨¡å—ä¿¡æ¯å£°æ˜çš„ç›¸å…³å‡½æ•°</li><li><code>#include &lt;linux/init.h&gt;</code>ï¼šåŒ…å«äº† module_init()å’Œ module_exit()å‡½æ•°çš„å£°æ˜</li><li><code>#include &lt;linux/kernel.h&gt;</code>ï¼šåŒ…å«å†…æ ¸æä¾›çš„å„ç§å‡½æ•°ï¼Œå¦‚printk</li></ul><h3 id="å†…æ ¸æ¨¡å—æ‰“å°å‡½æ•°"><a class="markdownIt-Anchor" href="#å†…æ ¸æ¨¡å—æ‰“å°å‡½æ•°"></a> å†…æ ¸æ¨¡å—æ‰“å°å‡½æ•°</h3><ul><li><p><code>printf</code>ï¼šglibcå®ç°çš„æ‰“å°å‡½æ•°ï¼Œå·¥ä½œäºç”¨æˆ·ç©ºé—´ï¼Œä¸å¯åœ¨å†…æ ¸ä½¿ç”¨</p></li><li><p><code>printk</code>ï¼šå†…æ ¸æ¨¡å—æ— æ³•ä½¿ç”¨glibcåº“å‡½æ•°ï¼Œå†…æ ¸è‡ªèº«å®ç°çš„ä¸€ä¸ªç±»printfå‡½æ•°ï¼Œä½†æ˜¯éœ€è¦æŒ‡å®šæ‰“å°ç­‰çº§ã€‚</p><ul><li><code>#define KERN_EMERG</code> â€œ&lt;0&gt;â€ é€šå¸¸æ˜¯ç³»ç»Ÿå´©æºƒå‰çš„ä¿¡æ¯</li><li><code>#define KERN_ALERT</code>          â€œ&lt;1&gt;â€ éœ€è¦ç«‹å³å¤„ç†çš„æ¶ˆæ¯</li><li><code>#define KERN_CRIT</code>             â€œ&lt;2&gt;â€ ä¸¥é‡æƒ…å†µ</li><li><code>#define KERN_ERR</code>              â€œ&lt;3&gt;â€ é”™è¯¯æƒ…å†µ</li><li><code>#define KERN_WARNING</code>      â€œ&lt;4&gt;â€ æœ‰é—®é¢˜çš„æƒ…å†µ</li><li><code>#define KERN_NOTICE</code>       â€œ&lt;5&gt;â€ æ³¨æ„ä¿¡æ¯</li><li><code>#define KERN_INFO</code>            â€œ&lt;6&gt;â€ æ™®é€šæ¶ˆæ¯</li><li><code>#define KERN_DEBUG</code>        â€œ&lt;7&gt;â€ è°ƒè¯•ä¿¡æ¯</li></ul></li></ul><p>æŸ¥çœ‹å½“å‰ç³»ç»Ÿprintkæ‰“å°ç­‰çº§ï¼š<code>cat /proc/sys/kernel/printk</code><br />è¾“å‡º</p><pre class="line-numbers language-none"><code class="language-none">7       4       1       7<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¡¨ç¤ºï¼š</p><ul><li>å½“å‰æ§åˆ¶å°æ—¥å¿—çº§åˆ«</li><li>é»˜è®¤æ¶ˆæ¯æ—¥å¿—çº§åˆ«</li><li>æœ€å°çš„æ§åˆ¶å°çº§åˆ«</li><li>é»˜è®¤æ§åˆ¶å°æ—¥å¿—çº§åˆ«</li></ul><p>å°äºç­‰äºè®¾å®šæ‰“å°ç­‰çº§çš„æ¶ˆæ¯ä¸ä¼šè¢«æ‰“å°ã€‚<br />æ‰“å°å†…æ ¸æ‰€æœ‰æ‰“å°ä¿¡æ¯ï¼šdmesg</p><ul><li>å†…æ ¸logç¼“å†²åŒºå¤§å°æœ‰é™åˆ¶ï¼Œç¼“å†²åŒºæ•°æ®å¯èƒ½è¢«å†²æ‰</li></ul><h3 id="æºç å±•ç¤º"><a class="markdownIt-Anchor" href="#æºç å±•ç¤º"></a> æºç å±•ç¤º</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;linux/kernel.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;linux/init.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;linux/module.h></span></span><span class="token keyword">static</span> <span class="token keyword">int</span> __init <span class="token function">hello_init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">printk</span><span class="token punctuation">(</span>KERN_EMERG<span class="token string">"[KERN_EMERG]Hello Kernel!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printk</span><span class="token punctuation">(</span><span class="token string">"[DEFAULT]Hello Kernel!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> __exit <span class="token function">hello_exit</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">printk</span><span class="token punctuation">(</span><span class="token string">"[DEFAULT]Goodbye Kernel!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">module_init</span><span class="token punctuation">(</span>hello_init<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">module_exit</span><span class="token punctuation">(</span>hello_exit<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">MODULE_LICENSE</span><span class="token punctuation">(</span><span class="token string">"MIT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">MODULE_AUTHOR</span><span class="token punctuation">(</span><span class="token string">"gdm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">MODULE_DESCRIPTION</span><span class="token punctuation">(</span><span class="token string">"print: hello kernel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">MODULE_ALIAS</span><span class="token punctuation">(</span><span class="token string">"test_module"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="makefileåˆ†æ"><a class="markdownIt-Anchor" href="#makefileåˆ†æ"></a> Makefileåˆ†æ</h3><pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token comment"># å®šä¹‰å†…æ ¸è·¯å¾„</span>KERNEL_DIR<span class="token operator">:=</span>/home/debian/linux/driver_learning/ebf_linux_kernel_6ull_depth1/build_image/build<span class="token comment"># å®šä¹‰ç¼–è¯‘å·¥å…·é›†</span>ARCH<span class="token operator">:=</span>armCROSS_COMPILE<span class="token operator">:=</span>arm-linux-gnueabihf-<span class="token comment"># å°†å˜é‡å¯¼å‡ºï¼Œç›¸å½“äºä½œä¸ºç¯å¢ƒå˜é‡ï¼Œè®©å†…æ ¸Makefileç»§æ‰¿æ­¤å˜é‡ å¦åˆ™å˜é‡åªåœ¨å½“å‰æ–‡ä»¶å¯è§ã€‚</span><span class="token keyword">export</span> ARCH CROSS_COMPILE<span class="token comment"># å†…æ ¸æ¨¡å—ç¼–è¯‘çš„æ ‡å‡†å˜é‡ï¼Œå‘Šè¯‰å†…æ ¸ç¼–è¯‘å“ªä¸ªæ¨¡å—ã€‚</span>obj-m<span class="token operator">:=</span>hellokernal.o<span class="token comment"># -C å‘½ä»¤æŒ‡åˆ‡æ¢åˆ°ç›®æ ‡ç›®å½•çš„makefile</span><span class="token comment"># M= å¯ä»¥ç†è§£ä¸ºmoduleï¼ŒæŒ‡å®šæ¨¡å—æ‰€åœ¨è·¯å¾„</span><span class="token comment"># modules æ˜¯å†…æ ¸makefileå®šä¹‰çš„ç›®æ ‡ï¼Œè§¦å‘â€œæ„å»ºå¤–éƒ¨æ¨¡å—â€å®Œæ•´è§„åˆ™</span><span class="token target symbol">all</span><span class="token punctuation">:</span>    <span class="token variable">$</span><span class="token punctuation">(</span>MAKE<span class="token punctuation">)</span> -C <span class="token variable">$</span><span class="token punctuation">(</span>KERNEL_DIR<span class="token punctuation">)</span> M<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>CURDIR<span class="token punctuation">)</span> moudules<span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span>clean<span class="token target symbol">clean</span><span class="token punctuation">:</span>    <span class="token variable">$</span><span class="token punctuation">(</span>MAKE<span class="token punctuation">)</span> -C <span class="token variable">$</span><span class="token punctuation">(</span>KERNEL_DIR<span class="token punctuation">)</span> M<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>CURDIR<span class="token punctuation">)</span> clean<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>KERNEL_DIR</code>ï¼šæŒ‡å‘linuxå†…æ ¸å…·ä½“è·¯å¾„</li><li><code>export</code>ï¼šå¯¼å‡ºå˜é‡ç»™å­Makefileä½¿ç”¨</li><li><code>obj-m</code> := &lt;æ¨¡å—å&gt;.oï¼šå®šä¹‰è¦ç”Ÿæˆçš„æ¨¡å—</li><li><code>$(MAKE)</code>ï¼šMakefileçš„é»˜è®¤å˜é‡ï¼Œå€¼ä¸ºmake</li><li><code>é€‰é¡¹â€-Câ€</code>ï¼šè®©makeå·¥å…·è·³è½¬åˆ°linuxå†…æ ¸ç›®å½•ä¸‹è¯»å–é¡¶å±‚Makefile</li><li><code>M=</code>ï¼šè¡¨ç¤ºå†…æ ¸æ¨¡å—æºç ç›®å½•</li><li><code>$(CURDIR)</code>ï¼šMakefileé»˜è®¤å˜é‡ï¼Œå€¼ä¸ºå½“å‰ç›®å½•æ‰€åœ¨è·¯å¾„</li><li><code>make modules</code>ï¼šæ‰§è¡ŒLinuxé¡¶å±‚Makefileçš„ä¼ªç›®æ ‡ï¼Œå®ƒå®ç°å†…æ ¸æ¨¡å—çš„æºç è¯»å–å¹¶ç¼–è¯‘ä¸º.koæ–‡ä»¶</li></ul><h3 id="ç¼–è¯‘å†…æ ¸æ¨¡å—"><a class="markdownIt-Anchor" href="#ç¼–è¯‘å†…æ ¸æ¨¡å—"></a> ç¼–è¯‘å†…æ ¸æ¨¡å—</h3><pre class="line-numbers language-none"><code class="language-none">make<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å¼€å‘æ¿åŠ è½½å†…æ ¸æ¨¡å—"><a class="markdownIt-Anchor" href="#å¼€å‘æ¿åŠ è½½å†…æ ¸æ¨¡å—"></a> å¼€å‘æ¿åŠ è½½å†…æ ¸æ¨¡å—</h3><pre class="line-numbers language-none"><code class="language-none">insmod xxx.ko<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/categories/Linux/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="å†…æ ¸" scheme="https://blog.godmao.top/Tags/%E5%86%85%E6%A0%B8/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/Tags/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>WSL-Archlinuxå®‰è£…ååº”è¯¥åšä»€ä¹ˆï¼Ÿ</title>
    <link href="https://blog.godmao.top/posts/17327/"/>
    <id>https://blog.godmao.top/posts/17327/</id>
    <published>2025-09-18T12:21:15.000Z</published>
    <updated>2025-09-29T14:42:37.877Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><ul><li><a href="#1-%E5%9C%A8wsl%E4%B8%8A%E5%AE%89%E8%A3%85archlinux">1. åœ¨WSLä¸Šå®‰è£…Archlinux</a></li><li><a href="#2-%E6%9B%B4%E6%96%B0%E7%B3%BB%E7%BB%9F">2. æ›´æ–°ç³»ç»Ÿ</a></li><li><a href="#3-%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE">3. åŸºç¡€é…ç½®</a><ul><li><a href="#31-%E8%AE%BE%E7%BD%AEroot%E5%AF%86%E7%A0%81">3.1. è®¾ç½®rootå¯†ç </a></li><li><a href="#32-%E5%88%9B%E5%BB%BA%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E5%B9%B6%E5%8A%A0%E5%85%A5-wheel-%E7%BB%84%E6%96%B9%E4%BE%BF%E5%90%8E%E7%BB%AD-sudo-%E6%9D%83%E9%99%90">3.2. åˆ›å»ºæ™®é€šç”¨æˆ·å¹¶åŠ å…¥ <code>wheel</code> ç»„ï¼ˆæ–¹ä¾¿åç»­ sudo æƒé™ï¼‰ï¼š</a></li><li><a href="#33-%E7%BC%96%E8%BE%91-sudo-%E6%9D%83%E9%99%90">3.3. ç¼–è¾‘ sudo æƒé™</a></li><li><a href="#34-%E8%AE%BE%E5%AE%9A%E9%BB%98%E8%AE%A4%E7%94%A8%E6%88%B7">3.4. è®¾å®šé»˜è®¤ç”¨æˆ·</a></li><li><a href="#35-%E8%AE%BE%E7%BD%AE%E8%AF%AD%E8%A8%80%E5%92%8C%E5%9C%B0%E5%8C%BA">3.5. è®¾ç½®è¯­è¨€å’Œåœ°åŒº</a></li><li><a href="#36-aur-%E6%94%AF%E6%8C%81">3.6. AUR æ”¯æŒ</a></li><li><a href="#37-%E5%85%B3%E4%BA%8E%E6%8D%A2%E6%BA%90">3.7. å…³äºæ¢æº</a></li></ul></li><li><a href="#4-%E4%B8%AA%E6%80%A7%E5%8C%96%E8%AE%BE%E7%BD%AE">4. ä¸ªæ€§åŒ–è®¾ç½®</a><ul><li><a href="#41-%E4%BD%BF%E7%94%A8zsh%E6%9B%BF%E4%BB%A3bash">4.1. ä½¿ç”¨zshæ›¿ä»£bash</a></li><li><a href="#42-%E4%BD%BF%E7%94%A8oh-my-zsh%E4%B8%BAzsh%E6%8F%90%E4%BE%9B%E6%8F%92%E4%BB%B6%E6%9C%8D%E5%8A%A1">4.2. ä½¿ç”¨oh-my-zshä¸ºzshæä¾›æ’ä»¶æœåŠ¡</a></li><li><a href="#43-%E4%BD%BF%E7%94%A8oh-my-posh%E4%B8%BAzsh%E6%8F%90%E4%BE%9B%E4%B8%BB%E9%A2%98">4.3. ä½¿ç”¨oh-my-poshä¸ºzshæä¾›ä¸»é¢˜</a></li></ul></li></ul><h2 id="1-åœ¨wslä¸Šå®‰è£…archlinux"><a class="markdownIt-Anchor" href="#1-åœ¨wslä¸Šå®‰è£…archlinux"></a> 1. åœ¨WSLä¸Šå®‰è£…Archlinux</h2><p>è¯·å‚è§â€”â€” <a href="https://wiki.archlinuxcn.org/wiki/%E5%9C%A8_WSL_%E4%B8%8A%E5%AE%89%E8%A3%85_Arch_Linux">åœ¨ WSL ä¸Šå®‰è£… Arch Linux - Arch Linux ä¸­æ–‡ç»´åŸº</a></p><h2 id="2-æ›´æ–°ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#2-æ›´æ–°ç³»ç»Ÿ"></a> 2. æ›´æ–°ç³»ç»Ÿ</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Syu</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-åŸºç¡€é…ç½®"><a class="markdownIt-Anchor" href="#3-åŸºç¡€é…ç½®"></a> 3. åŸºç¡€é…ç½®</h2><h3 id="31-è®¾ç½®rootå¯†ç "><a class="markdownIt-Anchor" href="#31-è®¾ç½®rootå¯†ç "></a> 3.1. è®¾ç½®rootå¯†ç </h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">passwd</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="32-åˆ›å»ºæ™®é€šç”¨æˆ·å¹¶åŠ å…¥-wheel-ç»„æ–¹ä¾¿åç»­-sudo-æƒé™"><a class="markdownIt-Anchor" href="#32-åˆ›å»ºæ™®é€šç”¨æˆ·å¹¶åŠ å…¥-wheel-ç»„æ–¹ä¾¿åç»­-sudo-æƒé™"></a> 3.2. åˆ›å»ºæ™®é€šç”¨æˆ·å¹¶åŠ å…¥ <code>wheel</code> ç»„ï¼ˆæ–¹ä¾¿åç»­ sudo æƒé™ï¼‰ï¼š</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token parameter variable">-G</span> wheel <span class="token parameter variable">-s</span> /bin/bash yourname<span class="token function">passwd</span> yourname<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>-m</code>ï¼šè‡ªåŠ¨åˆ›å»ºç”¨æˆ·ç›®å½•<br /><code>-G</code>ï¼šæŒ‡å®šç”¨æˆ·ç»„<br /><code>-s</code>ï¼šæŒ‡å®šshell</p><h3 id="33-ç¼–è¾‘-sudo-æƒé™"><a class="markdownIt-Anchor" href="#33-ç¼–è¾‘-sudo-æƒé™"></a> 3.3. ç¼–è¾‘ sudo æƒé™</h3><p>å®‰è£… <code>sudo</code>ï¼Œå†å¯ç”¨ <code>wheel</code> ç»„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> <span class="token function">sudo</span> <span class="token function">nano</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nano</span> /etc/sudoers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å»æ‰ <code># %wheel ALL=(ALL:ALL) ALL</code> å‰çš„æ³¨é‡Š</p><blockquote><p>å‰é¢å¸¦%(å¦‚%wheel)åˆ™è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç”¨æˆ·ç»„ï¼Œä¸å¸¦åˆ™è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç”¨æˆ·ã€‚</p></blockquote><h3 id="34-è®¾å®šé»˜è®¤ç”¨æˆ·"><a class="markdownIt-Anchor" href="#34-è®¾å®šé»˜è®¤ç”¨æˆ·"></a> 3.4. è®¾å®šé»˜è®¤ç”¨æˆ·</h3><p>ä¸èƒ½æ€»æ˜¯ç”¨rootç”¨æˆ·ç™»å½•ã€‚<br />é¦–å…ˆç¡®ä¿è¯¥ç”¨æˆ·å·²è¢«åˆ›å»ºï¼Œç„¶åå°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°Â <code>/etc/wsl.conf</code>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">[user]default&#x3D;username<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="35-è®¾ç½®è¯­è¨€å’Œåœ°åŒº"><a class="markdownIt-Anchor" href="#35-è®¾ç½®è¯­è¨€å’Œåœ°åŒº"></a> 3.5. è®¾ç½®è¯­è¨€å’Œåœ°åŒº</h3><p>ç›®çš„æ˜¯æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡å­—ç¬¦</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">locale-gen<span class="token builtin class-name">echo</span> <span class="token string">"LANG=en_US.UTF-8"</span> <span class="token operator">></span> /etc/locale.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¯·å‚è§â€”â€”<a href="https://wiki.archlinuxcn.org/wiki/%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%E6%9C%AC%E5%9C%B0%E5%8C%96">ç®€ä½“ä¸­æ–‡æœ¬åœ°åŒ– - Arch Linux ä¸­æ–‡ç»´åŸº</a></p><h3 id="36-aur-æ”¯æŒ"><a class="markdownIt-Anchor" href="#36-aur-æ”¯æŒ"></a> 3.6. AUR æ”¯æŒ</h3><p>å¯ä»¥ä¸‹è½½æ¥è‡ªç¤¾åŒºçš„è½¯ä»¶åŒ…ï¼Œè¿™é‡Œé€‰ç”¨AURåŠ©æ‰‹ yay<br />é€‰æ‹©ä¸€ä¸ªæŒ‡å®šç›®å½•ç„¶åæ‰§è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman <span class="token parameter variable">-S</span> <span class="token function">git</span> base-devel <span class="token parameter variable">--needed</span>  <span class="token comment">#&lt;-è¿™æ˜¯åŸºæœ¬çš„å¼€å‘å·¥å…·åŒ…ï¼Œå¦‚gccã€make</span><span class="token function">git</span> clone https://aur.archlinux.org/yay-bin.git<span class="token builtin class-name">cd</span> yay-binmakepkg <span class="token parameter variable">-si</span> <span class="token comment"># æ„å»ºåŒ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>-s</code>ï¼šè‡ªåŠ¨å®‰è£…ä¾èµ–<br /><code>-i</code>ï¼šç¼–è¯‘å®Œæˆåè‡ªåŠ¨å®‰è£…ç”Ÿæˆçš„åŒ…</p><p>è¯·å‚è§â€”â€”<a href="https://wiki.archlinuxcn.org/wiki/Yay">yay - Arch Linux ä¸­æ–‡ç»´åŸº</a></p><h3 id="37-å…³äºæ¢æº"><a class="markdownIt-Anchor" href="#37-å…³äºæ¢æº"></a> 3.7. å…³äºæ¢æº</h3><p>æ‰“å¼€<code>WSL-setting</code>ï¼ˆç›´æ¥åœ¨win11é‡Œæœç´¢ï¼‰çš„ç½‘ç»œè®¾ç½®ï¼Œå°†ç½‘ç»œæ¨¡å¼ç”±<code>NAT</code> æ”¹ä¸º <code>mirror</code>ï¼Œ åˆ™å¯ç›´æ¥ç»§æ‰¿å®¿ä¸»æœºçš„ç½‘ç»œç¯å¢ƒã€‚åœ¨å®¿ä¸»æœºä½¿ç”¨ç½‘ç»œå®‰å…¨å·¥å…·å³å¯ï¼Œå› æ­¤æš‚æ—¶æ²¡æœ‰æ¢æºã€‚</p><h2 id="4-ä¸ªæ€§åŒ–è®¾ç½®"><a class="markdownIt-Anchor" href="#4-ä¸ªæ€§åŒ–è®¾ç½®"></a> 4. ä¸ªæ€§åŒ–è®¾ç½®</h2><h3 id="41-ä½¿ç”¨zshæ›¿ä»£bash"><a class="markdownIt-Anchor" href="#41-ä½¿ç”¨zshæ›¿ä»£bash"></a> 4.1. ä½¿ç”¨zshæ›¿ä»£bash</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> <span class="token function">zsh</span>chsh <span class="token parameter variable">-s</span> /bin/zsh <span class="token comment"># æ”¹å˜é»˜è®¤shell</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="42-ä½¿ç”¨oh-my-zshä¸ºzshæä¾›æ’ä»¶æœåŠ¡"><a class="markdownIt-Anchor" href="#42-ä½¿ç”¨oh-my-zshä¸ºzshæä¾›æ’ä»¶æœåŠ¡"></a> 4.2. ä½¿ç”¨oh-my-zshä¸ºzshæä¾›æ’ä»¶æœåŠ¡</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> oh-my-zsh.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…å®Œæˆå å¯ä»¥åœ¨ <code>/usr/share/oh-my-zsh</code> ä¸­æŸ¥çœ‹ä¸»é¢˜æ–‡ä»¶å’Œæ’ä»¶ä»¥åŠå…¶æä¾›çš„<code>zshrc</code>é…ç½®æ¨¡æ¿ï¼Œç›´æ¥ä½¿ç”¨é…ç½®æ¨¡æ¿ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> /usr/share/oh-my-zsh/zshrc ~/.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿›å…¥<code>/usr/share/oh-my-zsh\plugins</code>ç›®å½• å®‰è£…è‡ªåŠ¨è¡¥å…¨ä¸è¯­æ³•é«˜äº®æ’ä»¶ï¼ˆä¸è‡ªå¸¦ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/zsh-users/zsh-autosuggestions<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/zsh-users/zsh-syntax-highlighting.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ <code>.zshrc</code> é‡Œæ·»åŠ ï¼š</p><pre class="line-numbers language-none"><code class="language-none">plugins&#x3D;(git zsh-autosuggestions zsh-syntax-highlighting)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="43-ä½¿ç”¨oh-my-poshä¸ºzshæä¾›ä¸»é¢˜"><a class="markdownIt-Anchor" href="#43-ä½¿ç”¨oh-my-poshä¸ºzshæä¾›ä¸»é¢˜"></a> 4.3. ä½¿ç”¨oh-my-poshä¸ºzshæä¾›ä¸»é¢˜</h3><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>oh-my-zsh</code>çš„ä¸»é¢˜ï¼Œåªä¸è¿‡æˆ‘æ›´å–œæ¬¢<code>oh-my-posh</code>çš„ä¸»é¢˜</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay <span class="token parameter variable">-S</span> oh-my-posh-bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŒæ ·ï¼Œå®‰è£…å®Œæˆå å¯ä»¥åœ¨ <code>/usr/share/oh-my-posh</code> ä¸­æŸ¥çœ‹ä¸»é¢˜æ–‡ä»¶ï¼Œ<br />ç¼–è¾‘<code>~/.zshrc</code>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#æ³¨é‡Šæ‰ZSH_THEME="robbyrussell"</span><span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span>oh-my-posh init <span class="token function">zsh</span> <span class="token parameter variable">--config</span> <span class="token string">'amro'</span><span class="token variable">)</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>å»ºè®®ä¸è¦ä½¿ç”¨ç±»ä¼¼äº <code>--config ~/.poshthemes/mytheme.omp.json</code>çš„é€‰é¡¹ï¼Œè¿™å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚</p></blockquote><p>é‡æ–°åŠ è½½ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">source</span> ~/.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="è®°å½•" scheme="https://blog.godmao.top/categories/Linux/%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="WSL2" scheme="https://blog.godmao.top/Tags/WSL2/"/>
    
    <category term="ArchLinux" scheme="https://blog.godmao.top/Tags/ArchLinux/"/>
    
  </entry>
  
  <entry>
    <title>POSIX IPCï¼šSystem V çš„ç»§ä»»è€…</title>
    <link href="https://blog.godmao.top/posts/26506/"/>
    <id>https://blog.godmao.top/posts/26506/</id>
    <published>2025-09-15T14:24:58.000Z</published>
    <updated>2025-09-15T14:45:59.965Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><ul><li><a href="#1-posix-ipcsystem-v-%E7%9A%84%E7%BB%A7%E4%BB%BB%E8%80%85">1. POSIX IPCï¼šSystem V çš„ç»§ä»»è€…</a><ul><li><a href="#11-posix-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97">1.1. POSIX æ¶ˆæ¯é˜Ÿåˆ—</a><ul><li><a href="#111-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E5%B1%9E%E6%80%A7">1.1.1. æ¶ˆæ¯é˜Ÿåˆ—å±æ€§</a></li></ul></li><li><a href="#12-posix-%E4%BF%A1%E5%8F%B7%E9%87%8F">1.2. POSIX ä¿¡å·é‡</a></li><li><a href="#13-posix-%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98">1.3. POSIX å…±äº«å†…å­˜</a></li></ul></li></ul><h2 id="1-posix-ipcsystem-v-çš„ç»§ä»»è€…"><a class="markdownIt-Anchor" href="#1-posix-ipcsystem-v-çš„ç»§ä»»è€…"></a> 1. POSIX IPCï¼šSystem V çš„ç»§ä»»è€…</h2><p><strong>POSIX IPC</strong>ï¼ˆPortable Operating System Interfaceï¼‰æ˜¯ä¸€å¥—æ–°çš„ IPC æ ‡å‡†ï¼Œæ—¨åœ¨è§£å†³ <strong>System V IPC</strong> çš„ä¸€äº›å±€é™æ€§ã€‚å®ƒæä¾›äº†ä¸€å¥—æ›´ç»Ÿä¸€ã€æ›´ç°ä»£çš„ APIï¼Œä½¿ç”¨<strong>æ–‡ä»¶å</strong>ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œè€Œä¸æ˜¯ System V çš„<strong>é”®å€¼</strong>ï¼Œè¿™ä½¿å¾— IPC èµ„æºçš„ç®¡ç†æ›´åŠ ç›´è§‚ã€‚</p><h3 id="11-posix-æ¶ˆæ¯é˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#11-posix-æ¶ˆæ¯é˜Ÿåˆ—"></a> 1.1. POSIX æ¶ˆæ¯é˜Ÿåˆ—</h3><p>ä¸ System V æ¶ˆæ¯é˜Ÿåˆ—ç±»ä¼¼ï¼Œä½† API æ›´ç®€æ´ã€‚</p><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p><strong>åŸºäºæ–‡ä»¶</strong>ï¼šé€šè¿‡ <code>/dev/mqueue</code> ç›®å½•ä¸‹çš„æ–‡ä»¶åæ¥æ ‡è¯†ã€‚</p></li><li><p><strong>ä¼˜å…ˆçº§</strong>ï¼šæ”¯æŒæ¶ˆæ¯ä¼˜å…ˆçº§ï¼Œé«˜ä¼˜å…ˆçº§çš„æ¶ˆæ¯ä¼šè¢«ä¼˜å…ˆå¤„ç†ã€‚</p></li><li><p><strong>éé˜»å¡æ¨¡å¼</strong>ï¼šå¯ä»¥è®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—ä¸ºéé˜»å¡æ¨¡å¼ï¼Œé˜²æ­¢ <code>mq_send</code> æˆ– <code>mq_receive</code> é˜»å¡è¿›ç¨‹ã€‚</p></li></ul></li><li><p><strong>ä½¿ç”¨</strong>ï¼š</p><ul><li><p><strong><code>mq_open()</code></strong>ï¼šåˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ã€‚</p></li><li><p><strong><code>mq_send()</code></strong>ï¼šå‘é€æ¶ˆæ¯ã€‚</p></li><li><p><strong><code>mq_receive()</code></strong>ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚</p></li><li><p><strong><code>mq_close()</code></strong>ï¼šå…³é—­æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p></li><li><p><strong><code>mq_unlink()</code></strong>ï¼šåˆ é™¤æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p></li></ul></li></ul><h4 id="111-æ¶ˆæ¯é˜Ÿåˆ—å±æ€§"><a class="markdownIt-Anchor" href="#111-æ¶ˆæ¯é˜Ÿåˆ—å±æ€§"></a> 1.1.1. æ¶ˆæ¯é˜Ÿåˆ—å±æ€§</h4><p>åœ¨POSIXæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œ<strong>æ¶ˆæ¯é˜Ÿåˆ—å±æ€§</strong>ï¼ˆ<code>mq_attr</code>ï¼‰æ˜¯ç”¨æ¥è®¾ç½®å’Œè·å–æ¶ˆæ¯é˜Ÿåˆ—çš„ç‰¹æ€§å’Œå‚æ•°çš„ç»“æ„ä½“ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯æ§åˆ¶æ¶ˆæ¯é˜Ÿåˆ—çš„è¡Œä¸ºï¼Œä¾‹å¦‚æœ€å¤§æ¶ˆæ¯æ•°ã€æ¶ˆæ¯å¤§å°ç­‰ã€‚<code>mq_attr</code>ç»“æ„ä½“åŒ…å«äº†ä»¥ä¸‹å‡ ä¸ªå­—æ®µï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">mq_attr</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">long</span>    mq_flags<span class="token punctuation">;</span>      <span class="token comment">// æ¶ˆæ¯é˜Ÿåˆ—çš„æ ‡å¿—</span>    <span class="token keyword">long</span>    mq_maxmsg<span class="token punctuation">;</span>     <span class="token comment">// æ¶ˆæ¯é˜Ÿåˆ—ä¸­æœ€å¤šå¯ä»¥å®¹çº³çš„æ¶ˆæ¯æ•°é‡</span>    <span class="token keyword">long</span>    mq_msgsize<span class="token punctuation">;</span>    <span class="token comment">// é˜Ÿåˆ—ä¸­æ¯æ¡æ¶ˆæ¯çš„æœ€å¤§å¤§å°</span>    <span class="token keyword">long</span>    mq_curmsgs<span class="token punctuation">;</span>    <span class="token comment">// å½“å‰é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ•°</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li><p><code>mq_flags</code></p><p>è¿™ä¸ªå­—æ®µç”¨äºè®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—çš„æ ‡å¿—ã€‚å¸¸è§çš„æ ‡å¿—æœ‰ï¼š</p><ul><li><p><strong><code>O_NONBLOCK</code></strong>ï¼šä»¥éé˜»å¡æ¨¡å¼æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—ã€‚è¿™æ„å‘³ç€å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—ä¸ºç©ºï¼Œæ¥æ”¶æ“ä½œï¼ˆ<code>mq_receive()</code>ï¼‰ä¼šç«‹å³è¿”å›ï¼Œè€Œä¸æ˜¯é˜»å¡ç­‰å¾…ã€‚</p></li><li><p><strong><code>O_RDWR</code></strong>ï¼šå…è®¸å¯¹æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œè¯»å†™æ“ä½œã€‚</p></li></ul><p>å¦‚æœæ²¡æœ‰è®¾ç½®è¿™äº›æ ‡å¿—ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°†ä¼šé»˜è®¤é˜»å¡æ¨¡å¼æ“ä½œã€‚</p></li><li><p><code>mq_maxmsg</code></p><p>è¿™ä¸ªå­—æ®µå®šä¹‰äº†æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥å®¹çº³çš„æœ€å¤§æ¶ˆæ¯æ•°é‡ã€‚å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—å·²ç»å­˜æ»¡ï¼Œä¸”æ²¡æœ‰ç©ºé—´å®¹çº³æ–°çš„æ¶ˆæ¯ï¼Œåç»­çš„æ¶ˆæ¯å‘é€ï¼ˆ<code>mq_send()</code>ï¼‰å°†ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰è¶³å¤Ÿçš„ç©ºé—´ã€‚è¿™ä¸ªå±æ€§é€šå¸¸è®¾ç½®ä¸ºä½ å¸Œæœ›æ¶ˆæ¯é˜Ÿåˆ—ä¸­èƒ½å­˜å‚¨çš„æ¶ˆæ¯ä¸ªæ•°ã€‚</p></li><li><p><code>mq_msgsize</code></p><p>æ­¤å­—æ®µå®šä¹‰æ¯æ¡æ¶ˆæ¯çš„æœ€å¤§å­—èŠ‚æ•°ã€‚åœ¨åˆ›å»ºæ¶ˆæ¯é˜Ÿåˆ—æ—¶ï¼Œå¿…é¡»ç¡®ä¿æ¶ˆæ¯å‘é€å’Œæ¥æ”¶æ“ä½œçš„æ¶ˆæ¯å¤§å°ä¸ä¼šè¶…è¿‡è¿™ä¸ªå€¼ã€‚å¦‚æœæ¶ˆæ¯è¶…è¿‡äº†è¿™ä¸ªå¤§å°ï¼Œå‘é€æ“ä½œå°†è¿”å›é”™è¯¯ã€‚</p></li><li><p><code>mq_curmsgs</code></p><p>è¿™ä¸ªå­—æ®µæ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼Œç”¨äºè·å–å½“å‰é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ•°é‡ã€‚å®ƒæ˜¯ä¸€ä¸ªåŠ¨æ€æ›´æ–°çš„å€¼ï¼Œæ¯æ¬¡è¯»å–æ—¶ä¼šè¿”å›å½“å‰æ¶ˆæ¯é˜Ÿåˆ—ä¸­å®é™…å­˜å‚¨çš„æ¶ˆæ¯æ•°ã€‚è¿™ä¸ªå­—æ®µå¯¹åº”ç”¨ç¨‹åºæ¥è¯´å¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦äº†è§£é˜Ÿåˆ—å½“å‰çŠ¶æ€çš„åœºæ™¯ã€‚</p></li></ol><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸¤ä¸ªä¸ç›¸å…³çš„è¿›ç¨‹å¦‚ä½•é€šè¿‡ POSIX æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ã€‚<br />å‘é€æ–¹(sender.c)ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span>          <span class="token comment">/* åŠ¨æ€å†…å­˜ç®¡ç†åŠå…¶ä»–è¾…åŠ©åŠŸèƒ½å¦‚exitã€abort */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span>           <span class="token comment">/* æä¾› O_CREAT, O_RDWR ç”¨äºæ–‡ä»¶æ§åˆ¶ */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span>        <span class="token comment">/* æ–‡ä»¶å±æ€§æ“ä½œ å¦‚chmodã€umask */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;mqueue.h></span>          <span class="token comment">/* æä¾›POSIXæ¶ˆæ¯é˜Ÿåˆ—æ”¯æŒ */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span>          <span class="token comment">/* æä¾›POSIXæ¥å£ */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MQ_NAME</span> <span class="token string">"/my_mq"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">mqd_t</span> mqd<span class="token punctuation">;</span>    <span class="token keyword">struct</span> <span class="token class-name">mq_attr</span> attr<span class="token punctuation">;</span>    <span class="token keyword">char</span> buffer<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>msg <span class="token operator">=</span> <span class="token string">"Hello from sender!"</span><span class="token punctuation">;</span>    <span class="token comment">// è®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—å±æ€§</span>    attr<span class="token punctuation">.</span>mq_flags <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    attr<span class="token punctuation">.</span>mq_maxmsg <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    attr<span class="token punctuation">.</span>mq_msgsize <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span>    attr<span class="token punctuation">.</span>mq_curmsgs <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">// åˆ›å»ºæˆ–æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—</span>    mqd <span class="token operator">=</span> <span class="token function">mq_open</span><span class="token punctuation">(</span>MQ_NAME<span class="token punctuation">,</span> O_CREAT <span class="token operator">|</span> O_WRONLY<span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mqd <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token class-name">mqd_t</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"mq_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Sender: Sending message...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å‘é€æ¶ˆæ¯ï¼Œä¼˜å…ˆçº§ä¸º1</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mq_send</span><span class="token punctuation">(</span>mqd<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"mq_send"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å…³é—­æ¶ˆæ¯é˜Ÿåˆ—æè¿°ç¬¦</span>    <span class="token function">mq_close</span><span class="token punctuation">(</span>mqd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Sender: Message sent and mq closed.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥æ”¶æ–¹(receiver.c)ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;mqueue.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MQ_NAME</span> <span class="token string">"/my_mq"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">mqd_t</span> mqd<span class="token punctuation">;</span>    <span class="token keyword">struct</span> <span class="token class-name">mq_attr</span> attr<span class="token punctuation">;</span>    <span class="token keyword">char</span> buffer<span class="token punctuation">[</span><span class="token number">256</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> prio<span class="token punctuation">;</span>    <span class="token comment">// æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—</span>    mqd <span class="token operator">=</span> <span class="token function">mq_open</span><span class="token punctuation">(</span>MQ_NAME<span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mqd <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token class-name">mqd_t</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"mq_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// è·å–æ¶ˆæ¯é˜Ÿåˆ—å±æ€§</span>    <span class="token function">mq_getattr</span><span class="token punctuation">(</span>mqd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Receiver: Waiting for message...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ¥æ”¶æ¶ˆæ¯</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mq_receive</span><span class="token punctuation">(</span>mqd<span class="token punctuation">,</span> buffer<span class="token punctuation">,</span> attr<span class="token punctuation">.</span>mq_msgsize<span class="token punctuation">,</span> <span class="token operator">&amp;</span>prio<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"mq_receive"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Receiver: Received message: %s (Priority: %u)\n"</span><span class="token punctuation">,</span> buffer<span class="token punctuation">,</span> prio<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å…³é—­å’Œåˆ é™¤æ¶ˆæ¯é˜Ÿåˆ—</span>    <span class="token function">mq_close</span><span class="token punctuation">(</span>mqd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">mq_unlink</span><span class="token punctuation">(</span>MQ_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç¼–è¯‘å’Œè¿è¡Œ</strong>ï¼š <code>gcc sender.c -o sender -lrt</code> <code>gcc receiver.c -o receiver -lrt</code> ï¼ˆéœ€è¦é“¾æ¥å®æ—¶åº“ <code>-lrt</code>ï¼‰ å…ˆè¿è¡Œ <code>./sender</code>ï¼Œå†è¿è¡Œ <code>./receiver</code>ã€‚</p><h3 id="12-posix-ä¿¡å·é‡"><a class="markdownIt-Anchor" href="#12-posix-ä¿¡å·é‡"></a> 1.2. POSIX ä¿¡å·é‡</h3><p>ç”¨äºè¿›ç¨‹é—´çš„åŒæ­¥ï¼ŒåŠŸèƒ½ä¸ System V ä¿¡å·é‡ç±»ä¼¼ï¼Œä½†æä¾›äº†æ›´ç®€å•çš„æ¥å£ã€‚</p><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p><strong>æœ‰åä¿¡å·é‡</strong>ï¼šé€šè¿‡ä¸€ä¸ªæ–‡ä»¶åæ ‡è¯†ï¼Œå¯ä»¥ç”¨äºéäº²ç¼˜è¿›ç¨‹ã€‚</p></li><li><p><strong>æ— åä¿¡å·é‡</strong>ï¼šå¸¸ç”¨äºçº¿ç¨‹é—´çš„åŒæ­¥ï¼Œå­˜æ”¾åœ¨å…±äº«å†…å­˜ä¸­ï¼Œåªèƒ½ç”¨äºæœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ã€‚</p></li></ul></li><li><p><strong>ä½¿ç”¨</strong>ï¼š</p><ul><li><p><strong><code>sem_open()</code></strong>ï¼šåˆ›å»ºæˆ–æ‰“å¼€æœ‰åä¿¡å·é‡ã€‚</p></li><li><p><strong><code>sem_wait()</code></strong>ï¼šåŸå­æ€§åœ°å‡å°‘ä¿¡å·é‡è®¡æ•°å™¨ï¼Œå¦‚æœä¸º0åˆ™é˜»å¡ã€‚</p></li><li><p><strong><code>sem_post()</code></strong>ï¼šåŸå­æ€§åœ°å¢åŠ ä¿¡å·é‡è®¡æ•°å™¨ã€‚</p></li><li><p><strong><code>sem_close()</code></strong>ï¼šå…³é—­ä¿¡å·é‡ã€‚</p></li><li><p><strong><code>sem_unlink()</code></strong>ï¼šåˆ é™¤ä¿¡å·é‡ã€‚</p></li></ul></li></ul><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ POSIX ä¿¡å·é‡æ¥åŒæ­¥ä¸¤ä¸ªè¿›ç¨‹å¯¹ä¸€ä¸ªå…±äº«èµ„æºçš„è®¿é—®ã€‚</p><p>å…±äº«èµ„æºè®¿é—®ç¨‹åº (sem_client.c)ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span>           <span class="token comment">/* For O_CREAT, O_RDWR */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span>        <span class="token comment">/* For mode constants */</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;semaphore.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SEM_NAME</span> <span class="token string">"/my_semaphore"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">sem_t</span> <span class="token operator">*</span>sem<span class="token punctuation">;</span>    <span class="token keyword">int</span> value<span class="token punctuation">;</span>    <span class="token comment">// æ‰“å¼€ä¿¡å·é‡</span>    sem <span class="token operator">=</span> <span class="token function">sem_open</span><span class="token punctuation">(</span>SEM_NAME<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// O_CREAT is not needed here</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>sem <span class="token operator">==</span> SEM_FAILED<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"sem_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Client: Waiting to get semaphore...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// P æ“ä½œï¼šç­‰å¾…ä¿¡å·é‡ï¼Œå¦‚æœå€¼ä¸º0åˆ™é˜»å¡</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sem_wait</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"sem_wait"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Client: Got the semaphore. Accessing shared resource...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¨¡æ‹Ÿè®¿é—®å…±äº«èµ„æº</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Client: Finished. Releasing semaphore...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// V æ“ä½œï¼šé‡Šæ”¾ä¿¡å·é‡ï¼Œè®¡æ•°å™¨åŠ 1</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sem_post</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"sem_post"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å…³é—­ä¿¡å·é‡</span>    <span class="token function">sem_close</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿¡å·é‡æ§åˆ¶ç¨‹åº (sem_main.c)ï¼š`</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;semaphore.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SEM_NAME</span> <span class="token string">"/my_semaphore"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">sem_t</span> <span class="token operator">*</span>sem<span class="token punctuation">;</span>    <span class="token class-name">pid_t</span> pid<span class="token punctuation">;</span>    <span class="token comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–ä¿¡å·é‡ï¼Œåˆå§‹å€¼ä¸º1</span>    sem <span class="token operator">=</span> <span class="token function">sem_open</span><span class="token punctuation">(</span>SEM_NAME<span class="token punctuation">,</span> O_CREAT<span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>sem <span class="token operator">==</span> SEM_FAILED<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"sem_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Main: Semaphore created and initialized to 1.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹</span>    pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// å­è¿›ç¨‹è¿è¡Œå¦ä¸€ä¸ªç¨‹åºæ¥è®¿é—®ä¿¡å·é‡</span>        <span class="token function">execlp</span><span class="token punctuation">(</span><span class="token string">"./sem_client"</span><span class="token punctuation">,</span> <span class="token string">"sem_client"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"execlp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚æœæ‰§è¡Œå¤±è´¥</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// çˆ¶è¿›ç¨‹ä¹Ÿå°è¯•è®¿é—®ä¿¡å·é‡</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç¡®ä¿å­è¿›ç¨‹å…ˆè¿è¡Œ</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Main: Waiting to get semaphore...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sem_wait</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Main: Got the semaphore. Accessing shared resource...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Main: Finished. Releasing semaphore...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sem_post</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç­‰å¾…å­è¿›ç¨‹ç»“æŸ</span>        <span class="token comment">// åˆ é™¤ä¿¡å·é‡</span>        <span class="token function">sem_unlink</span><span class="token punctuation">(</span>SEM_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Main: Child process finished. Semaphore unlinked.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å…³é—­ä¿¡å·é‡</span>    <span class="token function">sem_close</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç¼–è¯‘å’Œè¿è¡Œ</strong>ï¼š <code>gcc sem_client.c -o sem_client -lrt</code> <code>gcc sem_main.c -o sem_main -lrt</code> ï¼ˆåŒæ ·éœ€è¦é“¾æ¥å®æ—¶åº“ <code>-lrt</code>ï¼‰ è¿è¡Œ <code>./sem_main</code>ã€‚</p><h3 id="13-posix-å…±äº«å†…å­˜"><a class="markdownIt-Anchor" href="#13-posix-å…±äº«å†…å­˜"></a> 1.3. POSIX å…±äº«å†…å­˜</h3><p>å’Œ System V å…±äº«å†…å­˜ä¸€æ ·ï¼Œéƒ½æ˜¯æœ€å¿«çš„ IPC æ–¹å¼ï¼Œä½† POSIX ç‰ˆæœ¬ä½¿ç”¨äº†æ–‡ä»¶æè¿°ç¬¦ã€‚</p><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p><strong>åŸºäºæ–‡ä»¶</strong>ï¼šé€šè¿‡ <code>shm_open</code> åˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªå…±äº«å†…å­˜å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚</p></li><li><p><strong>å†…å­˜æ˜ å°„</strong>ï¼šé€šè¿‡ <code>mmap()</code> å°†æ–‡ä»¶æè¿°ç¬¦å¯¹åº”çš„å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚</p></li></ul></li><li><p><strong>ä½¿ç”¨</strong>ï¼š</p><ul><li><p><strong><code>shm_open()</code></strong>ï¼šåˆ›å»ºæˆ–æ‰“å¼€å…±äº«å†…å­˜å¯¹è±¡ã€‚</p></li><li><p><strong><code>ftruncate()</code></strong>ï¼šè°ƒæ•´å…±äº«å†…å­˜å¯¹è±¡çš„å¤§å°ã€‚</p></li><li><p><strong><code>mmap()</code></strong>ï¼šå°†å…±äº«å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´ã€‚</p></li><li><p><strong><code>munmap()</code></strong>ï¼šè§£é™¤æ˜ å°„ã€‚</p></li><li><p><strong><code>shm_unlink()</code></strong>ï¼šåˆ é™¤å…±äº«å†…å­˜å¯¹è±¡ã€‚</p></li></ul></li></ul><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸¤ä¸ªè¿›ç¨‹å¦‚ä½•é€šè¿‡ POSIX å…±äº«å†…å­˜æ¥å…±äº«ä¸€å—å†…å­˜åŒºåŸŸï¼Œå¹¶ç”¨ä¸€ä¸ªä¿¡å·é‡æ¥åŒæ­¥ã€‚</p><p>å†™å…¥æ–¹ (shm_writer.c)</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/mman.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;semaphore.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHM_NAME</span> <span class="token string">"/my_shm"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SEM_NAME</span> <span class="token string">"/my_shm_sem"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHM_SIZE</span> <span class="token expression"><span class="token number">4096</span></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> shm_fd<span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>    <span class="token class-name">sem_t</span> <span class="token operator">*</span>sem<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>msg <span class="token operator">=</span> <span class="token string">"Hello from shm writer!"</span><span class="token punctuation">;</span>    <span class="token comment">// åˆ›å»º/æ‰“å¼€å…±äº«å†…å­˜å¯¹è±¡</span>    shm_fd <span class="token operator">=</span> <span class="token function">shm_open</span><span class="token punctuation">(</span>SHM_NAME<span class="token punctuation">,</span> O_CREAT <span class="token operator">|</span> O_RDWR<span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>shm_fd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"shm_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// è®¾ç½®å…±äº«å†…å­˜å¤§å°</span>    <span class="token function">ftruncate</span><span class="token punctuation">(</span>shm_fd<span class="token punctuation">,</span> SHM_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å°†å…±äº«å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´</span>    ptr <span class="token operator">=</span> <span class="token function">mmap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> SHM_SIZE<span class="token punctuation">,</span> PROT_READ <span class="token operator">|</span> PROT_WRITE<span class="token punctuation">,</span> MAP_SHARED<span class="token punctuation">,</span> shm_fd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ptr <span class="token operator">==</span> MAP_FAILED<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"mmap"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// åˆ›å»º/æ‰“å¼€ä¿¡å·é‡ï¼Œç”¨äºåŒæ­¥</span>    sem <span class="token operator">=</span> <span class="token function">sem_open</span><span class="token punctuation">(</span>SEM_NAME<span class="token punctuation">,</span> O_CREAT<span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆå§‹å€¼ä¸º0ï¼Œè¡¨ç¤ºä¸å¯è®¿é—®</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>sem <span class="token operator">==</span> SEM_FAILED<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"sem_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Writer: Writing to shared memory...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å†™å…¥æ•°æ®</span>    <span class="token function">sprintf</span><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> <span class="token string">"%s"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// V æ“ä½œï¼šé‡Šæ”¾ä¿¡å·é‡ï¼Œé€šçŸ¥è¯»è€…å¯ä»¥è¯»å–äº†</span>    <span class="token function">sem_post</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Writer: Data written and semaphore posted.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å…³é—­</span>    <span class="token function">sem_close</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">munmap</span><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> SHM_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>shm_fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯»å–æ–¹ (shm_reader.c)ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/mman.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;semaphore.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHM_NAME</span> <span class="token string">"/my_shm"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SEM_NAME</span> <span class="token string">"/my_shm_sem"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SHM_SIZE</span> <span class="token expression"><span class="token number">4096</span></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> shm_fd<span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>    <span class="token class-name">sem_t</span> <span class="token operator">*</span>sem<span class="token punctuation">;</span>    <span class="token comment">// æ‰“å¼€å…±äº«å†…å­˜å¯¹è±¡</span>    shm_fd <span class="token operator">=</span> <span class="token function">shm_open</span><span class="token punctuation">(</span>SHM_NAME<span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>shm_fd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"shm_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å°†å…±äº«å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´</span>    ptr <span class="token operator">=</span> <span class="token function">mmap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> SHM_SIZE<span class="token punctuation">,</span> PROT_READ<span class="token punctuation">,</span> MAP_SHARED<span class="token punctuation">,</span> shm_fd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ptr <span class="token operator">==</span> MAP_FAILED<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"mmap"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// æ‰“å¼€ä¿¡å·é‡</span>    sem <span class="token operator">=</span> <span class="token function">sem_open</span><span class="token punctuation">(</span>SEM_NAME<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>sem <span class="token operator">==</span> SEM_FAILED<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"sem_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Reader: Waiting for writer...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// P æ“ä½œï¼šç­‰å¾…ä¿¡å·é‡ï¼Œç›´åˆ°æœ‰æ•°æ®å¯ç”¨</span>    <span class="token function">sem_wait</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Reader: Data received: %s\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å…³é—­å’Œæ¸…ç†</span>    <span class="token function">sem_close</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sem_unlink</span><span class="token punctuation">(</span>SEM_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ é™¤ä¿¡å·é‡</span>    <span class="token function">munmap</span><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> SHM_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>shm_fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">shm_unlink</span><span class="token punctuation">(</span>SHM_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ é™¤å…±äº«å†…å­˜å¯¹è±¡</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç¼–è¯‘å’Œè¿è¡Œ</strong>ï¼š <code>gcc shm_writer.c -o shm_writer -lrt</code> <code>gcc shm_reader.c -o shm_reader -lrt</code> ï¼ˆåŒæ ·éœ€è¦é“¾æ¥å®æ—¶åº“ <code>-lrt</code>ï¼‰ å…ˆè¿è¡Œ <code>./shm_writer</code>ï¼Œå†è¿è¡Œ <code>./shm_reader</code>ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/categories/Linux/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
    <category term="IPC" scheme="https://blog.godmao.top/Tags/IPC/"/>
    
    <category term="POSIX" scheme="https://blog.godmao.top/Tags/POSIX/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥æµ…å‡º Linux IPCï¼šè¿›ç¨‹é—´é€šä¿¡çš„è‰ºæœ¯</title>
    <link href="https://blog.godmao.top/posts/46571/"/>
    <id>https://blog.godmao.top/posts/46571/</id>
    <published>2025-09-12T09:28:41.000Z</published>
    <updated>2025-09-15T14:35:23.508Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><ul><li><a href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-ipc">1. ä¸ºä»€ä¹ˆéœ€è¦ IPCï¼Ÿ</a></li><li><a href="#2-%E5%B8%B8%E8%A7%81%E7%9A%84-linux-ipc-%E6%9C%BA%E5%88%B6">2. å¸¸è§çš„ Linux IPC æœºåˆ¶</a><ul><li><a href="#21-%E7%AE%A1%E9%81%93pipes">2.1. ç®¡é“ï¼ˆPipesï¼‰</a></li><li><a href="#22-fifo%E5%91%BD%E5%90%8D%E7%AE%A1%E9%81%93">2.2. FIFOï¼ˆå‘½åç®¡é“ï¼‰</a></li><li><a href="#23-%E4%BF%A1%E5%8F%B7">2.3. ä¿¡å·</a><ul><li><a href="#231-%E4%BF%A1%E5%8F%B7%E7%9A%84%E5%88%86%E7%B1%BB">2.3.1. ä¿¡å·çš„åˆ†ç±»</a></li><li><a href="#232-%E4%BF%A1%E5%8F%B7%E4%B8%8E-ipc-%E7%9A%84%E5%85%B3%E7%B3%BB">2.3.2. ä¿¡å·ä¸ IPC çš„å…³ç³»</a></li><li><a href="#233-%E4%BF%A1%E5%8F%B7%E7%9A%84%E4%B8%89%E7%A7%8D%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F">2.3.3. ä¿¡å·çš„ä¸‰ç§å¤„ç†æ–¹å¼</a></li><li><a href="#234-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E4%BF%A1%E5%8F%B7">2.3.4. å¦‚ä½•ä½¿ç”¨ä¿¡å·ï¼Ÿ</a><ul><li><a href="#2341-%E5%8F%91%E9%80%81%E4%BF%A1%E5%8F%B7kill-%E5%87%BD%E6%95%B0">2.3.4.1. å‘é€ä¿¡å·ï¼š<code>kill()</code> å‡½æ•°</a></li><li><a href="#2342-%E6%B3%A8%E5%86%8C%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0signal-%E5%92%8C-sigaction">2.3.4.2. æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°ï¼š<code>signal()</code> å’Œ <code>sigaction()</code></a></li></ul></li></ul></li><li><a href="#24-%E4%BF%A1%E5%8F%B7%E9%9B%86signal-set%E5%92%8C%E9%98%BB%E5%A1%9E">2.4. ä¿¡å·é›†ï¼ˆSignal Setï¼‰å’Œé˜»å¡</a><ul><li><a href="#241-%E4%BF%A1%E5%8F%B7%E9%9B%86%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0">2.4.1. ä¿¡å·é›†æ“ä½œå‡½æ•°</a></li><li><a href="#242-%E9%98%BB%E5%A1%9E%E4%BF%A1%E5%8F%B7sigprocmask">2.4.2. é˜»å¡ä¿¡å·ï¼š<code>sigprocmask()</code></a></li></ul></li><li><a href="#25-system-v-ipc-system-v-ipc">2.5. System V IPC (System V IPC)[^1]</a><ul><li><a href="#251-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97message-queues">2.5.1. æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queuesï¼‰</a></li><li><a href="#252-%E4%BF%A1%E5%8F%B7%E9%87%8Fsemaphores">2.5.2. ä¿¡å·é‡ï¼ˆSemaphoresï¼‰</a></li><li><a href="#253-%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98shared-memory">2.5.3. å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰</a></li></ul></li><li><a href="#26-ipc-%E6%80%BB%E7%BB%93%E4%B8%8E%E9%80%89%E6%8B%A9">2.6. IPC æ€»ç»“ä¸é€‰æ‹©</a></li></ul></li></ul><p>åœ¨ Linux ä¸–ç•Œä¸­ï¼Œè¿›ç¨‹æ˜¯ç‹¬ç«‹çš„æ‰§è¡Œå•å…ƒï¼Œæ‹¥æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ã€‚ä½†å¾ˆå¤šæ—¶å€™ï¼Œä¸ºäº†å®Œæˆä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ï¼Œä¸åŒçš„è¿›ç¨‹éœ€è¦ååŒå·¥ä½œï¼Œäº¤æ¢æ•°æ®ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦<strong>è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPC, Inter-Process Communicationï¼‰</strong>ã€‚IPC å°±åƒæ˜¯è¿›ç¨‹ä¹‹é—´çš„ä¸€åº§æ¡¥æ¢ï¼Œè®©å®ƒä»¬èƒ½å¤Ÿç›¸äº’â€œäº¤è°ˆâ€ï¼Œå…±äº«ä¿¡æ¯ã€‚</p><p>æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥äº†è§£ Linux ä¸­å¸¸è§çš„ IPC æœºåˆ¶ï¼Œå¹¶ä»¥<strong>ä½¿ç”¨ä¸ºå¯¼å‘</strong>ï¼Œç»“åˆä»£ç ç¤ºä¾‹ï¼Œè®©ä½ èƒ½å¤Ÿå¿«é€ŸæŒæ¡è¿™äº›â€œé€šä¿¡â€æŠ€æœ¯ã€‚</p><h2 id="1-ä¸ºä»€ä¹ˆéœ€è¦-ipc"><a class="markdownIt-Anchor" href="#1-ä¸ºä»€ä¹ˆéœ€è¦-ipc"></a> 1. ä¸ºä»€ä¹ˆéœ€è¦ IPCï¼Ÿ</h2><p>æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼šä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Web æœåŠ¡å™¨ã€‚ä¸€ä¸ªä¸»è¿›ç¨‹è´Ÿè´£ç›‘å¬ç½‘ç»œè¯·æ±‚ï¼Œä½†å¤„ç†è¿™äº›è¯·æ±‚éå¸¸è€—æ—¶ã€‚å¦‚æœä¸»è¿›ç¨‹è‡ªå·±å¤„ç†ï¼ŒæœåŠ¡å™¨å°±ä¼šå˜å¾—å¾ˆæ…¢ï¼Œæ— æ³•å“åº”æ–°çš„è¯·æ±‚ã€‚ä¸€ä¸ªæ›´å¥½çš„è®¾è®¡æ˜¯ï¼Œä¸»è¿›ç¨‹æ¯æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹æˆ–å°†è¯·æ±‚å‘é€ç»™ä¸€ä¸ªå·¥ä½œè¿›ç¨‹æ± æ¥å¤„ç†ã€‚è¿™æ ·ï¼Œä¸»è¿›ç¨‹å¯ä»¥ç«‹å³å›å»ç›‘å¬æ–°çš„è¿æ¥ï¼Œè€Œå·¥ä½œè¿›ç¨‹åˆ™ä¸“æ³¨äºå¤„ç†ä»»åŠ¡ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸»è¿›ç¨‹éœ€è¦å°†è¯·æ±‚æ•°æ®ä¼ é€’ç»™å·¥ä½œè¿›ç¨‹ã€‚è¿™å°±æ˜¯ IPC å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p><h2 id="2-å¸¸è§çš„-linux-ipc-æœºåˆ¶"><a class="markdownIt-Anchor" href="#2-å¸¸è§çš„-linux-ipc-æœºåˆ¶"></a> 2. å¸¸è§çš„ Linux IPC æœºåˆ¶</h2><p>Linux æä¾›äº†å¤šç§ IPC æœºåˆ¶ï¼Œæ¯ç§éƒ½æœ‰å…¶ç‹¬ç‰¹çš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚æˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬åˆ†ä¸ºä¸¤å¤§ç±»ï¼š<strong>åŸºäºæ–‡ä»¶</strong>å’Œ<strong>åŸºäºå†…å­˜</strong>ã€‚</p><h3 id="21-ç®¡é“pipes"><a class="markdownIt-Anchor" href="#21-ç®¡é“pipes"></a> 2.1. ç®¡é“ï¼ˆPipesï¼‰</h3><p>ç®¡é“å¯èƒ½æ˜¯æœ€ç®€å•ã€æœ€å¤è€çš„ IPC å½¢å¼ã€‚å®ƒå°±åƒä¸€ä¸ªå•å‘çš„â€œæ°´ç®¡â€ï¼Œä¸€ç«¯ç”¨äºå†™å…¥ï¼Œå¦ä¸€ç«¯ç”¨äºè¯»å–ã€‚</p><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p><strong>å•å‘é€šä¿¡</strong>ï¼šæ•°æ®åªèƒ½ä»ä¸€ç«¯æµå‘å¦ä¸€ç«¯ã€‚</p></li><li><p><strong>çˆ¶å­è¿›ç¨‹é€šä¿¡</strong>ï¼šç®¡é“é€šå¸¸ç”¨äºæœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ä¹‹é—´ï¼Œæ¯”å¦‚çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ã€‚</p></li><li><p><strong>åŠåŒå·¥</strong>ï¼šè™½ç„¶æ˜¯å•å‘ï¼Œä½†å¦‚æœåˆ›å»ºä¸¤ä¸ªç®¡é“ï¼Œå°±å¯ä»¥å®ç°åŒå‘é€šä¿¡ã€‚</p></li></ul></li><li><p><strong>ä½¿ç”¨</strong>ï¼š</p><ul><li><strong><code>pipe()</code> å‡½æ•°</strong>ï¼šè¿™æ˜¯åˆ›å»ºç®¡é“çš„æ ¸å¿ƒå‡½æ•°ã€‚</li></ul>  <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">int</span> <span class="token function">pipe</span><span class="token punctuation">(</span><span class="token keyword">int</span> pipefd<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>pipefd</code> æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„æ•°ç»„ï¼Œ<code>pipefd[0]</code> ç”¨äºè¯»å–ï¼Œ<code>pipefd[1]</code> ç”¨äºå†™å…¥ã€‚</p></li><li><p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼šä¸€ä¸ªç®€å•çš„çˆ¶å­è¿›ç¨‹é€šä¿¡ã€‚</p></li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> pipefd<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token class-name">pid_t</span> pid<span class="token punctuation">;</span>    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>msg <span class="token operator">=</span> <span class="token string">"Hello from parent!"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pipe</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"pipe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"fork"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// çˆ¶è¿›ç¨‹</span>        <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…³é—­è¯»å–ç«¯</span>        <span class="token function">write</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…³é—­å†™å…¥ç«¯ï¼Œå¦‚æœä¸å…³ï¼Œå­è¿›ç¨‹è¯»ç«¯æ”¶ä¸åˆ°EOFä¿¡å·ï¼Œåˆ™ä¼šä¸€ç›´è¯»å¯¼è‡´ç¨‹åºé˜»å¡</span>        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å­è¿›ç¨‹</span>        <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…³é—­å†™å…¥ç«¯ï¼Œå¦‚æœä¸å…³</span>        <span class="token function">read</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Child received: %s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">close</span><span class="token punctuation">(</span>pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…³é—­è¯»å–ç«¯</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="22-fifoå‘½åç®¡é“"><a class="markdownIt-Anchor" href="#22-fifoå‘½åç®¡é“"></a> 2.2. FIFOï¼ˆå‘½åç®¡é“ï¼‰</h3><p>ç®¡é“åªèƒ½ç”¨äºæœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹ï¼Œé‚£å¦‚æœä¸¤ä¸ªæ¯«ä¸ç›¸å…³çš„è¿›ç¨‹æƒ³é€šä¿¡æ€ä¹ˆåŠï¼Ÿç­”æ¡ˆå°±æ˜¯ <strong>FIFO (First-In, First-Out)</strong>ï¼Œä¹Ÿå«<strong>å‘½åç®¡é“</strong>ã€‚</p><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p><strong>æ–‡ä»¶ç³»ç»Ÿè·¯å¾„</strong>ï¼šå®ƒåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªè·¯å¾„åï¼Œä¸åŒäºåŒ¿åç®¡é“ã€‚</p></li><li><p><strong>éäº²ç¼˜è¿›ç¨‹é€šä¿¡</strong>ï¼šä»»æ„ä¸¤ä¸ªè¿›ç¨‹éƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªè·¯å¾„åæ‰“å¼€å¹¶é€šä¿¡ã€‚</p></li><li><p><strong>å•å‘</strong>ï¼šå’Œç®¡é“ä¸€æ ·ï¼ŒFIFO ä¹Ÿæ˜¯å•å‘çš„ï¼Œéœ€è¦ä¸¤ä¸ª FIFO æ¥å®ç°åŒå‘é€šä¿¡ã€‚</p></li></ul></li><li><p><strong>ä½¿ç”¨</strong>ï¼š</p><ul><li><strong><code>mkfifo()</code> å‡½æ•°</strong>æˆ– <strong><code>mkfifo</code> å‘½ä»¤</strong>ï¼šç”¨æ¥åˆ›å»º FIFOã€‚</li></ul>  <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token keyword">int</span> <span class="token function">mkfifo</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span> <span class="token class-name">mode_t</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li><strong><code>open()</code>, <code>read()</code>, <code>write()</code> å‡½æ•°</strong>ï¼šåƒæ“ä½œæ™®é€šæ–‡ä»¶ä¸€æ ·æ¥æ“ä½œ FIFOã€‚</li></ul></li><li><p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p><ul><li><strong><code>writer.c</code></strong>ï¼š</li></ul>  <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FIFO_NAME</span> <span class="token string">"my_fifo"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> fd<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>msg <span class="token operator">=</span> <span class="token string">"Hello from writer!"</span><span class="token punctuation">;</span>    <span class="token function">mkfifo</span><span class="token punctuation">(</span>FIFO_NAME<span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>FIFO_NAME<span class="token punctuation">,</span> O_WRONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">write</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span>FIFO_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ é™¤å‘½åç®¡é“æ–‡ä»¶</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong><code>reader.c</code></strong>ï¼š</li></ul>  <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FIFO_NAME</span> <span class="token string">"my_fifo"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> fd<span class="token punctuation">;</span>    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">mkfifo</span><span class="token punctuation">(</span>FIFO_NAME<span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¿è¯æ–‡ä»¶å­˜åœ¨</span>    fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>FIFO_NAME<span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Reader received: %s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½ å¯ä»¥å…ˆè¿è¡Œ <code>writer.c</code>ï¼Œå†è¿è¡Œ <code>reader.c</code>ã€‚</p></li></ul><h3 id="23-ä¿¡å·"><a class="markdownIt-Anchor" href="#23-ä¿¡å·"></a> 2.3. ä¿¡å·</h3><p><strong>ä¿¡å·ï¼ˆSignalï¼‰</strong> æ˜¯ä¸€ç§æ›´è½»é‡çº§ã€æ›´å¼‚æ­¥çš„è¿›ç¨‹é—´é€šä¿¡å’Œäº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚å®ƒå°±åƒä¸€ä¸ªâ€œè½¯ä¸­æ–­â€ï¼Œç”¨æ¥é€šçŸ¥è¿›ç¨‹å‘ç”Ÿäº†æŸä¸ªäº‹ä»¶ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨ä¸“æ³¨åœ°å·¥ä½œï¼Œçªç„¶æœ‰äººæ‹äº†ä½ ä¸€ä¸‹è‚©è†€ã€‚ä½ åœä¸‹æ‰‹ä¸­çš„æ´»ï¼Œè½¬å¤´çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Œç„¶åæ ¹æ®æƒ…å†µåšå‡ºååº”ï¼ˆæ¯”å¦‚ï¼Œå¯¹æ–¹æ˜¯åŒäº‹ï¼Œä½ å¯èƒ½å’Œä»–èŠä¸¤å¥ï¼›å¯¹æ–¹æ˜¯é¢†å¯¼ï¼Œä½ å¯èƒ½é©¬ä¸Šç«™èµ·æ¥ï¼‰ã€‚</p><p>åœ¨ Linux ä¸­ï¼Œ<strong>ä¿¡å·</strong>å°±æ˜¯é‚£ä¸ªâ€œæ‹è‚©è†€â€çš„åŠ¨ä½œã€‚å½“ä¸€ä¸ªè¿›ç¨‹æ”¶åˆ°ä¸€ä¸ªä¿¡å·æ—¶ï¼Œå®ƒä¼šæš‚åœå½“å‰æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè½¬è€Œå»å¤„ç†è¿™ä¸ªä¿¡å·ï¼Œå¤„ç†å®Œåå†æ¢å¤æ‰§è¡Œã€‚</p><ul><li><p><strong>å‘é€è€…</strong>ï¼šå¯ä»¥æ˜¯å†…æ ¸ï¼ˆæ¯”å¦‚ä½ æŒ‰ä¸‹ <code>Ctrl+C</code>ï¼Œå†…æ ¸ä¼šå‘é€ <code>SIGINT</code> ä¿¡å·ç»™å‰å°è¿›ç¨‹ï¼‰ã€ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–è¿›ç¨‹ï¼ˆä½¿ç”¨ <code>kill()</code> å‡½æ•°ï¼‰ã€‚</p></li><li><p><strong>æ¥æ”¶è€…</strong>ï¼šä»»ä½•ä¸€ä¸ªè¿›ç¨‹éƒ½å¯ä»¥æ¥æ”¶ä¿¡å·ã€‚</p></li></ul><h4 id="231-ä¿¡å·çš„åˆ†ç±»"><a class="markdownIt-Anchor" href="#231-ä¿¡å·çš„åˆ†ç±»"></a> 2.3.1. ä¿¡å·çš„åˆ†ç±»</h4><p>ä¿¡å·æœ‰å¾ˆå¤šç§ï¼Œæ¯ç§éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨é€”ã€‚å¸¸è§çš„ä¿¡å·åŠå…¶ä½œç”¨å¦‚ä¸‹ï¼š</p><table><thead><tr><th>ä¿¡å·åç§°</th><th>é»˜è®¤è¡Œä¸º</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><strong><code>SIGHUP</code> (1)</strong></td><td>ç»ˆæ­¢è¿›ç¨‹</td><td>å½“ç»ˆç«¯å…³é—­æ—¶å‘é€ç»™å…³è”çš„è¿›ç¨‹ã€‚</td></tr><tr><td><strong><code>SIGINT</code> (2)</strong></td><td>ç»ˆæ­¢è¿›ç¨‹</td><td>æ¥è‡ªé”®ç›˜ä¸­æ–­ï¼Œé€šå¸¸æ˜¯ <code>Ctrl+C</code>ã€‚</td></tr><tr><td><strong><code>SIGQUIT</code> (3)</strong></td><td>ç»ˆæ­¢å¹¶ç”Ÿæˆæ ¸å¿ƒè½¬å‚¨æ–‡ä»¶</td><td>æ¥è‡ªé”®ç›˜é€€å‡ºï¼Œé€šå¸¸æ˜¯ <code>Ctrl+\\</code>ã€‚</td></tr><tr><td><strong><code>SIGKILL</code> (9)</strong></td><td>å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹</td><td>æ— æ³•è¢«æ•è·ã€é˜»å¡æˆ–å¿½ç•¥ï¼Œå¼ºåˆ¶æ€æ­»è¿›ç¨‹ã€‚</td></tr><tr><td><strong><code>SIGTERM</code> (15)</strong></td><td>ç»ˆæ­¢è¿›ç¨‹</td><td>å‹å¥½çš„ç»ˆæ­¢è¯·æ±‚ï¼Œå¯ä»¥è¢«æ•è·ã€‚<code>kill</code> å‘½ä»¤é»˜è®¤å‘é€æ­¤ä¿¡å·ã€‚</td></tr><tr><td><strong><code>SIGCHLD</code></strong></td><td>å¿½ç•¥</td><td>å­è¿›ç¨‹ç»ˆæ­¢æˆ–åœæ­¢æ—¶å‘é€ç»™çˆ¶è¿›ç¨‹ã€‚</td></tr><tr><td><strong><code>SIGSTOP</code></strong></td><td>åœæ­¢è¿›ç¨‹</td><td>æ— æ³•è¢«æ•è·ã€å¿½ç•¥ï¼Œæš‚åœè¿›ç¨‹ã€‚</td></tr><tr><td><strong><code>SIGCONT</code></strong></td><td>ç»§ç»­è¿›ç¨‹</td><td>ä½¿åœæ­¢çš„è¿›ç¨‹ç»§ç»­è¿è¡Œã€‚</td></tr></tbody></table><h4 id="232-ä¿¡å·ä¸-ipc-çš„å…³ç³»"><a class="markdownIt-Anchor" href="#232-ä¿¡å·ä¸-ipc-çš„å…³ç³»"></a> 2.3.2. ä¿¡å·ä¸ IPC çš„å…³ç³»</h4><ul><li><p><strong>å¼‚æ­¥é€šçŸ¥</strong>ï¼šä¿¡å·æ˜¯å…¸å‹çš„å¼‚æ­¥ IPC æœºåˆ¶ï¼Œå®ƒä¸åƒç®¡é“æˆ–å…±äº«å†…å­˜é‚£æ ·ä¼ é€’æ•°æ®ï¼Œè€Œæ˜¯<strong>ä¼ é€’äº‹ä»¶ä¿¡æ¯</strong>ã€‚</p></li><li><p><strong>è½»é‡çº§</strong>ï¼šç›¸æ¯”äºå…¶ä»– IPCï¼Œä¿¡å·çš„å¼€é”€éå¸¸å°ã€‚</p></li><li><p><strong>åŒæ­¥</strong>ï¼šä¿¡å·ä¹Ÿå¯ä»¥ç”¨äºåŒæ­¥ç›®çš„ï¼Œä¾‹å¦‚ <code>SIGCHLD</code> ä¿¡å·å¸¸ç”¨äºçˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹ç»“æŸã€‚</p></li></ul><p>ç†è§£ä¿¡å·ï¼Œç‰¹åˆ«æ˜¯ä¿¡å·é›†å’Œé˜»å¡çš„æ¦‚å¿µï¼Œå¯¹äºç¼–å†™å¥å£®çš„å¤šè¿›ç¨‹æˆ–å¤šçº¿ç¨‹ç¨‹åºè‡³å…³é‡è¦ã€‚å®ƒèƒ½è®©ä½ æ›´å¥½åœ°æ§åˆ¶ç¨‹åºå¯¹å¤–éƒ¨äº‹ä»¶çš„å“åº”ã€‚</p><h4 id="233-ä¿¡å·çš„ä¸‰ç§å¤„ç†æ–¹å¼"><a class="markdownIt-Anchor" href="#233-ä¿¡å·çš„ä¸‰ç§å¤„ç†æ–¹å¼"></a> 2.3.3. ä¿¡å·çš„ä¸‰ç§å¤„ç†æ–¹å¼</h4><p>å½“è¿›ç¨‹æ”¶åˆ°ä¸€ä¸ªä¿¡å·æ—¶ï¼Œå®ƒå¯ä»¥æœ‰ä¸‰ç§å¤„ç†æ–¹å¼ï¼š</p><ol><li><p><strong>æ‰§è¡Œé»˜è®¤åŠ¨ä½œï¼ˆDefaultï¼‰</strong>ï¼šå¤§å¤šæ•°ä¿¡å·éƒ½æœ‰ä¸€ä¸ªé¢„å®šä¹‰çš„é»˜è®¤è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œ<code>SIGINT</code> çš„é»˜è®¤è¡Œä¸ºå°±æ˜¯ç»ˆæ­¢è¿›ç¨‹ã€‚</p></li><li><p><strong>å¿½ç•¥ä¿¡å·ï¼ˆIgnoreï¼‰</strong>ï¼šæœ‰äº›ä¿¡å·å¯ä»¥è¢«å¿½ç•¥ï¼Œå³è¿›ç¨‹æ”¶åˆ°ä¿¡å·åä¸åšä»»ä½•å¤„ç†ã€‚<code>SIGCHLD</code> ä¿¡å·çš„é»˜è®¤è¡Œä¸ºå°±æ˜¯å¿½ç•¥ã€‚</p></li><li><p><strong>æ•è·ä¿¡å·ï¼ˆCatchï¼‰</strong>ï¼šè¿™æ˜¯æœ€çµæ´»çš„æ–¹å¼ã€‚è¿›ç¨‹å¯ä»¥ä¸ºæŸä¸ªä¿¡å·æ³¨å†Œä¸€ä¸ª<strong>ä¿¡å·å¤„ç†å‡½æ•°ï¼ˆSignal Handlerï¼‰</strong>ã€‚å½“ä¿¡å·åˆ°æ¥æ—¶ï¼Œè¿›ç¨‹ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°æ¥å¤„ç†ä¿¡å·ï¼Œè€Œä¸æ˜¯æ‰§è¡Œé»˜è®¤åŠ¨ä½œã€‚</p></li></ol><div class="admonition caution"><p class="admonition-title">caution</p><p><strong>æ³¨æ„</strong>ï¼š<code>SIGKILL</code> å’Œ <code>SIGSTOP</code> è¿™ä¸¤ä¸ªä¿¡å·æ˜¯<strong>ä¸èƒ½è¢«æ•è·ã€å¿½ç•¥æˆ–é˜»å¡</strong>çš„ã€‚å®ƒä»¬æ˜¯ç³»ç»Ÿç®¡ç†å‘˜å¼ºåˆ¶ç»ˆæ­¢æˆ–åœæ­¢è¿›ç¨‹çš„â€œæœ€åæ‰‹æ®µâ€ã€‚</p></div><h4 id="234-å¦‚ä½•ä½¿ç”¨ä¿¡å·"><a class="markdownIt-Anchor" href="#234-å¦‚ä½•ä½¿ç”¨ä¿¡å·"></a> 2.3.4. å¦‚ä½•ä½¿ç”¨ä¿¡å·ï¼Ÿ</h4><h5 id="2341-å‘é€ä¿¡å·kill-å‡½æ•°"><a class="markdownIt-Anchor" href="#2341-å‘é€ä¿¡å·kill-å‡½æ•°"></a> 2.3.4.1. å‘é€ä¿¡å·ï¼š<code>kill()</code> å‡½æ•°</h5><p>ä½ å¯ä»¥ä½¿ç”¨ <code>kill()</code> å‡½æ•°å‘å¦ä¸€ä¸ªè¿›ç¨‹å‘é€ä¿¡å·ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h></span></span><span class="token keyword">int</span> <span class="token function">kill</span><span class="token punctuation">(</span><span class="token class-name">pid_t</span> pid<span class="token punctuation">,</span> <span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li><p><code>pid</code>ï¼šç›®æ ‡è¿›ç¨‹çš„ IDã€‚</p></li><li><p><code>sig</code>ï¼šè¦å‘é€çš„ä¿¡å·ç¼–å·ã€‚</p></li></ul><h5 id="2342-æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°signal-å’Œ-sigaction"><a class="markdownIt-Anchor" href="#2342-æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°signal-å’Œ-sigaction"></a> 2.3.4.2. æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°ï¼š<code>signal()</code> å’Œ <code>sigaction()</code></h5><ul><li><p><strong><code>signal()</code> å‡½æ•°</strong>ï¼šè¿™æ˜¯æœ€ç®€å•çš„æ³¨å†Œæ–¹å¼ï¼Œä½†å®ƒåœ¨ä¸åŒç³»ç»Ÿä¸Šçš„è¡Œä¸ºå¯èƒ½ä¸ä¸€è‡´ï¼Œä¸æ¨èåœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ã€‚</p></li><li><p><strong><code>sigaction()</code> å‡½æ•°</strong>ï¼šè¿™æ˜¯ POSIX æ ‡å‡†æ¨èçš„æ–¹å¼ï¼Œæ›´å¼ºå¤§ï¼Œæ›´å¯é ã€‚</p></li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h></span></span><span class="token keyword">int</span> <span class="token function">sigaction</span><span class="token punctuation">(</span><span class="token keyword">int</span> signum<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">sigaction</span> <span class="token operator">*</span>act<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">sigaction</span> <span class="token operator">*</span>oldact<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><p><code>signum</code>ï¼šè¦æ•è·çš„ä¿¡å·ç¼–å·ã€‚</p></li><li><p><code>act</code>ï¼šæŒ‡å‘ <code>struct sigaction</code> ç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“å®šä¹‰äº†æ–°çš„ä¿¡å·å¤„ç†è¡Œä¸ºã€‚</p></li><li><p><code>oldact</code>ï¼šå¯é€‰ï¼Œç”¨äºä¿å­˜æ—§çš„ä¿¡å·å¤„ç†è¡Œä¸ºã€‚</p></li></ul><p><strong><code>struct sigaction</code> ç»“æ„ä½“</strong>ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">sigaction</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>sa_handler<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ä¿¡å·å¤„ç†å‡½æ•°</span>    <span class="token class-name">sigset_t</span> sa_mask<span class="token punctuation">;</span>         <span class="token comment">// ä¿¡å·é›†ï¼Œåœ¨ä¿¡å·å¤„ç†å‡½æ•°æ‰§è¡ŒæœŸé—´éœ€è¦é˜»å¡çš„ä¿¡å·</span>    <span class="token keyword">int</span> sa_flags<span class="token punctuation">;</span>             <span class="token comment">// æ ‡å¿—ä½</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="24-ä¿¡å·é›†signal-setå’Œé˜»å¡"><a class="markdownIt-Anchor" href="#24-ä¿¡å·é›†signal-setå’Œé˜»å¡"></a> 2.4. ä¿¡å·é›†ï¼ˆSignal Setï¼‰å’Œé˜»å¡</h3><p>å½“ä½ åœ¨å¤„ç†ä¸€ä¸ªä¿¡å·æ—¶ï¼Œä½ å¯èƒ½ä¸å¸Œæœ›è¢«å…¶ä»–ä¿¡å·æ‰“æ–­ã€‚<strong>ä¿¡å·é›†ï¼ˆ<code>sigset_t</code>ï¼‰</strong> å°±æ˜¯ç”¨æ¥ç®¡ç†ä¸€ç»„ä¿¡å·çš„ã€‚é€šè¿‡æ“ä½œä¿¡å·é›†ï¼Œä½ å¯ä»¥<strong>é˜»å¡ï¼ˆBlockï¼‰</strong> æŸäº›ä¿¡å·ï¼Œè®©å®ƒä»¬åœ¨è¿›ç¨‹å¤„ç†å®Œå½“å‰ä»»åŠ¡åæ‰è¢«ä¼ é€’ã€‚</p><h4 id="241-ä¿¡å·é›†æ“ä½œå‡½æ•°"><a class="markdownIt-Anchor" href="#241-ä¿¡å·é›†æ“ä½œå‡½æ•°"></a> 2.4.1. ä¿¡å·é›†æ“ä½œå‡½æ•°</h4><ul><li><p><strong><code>sigemptyset()</code></strong>ï¼šåˆå§‹åŒ–ä¸€ä¸ªç©ºçš„ä¿¡å·é›†ã€‚</p></li><li><p><strong><code>sigaddset()</code></strong>ï¼šå‘ä¿¡å·é›†ä¸­æ·»åŠ ä¸€ä¸ªä¿¡å·ã€‚</p></li><li><p><strong><code>sigdelset()</code></strong>ï¼šä»ä¿¡å·é›†ä¸­åˆ é™¤ä¸€ä¸ªä¿¡å·ã€‚</p></li><li><p><strong><code>sigismember()</code></strong>ï¼šæ£€æŸ¥ä¸€ä¸ªä¿¡å·æ˜¯å¦åœ¨ä¿¡å·é›†ä¸­ã€‚</p></li></ul><h4 id="242-é˜»å¡ä¿¡å·sigprocmask"><a class="markdownIt-Anchor" href="#242-é˜»å¡ä¿¡å·sigprocmask"></a> 2.4.2. é˜»å¡ä¿¡å·ï¼š<code>sigprocmask()</code></h4><p><code>sigprocmask()</code> å‡½æ•°ç”¨æ¥è®¾ç½®è¿›ç¨‹çš„<strong>ä¿¡å·é˜»å¡æ©ç ï¼ˆSignal Maskï¼‰</strong>ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h></span></span><span class="token keyword">int</span> <span class="token function">sigprocmask</span><span class="token punctuation">(</span><span class="token keyword">int</span> how<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">sigset_t</span> <span class="token operator">*</span>set<span class="token punctuation">,</span> <span class="token class-name">sigset_t</span> <span class="token operator">*</span>oldset<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><p><code>how</code>ï¼šæŒ‡å®šå¦‚ä½•ä¿®æ”¹ä¿¡å·é˜»å¡æ©ç ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><p><code>SIG_BLOCK</code>ï¼šå°† <code>set</code> ä¸­çš„ä¿¡å·æ·»åŠ åˆ°é˜»å¡æ©ç ä¸­ã€‚</p></li><li><p><code>SIG_UNBLOCK</code>ï¼šå°† <code>set</code> ä¸­çš„ä¿¡å·ä»é˜»å¡æ©ç ä¸­ç§»é™¤ã€‚</p></li><li><p><code>SIG_SETMASK</code>ï¼šå°†é˜»å¡æ©ç è®¾ç½®ä¸º <code>set</code>ã€‚</p></li></ul></li><li><p><code>set</code>ï¼šåŒ…å«è¦é˜»å¡æˆ–è§£é™¤é˜»å¡çš„ä¿¡å·é›†ã€‚</p></li><li><p><code>oldset</code>ï¼šå¯é€‰ï¼Œç”¨äºä¿å­˜æ—§çš„é˜»å¡æ©ç ã€‚</p></li></ul><p><strong>ç¤ºä¾‹</strong>ï¼šåœ¨å¤„ç†å…³é”®ä»£ç æ®µæ—¶ä¸´æ—¶é˜»å¡ <code>SIGINT</code>ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">void</span> <span class="token function">my_handler</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Caught signal %d\n"</span><span class="token punctuation">,</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">sigset_t</span> block_mask<span class="token punctuation">,</span> old_mask<span class="token punctuation">;</span>    <span class="token comment">// 1. è®¾ç½®è¦é˜»å¡çš„ä¿¡å·é›†</span>    <span class="token function">sigemptyset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>block_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sigaddset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>block_mask<span class="token punctuation">,</span> SIGINT<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 2. é˜»å¡ SIGINT ä¿¡å·</span>    <span class="token function">sigprocmask</span><span class="token punctuation">(</span>SIG_BLOCK<span class="token punctuation">,</span> <span class="token operator">&amp;</span>block_mask<span class="token punctuation">,</span> <span class="token operator">&amp;</span>old_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"SIGINT is blocked. Press Ctrl+C...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åœ¨è¿™10ç§’å†…ï¼ŒCtrl+Cä¸ä¼šç»ˆæ­¢è¿›ç¨‹</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Unblocking SIGINT...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 3. è§£é™¤é˜»å¡ï¼Œæ¢å¤æ—§çš„ä¿¡å·æ©ç </span>    <span class="token function">sigprocmask</span><span class="token punctuation">(</span>SIG_SETMASK<span class="token punctuation">,</span> <span class="token operator">&amp;</span>old_mask<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"SIGINT is unblocked. Press Ctrl+C again.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 4. æ³¨å†Œä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°</span>    <span class="token keyword">struct</span> <span class="token class-name">sigaction</span> sa<span class="token punctuation">;</span>    sa<span class="token punctuation">.</span>sa_handler <span class="token operator">=</span> my_handler<span class="token punctuation">;</span>    <span class="token function">sigemptyset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sa<span class="token punctuation">.</span>sa_mask<span class="token punctuation">)</span><span class="token punctuation">;</span>    sa<span class="token punctuation">.</span>sa_flags <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">sigaction</span><span class="token punctuation">(</span>SIGINT<span class="token punctuation">,</span> <span class="token operator">&amp;</span>sa<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Running...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä½ ä¼šçœ‹åˆ°åœ¨é˜»å¡æœŸé—´ï¼Œ<code>Ctrl+C</code> æ— æ³•ç»ˆæ­¢è¿›ç¨‹ã€‚å½“è§£é™¤é˜»å¡åï¼Œ<code>Ctrl+C</code> æ‰èƒ½è§¦å‘ä¿¡å·å¤„ç†å‡½æ•°ã€‚</p><h3 id="25-system-v-ipc-system-v-ipc"><a class="markdownIt-Anchor" href="#25-system-v-ipc-system-v-ipc"></a> 2.5. System V IPC (System V IPC)<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></h3><p>System V IPC æ˜¯ Linux ç³»ç»Ÿä¸­ä¸€ç»„æ›´é«˜çº§ã€æ›´å¼ºå¤§çš„ IPC æœºåˆ¶ï¼ŒåŒ…æ‹¬æ¶ˆæ¯é˜Ÿåˆ—ã€ä¿¡å·é‡å’Œå…±äº«å†…å­˜ã€‚å®ƒä»¬éƒ½æ˜¯<strong>åŸºäºå†…æ ¸</strong>çš„ï¼Œéœ€è¦ä¸€ä¸ªå”¯ä¸€çš„é”®å€¼ï¼ˆkeyï¼‰æ¥æ ‡è¯†ã€‚</p><h4 id="251-æ¶ˆæ¯é˜Ÿåˆ—message-queues"><a class="markdownIt-Anchor" href="#251-æ¶ˆæ¯é˜Ÿåˆ—message-queues"></a> 2.5.1. æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queuesï¼‰</h4><p>æ¶ˆæ¯é˜Ÿåˆ—å°±åƒä¸€ä¸ªé“¾è¡¨ï¼Œå…è®¸è¿›ç¨‹å‘å…¶ä¸­æ·»åŠ æ¶ˆæ¯æˆ–ä»ä¸­è¯»å–æ¶ˆæ¯ã€‚</p><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p><strong>å¼‚æ­¥é€šä¿¡</strong>ï¼šå‘é€è¿›ç¨‹å¯ä»¥å‘é€æ¶ˆæ¯åç«‹å³è¿”å›ï¼Œä¸éœ€è¦ç­‰å¾…æ¥æ”¶è¿›ç¨‹ã€‚</p></li><li><p><strong>å¸¦ç±»å‹</strong>ï¼šæ¶ˆæ¯å¯ä»¥å¸¦æœ‰ç±»å‹ï¼Œæ¥æ”¶è¿›ç¨‹å¯ä»¥åªæ¥æ”¶ç‰¹å®šç±»å‹çš„æ¶ˆæ¯ã€‚</p></li><li><p><strong>å­˜å‚¨åœ¨å†…æ ¸ä¸­</strong>ï¼šå³ä½¿å‘é€è¿›ç¨‹ç»“æŸï¼Œæ¶ˆæ¯ä¾ç„¶ä¿ç•™åœ¨é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°è¢«è¯»å–ã€‚</p></li></ul></li><li><p><strong>ä½¿ç”¨</strong>ï¼š</p><ul><li><p><strong><code>ftok()</code></strong>ï¼šå°†æ–‡ä»¶è·¯å¾„å’Œæ•´æ•°è½¬æ¢ä¸ºä¸€ä¸ªå”¯ä¸€çš„ IPC é”®å€¼ã€‚</p></li><li><p><strong><code>msgget()</code></strong>ï¼šåˆ›å»ºæˆ–è·å–ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ã€‚</p></li><li><p><strong><code>msgsnd()</code></strong>ï¼šå‘é€æ¶ˆæ¯ã€‚</p></li><li><p><strong><code>msgrcv()</code></strong>ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚</p></li><li><p><strong><code>msgctl()</code></strong>ï¼šæ§åˆ¶æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚åˆ é™¤ã€‚</p></li></ul></li></ul><h4 id="252-ä¿¡å·é‡semaphores"><a class="markdownIt-Anchor" href="#252-ä¿¡å·é‡semaphores"></a> 2.5.2. ä¿¡å·é‡ï¼ˆSemaphoresï¼‰</h4><p>ä¿¡å·é‡ä¸»è¦ç”¨äº<strong>åŒæ­¥</strong>ï¼Œæ§åˆ¶å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚å®ƒæœ¬èº«ä¸ä¼ é€’æ•°æ®ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ç§â€œè®¡æ•°å™¨â€ã€‚</p><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p><strong>äº’æ–¥å’ŒåŒæ­¥</strong>ï¼šå¸¸ç”¨äºå®ç°äº’æ–¥é”ï¼Œç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¿›ç¨‹è®¿é—®å…±äº«èµ„æºã€‚</p></li><li><p><strong>åŸå­æ“ä½œ</strong>ï¼šä¿¡å·é‡çš„æ“ä½œï¼ˆP/Væ“ä½œï¼‰æ˜¯åŸå­çš„ï¼Œä¸ä¼šè¢«ä¸­æ–­ã€‚</p></li></ul></li><li><p><strong>ä½¿ç”¨</strong>ï¼š</p><ul><li><p><strong><code>semget()</code></strong>ï¼šåˆ›å»ºæˆ–è·å–ä¸€ç»„ä¿¡å·é‡ã€‚</p></li><li><p><strong><code>semop()</code></strong>ï¼šå¯¹ä¿¡å·é‡è¿›è¡Œæ“ä½œï¼Œå¦‚åŠ /å‡è®¡æ•°ã€‚</p></li><li><p><strong><code>semctl()</code></strong>ï¼šæ§åˆ¶ä¿¡å·é‡ã€‚</p></li></ul></li></ul><h4 id="253-å…±äº«å†…å­˜shared-memory"><a class="markdownIt-Anchor" href="#253-å…±äº«å†…å­˜shared-memory"></a> 2.5.3. å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰</h4><p>å…±äº«å†…å­˜æ˜¯æœ€é«˜æ•ˆçš„ IPC æ–¹å¼ã€‚å®ƒå…è®¸ä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹å…±äº«åŒä¸€å—ç‰©ç†å†…å­˜ã€‚</p><ul><li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li><p><strong>æœ€é«˜æ•ˆ</strong>ï¼šä¸€æ—¦æ˜ å°„åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œè¯»å†™æ“ä½œå°±åƒè®¿é—®æ™®é€šå†…å­˜ä¸€æ ·ï¼Œä¸éœ€è¦å†…æ ¸çš„å‚ä¸ã€‚</p></li><li><p><strong>éœ€è¦åŒæ­¥</strong>ï¼šç”±äºå¤šä¸ªè¿›ç¨‹åŒæ—¶è®¿é—®ï¼Œéœ€è¦ç”¨<strong>ä¿¡å·é‡</strong>ç­‰æœºåˆ¶æ¥åŒæ­¥è®¿é—®ï¼Œé˜²æ­¢æ•°æ®ç«äº‰ã€‚</p></li></ul></li><li><p><strong>ä½¿ç”¨</strong>ï¼š</p><ul><li><p><strong><code>shmget()</code></strong>ï¼šåˆ›å»ºæˆ–è·å–ä¸€ä¸ªå…±äº«å†…å­˜æ®µã€‚</p></li><li><p><strong><code>shmat()</code></strong>ï¼šå°†å…±äº«å†…å­˜æ®µé™„åŠ åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚</p></li><li><p><strong><code>shmdt()</code></strong>ï¼šå°†å…±äº«å†…å­˜æ®µä»è¿›ç¨‹çš„åœ°å€ç©ºé—´åˆ†ç¦»ã€‚</p></li><li><p><strong><code>shmctl()</code></strong>ï¼šæ§åˆ¶å…±äº«å†…å­˜ï¼Œå¦‚åˆ é™¤ã€‚</p></li></ul></li></ul><h3 id="26-ipc-æ€»ç»“ä¸é€‰æ‹©"><a class="markdownIt-Anchor" href="#26-ipc-æ€»ç»“ä¸é€‰æ‹©"></a> 2.6. IPC æ€»ç»“ä¸é€‰æ‹©</h3><table><thead><tr><th>æœºåˆ¶</th><th>é€‚ç”¨åœºæ™¯</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><strong>ç®¡é“</strong></td><td>æœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹</td><td>ç®€å•ï¼Œæ˜“äºä½¿ç”¨</td><td>å•å‘ï¼Œä»…é™äºäº²ç¼˜è¿›ç¨‹</td></tr><tr><td><strong>FIFO</strong></td><td>æ— äº²ç¼˜å…³ç³»çš„è¿›ç¨‹</td><td>å¯ä»¥åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­å‘½åï¼Œçµæ´»</td><td>å•å‘ï¼Œéœ€è¦åŒæ­¥ï¼Œè¯»å†™æ—¶æœ‰é˜»å¡</td></tr><tr><td><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong></td><td>å¼‚æ­¥é€šä¿¡ï¼Œå°‘é‡æ•°æ®</td><td>æ¶ˆæ¯å¸¦ç±»å‹ï¼Œæ— éœ€åŒæ­¥</td><td>æ•ˆç‡è¾ƒä½ï¼Œæœ‰å¤§å°é™åˆ¶</td></tr><tr><td><strong>ä¿¡å·é‡</strong></td><td>è¿›ç¨‹é—´åŒæ­¥ï¼Œäº’æ–¥</td><td>ç”¨äºæ§åˆ¶è®¿é—®ï¼Œé˜²æ­¢ç«äº‰</td><td>ä¸ä¼ é€’æ•°æ®</td></tr><tr><td><strong>å…±äº«å†…å­˜</strong></td><td>å¤§é‡æ•°æ®ä¼ è¾“</td><td>æœ€é«˜æ•ˆï¼Œè¯»å†™é€Ÿåº¦å¿«</td><td>å¿…é¡»é…åˆå…¶ä»–åŒæ­¥æœºåˆ¶ä½¿ç”¨</td></tr></tbody></table><p><strong>å¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></p><ul><li><p>å¦‚æœæ˜¯çˆ¶å­è¿›ç¨‹ä¹‹é—´å°‘é‡æ•°æ®çš„é€šä¿¡ï¼Œ<strong>ç®¡é“</strong>æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p></li><li><p>å¦‚æœæ˜¯ä¸¤ä¸ªä¸ç›¸å…³çš„è¿›ç¨‹ï¼Œä¸”æ•°æ®é‡ä¸å¤§ï¼Œ<strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ¡ˆã€‚</p></li><li><p>å¦‚æœéœ€è¦ä¼ è¾“å¤§é‡æ•°æ®ï¼Œä¸”å¯¹æ€§èƒ½è¦æ±‚æé«˜ï¼Œ<strong>å…±äº«å†…å­˜</strong>æ˜¯é¦–é€‰ï¼Œä½†<strong>å¿…é¡»</strong>ç»“åˆ<strong>ä¿¡å·é‡</strong>æˆ–å…¶ä»–åŒæ­¥æœºåˆ¶ã€‚</p></li><li><p>å¦‚æœä½ åªæƒ³è§£å†³èµ„æºè®¿é—®çš„åŒæ­¥é—®é¢˜ï¼Œ<strong>ä¿¡å·é‡</strong>æ˜¯ä¸“é—¨ä¸ºæ­¤è®¾è®¡çš„ã€‚</p></li></ul><p>äº†è§£è¿™äº› IPC æœºåˆ¶ï¼Œå°±å¦‚åŒæŒæ¡äº†è¿›ç¨‹ä¹‹é—´â€œæ²Ÿé€šâ€çš„å¤šç§è¯­è¨€ã€‚åœ¨å¼€å‘æ—¶ï¼Œé€‰æ‹©åˆé€‚çš„â€œè¯­è¨€â€èƒ½è®©ä½ çš„ç¨‹åºæ›´åŠ å¥å£®ã€é«˜æ•ˆã€‚ç°åœ¨ï¼Œä½ å¯ä»¥å°è¯•ç”¨è¿™äº›æœºåˆ¶æ¥è§£å†³ä½ é‡åˆ°çš„å®é™…é—®é¢˜äº†ï¼</p><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>ä½œäº†è§£ï¼Œé‡ç‚¹ä½¿ç”¨POSIX IPCã€‚ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/categories/Linux/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
    <category term="IPC" scheme="https://blog.godmao.top/Tags/IPC/"/>
    
  </entry>
  
  <entry>
    <title>Linux-Process</title>
    <link href="https://blog.godmao.top/posts/43741/"/>
    <id>https://blog.godmao.top/posts/43741/</id>
    <published>2025-09-10T06:53:13.000Z</published>
    <updated>2025-09-12T11:32:56.501Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><div class="admonition info"><p>AI è¾…åŠ©åˆ›ä½œ</p></div><p>åœ¨ Linux ç¼–ç¨‹ä¸­ï¼Œ<strong>è¿›ç¨‹ï¼ˆProcessï¼‰</strong> æ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºå’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ã€ä»£ç æ®µã€æ•°æ®æ®µå’Œæ‰§è¡Œä¸Šä¸‹æ–‡ã€‚å¤šä¸ªè¿›ç¨‹ä¹‹é—´å¸¸å¸¸éœ€è¦åä½œï¼Œè¿™å°±æ¶‰åŠåˆ° <strong>è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPC, Inter-Process Communicationï¼‰</strong>ã€‚æœ¬ç¯‡åšå®¢ä¼šç³»ç»Ÿä»‹ç»è¿›ç¨‹çš„åŸºç¡€æ“ä½œï¼Œå¹¶å¯¹å¸¸è§çš„ IPC æ–¹å¼è¿›è¡Œè¯¦ç»†è§£é‡Šä¸ç¤ºä¾‹ï¼Œå¸¦ä½ ä»é›¶å¼€å§‹æŒæ¡ã€‚</p><hr /><h2 id="1-è¿›ç¨‹ä¸-pid"><a class="markdownIt-Anchor" href="#1-è¿›ç¨‹ä¸-pid"></a> 1. è¿›ç¨‹ä¸ PID</h2><p>æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„ <strong>è¿›ç¨‹å·ï¼ˆPIDï¼‰</strong>ï¼Œå¯ä»¥é€šè¿‡ <code>getpid()</code> è·å–å½“å‰è¿›ç¨‹å·ï¼Œé€šè¿‡ <code>getppid()</code> è·å–çˆ¶è¿›ç¨‹å·ã€‚è¿™åœ¨è°ƒè¯•å’Œè¿›ç¨‹ç®¡ç†æ—¶éå¸¸é‡è¦ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"å½“å‰è¿›ç¨‹PID=%d, çˆ¶è¿›ç¨‹PID=%d\n"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getppid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>âš ï¸ æ³¨æ„ï¼šå¦‚æœçˆ¶è¿›ç¨‹å…ˆé€€å‡ºï¼Œå­è¿›ç¨‹ä¼šè¢« <code>init</code> è¿›ç¨‹æ¥ç®¡ï¼Œ<code>ppid</code> ä¼šå˜ä¸º 1ã€‚</p><h2 id="2-åˆ›å»ºè¿›ç¨‹-fork"><a class="markdownIt-Anchor" href="#2-åˆ›å»ºè¿›ç¨‹-fork"></a> 2. åˆ›å»ºè¿›ç¨‹ â€” <code>fork()</code></h2><p><code>fork()</code> æ˜¯åˆ›å»ºæ–°è¿›ç¨‹çš„ä¸»è¦æ–¹å¼ã€‚å®ƒä¼šå¤åˆ¶å½“å‰è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰çš„å¤§éƒ¨åˆ†å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªå‡ ä¹ä¸€æ¨¡ä¸€æ ·çš„å­è¿›ç¨‹ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">pid_t</span> pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p><strong>åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œ<code>fork()</code> è¿”å›å­è¿›ç¨‹çš„ PIDã€‚</strong></p></li><li><p><strong>åœ¨å­è¿›ç¨‹ä¸­ï¼Œ<code>fork()</code> è¿”å› 0ã€‚</strong></p></li><li><p>å¦‚æœå¤±è´¥ï¼Œè¿”å› -1ã€‚</p></li></ul><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">pid_t</span> pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[å­è¿›ç¨‹] pid=%d, ppid=%d\n"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getppid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[çˆ¶è¿›ç¨‹] pid=%d, å­è¿›ç¨‹pid=%d\n"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"fork å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="admonition caution"><p class="admonition-title">caution</p><ul><li><p>å­è¿›ç¨‹ä¸ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„æ‰€æœ‰èµ„æºï¼Œä¾‹å¦‚æ–‡ä»¶é”ã€‚</p></li><li><p><code>fork()</code> ä¹‹åï¼Œçˆ¶å­è¿›ç¨‹æ‰§è¡Œé¡ºåºä¸ç¡®å®šï¼Œéœ€è¦é€šè¿‡ <code>wait()</code> æˆ–å…¶ä»–æœºåˆ¶æ§åˆ¶ã€‚</p></li></ul></div><h2 id="3-ç¨‹åºæ›¿æ¢-exec-ç³»åˆ—"><a class="markdownIt-Anchor" href="#3-ç¨‹åºæ›¿æ¢-exec-ç³»åˆ—"></a> 3. ç¨‹åºæ›¿æ¢ â€” <code>exec()</code> ç³»åˆ—</h2><p>å­è¿›ç¨‹å¸¸å¸¸éœ€è¦è¿è¡Œä¸€ä¸ªæ–°çš„ç¨‹åºï¼Œè¿™å°±éœ€è¦ <code>exec()</code> ç³»åˆ—å‡½æ•°ï¼ˆå¦‚ <code>execlp</code>, <code>execvp</code> ç­‰ï¼‰ã€‚<br /><code>exec</code> ç³»åˆ—å‡½æ•°çš„ä½œç”¨æ˜¯ï¼š<strong>ç”¨æ–°çš„ç¨‹åºæ›¿æ¢å½“å‰è¿›ç¨‹çš„ä»£ç æ®µ</strong>ï¼Œè€Œè¿›ç¨‹çš„ PIDã€æ–‡ä»¶æè¿°ç¬¦ï¼ˆé™¤éè®¾ç½®äº† <code>FD_CLOEXEC</code>ï¼‰ç­‰ä¿æŒä¸å˜ã€‚å®ƒä¸ä¼šåˆ›å»ºæ–°è¿›ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰è¿›ç¨‹å†…åŠ è½½å¹¶è¿è¡Œæ–°ç¨‹åºã€‚</p><h3 id="å¸¸è§å‡½æ•°"><a class="markdownIt-Anchor" href="#å¸¸è§å‡½æ•°"></a> å¸¸è§å‡½æ•°</h3><p><code>exec</code> ç³»åˆ—ä¸€å…±æœ‰ 6 ä¸ªå¸¸ç”¨å‡½æ•°ï¼Œä¸»è¦åŒºåˆ«åœ¨äº <strong>å‚æ•°ä¼ é€’æ–¹å¼</strong> å’Œ <strong>æ˜¯å¦ä¾èµ– PATH ç¯å¢ƒå˜é‡</strong>ã€‚</p><table><thead><tr><th>å‡½æ•°</th><th>å‚æ•°ä¼ é€’æ–¹å¼</th><th>æ˜¯å¦æœç´¢ PATH</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>execl(path, arg0, arg1, ..., NULL)</code></td><td>åˆ—è¡¨ï¼ˆé€ä¸ªä¼ å‚ï¼‰</td><td>å¦</td><td>æœ€å¸¸è§ï¼Œå‚æ•°ä»¥ä¸å®šé•¿åˆ—è¡¨å½¢å¼ä¼ é€’ï¼Œæœ€åå¿…é¡»ä»¥ <code>NULL</code> ç»“å°¾ã€‚</td></tr><tr><td><code>execv(path, argv[])</code></td><td>æ•°ç»„</td><td>å¦</td><td>å‚æ•°é€šè¿‡å­—ç¬¦ä¸²æ•°ç»„ä¼ é€’ï¼Œæ–¹ä¾¿åŠ¨æ€æ„é€ å‚æ•°ã€‚</td></tr><tr><td><code>execlp(file, arg0, arg1, ..., NULL)</code></td><td>åˆ—è¡¨</td><td>æ˜¯</td><td>ä¸ <code>execl</code> ç±»ä¼¼ï¼Œä½†ä¼šåœ¨ <code>PATH</code> ä¸­æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚</td></tr><tr><td><code>execvp(file, argv[])</code></td><td>æ•°ç»„</td><td>æ˜¯</td><td>ä¸ <code>execv</code> ç±»ä¼¼ï¼Œä½†ä¼šåœ¨ <code>PATH</code> ä¸­æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚</td></tr><tr><td><code>execle(path, arg0, arg1, ..., NULL, envp[])</code></td><td>åˆ—è¡¨</td><td>å¦</td><td>å¯ä»¥è‡ªå®šä¹‰ç¯å¢ƒå˜é‡ï¼Œæœ€åå‚æ•°éœ€æä¾› <code>envp</code>ã€‚</td></tr><tr><td><code>execve(path, argv[], envp[])</code></td><td>æ•°ç»„</td><td>å¦</td><td>æœ€åº•å±‚çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå…¶å®ƒ <code>exec</code> å‡½æ•°æœ€ç»ˆéƒ½è°ƒç”¨å®ƒã€‚</td></tr></tbody></table><p>è¯´æ˜ï¼š</p><ul><li><code>PATH</code>ï¼šç³»ç»Ÿç¯å¢ƒå˜é‡</li><li><code>path</code>ï¼šè¦æ‰§è¡Œçš„ç¨‹åºè·¯å¾„ï¼ˆå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼‰ã€‚</li><li><code>arg</code>ï¼šç¨‹åºè¦è¾“å…¥çš„å‚æ•°</li></ul><h3 id="ä½¿ç”¨ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ä½¿ç”¨ç¤ºä¾‹"></a> ä½¿ç”¨ç¤ºä¾‹</h3><ol><li><strong>execlï¼šç”¨ç»å¯¹è·¯å¾„è°ƒç”¨ç¨‹åº</strong></li></ol><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span> </span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Before exec\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">execl</span><span class="token punctuation">(</span><span class="token string">"/bin/ls"</span><span class="token punctuation">,</span> <span class="token string">"ls"</span><span class="token punctuation">,</span> <span class="token string">"-l"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// åªæœ‰ exec è°ƒç”¨å¤±è´¥æ—¶æ‰ä¼šç»§ç»­æ‰§è¡Œ    </span><span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"execl failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><strong>execvpï¼šåœ¨ PATH ä¸­æœç´¢å‘½ä»¤</strong></li></ol><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"ls"</span><span class="token punctuation">,</span> <span class="token string">"-a"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">execvp</span><span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"execvp failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><strong>execleï¼šä¼ å…¥è‡ªå®šä¹‰ç¯å¢ƒå˜é‡</strong></li></ol><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>envp<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"MYVAR=HelloExec"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">execl</span><span class="token punctuation">(</span><span class="token string">"/usr/bin/env"</span><span class="token punctuation">,</span> <span class="token string">"env"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> envp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"execle failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ³¨æ„äº‹é¡¹"><a class="markdownIt-Anchor" href="#æ³¨æ„äº‹é¡¹"></a> æ³¨æ„äº‹é¡¹</h3><ul><li><p><code>exec</code> ç³»åˆ— <strong>ä¸ä¼šè¿”å›</strong>ï¼Œé™¤éè°ƒç”¨å¤±è´¥ã€‚</p></li><li><p>è‹¥è°ƒç”¨æˆåŠŸï¼ŒåŸè¿›ç¨‹çš„ä»£ç å’Œæ•°æ®æ®µä¼šè¢«æ–°ç¨‹åºæ›¿æ¢ã€‚</p></li><li><p><strong>æ–‡ä»¶æè¿°ç¬¦é»˜è®¤ç»§æ‰¿</strong>ï¼Œå¯ä»¥ç”¨äºåœ¨çˆ¶è¿›ç¨‹ä¸­è®¾ç½®å¥½ç®¡é“/é‡å®šå‘ï¼Œè®©å­è¿›ç¨‹åœ¨ exec åç»§ç»­ä½¿ç”¨ã€‚</p></li><li><p>éœ€è¦ä¿è¯å‚æ•°åˆ—è¡¨æœ€åæœ‰ <code>NULL</code>ï¼Œå¦åˆ™ä¼šå¼•å‘ä¸å¯é¢„æœŸé”™è¯¯ã€‚</p></li></ul><h2 id="4-ç­‰å¾…å­è¿›ç¨‹-wait-waitpid"><a class="markdownIt-Anchor" href="#4-ç­‰å¾…å­è¿›ç¨‹-wait-waitpid"></a> 4. ç­‰å¾…å­è¿›ç¨‹ â€” <code>wait()</code> / <code>waitpid()</code></h2><p><strong>çˆ¶è¿›ç¨‹éœ€è¦å›æ”¶å­è¿›ç¨‹é€€å‡ºæ—¶çš„èµ„æºï¼Œå¦åˆ™å­è¿›ç¨‹ä¼šæˆä¸º åƒµå°¸è¿›ç¨‹ï¼ˆZombieï¼‰ã€‚</strong></p><p>è¿™ä¸¤ä¸ªå‡½æ•°ç”¨äº <strong>çˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹ç»“æŸ</strong> å¹¶<strong>å›æ”¶èµ„æº</strong>ï¼Œé¿å…åƒµå°¸è¿›ç¨‹ã€‚</p><h3 id="1-wait"><a class="markdownIt-Anchor" href="#1-wait"></a> 1. wait()</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token class-name">pid_t</span> <span class="token function">wait</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p><strong>å‚æ•°</strong></p><ul><li><code>status</code>ï¼šæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨å­è¿›ç¨‹é€€å‡ºçŠ¶æ€ã€‚å¦‚æœä¸å…³å¿ƒçŠ¶æ€ï¼Œå¯ä»¥ä¼  <code>NULL</code>ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li><p>æˆåŠŸï¼šè¿”å›ç»“æŸçš„å­è¿›ç¨‹ PID</p></li><li><p>å¤±è´¥ï¼šè¿”å› -1ï¼ˆä¾‹å¦‚æ²¡æœ‰å­è¿›ç¨‹å­˜åœ¨æ—¶ï¼‰</p></li></ul></li><li><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong></p></li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">pid_t</span> pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å­è¿›ç¨‹</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Child running...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">42</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// çˆ¶è¿›ç¨‹</span>        <span class="token keyword">int</span> status<span class="token punctuation">;</span>        <span class="token class-name">pid_t</span> cpid <span class="token operator">=</span> <span class="token function">wait</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç­‰å¾…å­è¿›ç¨‹</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">WIFEXITED</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token comment">// åˆ¤æ–­æ˜¯å¦æ­£å¸¸é€€å‡º</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Child %d exited with code %d\n"</span><span class="token punctuation">,</span> cpid<span class="token punctuation">,</span> <span class="token function">WEXITSTATUS</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="admonition caution"><p class="admonition-title">caution</p><ul><li><p><code>wait()</code> ä¼šé˜»å¡çˆ¶è¿›ç¨‹ï¼Œç›´åˆ°ä»»æ„ä¸€ä¸ªå­è¿›ç¨‹é€€å‡ºã€‚</p></li><li><p>å¦‚æœçˆ¶è¿›ç¨‹æ²¡æœ‰å­è¿›ç¨‹ï¼Œè¿”å› -1 å¹¶è®¾ç½® <code>errno = ECHILD</code>ã€‚</p></li></ul></div><h3 id="2-waitpid"><a class="markdownIt-Anchor" href="#2-waitpid"></a> 2. waitpid()</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token class-name">pid_t</span> <span class="token function">waitpid</span><span class="token punctuation">(</span><span class="token class-name">pid_t</span> pid<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>status<span class="token punctuation">,</span> <span class="token keyword">int</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p><strong>å‚æ•°</strong></p><ul><li><p><code>pid</code>ï¼š</p><ul><li><p><code>&gt;0</code> ï¼šç­‰å¾…æŒ‡å®š PID çš„å­è¿›ç¨‹</p></li><li><p>-1 ï¼šç­‰å¾…ä»»æ„å­è¿›ç¨‹ï¼ˆåŠŸèƒ½ç±»ä¼¼ <code>wait()</code>ï¼‰</p></li><li><p>0 ï¼šç­‰å¾…ä¸è°ƒç”¨è¿›ç¨‹åŒç»„çš„ä»»æ„å­è¿›ç¨‹</p></li><li><p>&lt;-1ï¼šç­‰å¾…è¿›ç¨‹ç»„ ID = |pid| çš„ä»»æ„å­è¿›ç¨‹</p></li></ul></li><li><p><code>status</code>ï¼šæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆï¼Œç”¨äºä¿å­˜é€€å‡ºçŠ¶æ€</p></li><li><p><code>options</code>ï¼šæ§åˆ¶å‡½æ•°è¡Œä¸ºï¼Œå¸¸ç”¨å€¼ï¼š</p><ul><li><p><code>0</code>ï¼šé˜»å¡ç­‰å¾…ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰</p></li><li><p><code>WNOHANG</code>ï¼šéé˜»å¡ï¼Œå¦‚æœæ²¡æœ‰å­è¿›ç¨‹é€€å‡ºç«‹å³è¿”å› 0</p></li><li><p><code>WUNTRACED</code>ï¼šè¿”å›è¢«æš‚åœçš„å­è¿›ç¨‹ï¼ˆæ”¶åˆ° SIGSTOPï¼‰</p></li><li><p><code>WCONTINUED</code>ï¼šè¿”å›ç»§ç»­è¿è¡Œçš„å­è¿›ç¨‹ï¼ˆæ”¶åˆ° SIGCONTï¼‰</p></li></ul></li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li><p>æˆåŠŸï¼šè¿”å›å­è¿›ç¨‹ PID</p></li><li><p>éé˜»å¡ä¸”æ²¡æœ‰å­è¿›ç¨‹é€€å‡ºï¼šè¿”å› 0</p></li><li><p>å¤±è´¥ï¼šè¿”å› -1ï¼Œå¹¶è®¾ç½® <code>errno</code></p></li></ul></li><li><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong></p></li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">pid_t</span> pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å­è¿›ç¨‹</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// çˆ¶è¿›ç¨‹</span>        <span class="token keyword">int</span> status<span class="token punctuation">;</span>        <span class="token class-name">pid_t</span> cpid<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cpid <span class="token operator">=</span> <span class="token function">waitpid</span><span class="token punctuation">(</span>pid<span class="token punctuation">,</span> <span class="token operator">&amp;</span>status<span class="token punctuation">,</span> WNOHANG<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Child still running...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">WIFEXITED</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Child %d exited with code %d\n"</span><span class="token punctuation">,</span> cpid<span class="token punctuation">,</span> <span class="token function">WEXITSTATUS</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="admonition caution"><p class="admonition-title">caution</p><ul><li><p><code>waitpid()</code> å¯ä»¥å®ç° <strong>éé˜»å¡ç­‰å¾…</strong>ï¼Œé€‚åˆçˆ¶è¿›ç¨‹åŒæ—¶ç®¡ç†å¤šä¸ªå­è¿›ç¨‹ã€‚</p></li><li><p><code>WIFEXITED(status)</code> åˆ¤æ–­å­è¿›ç¨‹æ˜¯å¦æ­£å¸¸é€€å‡ºã€‚</p></li><li><p><code>WIFSIGNALED(status)</code> åˆ¤æ–­å­è¿›ç¨‹æ˜¯å¦è¢«ä¿¡å·ç»ˆæ­¢ã€‚</p></li><li><p>ä½¿ç”¨ <code>waitpid()</code> å¯ä»¥ç²¾å‡†å›æ”¶æŒ‡å®šå­è¿›ç¨‹ï¼Œé¿å…åƒµå°¸è¿›ç¨‹ç§¯ç´¯ã€‚</p></li></ul></div><div class="admonition note"><p class="admonition-title">tips</p><ul><li><p>çˆ¶è¿›ç¨‹åªéœ€è¦ç­‰å¾…ä»»æ„å­è¿›ç¨‹ â†’ ç”¨ <code>wait()</code> å³å¯ã€‚</p></li><li><p>çˆ¶è¿›ç¨‹éœ€è¦ç²¾ç¡®æ§åˆ¶æˆ–éé˜»å¡ â†’ ç”¨ <code>waitpid()</code>ã€‚</p></li><li><p>è°ƒç”¨å‰ä¸€å®šè¦ç†è§£ <strong>é˜»å¡ vs éé˜»å¡</strong>ï¼Œé¿å…çˆ¶è¿›ç¨‹è¢«å¡ä½ã€‚</p></li></ul></div><h2 id="5-è¿›ç¨‹é€€å‡º-exit-ä¸-_exit"><a class="markdownIt-Anchor" href="#5-è¿›ç¨‹é€€å‡º-exit-ä¸-_exit"></a> 5. è¿›ç¨‹é€€å‡º â€” <code>exit()</code> ä¸ <code>_exit()</code></h2><ul><li><p><code>exit()</code>ï¼šä¼šåˆ·æ–°ç¼“å†²åŒºï¼Œæ‰§è¡Œæ¸…ç†å‡½æ•°ã€‚</p></li><li><p><code>_exit()</code>ï¼šç«‹å³é€€å‡ºï¼Œä¸åšæ¸…ç†ï¼Œé€šå¸¸åœ¨å­è¿›ç¨‹ <code>fork()</code> åçš„é”™è¯¯å¤„ç†ä¸­ä½¿ç”¨ã€‚</p></li></ul><p>âš ï¸ åŒºåˆ«ï¼š<code>exit()</code> é€‚åˆæ™®é€šé€€å‡ºï¼Œ<code>_exit()</code> é€‚åˆåœ¨ <code>fork()</code> åä¸å¸Œæœ›å½±å“çˆ¶è¿›ç¨‹çš„ç¯å¢ƒæ—¶ä½¿ç”¨ã€‚</p><div class="admonition caution"><p class="admonition-title">caution</p><ul><li>å­è¿›ç¨‹æ‰§è¡Œé€€å‡ºå‡½æ•°åï¼Œå­è¿›ç¨‹ç»“æŸå¹¶å˜ä¸ºåƒµå°¸ğŸ§Ÿï¼Œå†…æ ¸ä¿ç•™å­è¿›ç¨‹åœ¨è¿›ç¨‹è¡¨ä¸­çš„éƒ¨åˆ†ä¿¡æ¯ï¼ˆPIDã€é€€å‡ºç ç­‰ï¼‰å ç”¨å°‘é‡ç³»ç»Ÿèµ„æºï¼Œä½†ä¸ä¼šå†è¿è¡Œã€‚éœ€è¦çˆ¶è¿›ç¨‹è°ƒç”¨waité‡Šæ”¾å­è¿›ç¨‹èµ„æºï¼Œå‡€åŒ–åƒµå°¸ï¼Œé‡Šæ”¾çµé­‚ğŸ‘»</li></ul></div><h2 id="6-ps-å‘½ä»¤ç®€è¿°"><a class="markdownIt-Anchor" href="#6-ps-å‘½ä»¤ç®€è¿°"></a> 6. ps å‘½ä»¤ç®€è¿°</h2><h3 id="ps-å‘½ä»¤çš„å¸¸è§ç”¨æ³•"><a class="markdownIt-Anchor" href="#ps-å‘½ä»¤çš„å¸¸è§ç”¨æ³•"></a> <code>ps</code> å‘½ä»¤çš„å¸¸è§ç”¨æ³•</h3><h4 id="1-æŸ¥çœ‹å½“å‰ç»ˆç«¯ä¸­çš„è¿›ç¨‹"><a class="markdownIt-Anchor" href="#1-æŸ¥çœ‹å½“å‰ç»ˆç«¯ä¸­çš„è¿›ç¨‹"></a> 1. æŸ¥çœ‹å½“å‰ç»ˆç«¯ä¸­çš„è¿›ç¨‹</h4><p>è¿™æ˜¯æœ€ç®€å•çš„ç”¨æ³•ï¼Œä¸åŠ ä»»ä½•é€‰é¡¹ï¼Œ<code>ps</code> å‘½ä»¤åªä¼šæ˜¾ç¤ºå½“å‰ç»ˆç«¯ä¼šè¯ä¸­è¿è¡Œçš„è¿›ç¨‹ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿è¡Œåä½ å¯èƒ½ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">PID TTY          TIME CMD<span class="token number">1234</span> pts/0    00:00:00 <span class="token function">bash</span><span class="token number">5678</span> pts/0    00:00:00 <span class="token function">ps</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li><p><strong>PID</strong>ï¼šè¿›ç¨‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆProcess IDï¼‰ã€‚</p></li><li><p><strong>TTY</strong>ï¼šè¿›ç¨‹è¿è¡Œæ‰€åœ¨çš„ç»ˆç«¯ã€‚</p></li><li><p><strong>TIME</strong>ï¼šè¿›ç¨‹ä½¿ç”¨çš„ CPU æ—¶é—´ã€‚</p></li><li><p><strong>CMD</strong>ï¼šå¯åŠ¨è¿›ç¨‹çš„å‘½ä»¤ã€‚</p></li></ul><h4 id="2-æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹"><a class="markdownIt-Anchor" href="#2-æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹"></a> 2. æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹</h4><p>å¦‚æœä½ æƒ³æŸ¥çœ‹ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>-e</code> é€‰é¡¹ï¼ˆä»£è¡¨æ‰€æœ‰è¿›ç¨‹ï¼‰æˆ– <code>-a</code> é€‰é¡¹ï¼ˆä»£è¡¨æ‰€æœ‰è¿›ç¨‹ï¼Œé™¤äº†ä¼šè¯å¼•å¯¼è¿›ç¨‹ï¼‰ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> <span class="token parameter variable">-e</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…ä½¿ç”¨ <code>-ef</code> ç»„åˆï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„ç»„åˆä¹‹ä¸€ï¼Œå®ƒæä¾›äº†æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> <span class="token parameter variable">-ef</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p><strong>UID</strong>ï¼šå¯åŠ¨è¿›ç¨‹çš„ç”¨æˆ· IDã€‚</p></li><li><p><strong>PID</strong>ï¼šè¿›ç¨‹ IDã€‚</p></li><li><p><strong>PPID</strong>ï¼šçˆ¶è¿›ç¨‹ IDã€‚</p></li><li><p><strong>C</strong>ï¼šCPU åˆ©ç”¨ç‡ã€‚</p></li><li><p><strong>STIME</strong>ï¼šè¿›ç¨‹å¯åŠ¨æ—¶é—´ã€‚</p></li><li><p><strong>TTY</strong>ï¼šè¿›ç¨‹æ‰€åœ¨çš„ç»ˆç«¯ã€‚</p></li><li><p><strong>TIME</strong>ï¼šè¿›ç¨‹ä½¿ç”¨çš„ CPU æ—¶é—´ã€‚</p></li><li><p><strong>CMD</strong>ï¼šå¯åŠ¨è¿›ç¨‹çš„å‘½ä»¤ã€‚</p></li></ul><h4 id="3-æŸ¥çœ‹ç”¨æˆ·è¿›ç¨‹"><a class="markdownIt-Anchor" href="#3-æŸ¥çœ‹ç”¨æˆ·è¿›ç¨‹"></a> 3. æŸ¥çœ‹ç”¨æˆ·è¿›ç¨‹</h4><p>å¦‚æœä½ åªæƒ³æŸ¥çœ‹æŸä¸ªç‰¹å®šç”¨æˆ·ï¼ˆä¾‹å¦‚ <code>root</code>ï¼‰çš„è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>-u</code> é€‰é¡¹ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> <span class="token parameter variable">-u</span> root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4-é€šè¿‡ç®¡é“å’Œ-grep-æŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹"><a class="markdownIt-Anchor" href="#4-é€šè¿‡ç®¡é“å’Œ-grep-æŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹"></a> 4. é€šè¿‡ç®¡é“å’Œ <code>grep</code> æŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹</h4><p>åœ¨å®é™…å·¥ä½œä¸­ï¼Œä½ é€šå¸¸ä¼šéœ€è¦æŸ¥æ‰¾æŸä¸ªç‰¹å®šçš„è¿›ç¨‹ï¼Œæ¯”å¦‚ Nginx æˆ– MySQLã€‚è¿™æ—¶ï¼Œ<code>ps</code> å‘½ä»¤é€šå¸¸ä¼šé…åˆ <code>grep</code> å‘½ä»¤ä¸€èµ·ä½¿ç”¨ã€‚<code>grep</code> å¯ä»¥ä» <code>ps</code> çš„è¾“å‡ºä¸­è¿‡æ»¤å‡ºä½ æƒ³è¦çš„ä¿¡æ¯ã€‚</p><p>ä¾‹å¦‚ï¼ŒæŸ¥æ‰¾æ‰€æœ‰ä¸ Nginx ç›¸å…³çš„è¿›ç¨‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œçš„ <code>|</code> æ˜¯ç®¡é“ç¬¦ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°† <code>ps -ef</code> å‘½ä»¤çš„è¾“å‡ºä½œä¸º <code>grep</code> å‘½ä»¤çš„è¾“å…¥ã€‚</p><h3 id="ps-å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹æ€»ç»“"><a class="markdownIt-Anchor" href="#ps-å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹æ€»ç»“"></a> <code>ps</code> å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹æ€»ç»“</h3><table><thead><tr><th>é€‰é¡¹</th><th>æè¿°</th></tr></thead><tbody><tr><td>-e</td><td>æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</td></tr><tr><td>-f</td><td>æ˜¾ç¤ºå®Œæ•´æ ¼å¼çš„åˆ—è¡¨</td></tr><tr><td>-a</td><td>æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼ˆä¸åŒ…æ‹¬ä¼šè¯å¼•å¯¼è¿›ç¨‹ï¼‰</td></tr><tr><td>-u</td><td>æŒ‰ç”¨æˆ·è¿‡æ»¤è¿›ç¨‹</td></tr><tr><td>-aux</td><td>æœ€ç»å…¸çš„ç»„åˆï¼Œæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†è¿›ç¨‹ä¿¡æ¯</td></tr></tbody></table><h3 id="å®é™…åº”ç”¨ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#å®é™…åº”ç”¨ç¤ºä¾‹"></a> å®é™…åº”ç”¨ç¤ºä¾‹</h3><p>å‡è®¾ä½ æƒ³æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­ CPU æˆ–å†…å­˜å ç”¨æœ€é«˜çš„å‡ ä¸ªè¿›ç¨‹ï¼Œ<code>ps</code> å‘½ä»¤å¯ä»¥ä¸ <code>head</code>ã€<code>sort</code> ç­‰å‘½ä»¤ç»“åˆä½¿ç”¨ã€‚</p><p><strong>æŸ¥çœ‹ CPU å ç”¨æœ€é«˜çš„ 5 ä¸ªè¿›ç¨‹ï¼š</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token parameter variable">--sort</span><span class="token operator">=</span>-%cpu <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">6</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œçš„ <code>--sort=-%cpu</code> è¡¨ç¤ºæŒ‰ CPU å ç”¨ç‡é™åºæ’åˆ—ï¼Œ<code>head -n 6</code> åˆ™å–å‰ 6 è¡Œï¼ˆåŒ…æ‹¬æ ‡é¢˜è¡Œï¼‰ã€‚</p><h3 id="è§£æ-ps-aux-å‘½ä»¤çš„è¾“å‡º"><a class="markdownIt-Anchor" href="#è§£æ-ps-aux-å‘½ä»¤çš„è¾“å‡º"></a> è§£æ <code>ps -aux</code> å‘½ä»¤çš„è¾“å‡º</h3><p>å½“ä½ è¿è¡Œ <code>ps -aux</code> å‘½ä»¤æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªåŒ…å«å¤šä¸ªåˆ—çš„è¡¨æ ¼ã€‚æ¯ä¸€åˆ—éƒ½æä¾›äº†å…³äºè¿›ç¨‹çš„é‡è¦ä¿¡æ¯ã€‚ä¸‹é¢æ˜¯å¯¹è¿™äº›åˆ—çš„è¯¦ç»†è§£é‡Šï¼š</p><ul><li><p><strong>USER</strong>ï¼šå¯åŠ¨è¯¥è¿›ç¨‹çš„ç”¨æˆ·ã€‚</p></li><li><p><strong>PID</strong>ï¼šè¿›ç¨‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆ<strong>P</strong>rocess <strong>ID</strong>ï¼‰ã€‚å½“ä½ éœ€è¦æ€æ­»ä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œé€šå¸¸ä¼šç”¨åˆ°è¿™ä¸ª IDã€‚</p></li><li><p><strong>%CPU</strong>ï¼šè¿›ç¨‹åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…ä½¿ç”¨çš„ <strong>CPU</strong> å ç”¨ç‡ã€‚</p></li><li><p><strong>%MEM</strong>ï¼šè¿›ç¨‹ä½¿ç”¨çš„ <strong>ç‰©ç†å†…å­˜</strong> å ç”¨ç‡ã€‚</p></li><li><p><strong>VSZ</strong>ï¼šè¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜å¤§å°ï¼ˆ<strong>V</strong>irtual <strong>S</strong>izeï¼‰ï¼Œå•ä½ä¸ºåƒå­—èŠ‚ï¼ˆKBï¼‰ã€‚</p></li><li><p><strong>RSS</strong>ï¼šè¿›ç¨‹ä½¿ç”¨çš„ <strong>ç‰©ç†å†…å­˜</strong> å¤§å°ï¼ˆ<strong>R</strong>esident <strong>S</strong>et <strong>S</strong>izeï¼‰ï¼Œå•ä½ä¸ºåƒå­—èŠ‚ï¼ˆKBï¼‰ã€‚</p></li><li><p><strong>TTY</strong>ï¼šè¿›ç¨‹è¿è¡Œæ‰€åœ¨çš„ç»ˆç«¯ã€‚å¦‚æœæ˜¾ç¤º <code>?</code>ï¼Œè¡¨ç¤ºè¯¥è¿›ç¨‹æ²¡æœ‰å…³è”çš„ç»ˆç«¯ï¼Œé€šå¸¸æ˜¯ç³»ç»Ÿè¿›ç¨‹ã€‚</p></li><li><p><strong>STAT</strong>ï¼šè¿›ç¨‹çš„å½“å‰çŠ¶æ€ï¼ˆ<strong>STAT</strong>usï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„åˆ—ï¼Œå¸¸ç”¨çš„çŠ¶æ€ç æœ‰ï¼š</p><ul><li><p><strong>R</strong>ï¼šæ­£åœ¨è¿è¡Œï¼ˆ<strong>R</strong>unningï¼‰æˆ–å¯è¿è¡Œï¼ˆ<strong>R</strong>unnableï¼‰ã€‚</p></li><li><p><strong>S</strong>ï¼šå¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ï¼ˆ<strong>S</strong>leepingï¼‰ã€‚</p></li><li><p><strong>D</strong>ï¼šä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ï¼ˆ<strong>D</strong>isk sleepï¼‰ï¼Œé€šå¸¸è¡¨ç¤ºè¿›ç¨‹æ­£åœ¨ç­‰å¾… I/O æ“ä½œã€‚</p></li><li><p><strong>Z</strong>ï¼šåƒµå°¸è¿›ç¨‹ï¼ˆ<strong>Z</strong>ombieï¼‰ï¼Œè¿›ç¨‹å·²ç»ˆæ­¢ï¼Œä½†å…¶çˆ¶è¿›ç¨‹è¿˜æœªå¯¹å…¶è¿›è¡Œå–„åå¤„ç†ã€‚</p></li><li><p><strong>T</strong>ï¼šåœæ­¢ï¼ˆ<strong>S</strong>toppedï¼‰ï¼Œè¿›ç¨‹è¢«ä¿¡å·åœæ­¢ã€‚</p></li><li><p><strong>&lt;</strong>ï¼šé«˜ä¼˜å…ˆçº§è¿›ç¨‹ã€‚</p></li><li><p><strong>N</strong>ï¼šä½ä¼˜å…ˆçº§è¿›ç¨‹ã€‚</p></li></ul></li><li><p><strong>START</strong>ï¼šè¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ã€‚</p></li><li><p><strong>TIME</strong>ï¼šè¿›ç¨‹å·²ç»æ¶ˆè€—çš„ <strong>CPU æ—¶é—´</strong> æ€»é‡ã€‚è¿™ä¸ %CPU ä¸åŒï¼Œ%CPU æ˜¯ç¬æ—¶å€¼ï¼Œè€Œ TIME æ˜¯ç´¯ç§¯å€¼ã€‚</p></li><li><p><strong>COMMAND</strong>ï¼šå¯åŠ¨è¯¥è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ï¼ŒåŒ…æ‹¬æ‰€æœ‰å‚æ•°ã€‚</p></li></ul><h3 id="ç¤ºä¾‹è§£æ"><a class="markdownIt-Anchor" href="#ç¤ºä¾‹è§£æ"></a> ç¤ºä¾‹è§£æ</h3><p>å‡è®¾ä½ è¿è¡Œ <code>ps -aux</code> çœ‹åˆ°ä»¥ä¸‹ä¸€è¡Œè¾“å‡ºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root      <span class="token number">1234</span>  <span class="token number">0.0</span>  <span class="token number">0.1</span> <span class="token number">23456</span> <span class="token number">1234</span> ?        S    Sep01  <span class="token number">0</span>:05 /usr/sbin/sshd <span class="token parameter variable">-D</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p><strong>USER</strong>ï¼š<code>root</code> ç”¨æˆ·ã€‚</p></li><li><p><strong>PID</strong>ï¼šè¿›ç¨‹ ID æ˜¯ <code>1234</code>ã€‚</p></li><li><p><strong>%CPU</strong>ï¼šCPU å ç”¨ç‡æ˜¯ <code>0.0%</code>ã€‚</p></li><li><p><strong>%MEM</strong>ï¼šå†…å­˜å ç”¨ç‡æ˜¯ <code>0.1%</code>ã€‚</p></li><li><p><strong>VSZ</strong>ï¼šè™šæ‹Ÿå†…å­˜å¤§å°æ˜¯ <code>23456 KB</code>ã€‚</p></li><li><p><strong>RSS</strong>ï¼šç‰©ç†å†…å­˜å¤§å°æ˜¯ <code>1234 KB</code>ã€‚</p></li><li><p><strong>TTY</strong>ï¼š<code>?</code>ï¼Œè¡¨ç¤ºæ²¡æœ‰å…³è”çš„ç»ˆç«¯ã€‚</p></li><li><p><strong>STAT</strong>ï¼š<code>S</code>ï¼Œè¡¨ç¤ºè¿›ç¨‹å¤„äºå¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ã€‚</p></li><li><p><strong>START</strong>ï¼šå¯åŠ¨æ—¶é—´æ˜¯ <code>Sep01</code>ã€‚</p></li><li><p><strong>TIME</strong>ï¼šæ€» CPU æ—¶é—´æ˜¯ <code>0:05</code>ï¼ˆ5ç§’ï¼‰ã€‚</p></li><li><p><strong>COMMAND</strong>ï¼šå®Œæ•´çš„å‘½ä»¤æ˜¯ <code>/usr/sbin/sshd -D</code>ï¼Œè¿™æ˜¯ä¸€ä¸ª SSH æœåŠ¡å®ˆæŠ¤è¿›ç¨‹ã€‚</p></li></ul><p>é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œä½ å¯ä»¥å¿«é€Ÿäº†è§£ä¸€ä¸ªè¿›ç¨‹æ˜¯ç”±è°è¿è¡Œçš„ã€å®ƒæ¶ˆè€—äº†å¤šå°‘èµ„æºã€å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Œä»¥åŠå®ƒæ˜¯ä»€ä¹ˆç¨‹åºã€‚è¿™å¯¹äºç³»ç»Ÿç›‘æ§å’Œæ•…éšœæ’é™¤éå¸¸æœ‰å¸®åŠ©ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/categories/Linux/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
    <category term="å†…æ ¸" scheme="https://blog.godmao.top/Tags/%E5%86%85%E6%A0%B8/"/>
    
    <category term="è¿›ç¨‹" scheme="https://blog.godmao.top/Tags/%E8%BF%9B%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Linux Cæ ‡å‡†IOæ“ä½œ</title>
    <link href="https://blog.godmao.top/posts/45385/"/>
    <id>https://blog.godmao.top/posts/45385/</id>
    <published>2025-09-09T12:54:03.000Z</published>
    <updated>2025-09-09T12:58:06.832Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><h1 id="c-æ ‡å‡†åº“-io-å‡½æ•°åŸºäº-stdioh"><a class="markdownIt-Anchor" href="#c-æ ‡å‡†åº“-io-å‡½æ•°åŸºäº-stdioh"></a> ğŸ“Œ C æ ‡å‡†åº“ I/O å‡½æ•°ï¼ˆåŸºäº <code>&lt;stdio.h&gt;</code>ï¼‰</h1><h2 id="1-æ‰“å¼€å’Œå…³é—­æ–‡ä»¶"><a class="markdownIt-Anchor" href="#1-æ‰“å¼€å’Œå…³é—­æ–‡ä»¶"></a> 1. æ‰“å¼€å’Œå…³é—­æ–‡ä»¶</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span>  </span>FILE <span class="token operator">*</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>filename<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>mode<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">int</span> <span class="token function">fclose</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li><p><strong>fopen å‚æ•° mode å¸¸ç”¨å€¼ï¼š</strong></p><ul><li><p><code>&quot;r&quot;</code>ï¼šåªè¯»ï¼ˆæ–‡ä»¶å¿…é¡»å­˜åœ¨ï¼‰</p></li><li><p><code>&quot;w&quot;</code>ï¼šåªå†™ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™æ¸…ç©ºï¼‰</p></li><li><p><code>&quot;a&quot;</code>ï¼šè¿½åŠ å†™ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰</p></li><li><p><code>&quot;r+&quot;</code>ï¼šè¯»å†™ï¼ˆå¿…é¡»å­˜åœ¨ï¼‰</p></li><li><p><code>&quot;w+&quot;</code>ï¼šè¯»å†™ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™æ¸…ç©ºï¼‰</p></li><li><p><code>&quot;a+&quot;</code>ï¼šè¯»å†™ï¼ˆè¿½åŠ æ¨¡å¼ï¼‰</p></li></ul></li></ul><hr /><h2 id="2-è¯»å†™å­—ç¬¦"><a class="markdownIt-Anchor" href="#2-è¯»å†™å­—ç¬¦"></a> 2. è¯»å†™å­—ç¬¦</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fgetc</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// è¯»å–ä¸€ä¸ªå­—ç¬¦</span><span class="token keyword">int</span> <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// å†™å…¥ä¸€ä¸ªå­—ç¬¦</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> c <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fputc</span><span class="token punctuation">(</span><span class="token char">'A'</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr /><h2 id="3-è¯»å†™å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#3-è¯»å†™å­—ç¬¦ä¸²"></a> 3. è¯»å†™å­—ç¬¦ä¸²</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">fgets</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¯»å–ä¸€è¡Œï¼ˆæœ€å¤š size-1 ä¸ªå­—ç¬¦ï¼‰ </span><span class="token keyword">int</span> <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// å†™å…¥å­—ç¬¦ä¸²</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">"Hello\n"</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr /><h2 id="4-æ ¼å¼åŒ–-io"><a class="markdownIt-Anchor" href="#4-æ ¼å¼åŒ–-io"></a> 4. æ ¼å¼åŒ– I/O</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ ¼å¼åŒ–è¾“å‡ºåˆ°æ–‡ä»¶ </span><span class="token keyword">int</span> <span class="token function">fscanf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// æ ¼å¼åŒ–è¯»å–</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">fprintf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">"name=%s age=%d\n"</span><span class="token punctuation">,</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">fscanf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">"%s %d"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token operator">&amp;</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr /><h2 id="5-å—è¯»å†™é€‚åˆäºŒè¿›åˆ¶æ–‡ä»¶"><a class="markdownIt-Anchor" href="#5-å—è¯»å†™é€‚åˆäºŒè¿›åˆ¶æ–‡ä»¶"></a> 5. å—è¯»å†™ï¼ˆé€‚åˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">size_t</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> <span class="token class-name">size_t</span> size<span class="token punctuation">,</span> <span class="token class-name">size_t</span> nmemb<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">size_t</span> <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> <span class="token class-name">size_t</span> size<span class="token punctuation">,</span> <span class="token class-name">size_t</span> nmemb<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> data<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token function">fwrite</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å†™10ä¸ªæ•´æ•° </span><span class="token function">fread</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è¯»10ä¸ªæ•´æ•°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr /><h2 id="6-æ–‡ä»¶å®šä½"><a class="markdownIt-Anchor" href="#6-æ–‡ä»¶å®šä½"></a> 6. æ–‡ä»¶å®šä½</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fseek</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token keyword">long</span> offset<span class="token punctuation">,</span> <span class="token keyword">int</span> whence<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆ</span><span class="token keyword">long</span> <span class="token function">ftell</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token comment">// è·å–å½“å‰ä½ç½® </span><span class="token keyword">void</span> <span class="token function">rewind</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// å›åˆ°å¼€å¤´`</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>whence</code> å¯å–ï¼š</p><ul><li><p><code>SEEK_SET</code>ï¼šæ–‡ä»¶å¼€å¤´</p></li><li><p><code>SEEK_CUR</code>ï¼šå½“å‰ä½ç½®</p></li><li><p><code>SEEK_END</code>ï¼šæ–‡ä»¶æœ«å°¾</p></li></ul><hr /><h2 id="7-ç¼“å†²åˆ·æ–°"><a class="markdownIt-Anchor" href="#7-ç¼“å†²åˆ·æ–°"></a> 7. ç¼“å†²åˆ·æ–°</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fflush</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// å¼ºåˆ¶æŠŠç¼“å†²åŒºå†™å…¥æ–‡ä»¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¸¸ç”¨äºå†™æ—¥å¿—ï¼Œé¿å…å¼‚å¸¸é€€å‡ºæ—¶ä¸¢æ•°æ®ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/categories/Linux/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
    <category term="IO" scheme="https://blog.godmao.top/Tags/IO/"/>
    
    <category term="å†…æ ¸" scheme="https://blog.godmao.top/Tags/%E5%86%85%E6%A0%B8/"/>
    
  </entry>
  
  <entry>
    <title>Linux ç³»ç»ŸIOç¼–ç¨‹</title>
    <link href="https://blog.godmao.top/posts/7076/"/>
    <id>https://blog.godmao.top/posts/7076/</id>
    <published>2025-09-09T05:15:16.000Z</published>
    <updated>2025-09-09T13:04:05.999Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><h2 id="æ–‡ä»¶æè¿°ç¬¦å†…æ ¸åˆ†å‘çš„èº«ä»½è¯"><a class="markdownIt-Anchor" href="#æ–‡ä»¶æè¿°ç¬¦å†…æ ¸åˆ†å‘çš„èº«ä»½è¯"></a> æ–‡ä»¶æè¿°ç¬¦ï¼šå†…æ ¸åˆ†å‘çš„èº«ä»½è¯</h2><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼Œç®€ç§° FDï¼‰æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°</strong>ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯æ™®é€šæ–‡ä»¶ã€ç›®å½•ã€ç½‘ç»œå¥—æ¥å­—ï¼ˆsocketï¼‰ï¼Œç”šè‡³æ˜¯è®¾å¤‡ï¼ˆå¦‚é”®ç›˜ã€æ˜¾ç¤ºå™¨ï¼‰ã€‚</p><p>æ–‡ä»¶æè¿°ç¬¦çš„è®¾è®¡ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š</p><ol><li><p><strong>ç®€åŒ–äº† I/O æ¥å£</strong>ï¼šæ— è®ºæ˜¯è¯»å†™æœ¬åœ°æ–‡ä»¶ï¼Œè¿˜æ˜¯è¿›è¡Œç½‘ç»œé€šä¿¡ï¼Œå¼€å‘è€…éƒ½å¯ä»¥ä½¿ç”¨ä¸€å¥—ç»Ÿä¸€çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆ<code>read</code>, <code>write</code>, <code>close</code> ç­‰ï¼‰ï¼Œè€Œæ— éœ€å…³å¿ƒåº•å±‚çš„å…·ä½“ç±»å‹ã€‚è¿™ç§â€œä¸€åˆ‡çš†æ–‡ä»¶â€çš„è®¾è®¡å“²å­¦æ˜¯ Linux ç®€æ´å’Œå¼ºå¤§çš„ä½“ç°ã€‚</p></li><li><p><strong>éš”ç¦»äº†åº”ç”¨ç¨‹åºä¸å†…æ ¸</strong>ï¼šåº”ç”¨ç¨‹åºåªçŸ¥é“ä¸€ä¸ªç®€å•çš„æ•´æ•°ï¼Œè€Œä¸éœ€è¦çŸ¥é“æ–‡ä»¶åœ¨ç£ç›˜ä¸Šçš„ç‰©ç†ä½ç½®ï¼Œä¹Ÿä¸ç”¨å…³å¿ƒå†…æ ¸æ˜¯å¦‚ä½•ç®¡ç†æ–‡ä»¶çš„ã€‚æ‰€æœ‰å¤æ‚çš„æ“ä½œéƒ½ç”±å†…æ ¸åœ¨å¹•åå®Œæˆã€‚</p></li><li><p><strong>ç®¡ç†ç³»ç»Ÿèµ„æº</strong>ï¼šå†…æ ¸é€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¡¨æ¥ç®¡ç†æ¯ä¸ªè¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ã€‚å½“ä¸€ä¸ªè¿›ç¨‹ç»“æŸæ—¶ï¼Œå†…æ ¸å¯ä»¥æ ¹æ®è¿™ä¸ªè¡¨è‡ªåŠ¨å…³é—­æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶ï¼Œé¿å…èµ„æºæ³„éœ²ã€‚</p></li></ol><p>æ–‡ä»¶æè¿°ç¬¦çš„å‡ ä¸ªé‡è¦ç‰¹ç‚¹ï¼š</p><ul><li><p><strong>å”¯ä¸€æ€§</strong>ï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œæ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ–‡ä»¶æè¿°ç¬¦ã€‚</p></li><li><p><strong>éè´Ÿæ•´æ•°</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦çš„å€¼é€šå¸¸ä» 3 å¼€å§‹åˆ†é…ï¼Œå› ä¸º 0ã€1ã€2 è¿™ä¸‰ä¸ªæè¿°ç¬¦è¢«ç³»ç»Ÿé¢„ç•™ç»™æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ã€‚</p><ul><li><p><strong>0</strong>ï¼šæ ‡å‡†è¾“å…¥ï¼ˆ<code>stdin</code>ï¼‰ï¼Œé€šå¸¸æ˜¯é”®ç›˜ã€‚</p></li><li><p><strong>1</strong>ï¼šæ ‡å‡†è¾“å‡ºï¼ˆ<code>stdout</code>ï¼‰ï¼Œé€šå¸¸æ˜¯æ˜¾ç¤ºå™¨ã€‚</p></li><li><p><strong>2</strong>ï¼šæ ‡å‡†é”™è¯¯ï¼ˆ<code>stderr</code>ï¼‰ï¼Œä¹Ÿé€šå¸¸æ˜¯æ˜¾ç¤ºå™¨ã€‚</p></li></ul></li><li><p><strong>è¿›ç¨‹ç§æœ‰</strong>ï¼šæ–‡ä»¶æè¿°ç¬¦æ˜¯åœ¨è¿›ç¨‹å†…éƒ¨ä½¿ç”¨çš„ï¼Œä¸åŒè¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦äº’ä¸å½±å“ã€‚ä¾‹å¦‚ï¼Œè¿›ç¨‹ A çš„æ–‡ä»¶æè¿°ç¬¦ 3 å’Œè¿›ç¨‹ B çš„æ–‡ä»¶æè¿°ç¬¦ 3 å¯èƒ½æŒ‡å‘å®Œå…¨ä¸åŒçš„æ–‡ä»¶ã€‚</p></li></ul><h2 id="æœ€åŸºç¡€çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°"><a class="markdownIt-Anchor" href="#æœ€åŸºç¡€çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°"></a> æœ€åŸºç¡€çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°</h2><p><strong>Linux I/O ç¼–ç¨‹ä¸­å¸¸è§çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°</strong>ï¼Œè¿™äº›å‡½æ•°ä½äº <strong><code>unistd.h</code></strong>ï¼ˆä»¥åŠ <code>fcntl.h</code> ç­‰ï¼‰ä¸­ï¼Œæ˜¯ç”¨æˆ·æ€å’Œå†…æ ¸æ€äº¤äº’çš„åŸºç¡€æ¥å£ã€‚</p><h3 id="1-open"><a class="markdownIt-Anchor" href="#1-open"></a> 1. <code>open</code></h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span>    <span class="token comment">// open flags</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">int</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">,</span> <span class="token class-name">mode_t</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä½œç”¨"><a class="markdownIt-Anchor" href="#ä½œç”¨"></a> ä½œç”¨</h4><p>æ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè¿”å›ä¸€ä¸ª <strong>æ–‡ä»¶æè¿°ç¬¦</strong>ï¼ˆfdï¼Œæ•´æ•°ï¼‰ï¼Œåç»­ I/O éƒ½ä¾èµ–å®ƒã€‚</p><h4 id="å‚æ•°"><a class="markdownIt-Anchor" href="#å‚æ•°"></a> å‚æ•°</h4><ul><li><p><code>pathname</code>ï¼šæ–‡ä»¶è·¯å¾„ã€‚</p></li><li><p><code>flags</code>ï¼šæ‰“å¼€æ–¹å¼ï¼Œå¸¸ç”¨å€¼ï¼š</p><ul><li><p><code>O_RDONLY</code>ï¼šåªè¯»</p></li><li><p><code>O_WRONLY</code>ï¼šåªå†™</p></li><li><p><code>O_RDWR</code>ï¼šè¯»å†™</p></li><li><p><code>O_CREAT</code>ï¼šè‹¥æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œéœ€è¦é…åˆ <code>mode</code> å‚æ•°</p></li><li><p><code>O_TRUNC</code>ï¼šæ‰“å¼€æ—¶æ¸…ç©ºæ–‡ä»¶</p></li><li><p><code>O_APPEND</code>ï¼šå†™æ—¶è¿½åŠ åˆ°æ–‡ä»¶å°¾éƒ¨</p></li><li><p><code>O_NOBLOCK</code>ï¼šéé˜»å¡æ¨¡å¼</p></li></ul></li><li><p><code>mode</code>ï¼šåˆ›å»ºæ–‡ä»¶æ—¶çš„æƒé™ï¼ˆå¦‚ <code>0666</code>ï¼Œå— umask å½±å“ï¼‰ã€‚</p></li></ul><h4 id="è¿”å›å€¼"><a class="markdownIt-Anchor" href="#è¿”å›å€¼"></a> è¿”å›å€¼</h4><ul><li><p>æˆåŠŸï¼šæ–‡ä»¶æè¿°ç¬¦ï¼ˆéè´Ÿæ•´æ•°ï¼‰</p></li><li><p>å¤±è´¥ï¼š<code>-1</code>ï¼Œå¹¶è®¾ç½® <code>errno</code></p></li></ul><hr /><h3 id="2-write"><a class="markdownIt-Anchor" href="#2-write"></a> 2. <code>write</code></h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token class-name">ssize_t</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token class-name">size_t</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="ä½œç”¨-2"><a class="markdownIt-Anchor" href="#ä½œç”¨-2"></a> ä½œç”¨</h4><p>å‘æ–‡ä»¶ï¼ˆæˆ–è®¾å¤‡ï¼‰å†™å…¥æ•°æ®ã€‚</p><h4 id="å‚æ•°-2"><a class="markdownIt-Anchor" href="#å‚æ•°-2"></a> å‚æ•°</h4><ul><li><p><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦</p></li><li><p><code>buf</code>ï¼šè¦å†™å…¥çš„æ•°æ®ç¼“å†²åŒºæŒ‡é’ˆ</p></li><li><p><code>count</code>ï¼šè¦å†™å…¥çš„å­—èŠ‚æ•°</p></li></ul><h4 id="è¿”å›å€¼-2"><a class="markdownIt-Anchor" href="#è¿”å›å€¼-2"></a> è¿”å›å€¼</h4><ul><li><p>æˆåŠŸï¼šå®é™…å†™å…¥çš„å­—èŠ‚æ•°ï¼ˆå¯èƒ½å°äº <code>count</code>ï¼‰</p></li><li><p>å¤±è´¥ï¼š<code>-1</code></p></li></ul><h4 id="æ³¨æ„"><a class="markdownIt-Anchor" href="#æ³¨æ„"></a> æ³¨æ„</h4><ul><li><p>å¯¹äºæ™®é€šæ–‡ä»¶ï¼Œé€šå¸¸ä¼šå†™å…¥å…¨éƒ¨æ•°æ®ã€‚</p></li><li><p>å¯¹äºç®¡é“ã€socket ç­‰ï¼Œå¯èƒ½åˆ†å¤šæ¬¡å†™å…¥ï¼Œéœ€è¦å¾ªç¯å†™ã€‚</p></li></ul><hr /><h3 id="3-read"><a class="markdownIt-Anchor" href="#3-read"></a> 3. <code>read</code></h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>  <span class="token class-name">ssize_t</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token class-name">size_t</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="ä½œç”¨-3"><a class="markdownIt-Anchor" href="#ä½œç”¨-3"></a> ä½œç”¨</h4><p>ä»æ–‡ä»¶ï¼ˆæˆ–è®¾å¤‡ï¼‰è¯»å–æ•°æ®ã€‚</p><h4 id="å‚æ•°-3"><a class="markdownIt-Anchor" href="#å‚æ•°-3"></a> å‚æ•°</h4><ul><li><p><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦</p></li><li><p><code>buf</code>ï¼šå­˜æ”¾è¯»å‡ºæ•°æ®çš„ç¼“å†²åŒº</p></li><li><p><code>count</code>ï¼šæœ€å¤§è¯»å–å­—èŠ‚æ•°</p></li></ul><h4 id="è¿”å›å€¼-3"><a class="markdownIt-Anchor" href="#è¿”å›å€¼-3"></a> è¿”å›å€¼</h4><ul><li><p>æˆåŠŸï¼šå®é™…è¯»å–çš„å­—èŠ‚æ•°</p><ul><li><code>0</code> è¡¨ç¤ºåˆ°è¾¾æ–‡ä»¶ç»“å°¾ (EOF)</li></ul></li><li><p>å¤±è´¥ï¼š<code>-1</code></p></li></ul><h4 id="æ³¨æ„-2"><a class="markdownIt-Anchor" href="#æ³¨æ„-2"></a> æ³¨æ„</h4><ul><li><p>å®é™…è¯»å–å­—èŠ‚æ•°å¯èƒ½å°äº <code>count</code>ã€‚</p></li><li><p>å¯¹äºé˜»å¡ I/Oï¼Œå¦‚æœæ²¡æœ‰æ•°æ®ï¼Œå¯èƒ½ä¼šæŒ‚èµ·ç­‰å¾…ã€‚</p></li></ul><hr /><h3 id="4-lseek"><a class="markdownIt-Anchor" href="#4-lseek"></a> 4. <code>lseek</code></h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span>  </span><span class="token class-name">off_t</span> <span class="token function">lseek</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token class-name">off_t</span> offset<span class="token punctuation">,</span> <span class="token keyword">int</span> whence<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="ä½œç”¨-4"><a class="markdownIt-Anchor" href="#ä½œç”¨-4"></a> ä½œç”¨</h4><p>ç§»åŠ¨æ–‡ä»¶è¯»å†™ä½ç½®ï¼ˆæ–‡ä»¶æŒ‡é’ˆï¼‰ã€‚</p><h4 id="å‚æ•°-4"><a class="markdownIt-Anchor" href="#å‚æ•°-4"></a> å‚æ•°</h4><ul><li><p><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦</p></li><li><p><code>offset</code>ï¼šåç§»é‡ï¼ˆå¯æ­£å¯è´Ÿï¼‰</p></li><li><p><code>whence</code>ï¼šåç§»èµ·å§‹ç‚¹</p><ul><li><p><code>SEEK_SET</code>ï¼šä»æ–‡ä»¶å¼€å¤´</p></li><li><p><code>SEEK_CUR</code>ï¼šä»å½“å‰ä½ç½®</p></li><li><p><code>SEEK_END</code>ï¼šä»æ–‡ä»¶æœ«å°¾</p></li></ul></li></ul><h4 id="è¿”å›å€¼-4"><a class="markdownIt-Anchor" href="#è¿”å›å€¼-4"></a> è¿”å›å€¼</h4><ul><li><p>æˆåŠŸï¼šæ–°çš„æ–‡ä»¶åç§»ä½ç½®</p></li><li><p>å¤±è´¥ï¼š<code>-1</code></p></li></ul><h4 id="æ³¨æ„-3"><a class="markdownIt-Anchor" href="#æ³¨æ„-3"></a> æ³¨æ„</h4><ul><li><p>å¸¸ç”¨æ¥å®ç°éšæœºè¯»å†™ã€‚</p></li><li><p>å¯¹æŸäº›è®¾å¤‡æ–‡ä»¶å¯èƒ½ä¸æ”¯æŒï¼ˆå¦‚ç®¡é“ï¼‰ã€‚</p></li></ul><hr /><h3 id="5-close"><a class="markdownIt-Anchor" href="#5-close"></a> 5. <code>close</code></h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token keyword">int</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="ä½œç”¨-5"><a class="markdownIt-Anchor" href="#ä½œç”¨-5"></a> ä½œç”¨</h4><p>å…³é—­ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé‡Šæ”¾å†…æ ¸èµ„æºã€‚</p><h4 id="å‚æ•°-5"><a class="markdownIt-Anchor" href="#å‚æ•°-5"></a> å‚æ•°</h4><ul><li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦</li></ul><h4 id="è¿”å›å€¼-5"><a class="markdownIt-Anchor" href="#è¿”å›å€¼-5"></a> è¿”å›å€¼</h4><ul><li><p>æˆåŠŸï¼š<code>0</code></p></li><li><p>å¤±è´¥ï¼š<code>-1</code></p></li></ul><h2 id="å¸¸è§å‡½æ•°æŸ¥æ‰¾è¡¨"><a class="markdownIt-Anchor" href="#å¸¸è§å‡½æ•°æŸ¥æ‰¾è¡¨"></a> å¸¸è§å‡½æ•°æŸ¥æ‰¾è¡¨</h2><table><thead><tr><th>å‡½æ•°</th><th>å¤´æ–‡ä»¶</th><th>åŠŸèƒ½</th><th>ä¸»è¦å‚æ•°</th><th>è¿”å›å€¼</th><th>å¸¸è§ç”¨é€”</th></tr></thead><tbody><tr><td><code>open</code></td><td><code>&lt;fcntl.h&gt;</code>, <code>&lt;unistd.h&gt;</code></td><td>æ‰“å¼€æˆ–åˆ›å»ºæ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶æè¿°ç¬¦</td><td><code>pathname</code>ï¼šè·¯å¾„<code>flags</code>ï¼šæ‰“å¼€æ–¹å¼ï¼ˆå¦‚ <code>O_RDONLY</code>ï¼‰<code>mode</code>ï¼šæƒé™ï¼ˆå¦‚ <code>0644</code>ï¼Œä»…åœ¨ <code>O_CREAT</code> æ—¶æœ‰æ•ˆï¼‰</td><td>æˆåŠŸï¼šæ–‡ä»¶æè¿°ç¬¦ (â‰¥0)å¤±è´¥ï¼š<code>-1</code></td><td>æ‰“å¼€æ–‡ä»¶/è®¾å¤‡ï¼Œè·å¾— <code>fd</code></td></tr><tr><td><code>write</code></td><td><code>&lt;unistd.h&gt;</code></td><td>å‘æ–‡ä»¶å†™å…¥æ•°æ®</td><td><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦<code>buf</code>ï¼šæ•°æ®ç¼“å†²åŒº<code>count</code>ï¼šè¦å†™å…¥å­—èŠ‚æ•°</td><td>æˆåŠŸï¼šå®é™…å†™å…¥å­—èŠ‚æ•°å¤±è´¥ï¼š<code>-1</code></td><td>å‘æ–‡ä»¶ã€ç®¡é“ã€socket å†™æ•°æ®</td></tr><tr><td><code>read</code></td><td><code>&lt;unistd.h&gt;</code></td><td>ä»æ–‡ä»¶è¯»å–æ•°æ®</td><td><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦<code>buf</code>ï¼šå­˜æ”¾æ•°æ®çš„ç¼“å†²åŒº<code>count</code>ï¼šæœ€å¤§è¯»å–å­—èŠ‚æ•°</td><td>æˆåŠŸï¼šå®é™…è¯»å–å­—èŠ‚æ•°<code>0</code>ï¼šæ–‡ä»¶ç»“å°¾å¤±è´¥ï¼š<code>-1</code></td><td>è¯»å–æ–‡ä»¶ã€é”®ç›˜è¾“å…¥ã€ç½‘ç»œæ•°æ®</td></tr><tr><td><code>lseek</code></td><td><code>&lt;unistd.h&gt;</code></td><td>æ”¹å˜æ–‡ä»¶è¯»å†™ä½ç½®ï¼ˆæ–‡ä»¶æŒ‡é’ˆï¼‰</td><td><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦<code>offset</code>ï¼šåç§»é‡<code>whence</code>ï¼šå‚è€ƒä½ç½®ï¼ˆ<code>SEEK_SET</code>/<code>SEEK_CUR</code>/<code>SEEK_END</code>ï¼‰</td><td>æˆåŠŸï¼šæ–°çš„åç§»ä½ç½®å¤±è´¥ï¼š<code>-1</code></td><td>éšæœºè¯»å†™æ–‡ä»¶ã€è·å–æ–‡ä»¶å¤§å°</td></tr><tr><td><code>close</code></td><td><code>&lt;unistd.h&gt;</code></td><td>å…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼Œé‡Šæ”¾èµ„æº</td><td><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦</td><td>æˆåŠŸï¼š<code>0</code>å¤±è´¥ï¼š<code>-1</code></td><td>ç¨‹åºç»“æŸæˆ–æ–‡ä»¶ä¸å†ä½¿ç”¨æ—¶å…³é—­</td></tr><tr><td><code>sync</code></td><td><code>&lt;unistd.h&gt;</code></td><td>å°†å†…æ ¸ç¼“å†²åŒºä¸­æ‰€æœ‰ä¿®æ”¹è¿‡çš„æ•°æ®ï¼ˆè„é¡µï¼‰å†™å…¥ç£ç›˜</td><td>æ— </td><td>æ— è¿”å›å€¼</td><td>å…¨å±€åˆ·æ–°ï¼Œå½±å“æ‰€æœ‰æ–‡ä»¶ï¼Œæ•ˆç‡è¾ƒä½</td></tr><tr><td><code>fsync</code></td><td><code>&lt;unistd.h&gt;</code></td><td>å°†æŒ‡å®šæ–‡ä»¶çš„ç¼“å­˜æ•°æ®å¼ºåˆ¶å†™å…¥ç£ç›˜</td><td><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦</td><td>æˆåŠŸï¼š<code>0</code>ï¼Œå¤±è´¥ï¼š<code>-1</code></td><td>ç²¾ç¡®åˆ°å•ä¸ªæ–‡ä»¶ï¼Œå¸¸ç”¨äºæ•°æ®åº“ã€æ—¥å¿—å†™å…¥</td></tr><tr><td><code>pipe</code></td><td><code>&lt;unistd.h&gt;</code></td><td>åˆ›å»ºåŒ¿åç®¡é“ï¼Œç”¨äºè¿›ç¨‹é—´é€šä¿¡</td><td><code>int pipefd[2]</code></td><td>æˆåŠŸï¼š0ï¼Œå¤±è´¥ï¼š-1</td><td><code>pipefd[0]</code> è¯»ç«¯ï¼Œ<code>pipefd[1]</code> å†™ç«¯</td></tr><tr><td><code>unlink</code></td><td><code>&lt;unistd.h&gt;</code></td><td>åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ï¼ˆç›®å½•ç”¨ <code>rmdir</code>ï¼‰</td><td><code>pathname</code>ï¼šæ–‡ä»¶è·¯å¾„</td><td>æˆåŠŸï¼š0ï¼Œå¤±è´¥ï¼š-1</td><td>å®é™…åˆ é™¤åœ¨å¼•ç”¨è®¡æ•°å½’é›¶æ—¶å‘ç”Ÿ</td></tr><tr><td><code>access</code></td><td><code>&lt;unistd.h&gt;</code></td><td>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨åŠæƒé™</td><td><code>pathname, mode</code></td><td>æˆåŠŸï¼š0ï¼Œå¤±è´¥ï¼š-1</td><td><code>mode</code> å¯å– <code>R_OK, W_OK, X_OK, F_OK</code></td></tr></tbody></table><h2 id="å¯¹æ¯”c-æ ‡å‡†åº“ioæ“ä½œ"><a class="markdownIt-Anchor" href="#å¯¹æ¯”c-æ ‡å‡†åº“ioæ“ä½œ"></a> å¯¹æ¯”C æ ‡å‡†åº“IOæ“ä½œ</h2><p>ä½¿ç”¨cæ ‡å‡†åº“çš„IOæ“ä½œï¼Œå°é‡é¢‘ç¹è¯»å†™çš„æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå…¶å†…éƒ¨è‡ªå¸¦æœ‰ç¼“å†²åŒºã€‚<br />è¿™å¯ä»¥ç†è§£ä¸ºåœ¨ç³»ç»ŸIOä¸Šæœ‰å°è£…äº†ä¸€å±‚ï¼Œè¿›è¡Œæ–‡ä»¶æ“ä½œæ—¶å†™å…¥Cè‡ªå¸¦ç¼“å†²åŒºï¼Œæ»¡è¶³ä¸€å®šæ¡ä»¶å†è°ƒç”¨ç³»ç»ŸIOï¼Œå°†ç¼“å†²åŒºçš„å†…å®¹å†™å…¥IOç¼“å­˜åŒºï¼Œå†åˆ°å†…æ ¸çš„é¡µç¼“å­˜åŒºï¼Œæœ€ååˆ°ç‰©ç†çš„ç£ç›˜ã€‚</p><table><thead><tr><th>ç‰¹æ€§</th><th>Linux ç³»ç»Ÿè°ƒç”¨ I/O</th><th>C æ ‡å‡†åº“æ–‡ä»¶æ“ä½œ</th></tr></thead><tbody><tr><td><strong>å¤´æ–‡ä»¶</strong></td><td><code>&lt;unistd.h&gt;</code>, <code>&lt;fcntl.h&gt;</code></td><td><code>&lt;stdio.h&gt;</code></td></tr><tr><td><strong>å‡½æ•°ç¤ºä¾‹</strong></td><td><code>open</code>, <code>read</code>, <code>write</code>, <code>lseek</code>, <code>close</code></td><td><code>fopen</code>, <code>fread</code>, <code>fwrite</code>, <code>fseek</code>, <code>fclose</code>, <code>fprintf</code>, <code>fscanf</code></td></tr><tr><td><strong>è¿”å›å€¼</strong></td><td>ç›´æ¥è¿”å›å­—èŠ‚æ•°ã€æ–‡ä»¶æè¿°ç¬¦ç­‰ï¼Œæˆ– <code>-1</code></td><td>è¿”å› <code>FILE*</code> æŒ‡é’ˆï¼Œæˆ– <code>EOF</code> ç­‰é”™è¯¯ç </td></tr><tr><td><strong>æ•°æ®å•ä½</strong></td><td>ä»¥ <strong>å­—èŠ‚ï¼ˆbyteï¼‰</strong> ä¸ºå•ä½</td><td>ä»¥ <strong>ç¼“å†²åŒº / ç»“æ„åŒ–æ•°æ®</strong> ä¸ºå•ä½ï¼ˆæœ‰ç¼“å†²æœºåˆ¶ï¼‰</td></tr><tr><td><strong>ç¼“å†²</strong></td><td><strong>æ— ç”¨æˆ·æ€ç¼“å†²</strong>ï¼Œç›´æ¥åœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´é—´ä¼ é€’æ•°æ®</td><td><strong>å¸¦ç¼“å†²åŒº</strong>ï¼ˆstdio åº“å†…éƒ¨ç»´æŠ¤ç¼“å­˜ï¼ŒåŠ é€Ÿå°å—è¯»å†™ï¼‰</td></tr><tr><td><strong>å±‚æ¬¡</strong></td><td>æ“ä½œç³»ç»Ÿå†…æ ¸æä¾›çš„ <strong>åº•å±‚æ¥å£</strong></td><td>åŸºäºç³»ç»Ÿè°ƒç”¨çš„ <strong>å°è£…åº“å‡½æ•°</strong></td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>å¯æ“ä½œæ™®é€šæ–‡ä»¶ã€è®¾å¤‡æ–‡ä»¶ã€socketã€ç®¡é“</td><td>ä¸»è¦æ“ä½œæ™®é€šæ–‡ä»¶å’Œæ ‡å‡†è¾“å…¥è¾“å‡º</td></tr><tr><td><strong>å¯ç§»æ¤æ€§</strong></td><td>åå‘ Unix/Linux ç³»ç»Ÿ</td><td>è·¨å¹³å°ï¼ˆç¬¦åˆ ANSI C æ ‡å‡†ï¼ŒWindows/Linux é€šç”¨ï¼‰</td></tr><tr><td><strong>å…¸å‹ç”¨é€”</strong></td><td>é©±åŠ¨å¼€å‘ã€ç³»ç»Ÿç¼–ç¨‹ã€ç²¾ç¡®æ§åˆ¶ I/O</td><td>åº”ç”¨å±‚æ–‡ä»¶è¯»å†™ã€æ–‡æœ¬å¤„ç†ã€å¿«é€Ÿå¼€å‘</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="å†…æ ¸ç¼–ç¨‹" scheme="https://blog.godmao.top/categories/Linux/%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
    <category term="IO" scheme="https://blog.godmao.top/Tags/IO/"/>
    
    <category term="å†…æ ¸" scheme="https://blog.godmao.top/Tags/%E5%86%85%E6%A0%B8/"/>
    
  </entry>
  
  <entry>
    <title>MakeFileç®€æ˜æŒ‡å—</title>
    <link href="https://blog.godmao.top/posts/4341/"/>
    <id>https://blog.godmao.top/posts/4341/</id>
    <published>2025-09-07T13:48:09.000Z</published>
    <updated>2025-09-17T13:36:34.997Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œé¡¹ç›®é€šå¸¸åŒ…å«å¾ˆå¤šæºæ–‡ä»¶ï¼Œå¦‚æœæ¯æ¬¡ç¼–è¯‘éƒ½æ‰‹åŠ¨æ•²å‘½ä»¤ï¼Œä¸ä»…ç¹çï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚<br /><strong>Makefile</strong> å¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨åŒ–æ„å»ºæµç¨‹ï¼Œå¤§å¹…æå‡æ•ˆç‡ã€‚æœ¬æ–‡å°†ä»‹ç» Makefile çš„åŸºç¡€è¯­æ³•ä¸å¸¸ç”¨ç”¨æ³•ã€‚</p><hr /><ul><li><a href="#1-%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95">1. åŸºç¡€ç”¨æ³•</a></li><li><a href="#2-%E6%89%A7%E8%A1%8C%E9%80%BB%E8%BE%911">2. æ‰§è¡Œé€»è¾‘^1</a><ul><li><a href="#21--%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E7%A4%BA%E6%84%8F%E5%9B%BE">2.1. ğŸ”„ æ‰§è¡Œæµç¨‹ç¤ºæ„å›¾</a></li></ul></li><li><a href="#3-%E4%BC%AA%E7%9B%AE%E6%A0%87-phony">3. ä¼ªç›®æ ‡ .PHONY</a></li><li><a href="#4-%E5%8F%98%E9%87%8F">4. å˜é‡</a><ul><li><a href="#41-%E8%B5%8B%E5%80%BC%E7%AC%A6%E5%8F%B7">4.1. èµ‹å€¼ç¬¦å·</a></li></ul></li><li><a href="#5-%E9%9A%90%E5%90%AB%E8%A7%84%E5%88%99%E4%B8%8E%E9%80%9A%E9%85%8D%E7%AC%A6">5. éšå«è§„åˆ™ä¸é€šé…ç¬¦</a></li><li><a href="#6-%E6%9D%A1%E4%BB%B6%E5%88%86%E6%94%AF">6. æ¡ä»¶åˆ†æ”¯</a><ul><li><a href="#61-%E8%AF%AD%E6%B3%95">6.1. è¯­æ³•</a></li><li><a href="#62-%E7%A4%BA%E4%BE%8B%E4%B8%80%E6%A0%B9%E6%8D%AE%E5%B9%B3%E5%8F%B0%E9%80%89%E6%8B%A9clean%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8F">6.2. ç¤ºä¾‹ä¸€ï¼šæ ¹æ®å¹³å°é€‰æ‹©cleanæ‰§è¡Œæ–¹å¼</a></li><li><a href="#63-%E7%A4%BA%E4%BE%8B%E4%BA%8C%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E6%A8%A1%E5%BC%8F">6.3. ç¤ºä¾‹äºŒï¼šè°ƒè¯•æ¨¡å¼ä¸å‘å¸ƒæ¨¡å¼</a></li></ul></li><li><a href="#7-%E5%87%BD%E6%95%B0">7. å‡½æ•°</a><ul><li><a href="#71-subst--%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9B%BF%E6%8D%A2">7.1. <code>subst</code> â€”â€” å­—ç¬¦ä¸²æ›¿æ¢</a></li><li><a href="#72-patsubst--%E6%A8%A1%E5%BC%8F%E6%9B%BF%E6%8D%A2">7.2. <code>patsubst</code> â€”â€” æ¨¡å¼æ›¿æ¢</a></li><li><a href="#73-wildcard--%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%88%97%E8%A1%A8">7.3. <code>wildcard</code> â€”â€” è·å–æ–‡ä»¶åˆ—è¡¨</a></li><li><a href="#74-notdir--%E5%8E%BB%E6%8E%89%E8%B7%AF%E5%BE%84%E5%8F%AA%E4%BF%9D%E7%95%99%E6%96%87%E4%BB%B6%E5%90%8D">7.4. <code>notdir</code> â€”â€” å»æ‰è·¯å¾„ï¼Œåªä¿ç•™æ–‡ä»¶å</a></li><li><a href="#75-dir--%E8%8E%B7%E5%8F%96%E8%B7%AF%E5%BE%84%E9%83%A8%E5%88%86">7.5. <code>dir</code> â€”â€” è·å–è·¯å¾„éƒ¨åˆ†</a></li><li><a href="#76-basename--addsuffix-%E5%92%8C-addprefix--%E6%89%B9%E9%87%8F%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E5%90%8D">7.6. <code>basename</code> ã€ <code>addsuffix</code> å’Œ <code>addprefix</code> â€”â€” æ‰¹é‡å¤„ç†æ–‡ä»¶å</a></li><li><a href="#77-shell--%E6%89%A7%E8%A1%8C-shell-%E5%91%BD%E4%BB%A4">7.7. <code>shell</code> â€”â€” æ‰§è¡Œ shell å‘½ä»¤</a></li></ul></li><li><a href="#8-%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B%E7%A8%8B%E5%BA%8F">8. å®Œæ•´ç¤ºä¾‹ç¨‹åº</a></li></ul><h2 id="1-åŸºç¡€ç”¨æ³•"><a class="markdownIt-Anchor" href="#1-åŸºç¡€ç”¨æ³•"></a> 1. åŸºç¡€ç”¨æ³•</h2><p>ä¸€ä¸ªå…¸å‹çš„è§„åˆ™æ ¼å¼å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-make" data-language="make"><code class="language-make">target: dependencies&lt;TAB&gt; command<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>targetï¼šç›®æ ‡æ–‡ä»¶ï¼Œæ¯”å¦‚å¯æ‰§è¡Œæ–‡ä»¶æˆ–ä¸­é—´æ–‡ä»¶ã€‚</li><li>dependenciesï¼šä¾èµ–æ–‡ä»¶ï¼ˆæºæ–‡ä»¶ã€å¤´æ–‡ä»¶ç­‰ï¼‰ã€‚</li><li>commandï¼šç”Ÿæˆç›®æ ‡æ‰€éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆå¿…é¡»ä»¥ TAB ç¼©è¿› å¼€å¤´ï¼‰ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-make" data-language="make"><code class="language-make">main.o: main.cgcc -c main.c -o main.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div class="admonition warning"><p class="admonition-title">warning</p><p>ç”±äºmakfileå¯¹ç©ºæ ¼ã€tabæå…¶æ•æ„Ÿï¼Œå»ºè®®ç¼–å†™æ—¶æ‰“å¼€ç¼–è¾‘å™¨çš„ç©ºæ ¼ã€tabæ˜¾ç¤ºï¼Œå¹¶é¿å…ä¸å¿…è¦çš„ç©ºæ ¼ï¼Œè§„èŒƒåŒ–ä¹¦å†™ã€‚</p></div><h2 id="2-æ‰§è¡Œé€»è¾‘"><a class="markdownIt-Anchor" href="#2-æ‰§è¡Œé€»è¾‘"></a> 2. æ‰§è¡Œé€»è¾‘<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></h2><p>å½“æˆ‘ä»¬æ‰§è¡Œ <code>make</code> æ—¶ï¼Œå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p><strong>è§£æ Makefile</strong></p><ul><li><code>make</code> ä¼šä»å½“å‰ç›®å½•å¯»æ‰¾ <code>Makefile</code> æˆ– <code>makefile</code> æ–‡ä»¶ã€‚</li><li>è¯»å–å…¶ä¸­çš„è§„åˆ™ã€å˜é‡ã€ä¼ªç›®æ ‡ç­‰å®šä¹‰ã€‚</li></ul></li><li><p><strong>ç¡®å®šé»˜è®¤ç›®æ ‡</strong></p><ul><li>ä¸€èˆ¬æ˜¯æ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªç›®æ ‡ï¼ˆä¾‹å¦‚ <code>app</code>ï¼‰ã€‚</li><li>ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡ŒæŒ‡å®šï¼Œä¾‹å¦‚ï¼š</li></ul></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> clean<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="3"><li><p><strong>æ£€æŸ¥ä¾èµ–å…³ç³»</strong></p><ul><li>ä»ç›®æ ‡å¼€å§‹ï¼Œé€å±‚æ£€æŸ¥ä¾èµ–æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€æ˜¯å¦æ¯”ç›®æ ‡æ–‡ä»¶æ›´æ–°ã€‚</li><li>å¦‚æœä¾èµ–æ–‡ä»¶æ¯”ç›®æ ‡æ–‡ä»¶â€œæ–°â€ï¼Œè¯´æ˜ç›®æ ‡éœ€è¦é‡æ–°ç”Ÿæˆã€‚</li></ul></li><li><p><strong>æ‰§è¡Œå‘½ä»¤</strong></p><ul><li>å¯¹éœ€è¦æ›´æ–°çš„ç›®æ ‡ï¼Œæ‰§è¡Œå…¶è§„åˆ™ä¸­å®šä¹‰çš„å‘½ä»¤ã€‚</li><li>å‘½ä»¤å¿…é¡»ä»¥ <strong>TAB ç¼©è¿›</strong> å¼€å¤´ã€‚</li></ul></li><li><p><strong>é€’å½’æ„å»º</strong></p><ul><li>å¦‚æœä¾èµ–æ–‡ä»¶æœ¬èº«ä¹Ÿæ˜¯å…¶ä»–è§„åˆ™çš„ç›®æ ‡ï¼Œåˆ™ä¼šé€’å½’æ£€æŸ¥å’Œæ‰§è¡Œã€‚</li><li>ç›´åˆ°æ‰€æœ‰ä¾èµ–æ»¡è¶³ï¼Œæ‰æœ€ç»ˆç”Ÿæˆç›®æ ‡ã€‚</li></ul></li><li><p><strong>ç»“æŸ</strong></p><ul><li>å¦‚æœæ‰€æœ‰ç›®æ ‡éƒ½å·²æ˜¯æœ€æ–°ï¼Œåˆ™ <code>make</code> ä¼šæç¤ºï¼š</li></ul></li></ol><pre class="line-numbers language-none"><code class="language-none">make: &#39;app&#39; is up to date.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="21-æ‰§è¡Œæµç¨‹ç¤ºæ„å›¾"><a class="markdownIt-Anchor" href="#21-æ‰§è¡Œæµç¨‹ç¤ºæ„å›¾"></a> 2.1. ğŸ”„ æ‰§è¡Œæµç¨‹ç¤ºæ„å›¾</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">          make           â”‚           â–¼   è¯»å–å¹¶è§£æ Makefile           â”‚           â–¼   ç¡®å®šè¦æ„å»ºçš„ç›®æ ‡ (é»˜è®¤/æŒ‡å®š)           â”‚           â–¼   æ£€æŸ¥ç›®æ ‡çš„ä¾èµ–æ–‡ä»¶           â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚               â”‚ä¾èµ–æ¯”ç›®æ ‡æ—§      ä¾èµ–æ¯”ç›®æ ‡æ–°/ä¸å­˜åœ¨    â”‚               â”‚ç›®æ ‡å·²æ˜¯æœ€æ–°    æ‰§è¡Œè§„åˆ™å‘½ä»¤ â†’ ç”Ÿæˆæ–°ç›®æ ‡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="admonition info"><p class="admonition-title">tips</p><p>å¯ä»¥ä½¿ç”¨ make -f [makefile_name] æŒ‡å®šä½¿ç”¨æŸä¸ªmakefileæ–‡ä»¶ã€‚</p></div><h2 id="3-ä¼ªç›®æ ‡-phony"><a class="markdownIt-Anchor" href="#3-ä¼ªç›®æ ‡-phony"></a> 3. ä¼ªç›®æ ‡ .PHONY</h2><p>æœ‰äº›ç›®æ ‡ä¸æ˜¯å®é™…æ–‡ä»¶ï¼Œè€Œåªæ˜¯ä¸€ä¸ªæ“ä½œï¼Œä¾‹å¦‚ <code>clean</code>ã€‚<br />è¿™æ—¶å»ºè®®ä½¿ç”¨ <strong>.PHONY</strong> å£°æ˜ï¼š</p><pre class="line-numbers language-make" data-language="make"><code class="language-make">.PHONY:Â clean  clean:  rm -r Â [filepath]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æŒ‡å®šmakeç›®æ ‡æ–‡ä»¶ï¼š</p><pre class="line-numbers language-make" data-language="make"><code class="language-make">make clean<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="4-å˜é‡"><a class="markdownIt-Anchor" href="#4-å˜é‡"></a> 4. å˜é‡</h2><p>Makefile æ”¯æŒå˜é‡ï¼Œå¸¸ç”¨äºä¿å­˜ç¼–è¯‘å™¨æˆ–ç¼–è¯‘é€‰é¡¹ã€‚<br />ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-make" data-language="make"><code class="language-make">CC &#x3D; gccCFLAGS &#x3D; -Wall -gapp: main.o utils.o$(CC) $(CFLAGS) main.o utils.o -o appmain.o: main.c$(CC) $(CFLAGS) -c main.c -o main.outils.o: utils.c$(CC) $(CFLAGS) -c utils.c -o utils.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="41-èµ‹å€¼ç¬¦å·"><a class="markdownIt-Anchor" href="#41-èµ‹å€¼ç¬¦å·"></a> 4.1. èµ‹å€¼ç¬¦å·</h3><ul><li><strong>=</strong><br />æˆ‘ç§°ä¹‹ä¸ºæœ€ç»ˆèµ‹å€¼ï¼ŒåŒä¸€ä¸ªå˜é‡æ— è®ºè¢«èµ‹å€¼å¤šæ¬¡ï¼Œæ°¸è¿œå–æœ€åæŒ‡å®šçš„å€¼ã€‚<br />ç¤ºä¾‹ï¼š</li></ul><pre class="line-numbers language-make" data-language="make"><code class="language-make">VIR_A &#x3D; AVIR_B &#x3D; $(VIR_A) BVIR_A &#x3D; AA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æœ€åVIR_Bçš„å€¼æ˜¯AA Bã€‚</p><ul><li><strong>:=</strong><br />ç«‹å³èµ‹å€¼ï¼Œæ­£å¸¸é€»è¾‘çš„èµ‹å€¼å·ï¼Œç±»ä¼¼äºcè¯­è¨€çš„èµ‹å€¼å·ã€‚</li><li><strong>?=</strong><br />å¦‚æœå˜é‡åœ¨ä¹‹å‰æ²¡æœ‰è¢«èµ‹å€¼åˆ™èµ‹å€¼ã€‚<br />å¯ä»¥ç†è§£ä¸º  <pre class="line-numbers language-none"><code class="language-none">#ifndef#define ...#endif<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><strong>+=</strong><br />è¿½åŠ èµ‹å€¼ï¼Œå°†å€¼è¿½åŠ åˆ°å˜é‡ä¸­ã€‚</li></ul><h2 id="5-éšå«è§„åˆ™ä¸é€šé…ç¬¦"><a class="markdownIt-Anchor" href="#5-éšå«è§„åˆ™ä¸é€šé…ç¬¦"></a> 5. éšå«è§„åˆ™ä¸é€šé…ç¬¦</h2><p>Make å†…ç½®äº†ä¸€äº›è§„åˆ™ï¼Œå¯ä»¥ç”¨ç®€å†™æ–¹å¼ï¼š</p><ul><li><code>$@</code>ï¼šç›®æ ‡æ–‡ä»¶å</li><li><code>$&lt;</code>ï¼šç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶</li><li><code>$^</code>ï¼šæ‰€æœ‰ä¾èµ–æ–‡ä»¶</li></ul><p><code>%</code> è¡¨ç¤ºå¯ä»¥åŒ¹é…ä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œç”¨äºå®šä¹‰ä¸€ç±»æ–‡ä»¶çš„ç”Ÿæˆè§„åˆ™ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-make" data-language="make"><code class="language-make">%.o: %.c     gcc -c $&lt; -o $@<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>å«ä¹‰ï¼š<ul><li><code>%.o</code> è¡¨ç¤ºæ‰€æœ‰ä»¥ <code>.o</code> ç»“å°¾çš„ç›®æ ‡æ–‡ä»¶ã€‚</li><li><code>%.c</code> è¡¨ç¤ºæ‰€æœ‰ä»¥ <code>.c</code> ç»“å°¾çš„æºæ–‡ä»¶ã€‚</li><li><code>$&lt;</code> æ˜¯ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶ï¼ˆè¿™é‡Œæ˜¯ <code>.c</code> æ–‡ä»¶ï¼‰ã€‚</li><li><code>$@</code> æ˜¯ç›®æ ‡æ–‡ä»¶ï¼ˆè¿™é‡Œæ˜¯ <code>.o</code> æ–‡ä»¶ï¼‰ã€‚</li></ul></li><li>ä½œç”¨ï¼šè¿™æ¡è§„åˆ™è¡¨ç¤ºï¼Œæ‰€æœ‰ <code>.c</code> æ–‡ä»¶å¯ä»¥é€šè¿‡ç¼–è¯‘ç”Ÿæˆå¯¹åº”çš„ <code>.o</code> æ–‡ä»¶ã€‚</li></ul><hr /><p><code>%</code> å¯ä»¥åŒ¹é…æ–‡ä»¶åçš„æŸä¸€éƒ¨åˆ†ï¼Œç”¨äºç®€åŒ–è§„åˆ™ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">build&#x2F;%: src&#x2F;%     cp $&lt; $@<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>å«ä¹‰ï¼š<ul><li><code>build/%</code> è¡¨ç¤ºç›®æ ‡æ–‡ä»¶åœ¨ <code>build/</code> ç›®å½•ä¸‹ã€‚</li><li><code>src/%</code> è¡¨ç¤ºä¾èµ–æ–‡ä»¶åœ¨ <code>src/</code> ç›®å½•ä¸‹ã€‚</li><li><code>$&lt;</code> æ˜¯ä¾èµ–æ–‡ä»¶ï¼Œ<code>$@</code> æ˜¯ç›®æ ‡æ–‡ä»¶ã€‚</li></ul></li><li>ä½œç”¨ï¼šè¿™æ¡è§„åˆ™è¡¨ç¤ºï¼Œå°† <code>src/</code> ç›®å½•ä¸‹çš„æ–‡ä»¶å¤åˆ¶åˆ° <code>build/</code> ç›®å½•ä¸‹ã€‚</li></ul><hr /><p>åœ¨æ¨¡å¼è§„åˆ™ä¸­ï¼Œ<code>%</code> å¯ä»¥ç”¨äºå®šä¹‰å¤šä¸ªç›®æ ‡ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">%.a: %.b %.c     cat $^ &gt; $@&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>å«ä¹‰ï¼š<ul><li><code>%.a</code> æ˜¯ç›®æ ‡æ–‡ä»¶ã€‚</li><li><code>%.b</code> å’Œ <code>%.c</code> æ˜¯ä¾èµ–æ–‡ä»¶ã€‚</li><li><code>$^</code> è¡¨ç¤ºæ‰€æœ‰ä¾èµ–æ–‡ä»¶ï¼Œ<code>$@</code> æ˜¯ç›®æ ‡æ–‡ä»¶ã€‚</li></ul></li><li>ä½œç”¨ï¼šè¿™æ¡è§„åˆ™è¡¨ç¤ºï¼Œå°† <code>.b</code> å’Œ <code>.c</code> æ–‡ä»¶åˆå¹¶ç”Ÿæˆ <code>.a</code> æ–‡ä»¶ã€‚</li></ul><hr /><h2 id="6-æ¡ä»¶åˆ†æ”¯"><a class="markdownIt-Anchor" href="#6-æ¡ä»¶åˆ†æ”¯"></a> 6. æ¡ä»¶åˆ†æ”¯</h2><p>åœ¨ Makefile ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¡ä»¶è¯­å¥æ¥æ ¹æ®ä¸åŒæƒ…å†µæ‰§è¡Œä¸åŒè§„åˆ™æˆ–å®šä¹‰å˜é‡ã€‚å¸¸è§çš„æœ‰ <code>ifeq</code>ã€<code>ifneq</code>ã€<code>ifdef</code>ã€<code>ifndef</code>ã€‚</p><h3 id="61-è¯­æ³•"><a class="markdownIt-Anchor" href="#61-è¯­æ³•"></a> 6.1. è¯­æ³•</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make">ifeq (æ¡ä»¶1, æ¡ä»¶2)    # å½“ æ¡ä»¶1 &#x3D;&#x3D; æ¡ä»¶2 æ—¶æ‰§è¡Œè¿™é‡Œelse    # å¦åˆ™æ‰§è¡Œè¿™é‡Œendififneq (æ¡ä»¶1, æ¡ä»¶2)    # å½“ æ¡ä»¶1 !&#x3D; æ¡ä»¶2 æ—¶æ‰§è¡Œè¿™é‡Œendififdef å˜é‡å    # å½“å˜é‡å·²å®šä¹‰æ—¶æ‰§è¡Œè¿™é‡Œendififndef å˜é‡å    # å½“å˜é‡æœªå®šä¹‰æ—¶æ‰§è¡Œè¿™é‡Œendif<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="62-ç¤ºä¾‹ä¸€æ ¹æ®å¹³å°é€‰æ‹©cleanæ‰§è¡Œæ–¹å¼"><a class="markdownIt-Anchor" href="#62-ç¤ºä¾‹ä¸€æ ¹æ®å¹³å°é€‰æ‹©cleanæ‰§è¡Œæ–¹å¼"></a> 6.2. ç¤ºä¾‹ä¸€ï¼šæ ¹æ®å¹³å°é€‰æ‹©cleanæ‰§è¡Œæ–¹å¼</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make"># é»˜è®¤å˜é‡CC &#x3D; gcc# åˆ¤æ–­ç³»ç»Ÿifeq ($(OS), Windows_NT)    RM &#x3D; delelse    RM &#x3D; rm -fendifapp: main.o$(CC) main.o -o appclean:$(RM) *.o app<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="63-ç¤ºä¾‹äºŒè°ƒè¯•æ¨¡å¼ä¸å‘å¸ƒæ¨¡å¼"><a class="markdownIt-Anchor" href="#63-ç¤ºä¾‹äºŒè°ƒè¯•æ¨¡å¼ä¸å‘å¸ƒæ¨¡å¼"></a> 6.3. ç¤ºä¾‹äºŒï¼šè°ƒè¯•æ¨¡å¼ä¸å‘å¸ƒæ¨¡å¼</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make"># è®¾ç½®ç¼–è¯‘é€‰é¡¹CFLAGS &#x3D; -Wallifeq ($(MODE), debug)    CFLAGS +&#x3D; -gelse    CFLAGS +&#x3D; -O2endifapp: main.o$(CC) $(CFLAGS) main.o -o app<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨æ–¹å¼ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> <span class="token assign-left variable">MODE</span><span class="token operator">=</span>debug   <span class="token comment"># è°ƒè¯•æ¨¡å¼ï¼Œå¸¦è°ƒè¯•ä¿¡æ¯</span><span class="token function">make</span> <span class="token assign-left variable">MODE</span><span class="token operator">=</span>release <span class="token comment"># é»˜è®¤ä¼˜åŒ–æ¨¡å¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="7-å‡½æ•°"><a class="markdownIt-Anchor" href="#7-å‡½æ•°"></a> 7. å‡½æ•°</h2><p>Makefile å†…ç½®äº†è®¸å¤šå‡½æ•°ï¼Œç”¨æ¥å¤„ç†å­—ç¬¦ä¸²ã€æ–‡ä»¶åã€è·¯å¾„ç­‰ã€‚<br />å¸¸è§å‡½æ•°æ ¼å¼ä¸ºï¼š</p><pre class="line-numbers language-make" data-language="make"><code class="language-make">$(å‡½æ•°å å‚æ•°1 å‚æ•°2 ...)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸‹é¢ä»‹ç»ä¸€äº›<strong>å¸¸ç”¨å‡½æ•°</strong></p><h3 id="71-subst-å­—ç¬¦ä¸²æ›¿æ¢"><a class="markdownIt-Anchor" href="#71-subst-å­—ç¬¦ä¸²æ›¿æ¢"></a> 7.1. <code>subst</code> â€”â€” å­—ç¬¦ä¸²æ›¿æ¢</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make">$(subst from,to,text)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>åŠŸèƒ½ï¼šå°† <code>text</code> ä¸­çš„ <code>from</code> æ›¿æ¢ä¸º <code>to</code>ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p></li></ul><pre class="line-numbers language-none"><code class="language-none">SRC &#x3D; main.c utils.c OBJ &#x3D; $(subst .c,.o,$(SRC)) # ç»“æœï¼šOBJ &#x3D; main.o utils.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><hr /><h3 id="72-patsubst-æ¨¡å¼æ›¿æ¢"><a class="markdownIt-Anchor" href="#72-patsubst-æ¨¡å¼æ›¿æ¢"></a> 7.2. <code>patsubst</code> â€”â€” æ¨¡å¼æ›¿æ¢</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make">$(patsubst pattern,replacement,text)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>åŠŸèƒ½ï¼šæ›´çµæ´»çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ”¯æŒé€šé…ç¬¦ <code>%</code>ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p></li></ul><pre class="line-numbers language-make" data-language="make"><code class="language-make">SRC &#x3D; main.c utils.c test.cOBJ &#x3D; $(patsubst %.c,%.o,$(SRC))# ç»“æœï¼šOBJ &#x3D; main.o utils.o test.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><hr /><h3 id="73-wildcard-è·å–æ–‡ä»¶åˆ—è¡¨"><a class="markdownIt-Anchor" href="#73-wildcard-è·å–æ–‡ä»¶åˆ—è¡¨"></a> 7.3. <code>wildcard</code> â€”â€” è·å–æ–‡ä»¶åˆ—è¡¨</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make">$(wildcard pattern)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>åŠŸèƒ½ï¼šåŒ¹é…ç¬¦åˆæ¨¡å¼çš„æ–‡ä»¶ã€‚</p></li><li><p>ç¤ºä¾‹ï¼š</p></li></ul><pre class="line-numbers language-make" data-language="make"><code class="language-make">SRC &#x3D; $(wildcard *.c)# ç»“æœï¼šSRC &#x3D; å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ .c æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr /><h3 id="74-notdir-å»æ‰è·¯å¾„åªä¿ç•™æ–‡ä»¶å"><a class="markdownIt-Anchor" href="#74-notdir-å»æ‰è·¯å¾„åªä¿ç•™æ–‡ä»¶å"></a> 7.4. <code>notdir</code> â€”â€” å»æ‰è·¯å¾„ï¼Œåªä¿ç•™æ–‡ä»¶å</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make">FILES &#x3D; src&#x2F;main.c src&#x2F;utils.cNAMES &#x3D; $(notdir $(FILES))# ç»“æœï¼šNAMES &#x3D; main.c utils.c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><hr /><h3 id="75-dir-è·å–è·¯å¾„éƒ¨åˆ†"><a class="markdownIt-Anchor" href="#75-dir-è·å–è·¯å¾„éƒ¨åˆ†"></a> 7.5. <code>dir</code> â€”â€” è·å–è·¯å¾„éƒ¨åˆ†</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make">FILES &#x3D; src&#x2F;main.c src&#x2F;utils.cPATHS &#x3D; $(dir $(FILES))# ç»“æœï¼šPATHS &#x3D; src&#x2F; src&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><hr /><h3 id="76-basename-addsuffix-å’Œ-addprefix-æ‰¹é‡å¤„ç†æ–‡ä»¶å"><a class="markdownIt-Anchor" href="#76-basename-addsuffix-å’Œ-addprefix-æ‰¹é‡å¤„ç†æ–‡ä»¶å"></a> 7.6. <code>basename</code> ã€ <code>addsuffix</code> å’Œ <code>addprefix</code> â€”â€” æ‰¹é‡å¤„ç†æ–‡ä»¶å</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make">FILES &#x3D; main.c utils.c# å»æ‰åç¼€NAMES &#x3D; $(basename $(FILES))# NAMES &#x3D; main utils# æ‰¹é‡æ·»åŠ åç¼€OBJS &#x3D; $(addsuffix .o,$(NAMES))# OBJS &#x3D; main.o utils.o# æ‰¹é‡æ·»åŠ å‰ç¼€OBJS &#x3D; $(addprefix -I,$(NAMES))# OBJS &#x3D; -Imain -Iutils<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr /><h3 id="77-shell-æ‰§è¡Œ-shell-å‘½ä»¤"><a class="markdownIt-Anchor" href="#77-shell-æ‰§è¡Œ-shell-å‘½ä»¤"></a> 7.7. <code>shell</code> â€”â€” æ‰§è¡Œ shell å‘½ä»¤</h3><pre class="line-numbers language-make" data-language="make"><code class="language-make">DATE &#x3D; $(shell date +%Y-%m-%d)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å¯ä»¥åœ¨ Makefile ä¸­ç›´æ¥ä½¿ç”¨ç³»ç»Ÿå‘½ä»¤çš„è¾“å‡ºã€‚</p><h2 id="8-å®Œæ•´ç¤ºä¾‹ç¨‹åº"><a class="markdownIt-Anchor" href="#8-å®Œæ•´ç¤ºä¾‹ç¨‹åº"></a> 8. å®Œæ•´ç¤ºä¾‹ç¨‹åº</h2><p>è¿™æ˜¯ä¸€ä¸ªå®Œæ•´Makefileç¤ºä¾‹ç¨‹åºï¼Œç”¨äºå°†cè¯­è¨€ç¨‹åºç¼–è¯‘ä¸ºå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶binæ–‡ä»¶ã€‚å®ƒå¯ä»¥åˆ¶æˆé•œåƒä¾›SoCçƒ§å½•ã€‚</p><pre class="line-numbers language-make" data-language="make"><code class="language-make">#0############################################################ è®¾ç½®ç›®å½•å˜é‡ï¼Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†å’Œä¿®æ”¹# å½“å‰æ ¹ç›®å½•:ROOT_DIR :&#x3D; .# ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆ.oï¼‰è¾“å‡ºç›®å½•:BUILD_DIR :&#x3D; build# æœ€ç»ˆç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆ.binï¼‰ç›®å½•:BIN_DIR :&#x3D; bin# å·¥ç¨‹åNAME :&#x3D; key# æŒ‡å®šé“¾æ¥è„šæœ¬LDS &#x3D; imx.lds##############################################################1############################################################ è‡ªåŠ¨æŸ¥æ‰¾ src&#x2F; ç›®å½•ä¸‹çš„æ‰€æœ‰ .c æ–‡ä»¶SRCS &#x3D; $(shell find $(ROOT_DIR) -name &quot;*.c&quot;)# å°† SRCä¸­çš„ xxx.c è½¬æ¢ä¸º build&#x2F;xxx.o# åŒæ—¶æ·»åŠ  build&#x2F;startup.oï¼ˆæ±‡ç¼–å¯åŠ¨æ–‡ä»¶ï¼‰OBJS &#x3D; $(BUILD_DIR)&#x2F;startup.oOBJS +&#x3D; $(patsubst %.c,$(BUILD_DIR)&#x2F;%.o,$(SRCS))# è‡ªåŠ¨æŸ¥æ‰¾æ‰€æœ‰åŒ…å«å¤´æ–‡ä»¶çš„ç›®å½•INC_DIRS &#x3D; $(shell find $(ROOT_DIR) -type f -name &quot;*.h&quot; -exec dirname &#123;&#125; \; | sort -u)INCLUDES &#x3D; $(addprefix -I, $(INC_DIRS))##############################################################2############################################################ è®¾ç½®ç¼–è¯‘å·¥å…·ï¼ˆä½¿ç”¨ ARM çš„äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼‰CC :&#x3D; arm-none-eabi-# ç¼–è¯‘å™¨ï¼ˆç”¨äº .c å’Œ .S æ–‡ä»¶ï¼‰:GCC :&#x3D; $(CC)gcc# é“¾æ¥å™¨:LD :&#x3D; $(CC)ld# ç”¨äºå°† elf è½¬ä¸º bin æ ¼å¼:OBJCOPY :&#x3D; $(CC)objcopy# ç”¨äºåæ±‡ç¼–OBJDUMP :&#x3D; $(CC)objdump# ç¼–è¯‘é€‰é¡¹ï¼ˆGCC ç¼–è¯‘é˜¶æ®µï¼‰# -Iï¼šæŒ‡å®šå¤´æ–‡ä»¶æœç´¢ç›®å½•# -Wallï¼šæ‰“å¼€æ‰€æœ‰è­¦å‘Š# -O2ï¼šä¼˜åŒ–ç­‰çº§ 2ï¼ˆæ¨èç”¨äº releaseï¼‰# -nostdlibï¼šä¸é“¾æ¥æ ‡å‡†åº“ï¼ˆé€‚ç”¨äºè£¸æœºï¼‰# -cï¼šåªç¼–è¯‘ï¼Œä¸é“¾æ¥GCC_FLAGS &#x3D; $(INCLUDES) -Wall -nostdlib -c# é“¾æ¥å™¨é€‰é¡¹LD_FLAGS &#x3D; -T$(LDS)# ä½¿ç”¨ objdump å·¥å…·å¯¹ç”Ÿæˆçš„ ELF æ–‡ä»¶è¿›è¡Œåæ±‡ç¼–# -Dï¼šåæ±‡ç¼–æ‰€æœ‰èŠ‚ï¼ˆåŒ…æ‹¬ä»£ç æ®µã€å¯åŠ¨ä»£ç ç­‰ï¼‰# -m armï¼šæŒ‡å®šç›®æ ‡æ¶æ„ä¸º ARM# .elfï¼šè¾“å…¥çš„å¯æ‰§è¡Œæ–‡ä»¶# &gt; .disï¼šå°†åæ±‡ç¼–ç»“æœè¾“å‡ºä¸º .dis æ–‡æœ¬æ–‡ä»¶OBJDUMP_FLAGS &#x3D; -D -m arm $(BUILD_DIR)&#x2F;$(NAME).elf &gt; $(BUILD_DIR)&#x2F;$(NAME).dis##############################################################3############################################################ ç›®æ ‡ï¼šç”Ÿæˆæœ€ç»ˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ bin&#x2F;$(NAME).bin$(BIN_DIR)&#x2F;$(NAME).bin: $(OBJS)# é“¾æ¥æ‰€æœ‰ .o æ–‡ä»¶ç”Ÿæˆ elf æ ¼å¼å¯æ‰§è¡Œæ–‡ä»¶Â  Â  $(LD) $(LD_FLAGS) $(OBJS) -o $(BUILD_DIR)&#x2F;$(NAME).elf# åæ±‡ç¼– è°ƒè¯•ç”¨Â  Â  $(OBJDUMP) $(OBJDUMP_FLAGS)# æŠŠ elf æ–‡ä»¶è½¬æ¢ä¸ºè£¸æœºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæ— ç¬¦å·ã€æ— å¤´ä¿¡æ¯ï¼‰Â  Â  $(OBJCOPY) -O binary -S $(BUILD_DIR)&#x2F;$(NAME).elf $@ # ç¼–è¯‘æ±‡ç¼–å¯åŠ¨æ–‡ä»¶ startup.Sï¼Œç”Ÿæˆ build&#x2F;startup.o$(BUILD_DIR)&#x2F;startup.o: startup.S# æ³¨æ„ startup.S æ˜¯æ±‡ç¼–æ–‡ä»¶ï¼Œç”¨ gcc ç¼–è¯‘ä¹Ÿå¯ä»¥ï¼Œé»˜è®¤ä¼šè°ƒç”¨æ±‡ç¼–å™¨Â  Â  $(GCC) $(GCC_FLAGS) $&lt; -o $@# ç¼–è¯‘æ¯ä¸ª .c æ–‡ä»¶åˆ° build&#x2F;xxx.o# $@ï¼šç›®æ ‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ build&#x2F;main.oï¼‰# $&lt;ï¼šä¾èµ–çš„æºæ–‡ä»¶ï¼ˆä¾‹å¦‚ src&#x2F;main.cï¼‰$(BUILD_DIR)&#x2F;%.o: %.c# ä¿®å¤ç”±äºæ²¡æœ‰æ–‡ä»¶å¤¹æŠ¥é”™Â  Â  mkdir -p $(dir $@)Â  Â  $(GCC) $(GCC_FLAGS) -c $&lt; -o $@#############################################################.PHONY: cleanclean:Â  Â  rm -r $(BUILD_DIR)&#x2F;* $(BIN_DIR)&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€ä¸ªæ›´é€šç”¨çš„æ¨¡æ¿</p><pre class="line-numbers language-make" data-language="make"><code class="language-make"># é€šç”¨ Makefile æ¨¡æ¿# 1. ç¼–è¯‘å™¨åŠé€‰é¡¹CC      :&#x3D; gcc             # C ç¼–è¯‘å™¨ (å¯æ”¹æˆ g++)CFLAGS  :&#x3D; -Wall -O2       # ç¼–è¯‘å‚æ•°LDFLAGS :&#x3D;                 # é“¾æ¥å‚æ•° (åº“è·¯å¾„)LDLIBS  :&#x3D; -lm             # ä¾èµ–çš„åº“ (-lpthread, -lrt ç­‰)# 2. ç›®å½•ç»“æ„SRC_DIR :&#x3D; src             # æºç ç›®å½•OBJ_DIR :&#x3D; build           # ç›®æ ‡æ–‡ä»¶ç›®å½•BIN_DIR :&#x3D; bin             # å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•# 3. è‡ªåŠ¨æ”¶é›†æºæ–‡ä»¶SRCS :&#x3D; $(wildcard $(SRC_DIR)&#x2F;*.c)OBJS :&#x3D; $(patsubst $(SRC_DIR)&#x2F;%.c,$(OBJ_DIR)&#x2F;%.o,$(SRCS))TARGET :&#x3D; $(BIN_DIR)&#x2F;app   # ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å# 4. é»˜è®¤ç›®æ ‡all: $(TARGET)# 5. é“¾æ¥è§„åˆ™$(TARGET): $(OBJS) | $(BIN_DIR)$(CC) $(LDFLAGS) -o $@ $^ $(LDLIBS)# 6. ç¼–è¯‘è§„åˆ™$(OBJ_DIR)&#x2F;%.o: $(SRC_DIR)&#x2F;%.c | $(OBJ_DIR)$(CC) $(CFLAGS) -c $&lt; -o $@# 7. ç›®å½•ç”Ÿæˆ$(OBJ_DIR) $(BIN_DIR):mkdir -p $@# 8. æ¸…ç†.PHONY: clean runclean:rm -rf $(OBJ_DIR) $(BIN_DIR)# 9. è¿è¡Œ (å¯é€‰)run: all.&#x2F;$(TARGET)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr class="footnotes-sep" /><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>ä»…ä½œäº†è§£ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="é¡¹ç›®ç®¡ç†" scheme="https://blog.godmao.top/categories/Linux/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/"/>
    
    
    <category term="MakeFile" scheme="https://blog.godmao.top/Tags/MakeFile/"/>
    
  </entry>
  
  <entry>
    <title>äº¤å‰ç¼–è¯‘å™¨ç›¸å…³çŸ¥è¯†æ¢³ç†</title>
    <link href="https://blog.godmao.top/posts/27939/"/>
    <id>https://blog.godmao.top/posts/27939/</id>
    <published>2025-09-07T09:18:55.000Z</published>
    <updated>2025-09-07T10:45:40.598Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr />]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å…³äºLinuxå¼€å‘æ¿ä¸ä¸Šä½æœºçš„è¿æ¥æ–¹å¼</title>
    <link href="https://blog.godmao.top/posts/32814/"/>
    <id>https://blog.godmao.top/posts/32814/</id>
    <published>2025-09-07T09:17:17.000Z</published>
    <updated>2025-09-29T14:50:17.984Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><div class="admonition warning"><p class="admonition-title">warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p></div></details><hr /><blockquote><p>æœ¬æ–‡æ—¨åœ¨è®°å½•è‡ªå·±çš„IMX6ULLå¼€å‘æ¿ä¸Šä½æœºè¿æ¥çš„è¿‡ç¨‹ã€‚<s>ä¸ºä»€ä¹ˆæ„Ÿè§‰æ˜¯åç«¯è¿™ä¸€å—å‘¢ï¼Ÿ</s></p></blockquote><h2 id="1-å‰ææ¡ä»¶"><a class="markdownIt-Anchor" href="#1-å‰ææ¡ä»¶"></a> 1. å‰ææ¡ä»¶</h2><blockquote><ul><li>è£…æœ‰Debian/Ubuntuç³»ç»Ÿçš„ã€å®‰è£…äº†sshæœåŠ¡çš„ã€å¸¦æœ‰ç½‘ç»œè®¾å¤‡åŠé©±åŠ¨çš„å¼€å‘æ¿</li><li>MobaXtermå·¥å…·</li><li>ç›®å‰ä½¿ç”¨çš„ä¸Šä½æœºæ˜¯Win11å¹³å°ï¼Œåç»­å†ç ”ç©¶Linuxå¹³å°ã€‚</li></ul></blockquote><h2 id="2-åŸºæœ¬æ“ä½œ"><a class="markdownIt-Anchor" href="#2-åŸºæœ¬æ“ä½œ"></a> 2. åŸºæœ¬æ“ä½œ</h2><h3 id="21-æŸ¥è¯¢è®¾å¤‡ç½‘ç»œè¿æ¥çŠ¶æ€åŠipåœ°å€"><a class="markdownIt-Anchor" href="#21-æŸ¥è¯¢è®¾å¤‡ç½‘ç»œè¿æ¥çŠ¶æ€åŠipåœ°å€"></a> 2.1. æŸ¥è¯¢è®¾å¤‡ç½‘ç»œè¿æ¥çŠ¶æ€åŠipåœ°å€</h3><p><code>ifconfig</code> å‘½ä»¤</p><h3 id="22-è¿æ¥æµ‹è¯•"><a class="markdownIt-Anchor" href="#22-è¿æ¥æµ‹è¯•"></a> 2.2. è¿æ¥æµ‹è¯•</h3><p><code>ping</code> å‘½ä»¤</p><h3 id="23-åŠ¨æ€åˆ†é…ipä¸»åŠ¨ç”³è¯·ipåœ°å€"><a class="markdownIt-Anchor" href="#23-åŠ¨æ€åˆ†é…ipä¸»åŠ¨ç”³è¯·ipåœ°å€"></a> 2.3. åŠ¨æ€åˆ†é…ip/ä¸»åŠ¨ç”³è¯·ipåœ°å€</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">udhcpc <span class="token parameter variable">-i</span> eth0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong><code>udhcpc</code></strong></p><ul><li>å…¨ç§°æ˜¯ <em>Micro DHCP Client</em>ï¼Œæ˜¯ BusyBox æä¾›çš„ä¸€ä¸ªè½»é‡çº§ DHCP å®¢æˆ·ç«¯å·¥å…·ã€‚</li><li>å®ƒä¼šå‘å±€åŸŸç½‘é‡Œçš„ DHCP æœåŠ¡å™¨ï¼ˆæ¯”å¦‚è·¯ç”±å™¨ã€ä¸»æœºä¸Šçš„ Internet Connection Sharing æœåŠ¡ï¼‰å‘é€è¯·æ±‚ï¼Œè¯·æ±‚ä¸€ä¸ª IP åœ°å€ã€‚</li></ul><p><strong><code>-i eth0</code></strong></p><ul><li>æŒ‡å®šè¦ä½¿ç”¨çš„ç½‘ç»œæ¥å£ï¼Œè¿™é‡Œæ˜¯ <code>eth0</code>ï¼ˆå¼€å‘æ¿ä¸Šçš„ä»¥å¤ªç½‘ç½‘å¡ï¼‰ã€‚</li><li>å¦‚æœä½ ç”¨çš„æ˜¯å…¶ä»–ç½‘å¡ï¼ˆæ¯”å¦‚ <code>eth1</code> æˆ– <code>enp0s3</code>ï¼‰ï¼Œéœ€è¦æ”¹æˆå¯¹åº”åå­—ã€‚</li></ul><p>æˆåŠŸçš„è¯ï¼Œå®ƒä¼šæ˜¾ç¤ºç±»ä¼¼ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">udhcpc: sending discoverudhcpc: sending <span class="token keyword">select</span> <span class="token keyword">for</span> <span class="token number">192.168</span>.137.2udhcpc: lease of <span class="token number">192.168</span>.137.2 obtained, lease <span class="token function">time</span> <span class="token number">86400</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™è¡¨ç¤ºç½‘å¡å·²ç»ä» DHCP æœåŠ¡å™¨é‚£é‡Œæ‹¿åˆ°äº† IPï¼ˆè¿™é‡Œæ˜¯ <code>192.168.137.2</code>ï¼‰ã€‚å¦‚æœæ²¡æœ‰ DHCP æœåŠ¡å™¨å“åº”ï¼Œå°±ä¼šä¸€ç›´ <code>sending discover</code>ï¼Œè¯´æ˜æ²¡æœ‰å¯åˆ†é… IPã€‚</p><h3 id="24-æ‰‹åŠ¨è®¾ç½®è®¾å¤‡ipåœ°å€"><a class="markdownIt-Anchor" href="#24-æ‰‹åŠ¨è®¾ç½®è®¾å¤‡ipåœ°å€"></a> 2.4. æ‰‹åŠ¨è®¾ç½®è®¾å¤‡ipåœ°å€</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ifconfig</span> eth0 <span class="token number">192.168</span>.10.2 netmask <span class="token number">255.255</span>.255.0 up<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>up</code> æŒ‡å¯ç”¨</p><h3 id="25-æŸ¥è¯¢sshæ˜¯å¦å¼€å¯"><a class="markdownIt-Anchor" href="#25-æŸ¥è¯¢sshæ˜¯å¦å¼€å¯"></a> 2.5. æŸ¥è¯¢sshæ˜¯å¦å¼€å¯</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl status <span class="token function">ssh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="26-å¼€å¯sshæœåŠ¡"><a class="markdownIt-Anchor" href="#26-å¼€å¯sshæœåŠ¡"></a> 2.6. å¼€å¯sshæœåŠ¡</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl start <span class="token function">ssh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/etc/init.d/ssh start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="27-sshè¿œç¨‹è¿æ¥"><a class="markdownIt-Anchor" href="#27-sshè¿œç¨‹è¿æ¥"></a> 2.7. sshè¿œç¨‹è¿æ¥</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> <span class="token punctuation">[</span>username<span class="token punctuation">]</span>@<span class="token punctuation">[</span>ip-addr/hostname<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="28-é€šè¿‡mobaxtermè¿æ¥"><a class="markdownIt-Anchor" href="#28-é€šè¿‡mobaxtermè¿æ¥"></a> 2.8. é€šè¿‡MobaXtermè¿æ¥</h3><p>å¡«å¥½å³å¯ã€‚<br /><img src="Snipaste_2025-09-07_19-20-07.png" alt="" /></p><p><code>hostname</code> å¯ä»¥è¾“å…¥åŒåæŒ‡ä»¤æŸ¥çœ‹ã€‚</p><h2 id="3-æ–¹å¼ä¸€æ— çº¿ç½‘ç»œè¿æ¥"><a class="markdownIt-Anchor" href="#3-æ–¹å¼ä¸€æ— çº¿ç½‘ç»œè¿æ¥"></a> 3. æ–¹å¼ä¸€ï¼šæ— çº¿ç½‘ç»œè¿æ¥</h2><blockquote><p>â€œä¼˜ç‚¹â€ï¼šæ— çº¿é€šä¿¡ã€‚<br />â€œç¼ºç‚¹â€ï¼šå»¶è¿Ÿå¯èƒ½è¾ƒé«˜ã€‚</p></blockquote><h3 id="31-åŒä¸€ç½‘ç»œä¸‹"><a class="markdownIt-Anchor" href="#31-åŒä¸€ç½‘ç»œä¸‹"></a> 3.1. åŒä¸€ç½‘ç»œä¸‹</h3><p>åœ¨åŒä¸€ç½‘æ®µä¸‹ï¼ˆè¿æ¥åŒä¸€ä¸ªWIFIï¼‰ï¼Œé€šè¿‡sshå»ºç«‹è¿æ¥ã€‚ç®€ç®€å•å•ã€‚</p><h3 id="32-ä¸åŒç½‘ç»œä¸‹"><a class="markdownIt-Anchor" href="#32-ä¸åŒç½‘ç»œä¸‹"></a> 3.2. ä¸åŒç½‘ç»œä¸‹</h3><blockquote><p>å¾…è¡¥å……ã€‚</p></blockquote><h2 id="4-æ–¹å¼äºŒé€šè¿‡ç½‘çº¿ä¸winç”µè„‘è¿æ¥"><a class="markdownIt-Anchor" href="#4-æ–¹å¼äºŒé€šè¿‡ç½‘çº¿ä¸winç”µè„‘è¿æ¥"></a> 4. æ–¹å¼äºŒï¼šé€šè¿‡ç½‘çº¿ä¸Winç”µè„‘è¿æ¥</h2><blockquote><p>â€œä¼˜ç‚¹â€ï¼šå»¶è¿Ÿä½ã€‚<br />â€œç¼ºç‚¹â€ï¼šæœ‰çº¿é€šä¿¡ã€‚</p></blockquote><h3 id="41-ç‚¹å¯¹ç‚¹é€šä¿¡æ— éœ€å…±äº«ç”µè„‘ç½‘ç»œ"><a class="markdownIt-Anchor" href="#41-ç‚¹å¯¹ç‚¹é€šä¿¡æ— éœ€å…±äº«ç”µè„‘ç½‘ç»œ"></a> 4.1. ç‚¹å¯¹ç‚¹é€šä¿¡ï¼ˆæ— éœ€å…±äº«ç”µè„‘ç½‘ç»œï¼‰</h3><blockquote><p>â€œä¼˜ç‚¹â€ï¼šæ“ä½œç®€å•ã€‚<br />â€œç¼ºç‚¹â€ï¼šå¼€å‘æ¿ä¸èƒ½å…±äº«ç”µè„‘ç½‘ç»œã€‚</p></blockquote><p>å°†å¼€å‘æ¿ç½‘å£å’Œç”µè„‘ç½‘å£ç”¨ç½‘çº¿è¿æ¥ï¼Œè¿›å…¥ç”µè„‘<code>ç½‘ç»œå’ŒInternet</code>è®¾ç½®ï¼Œé€‰æ‹©<code>ä»¥å¤ªç½‘</code></p><p>ipåˆ†é…æ”¹ä¸ºæ‰‹åŠ¨ï¼Œipåœ°å€å¯ä»¥åˆ†é…ä¸º<code>192.168.10.1</code><br />æ©ç ä¸º<code>255.255.255.0</code><br /><img src="Snipaste_2025-09-07_19-29-57.png" alt="" /></p><p>å¼€å‘æ¿ç«¯åŒæ ·æŒ‡å®šipåœ°å€å’Œæ©ç ï¼Œé¡»åœ¨åŒä¸€ç½‘æ®µï¼Œä¾‹å¦‚<code>192.168.10.7</code> ã€‚è¿™æ ·ä¸¤ä¸ªè®¾å¤‡å°±èƒ½äº’ç›¸æ‰¾åˆ°äº†ã€‚<br />å†åœ¨ç”µè„‘ä¸Šè¿›è¡Œpingæµ‹è¯•ã€‚èƒ½pingé€šç”¨ssh/MobaXtermè¿æ¥å³å¯ã€‚</p><h3 id="42-ç‚¹å¯¹ç‚¹é€šä¿¡å¹¶å…±äº«ç”µè„‘ç½‘ç»œç”µè„‘æˆç½‘å…³"><a class="markdownIt-Anchor" href="#42-ç‚¹å¯¹ç‚¹é€šä¿¡å¹¶å…±äº«ç”µè„‘ç½‘ç»œç”µè„‘æˆç½‘å…³"></a> 4.2. ç‚¹å¯¹ç‚¹é€šä¿¡å¹¶å…±äº«ç”µè„‘ç½‘ç»œï¼ˆç”µè„‘æˆç½‘å…³ï¼‰</h3><blockquote><p>â€œä¼˜ç‚¹â€ï¼šå¼€å‘æ¿ä¸ä»…å¯ä»¥ä¸ç”µè„‘å»ºç«‹é€šä¿¡ï¼Œè¿˜èƒ½å…±äº«ç”µè„‘ç½‘ç»œã€‚<br />â€œç¼ºç‚¹â€ï¼šæ“ä½œè¾ƒå¤æ‚ã€‚</p></blockquote><p>ç”µè„‘é€šè¿‡wifiè¿æ¥ç½‘ç»œï¼Œé€šè¿‡ä»¥å¤ªç½‘æ¥å£è¿æ¥å¼€å‘æ¿ã€‚<br />åœ¨ç”µè„‘æ§åˆ¶é¢æ¿&gt;ç½‘ç»œå’ŒInternet&gt;ç½‘ç»œå’Œå…±äº«ä¸­å¿ƒ å³ä¾§æ›´æ”¹é€‚é…å™¨è®¾ç½®ï¼ŒåŒå‡»æ— çº¿ç½‘å¡è®¾å¤‡ï¼ˆè¿æ¥ç½‘ç»œçš„é‚£ä¸ªè®¾å¤‡ï¼‰é€‰æ‹©å±æ€§&gt; å…±äº«é€‰é¡¹å¡ å‹¾é€‰<br /><img src="Snipaste_2025-09-07_19-41-42.png" alt="" /></p><p>æç¤ºï¼š<br /><img src="Snipaste_2025-09-07_19-41-53.png" alt="" /></p><p>æ„æ€æ˜¯ï¼šå½“è¯¥åŠŸèƒ½è¢«å¯ç”¨æ—¶ï¼Œä½ çš„LANå£ ipåœ°å€ è‡ªåŠ¨è¢«è®¾ç½®ä¸º <code>192.168.137.1</code>ï¼Œè¦é€šè¿‡è¿™ä¸ªLANå£è¿æ¥ç½‘ç»œçš„è®¾å¤‡éœ€å°†è‡ªå·±ipåœ°å€è®¾ç½®ä¸ºåŠ¨æ€è·å–ï¼Œä¹Ÿå°±æ˜¯åœ¨å¼€å‘æ¿æ‰§è¡Œå‰é¢çš„åŠ¨æ€è·å–ipåœ°å€çš„å‘½ä»¤ã€‚</p><p>å½“å¼€å‘ç‰ˆæˆåŠŸè·å–åˆ°ipåœ°å€ï¼ˆè§åŸºæœ¬æ“ä½œèŠ‚ åˆ†é…ipåœ°å€ï¼‰åï¼Œåˆ™å¯ä»¥æ­£å¸¸å»ºç«‹è¿æ¥ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;details&gt;
&lt;summary&gt;ç‰ˆæƒä¿¡æ¯&lt;/summary&gt;
&lt;div class=&quot;admonition warning&quot;&gt;&lt;p class=&quot;admonition-title&quot;&gt;warning&lt;/p&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª &lt;a href=&quot;https://c</summary>
      
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="è®°å½•" scheme="https://blog.godmao.top/categories/Linux/%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
    <category term="ç½‘ç»œ" scheme="https://blog.godmao.top/Tags/%E7%BD%91%E7%BB%9C/"/>
    
    <category term="é€šä¿¡" scheme="https://blog.godmao.top/Tags/%E9%80%9A%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>æ— èŠéšä¾¿æ‰“ç‚¹å­—</title>
    <link href="https://blog.godmao.top/posts/7593/"/>
    <id>https://blog.godmao.top/posts/7593/</id>
    <published>2025-08-25T07:16:07.000Z</published>
    <updated>2025-09-12T11:32:30.195Z</updated>
    
    <content type="html"><![CDATA[<hr /><h1 id="å’Œæ—¶é—´èµ›è·‘-æ—æ¸…ç„"><a class="markdownIt-Anchor" href="#å’Œæ—¶é—´èµ›è·‘-æ—æ¸…ç„"></a> å’Œæ—¶é—´èµ›è·‘ æ—æ¸…ç„</h1><p>è¯»å°å­¦çš„æ—¶å€™ï¼Œæˆ‘çš„å¤–ç¥–æ¯å»ä¸–äº†ã€‚å¤–ç¥–æ¯ç”Ÿå‰æœ€ç–¼çˆ±æˆ‘ã€‚æˆ‘æ— æ³•æ’é™¤è‡ªå·±çš„å¿§ä¼¤ï¼Œæ¯å¤©åœ¨å­¦æ ¡çš„æ“åœºä¸Šä¸€åœˆä¸€åœˆåœ°è·‘ç€ï¼Œè·‘å¾—ç´¯å€’åœ¨åœ°ä¸Šï¼Œæ‰‘åœ¨è‰åªä¸Šç—›å“­ã€‚</p><p>é‚£å“€ç—›çš„æ—¥å­æŒç»­äº†å¾ˆä¹…ï¼Œçˆ¸çˆ¸å¦ˆå¦ˆä¹Ÿä¸çŸ¥é“å¦‚ä½•å®‰æ…°æˆ‘ã€‚ä»–ä»¬çŸ¥é“ä¸å…¶æ¬ºéª—æˆ‘è¯´å¤–ç¥–æ¯ç¡ç€äº†ï¼Œè¿˜ä¸å¦‚å¯¹æˆ‘è¯´å®è¯ï¼šå¤–ç¥–æ¯æ°¸è¿œä¸ä¼šå›æ¥äº†ã€‚</p><p>â€œä»€ä¹ˆæ˜¯æ°¸è¿œä¸ä¼šå›æ¥äº†å‘¢ï¼Ÿâ€æˆ‘é—®ã€‚</p><p>â€œæ‰€æœ‰æ—¶é—´é‡Œçš„äº‹ç‰©ï¼Œéƒ½æ°¸è¿œä¸ä¼šå›æ¥äº†ï¼Œä½ çš„æ˜¨å¤©è¿‡å»äº†ï¼Œå®ƒå°±æ°¸è¿œå˜æˆæ˜¨å¤©ï¼Œä½ å†ä¹Ÿä¸èƒ½å›åˆ°æ˜¨å¤©äº†ã€‚çˆ¸çˆ¸ä»¥å‰å’Œä½ ä¸€æ ·å°ï¼Œç°åœ¨å†ä¹Ÿä¸èƒ½å›åˆ°ä½ è¿™ä¹ˆå°çš„ç«¥å¹´äº†ã€‚æœ‰ä¸€å¤©ä½ ä¼šé•¿å¤§ï¼Œä½ ä¹Ÿä¼šåƒå¤–ç¥–æ¯ä¸€æ ·è€ï¼Œæœ‰ä¸€å¤©ä½ åº¦è¿‡äº†ä½ çš„æ‰€æœ‰æ—¶é—´ï¼Œä¹Ÿä¼šåƒå¤–ç¥–æ¯ä¸€æ ·æ°¸è¿œä¸èƒ½å›æ¥äº†ã€‚â€çˆ¸çˆ¸è¯´ã€‚</p><p>çˆ¸çˆ¸ç­‰äºç»™æˆ‘è¯´äº†ä¸€ä¸ªè°œï¼Œè¿™ä¸ªè°œæ¯”â€œä¸€å¯¸å…‰é˜´ä¸€å¯¸é‡‘ï¼Œå¯¸é‡‘éš¾ä¹°å¯¸å…‰é˜´â€è¿˜è®©æˆ‘æ„Ÿåˆ°å¯æ€•ï¼Œæ¯”â€œå…‰é˜´ä¼¼ç®­ï¼Œæ—¥æœˆå¦‚æ¢­â€æ›´è®©æˆ‘æœ‰ä¸€ç§è¯´ä¸å‡ºçš„æ»‹å‘³ã€‚</p><p>ä»¥åï¼Œæˆ‘æ¯å¤©æ”¾å­¦å›å®¶ï¼Œåœ¨åº­é™¢æ—¶çœ‹ç€å¤ªé˜³ä¸€å¯¸ä¸€å¯¸åœ°æ²‰è¿›äº†å±±å¤´ï¼Œå°±çŸ¥é“ä¸€å¤©çœŸçš„è¿‡å®Œäº†ã€‚è™½ç„¶æ˜å¤©è¿˜ä¼šæœ‰æ–°çš„å¤ªé˜³ï¼Œä½†æ°¸è¿œä¸ä¼šæœ‰ä»Šå¤©çš„å¤ªé˜³äº†ã€‚</p><p>æˆ‘çœ‹åˆ°é¸Ÿå„¿é£åˆ°å¤©ç©ºï¼Œå®ƒä»¬é£å¾—å¤šå—å‘€ã€‚æ˜å¤©å®ƒä»¬å†é£è¿‡åŒæ ·çš„è·¯çº¿ï¼Œä¹Ÿæ°¸è¿œä¸æ˜¯ä»Šå¤©äº†ã€‚æˆ–è®¸æ˜å¤©é£è¿‡è¿™æ¡è·¯çº¿çš„ï¼Œä¸æ˜¯è€é¸Ÿï¼Œè€Œæ˜¯å°é¸Ÿäº†ã€‚</p><p>æ—¶é—´è¿‡å¾—é£å¿«ï¼Œä½¿æˆ‘çš„å°å¿ƒçœ¼ä¸åªæ˜¯ç€æ€¥ï¼Œè¿˜æœ‰æ‚²ä¼¤ã€‚æœ‰ä¸€å¤©æˆ‘æ”¾å­¦å›å®¶ï¼Œçœ‹åˆ°å¤ªé˜³å¿«è½å±±äº†ï¼Œå°±ä¸‹å†³å¿ƒè¯´ï¼šâ€œæˆ‘è¦æ¯”å¤ªé˜³æ›´å¿«åœ°å›å®¶ã€‚â€æˆ‘ç‹‚å¥”å›å»ï¼Œç«™åœ¨åº­é™¢é‡Œå–˜æ°”çš„æ—¶å€™ï¼Œçœ‹åˆ°å¤ªé˜³è¿˜éœ²ç€åŠè¾¹è„¸ï¼Œæˆ‘é«˜å…´åœ°è·³èµ·æ¥ã€‚é‚£ä¸€å¤©æˆ‘è·‘èµ¢äº†å¤ªé˜³ã€‚ä»¥åæˆ‘å¸¸åšè¿™æ ·çš„æ¸¸æˆï¼Œæœ‰æ—¶å’Œå¤ªé˜³èµ›è·‘ï¼Œæœ‰æ—¶å’Œè¥¿åŒ—é£æ¯”èµ›ï¼Œæœ‰æ—¶ä¸€ä¸ªæš‘å‡çš„ä½œä¸šï¼Œæˆ‘åå¤©å°±åšå®Œäº†ã€‚é‚£æ—¶æˆ‘ä¸‰å¹´çº§ï¼Œå¸¸æŠŠå“¥å“¥äº”å¹´çº§çš„ä½œä¸šæ‹¿æ¥åšã€‚æ¯ä¸€æ¬¡æ¯”èµ›èƒœè¿‡æ—¶é—´ï¼Œæˆ‘å°±å¿«ä¹å¾—ä¸çŸ¥é“æ€ä¹ˆå½¢å®¹ã€‚</p><p>åæ¥äºŒåå¹´é‡Œï¼Œæˆ‘å› æ­¤å—ç›Šæ— ç©·ã€‚è™½ç„¶æˆ‘çŸ¥é“äººæ°¸è¿œè·‘ä¸è¿‡æ—¶é—´ï¼Œä½†æ˜¯å¯ä»¥æ¯”åŸæ¥è·‘å¿«ä¸€æ­¥ï¼Œå¦‚æœåŠ æŠŠåŠ²ï¼Œæœ‰æ—¶å¯ä»¥å¿«å¥½å‡ æ­¥ã€‚é‚£å‡ æ­¥è™½ç„¶å¾ˆå°å¾ˆå°ï¼Œç”¨é€”å´å¾ˆå¤§å¾ˆå¤§ã€‚</p><p>å¦‚æœå°†æ¥æˆ‘æœ‰ä»€ä¹ˆè¦æ•™ç»™å­©å­ï¼Œæˆ‘ä¼šå‘Šè¯‰ä»–ï¼šå‡è‹¥ä½ ä¸€ç›´å’Œæ—¶é—´èµ›è·‘ï¼Œä½ å°±å¯ä»¥æˆåŠŸã€‚</p><h1 id="ç§‹å¤©çš„æ€€å¿µ-å²é“ç”Ÿ"><a class="markdownIt-Anchor" href="#ç§‹å¤©çš„æ€€å¿µ-å²é“ç”Ÿ"></a> ç§‹å¤©çš„æ€€å¿µ å²é“ç”Ÿ</h1><p>åŒè…¿ç˜«ç—ªåï¼Œæˆ‘çš„è„¾æ°”å˜å¾—æš´æ€’æ— å¸¸ã€‚æœ›ç€æœ›ç€å¤©ä¸ŠåŒ—å½’çš„é›é˜µï¼Œæˆ‘ä¼šçªç„¶æŠŠé¢å‰çš„ç»ç’ƒç ¸ç¢ï¼›å¬ç€å¬ç€æè°·ä¸€ç”œç¾çš„æ­Œå£°ï¼Œæˆ‘ä¼šçŒ›åœ°æŠŠæ‰‹è¾¹çš„ä¸œè¥¿æ‘”å‘å››å‘¨çš„å¢™å£ã€‚æ¯äº²å°±æ‚„æ‚„åœ°èº²å‡ºå»ï¼Œåœ¨æˆ‘çœ‹ä¸è§çš„åœ°æ–¹å·å·åœ°å¬ç€æˆ‘çš„åŠ¨é™ã€‚å½“ä¸€åˆ‡æ¢å¤æ²‰å¯‚ï¼Œå¥¹åˆæ‚„æ‚„åœ°è¿›æ¥ï¼Œçœ¼è¾¹çº¢çº¢çš„ï¼Œçœ‹ç€æˆ‘ã€‚â€œå¬è¯´åŒ—æµ·çš„èŠ±å„¿éƒ½å¼€äº†ï¼Œæˆ‘æ¨ä½ å»èµ°èµ°ã€‚â€å¥¹æ€»æ˜¯è¿™ä¹ˆè¯´ã€‚æ¯äº²å–œæ¬¢èŠ±ï¼Œå¯è‡ªä»æˆ‘åŒè…¿ç˜«ç—ªåï¼Œå¥¹ä¾å¼„çš„é‚£äº›èŠ±éƒ½æ­»äº†ã€‚â€œä¸ï¼Œæˆ‘ä¸å»ï¼â€æˆ‘ç‹ å‘½åœ°æ¶æ‰“è¿™ä¸¤æ¡å¯æ¨çš„è…¿ï¼Œå–Šç€ï¼šâ€œæˆ‘æ´»ç€æœ‰ä»€ä¹ˆåŠ²ï¼â€æ¯äº²æ‰‘è¿‡æ¥æŠ“ä½æˆ‘çš„æ‰‹ï¼Œå¿ä½å“­å£°è¯´ï¼šâ€œå’±å¨˜å„¿ä¿©åœ¨ä¸€å—å„¿ï¼Œå¥½å¥½å„¿æ´»â€¦â€¦â€å¯æˆ‘å´ä¸€ç›´éƒ½ä¸çŸ¥é“ï¼Œå¥¹çš„ç—…å·²ç»åˆ°äº†é‚£æ­¥ç”°åœ°ã€‚åæ¥å¦¹å¦¹å‘Šè¯‰æˆ‘ï¼Œå¥¹å¸¸å¸¸è‚ç–¼å¾—æ•´å®¿æ•´å®¿ç¿»æ¥è¦†å»åœ°ç¡ä¸äº†è§‰ã€‚</p><p>é‚£å¤©æˆ‘åˆç‹¬è‡ªååœ¨å±‹é‡Œï¼Œçœ‹ç€çª—å¤–çš„æ ‘å¶â€œå”°å”°å•¦å•¦â€åœ°é£˜è½ã€‚æ¯äº²è¿›æ¥äº†ï¼ŒæŒ¡åœ¨çª—å‰ï¼šâ€œåŒ—æµ·åœ°èŠèŠ±å¼€äº†ï¼Œæˆ‘æ¨ç€ä½ å»çœ‹çœ‹å§ã€‚â€å¥¹æ†”æ‚´çš„è„¸ä¸Šç°å‡ºå¤®æ±‚èˆ¬çš„ç¥è‰²ã€‚â€œä»€ä¹ˆæ—¶å€™ï¼Ÿâ€ä½ è¦æ˜¯æ„¿æ„ï¼Œå°±æ˜å¤©ï¼Ÿâ€œå¥¹è¯´ã€‚æˆ‘çš„å›ç­”å·²ç»è®©å¥¹å–œå‡ºæœ›å¤–äº†ã€‚â€å¥½å§ï¼Œå°±æ˜å¤©ã€‚â€œæˆ‘è¯´ã€‚å¥¹é«˜å…´å¾—ä¸€ä¼šåä¸‹ï¼Œä¸€ä¼šç«™èµ·ï¼šâ€é‚£å°±èµ¶ç´§å‡†å¤‡å‡†å¤‡ã€‚â€œâ€å”‰å‘€ï¼Œçƒ¦ä¸çƒ¦ï¼Ÿå‡ æ­¥è·¯ï¼Œæœ‰ä»€ä¹ˆå¥½å‡†å¤‡çš„ï¼â€œå¥¹ä¹Ÿç¬‘äº†ï¼Œååœ¨æˆ‘èº«è¾¹ï¼Œçµ®çµ®å¨å¨åœ°è¯´ç€â€çœ‹å®ŒèŠèŠ±ï¼Œå’±ä»¬å°±å»â€˜ä»¿è†³â€™ï¼Œä½ å°æ—¶å€™æœ€çˆ±åƒé‚£å„¿çš„è±Œè±†é»„å„¿ã€‚è¿˜è®°å¾—é‚£å›æˆ‘å¸¦ä½ å»åŒ—æµ·å—ï¼Ÿä½ åè¯´é‚£æ¨æ ‘èŠ±æ˜¯æ¯›æ¯›è™«ï¼Œè·‘ç€ï¼Œä¸€è„šè¸©æ‰ä¸€ä¸ªâ€¦â€¦â€œå¥¹å¿½ç„¶ä¸è¯´äº†ã€‚å¯¹äºâ€è·‘â€œå’Œâ€è¸©â€œä¸€ç±»çš„å­—çœ¼å„¿ã€‚å¥¹æ¯”æˆ‘è¿˜æ•æ„Ÿã€‚å¥¹åˆæ‚„æ‚„å‡ºå»äº†ã€‚</p><p>å¥¹å‡ºå»äº†ã€‚å°±å†ä¹Ÿæ²¡å›æ¥ã€‚</p><p>é‚»å±…ä»¬æŠŠå¥¹æŠ¬åˆ°è½¦ä¸Šæ—¶ï¼Œå¥¹è¿˜åœ¨å¤§å£å¤§å£åœ°åç€é²œè¡€ã€‚æˆ‘æ²¡æƒ³åˆ°å¥¹å·²ç»ç—…æˆé‚£æ ·ã€‚çœ‹ç€ä¸‰è½®è½¦è¿œå»ï¼Œä¹Ÿç»æ²¡æœ‰æƒ³åˆ°é‚£ç«Ÿæ˜¯æ°¸è¿œçš„è¯€åˆ«ã€‚</p><p>é‚»å±…çš„å°ä¼™å­èƒŒç€æˆ‘å»çœ‹å¥¹çš„æ—¶å€™ï¼Œå¥¹æ­£è‰°éš¾åœ°å‘¼å¸ç€ï¼Œåƒå¥¹é‚£ä¸€ç”Ÿè‰°éš¾çš„ç”Ÿæ´»ã€‚åˆ«äººå‘Šè¯‰æˆ‘ï¼Œä»–æ˜è¿·å‰çš„æœ€åä¸€å¥è¯æ˜¯ï¼šâ€æˆ‘é‚£ä¸ªæœ‰ç—…çš„å„¿å­å’Œæˆ‘é‚£ä¸ªæœªæˆå¹´çš„å¥³å„¿â€¦â€¦â€œ</p><p>åˆæ˜¯ç§‹å¤©ï¼Œå¦¹å¦¹æ¨ç€æˆ‘å»åŒ—æµ·çœ‹äº†èŠèŠ±ã€‚é»„è‰²çš„èŠ±æ·¡é›…ã€ç™½è‰²çš„èŠ±é«˜æ´ã€ç´«çº¢è‰²çš„èŠ±çƒ­çƒˆè€Œæ·±æ²‰ï¼Œæ³¼æ³¼æ´’æ´’ï¼Œç§‹é£ä¸­æ­£å¼€çš„çƒ‚æ¼«ã€‚æˆ‘æ‡‚å¾—æ¯äº²æ²¡æœ‰è¯´å®Œçš„è¯ï¼Œå¦¹å¦¹ä¹Ÿæ‡‚ã€‚æˆ‘ä¿©åœ¨ä¸€å—å„¿ï¼Œè¦å¥½å¥½å„¿æ´»â€¦â€¦</p>]]></content>
    
    
    <summary type="html">å–µå–µå–µã€‚</summary>
    
    
    
    <category term="å…¶ä»–" scheme="https://blog.godmao.top/categories/%E5%85%B6%E4%BB%96/"/>
    
    
  </entry>
  
  <entry>
    <title>I-MX6ULLçš„ä¸­æ–­å®éªŒï¼ˆä¸‹ï¼‰</title>
    <link href="https://blog.godmao.top/posts/33465/"/>
    <id>https://blog.godmao.top/posts/33465/</id>
    <published>2025-08-24T14:17:34.000Z</published>
    <updated>2025-08-25T08:21:45.638Z</updated>
    
    <content type="html"><![CDATA[<details><summary>ç‰ˆæƒä¿¡æ¯</summary><p>:::warning</p><p>æœ¬æ–‡ç« ä¸ºåšä¸»åŸåˆ›æ–‡ç« ã€‚éµå¾ª <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh-hans">CC 4.0 BY-SA</a> ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p><p>:::</p></details><hr /><h2 id="cè¯­è¨€ä¸‹ä¸­æ–­æ¨¡å—"><a class="markdownIt-Anchor" href="#cè¯­è¨€ä¸‹ä¸­æ–­æ¨¡å—"></a> Cè¯­è¨€ä¸‹ä¸­æ–­æ¨¡å—</h2><h3 id="æ ¸å¿ƒæ€è·¯"><a class="markdownIt-Anchor" href="#æ ¸å¿ƒæ€è·¯"></a> æ ¸å¿ƒæ€è·¯ï¼š</h3><p>æ¯ä¸ªä¸­æ–­å¯¹è±¡åŒ…å«ï¼š1ä¸ªä¸­æ–­å¤„ç†å‡½æ•°å’Œéœ€è¦ä¼ å…¥çš„å‚æ•°â€”â€”ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ+ä¸€ä¸ªæœªå®šä¹‰ç±»å‹æŒ‡é’ˆã€‚æ‰€ä»¥å°†ä¸­æ–­å¯¹è±¡æ‰“åŒ…æˆä¸€ä¸ªç»“æ„ä½“ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* å®šä¹‰ä¸­æ–­å¤„ç†å‡½æ•°åŸå‹ */</span><span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token class-name">sys_irq_handler_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>para<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* å®šä¹‰ä¸­æ–­å‡½æ•°ç»“æ„ä½“ */</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_sys_irq_handle</span><span class="token punctuation">&#123;</span>    <span class="token class-name">sys_irq_handler_t</span> irqHandler<span class="token punctuation">;</span>    <span class="token keyword">void</span><span class="token operator">*</span> usrPara<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">sys_irq_handle_t</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŒ‡å®šä¸€ä¸ªé»˜è®¤ä¸­æ–­å¤„ç†å‡½æ•°ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* å®šä¹‰é»˜è®¤ä¸­æ–­å¤„ç†å‡½æ•° */</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">default_irqHandler</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>para<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å°†æ‰€æœ‰ä¸­æ–­å¯¹è±¡å½’å…¥ä¸€ä¸ªè¡¨ä¸­ï¼ŒæŒ‰ä¸­æ–­idç´¢å¼•ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NUM_OF_IT_VECTORS</span> <span class="token expression"><span class="token number">160</span></span></span><span class="token keyword">static</span> <span class="token class-name">sys_irq_handle_t</span> irqTable<span class="token punctuation">[</span>NUM_OF_IT_VECTORS<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åç»­å¯èƒ½æ¶‰åŠåˆ°ä¸­æ–­åµŒå¥—ï¼Œå› æ­¤å®šä¹‰ä¸€ä¸ªä¸­æ–­åµŒå¥—è®¡æ•°å™¨ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> irqNesting<span class="token punctuation">;</span> <span class="token comment">//ä¸­æ–­åµŒå¥—è®¡æ•°å™¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆå§‹åŒ–ä¸­æ–­å¯¹è±¡è¡¨ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* åˆå§‹åŒ–ä¸­æ–­å¤„ç†è¡¨ */</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sys_iqrTable_init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    irqNesting <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//ä¸­æ–­åµŒå¥—è®¡æ•°å™¨</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> NUM_OF_IT_VECTORS<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        irqTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>irqHandler <span class="token operator">=</span> default_irqHandler<span class="token punctuation">;</span>        irqTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>usrPara <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†å½“è¿›å…¥ä¸­æ–­æ—¶è·³å…¥ä¸€ä¸ªåä¸º<code>system_irqhandler</code>çš„å‡½æ•°å¤„ç†ä¸­æ–­ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å®šä¹‰è¯¥å‡½æ•°ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/// @brief ä¸­æ–­å¤„ç†å‡½æ•°</span><span class="token comment">/// @param gicciar å¯„å­˜å™¨gicciarçš„å€¼</span><span class="token comment">/// @note è¿›å…¥irqä¸­æ–­åè‡ªåŠ¨è°ƒç”¨</span><span class="token keyword">void</span> <span class="token function">system_irqhandler</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> gicciar<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token class-name">uint32_t</span> id <span class="token operator">=</span> gicciar <span class="token operator">&amp;</span> <span class="token number">0x3ff</span><span class="token punctuation">;</span> <span class="token comment">//ä»gicciarå¯„å­˜å™¨ä¸­è¯»å–ä¸­æ–­idå·ï¼ˆ0~9ä½ æ•…&amp; 0x3ffï¼‰</span>    <span class="token comment">/* å®‰å…¨æ£€æŸ¥ */</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">1023</span> <span class="token operator">||</span> id <span class="token operator">>=</span> NUM_OF_IT_VECTORS<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">//1023å³æ²¡æœ‰ä¸­æ–­ï¼Œå³0~9ä½å…¨ä¸º1</span>    irqNesting<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token comment">/* å¼€å§‹å¤„ç† */</span>    irqTable<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">irqHandler</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> irqTable<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>usrPara<span class="token punctuation">)</span><span class="token punctuation">;</span>    irqNesting<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬ä¸å¯èƒ½åªç”¨é»˜è®¤ä¸­æ–­å¤„ç†å‡½æ•°ï¼Œè‚¯å®šè¦è‡ªå·±è‡ªå®šä¹‰ï¼Œè‡ªå®šä¹‰å®Œå¤„ç†å‡½æ•°åï¼Œå°†è¯¥å‡½æ•°æ³¨å†Œç»™ä¸­æ–­å¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç”¨äºæ³¨å†Œçš„å‡½æ•°ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/// @brief ç”¨äºæ³¨å†Œä½ è‡ªå®šä¹‰çš„ä¸­æ–­å¤„ç†å‡½æ•°</span><span class="token comment">/// @param irq_id ä½ ä¸ºå“ªä¸ªä¸­æ–­å†™å¥½äº†å¤„ç†å‡½æ•°ï¼Œå†™å…¥id</span><span class="token comment">/// @param handler ä½ å†™çš„å¤„ç†å‡½æ•°çš„åœ°å€</span><span class="token comment">/// @param para è¦ä¼ å…¥çš„å‚æ•°</span><span class="token keyword">void</span> <span class="token function">register_irqHandler</span><span class="token punctuation">(</span>IRQn_Type irq_id<span class="token punctuation">,</span> <span class="token class-name">sys_irq_handler_t</span> handler<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>para<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    irqTable<span class="token punctuation">[</span>irq_id<span class="token punctuation">]</span><span class="token punctuation">.</span>irqHandler <span class="token operator">=</span> handler<span class="token punctuation">;</span>    irqTable<span class="token punctuation">[</span>irq_id<span class="token punctuation">]</span><span class="token punctuation">.</span>usrPara <span class="token operator">=</span> para<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é…ç½®gpioå¤–éƒ¨ä¸­æ–­"><a class="markdownIt-Anchor" href="#é…ç½®gpioå¤–éƒ¨ä¸­æ–­"></a> é…ç½®gpioå¤–éƒ¨ä¸­æ–­</h2><p>é€šè¿‡åŸç†å›¾å¯çŸ¥ï¼Œåº”é…ç½®ä¸ºä¸Šå‡æ²¿è§¦å‘ã€‚</p><h3 id="é…ç½®gpio_icrå¯„å­˜å™¨"><a class="markdownIt-Anchor" href="#é…ç½®gpio_icrå¯„å­˜å™¨"></a> é…ç½®GPIO_ICRå¯„å­˜å™¨</h3><p>å¯„å­˜å™¨ç”¨äºæŒ‡å®šè§¦å‘æ–¹å¼â€”â€”ä¸Šå‡æ²¿è§¦å‘ã€‚<br />æˆ‘çš„å¼€å‘æ¿åº”æŒ‡å®šGOIO5_ICR1_icr1 ä¸º 10ã€‚</p><h3 id="é…ç½®gpio_imrå¯„å­˜å™¨"><a class="markdownIt-Anchor" href="#é…ç½®gpio_imrå¯„å­˜å™¨"></a> é…ç½®GPIO_IMRå¯„å­˜å™¨</h3><p>è¯¥å¯„å­˜å™¨ç”¨äºä½¿èƒ½ä¸­æ–­ã€‚<br />æˆ‘çš„å¼€å‘æ¿åº”æŒ‡å®šGPIO5_IMR_imr1 ä¸º 1â€”â€”UNMASKED</p><h2 id="ä¸­æ–­åæ¸…é™¤ä¸­æ–­æ ‡å¿—ä½"><a class="markdownIt-Anchor" href="#ä¸­æ–­åæ¸…é™¤ä¸­æ–­æ ‡å¿—ä½"></a> ä¸­æ–­åæ¸…é™¤ä¸­æ–­æ ‡å¿—ä½</h2><p>å‚è€ƒæ‰‹å†Œä¸­æŒ‡å‡ºï¼Œå¤„ç†å®Œä¸­æ–­åï¼Œéœ€æ¸…é™¤GPIO_ISRå¯„å­˜å™¨çš„ç›¸åº”ä½ã€‚<br />éœ€è¦æ³¨æ„çš„æ˜¯<strong>é€šè¿‡å¯¹è¯¥ä½å†™1æ¸…é™¤ã€‚</strong></p><h2 id="gic-é…ç½®"><a class="markdownIt-Anchor" href="#gic-é…ç½®"></a> GIC é…ç½®</h2><p>just like NVICâ€¦ you must know cubemx rightï¼Ÿ</p><h3 id="ä½¿èƒ½ç›¸åº”çš„ä¸­æ–­id"><a class="markdownIt-Anchor" href="#ä½¿èƒ½ç›¸åº”çš„ä¸­æ–­id"></a> ä½¿èƒ½ç›¸åº”çš„ä¸­æ–­ID</h3><p>GPIO5_1å¯¹åº”çš„ä¸­æ–­idä¸º74<br /><img src="Snipaste_2025-08-24_23-51-22.png" alt="" /><br />ä½†æ˜¯æ³¨æ„è¿™æ®µè¯ï¼š<br /><img src="Snipaste_2025-08-24_23-53-41.png" alt="" /></p><p>å‘Šè¯‰æˆ‘ä»¬å‰é¢è¿˜æœ‰32ä¸ªä¸­æ–­æ¥åˆ°äº†CPUçš„æ¥å£ æ‰€ä»¥ä¸­æ–­IDä¸º 74+32 = 106ã€‚</p><h3 id="é…ç½®ä¸­æ–­ä¼˜å…ˆçº§"><a class="markdownIt-Anchor" href="#é…ç½®ä¸­æ–­ä¼˜å…ˆçº§"></a> é…ç½®ä¸­æ–­ä¼˜å…ˆçº§</h3><h2 id="æ³¨å†Œä¸­æ–­å¤„ç†å‡½æ•°"><a class="markdownIt-Anchor" href="#æ³¨å†Œä¸­æ–­å¤„ç†å‡½æ•°"></a> æ³¨å†Œä¸­æ–­å¤„ç†å‡½æ•°</h2>]]></content>
    
    
    <summary type="html">æœ¬ç¯‡ç¼–å†™cè¯­è¨€ä¸­çš„ä¸­æ–­æ¨¡å—å¹¶é…ç½®GPIOå¤–éƒ¨ä¸­æ–­ã€‚</summary>
    
    
    
    <category term="Linux" scheme="https://blog.godmao.top/categories/Linux/"/>
    
    <category term="è®°å½•" scheme="https://blog.godmao.top/categories/Linux/%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="åµŒå…¥å¼" scheme="https://blog.godmao.top/Tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
    <category term="Linux" scheme="https://blog.godmao.top/Tags/Linux/"/>
    
  </entry>
  
</feed>
